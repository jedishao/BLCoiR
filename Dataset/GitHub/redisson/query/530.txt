server deal line claster run promise deadlock load rate function get lock client connection end state nobody redirection junit test issue nightmare something exit future logic headache