ledger sequenceidwitherrortest test race reconnection broker error condition failure producer topic consumer case fencing