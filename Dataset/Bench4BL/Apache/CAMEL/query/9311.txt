Concurrency issue with the dynamic router