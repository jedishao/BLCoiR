Redisson hang on RBatch.execute()

Hi, we are using redisson client for our multi-threaded application.

We use RBatch to batch two commands as below:

During the test, we noticed the hang several time.

We first show this error first before the hang:


Then our thread calling the batch hung. There is the stacktrace:

java.lang.Thread.State: WAITING (parking) at sun.misc.Unsafe.park(Native Method) - parking to wait for  <0x00000007bafd7438> (a java.util.concurrent.CountDownLatch$Sync) at java.util.concurrent.locks.LockSupport.park(LockSupport.java:175) at java.util.concurrent.locks.AbstractQueuedSynchronizer.parkAndCheckInterrupt(AbstractQueuedSynchronizer.java:836) at java.util.concurrent.locks.AbstractQueuedSynchronizer.doAcquireSharedInterruptibly(AbstractQueuedSynchronizer.java:997) at java.util.concurrent.locks.AbstractQueuedSynchronizer.acquireSharedInterruptibly(AbstractQueuedSynchronizer.java:1304) at java.util.concurrent.CountDownLatch.await(CountDownLatch.java:231) at org.redisson.command.CommandAsyncService.get(CommandAsyncService.java:148) at org.redisson.command.CommandBatchService.execute(CommandBatchService.java:134) at org.redisson.RedissonBatch.execute(RedissonBatch.java:253)

I tried to set the lower lockWatchdogTimeout and set the batch timeout but this did not help.

