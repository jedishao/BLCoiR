Replace runnables directly added to runtime shutdown hooks to avoid deadlock.
Deepesh Khandelwal reported that a deadlock can occur when running queries through hive cli. 
Chris Nauroth analyzed it and reported that hive adds shutdown hooks directly to java Runtime which may execute in non-deterministic order causing deadlocks with hadoop's shutdown hooks.
In one case, hadoop shutdown locked FileSystem#Cache and FileSystem.close whereas hive shutdown hook locked FileSystem.close and FileSystem#Cache order causing a deadlock.
Hive and Hadoop has ShutdownHookManager that runs the shutdown hooks in deterministic order based on priority. 
We should use that to avoid deadlock throughout the code.