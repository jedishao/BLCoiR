<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Thu Dec 01 20:26:59 UTC 2016

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/COMPRESS-105/COMPRESS-105.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[COMPRESS-105] While Archiving the empty directories are not archived to the archive.</title>
                <link>https://issues.apache.org/jira/browse/COMPRESS-105</link>
                <project id="12310904" key="COMPRESS">Commons Compress</project>
                    <description>&lt;p&gt;I am trying to create a zip archive. I am having a empty directory &quot;test&quot; . When i try to create it to archive . The archive created but the test folder is created as file. And also I got the below exception.&lt;/p&gt;

&lt;p&gt;Temp file created at C:\Users\Soundar\AppData\Local\Temp\sample5278197872513888977.zip&lt;br/&gt;
Exception in thread &quot;main&quot; java.io.IOException: This archives contains unclosed entries.&lt;br/&gt;
	at org.apache.commons.compress.archivers.zip.ZipArchiveOutputStream.finish(ZipArchiveOutputStream.java:343)&lt;br/&gt;
	at org.apache.commons.compress.archivers.zip.ZipArchiveOutputStream.close(ZipArchiveOutputStream.java:550)&lt;br/&gt;
	at com.tcs.tools.archive.test.ArchiveTest.createArchive(ArchiveTest.java:64)&lt;br/&gt;
	at com.tcs.tools.archive.test.ArchiveTest.main(ArchiveTest.java:119)&lt;/p&gt;

&lt;p&gt;Code used&lt;br/&gt;
-------------&lt;/p&gt;

&lt;p&gt;	protected File createArchive(String archivename) throws Exception {&lt;br/&gt;
		ArchiveOutputStream out = null;&lt;br/&gt;
		OutputStream stream = null;&lt;br/&gt;
		ArchiveStreamFactory factory = new ArchiveStreamFactory();&lt;br/&gt;
		try &lt;/p&gt;
{
			File archive = File.createTempFile(&quot;sample&quot;, &quot;.&quot; + archivename);
			System.out.println(&quot;Temp file created at &quot; + archive.getAbsolutePath());
			List archiveList = new ArrayList();

			stream = new FileOutputStream(archive);
			out = factory.createArchiveOutputStream(archivename, stream);
			final File file7 = new File(&quot;C:\\Users\\Soundar\\Desktop\\test&quot;);

			addArchiveEntry(out, &quot;test&quot;, file7);
			System.out.println(&quot;Going to process directory&quot;);
			System.out.println(&quot;Directory Name =&quot; + file7.getName());
			ArchiveEntry entry = out.createArchiveEntry(file7, &quot;test&quot;);
			out.putArchiveEntry(entry);
			IOUtils.copy(new FileInputStream(file7), out);
			out.closeArchiveEntry();

			out.finish();
			return archive;
		}
&lt;p&gt; finally {&lt;br/&gt;
			if (out != null) &lt;/p&gt;
{
				out.close();
			}
&lt;p&gt; else if (stream != null) &lt;/p&gt;
{
				stream.close();
			}
&lt;p&gt;		}&lt;br/&gt;
	}&lt;/p&gt;

&lt;p&gt;Note&lt;br/&gt;
------&lt;/p&gt;

&lt;p&gt;I tried the same archiving using the compressed zip of Windows Vista default feature. It creates the Sample.zip which contains the empty test folder as archived.&lt;/p&gt;

&lt;p&gt;I know there is a work around  using java.util.zip.zipEntry. But is there a  work around in our Compress itself?&lt;/p&gt;</description>
                <environment>&lt;p&gt;64 bit Windows Vista, JDK1.4.1_11&lt;/p&gt;</environment>
        <key id="12462322">COMPRESS-105</key>
            <summary>While Archiving the empty directories are not archived to the archive.</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/bug.png">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.png">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="soundararajan@jira">Soundararajan Thevaraj</reporter>
                        <labels>
                    </labels>
                <created>Sat, 17 Apr 2010 14:39:44 +0000</created>
                <updated>Mon, 19 Apr 2010 16:17:06 +0000</updated>
                            <resolved>Mon, 19 Apr 2010 16:17:06 +0000</resolved>
                                    <version>1.0</version>
                                    <fixVersion>1.1</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>1</watches>
                                                                <comments>
                            <comment id="12858442" author="bodewig" created="Mon, 19 Apr 2010 10:05:11 +0000"  >&lt;p&gt;We don&apos;t see your addArchiveEntry method, but I suspect I know what the problem is.&lt;/p&gt;

&lt;p&gt;It isn&apos;t properly document and I&apos;ll change that soonish: the name of an ZipArchiveEntry determines whether an entry is considered a directory or not.  If you don&apos;t use the constructor with the File argument the entry&apos;s name must end in a &quot;/&quot; in order for the entry to be known as a directory.&lt;/p&gt;</comment>
                            <comment id="12858476" author="soundararajan@jira" created="Mon, 19 Apr 2010 12:48:28 +0000"  >&lt;p&gt;Hi Stefan,&lt;/p&gt;

&lt;p&gt;   Thanks for your comments. But i tried by adding the &quot;/&quot; at the end of the entry name. It was not working. I have attached the java file for your reference. Kindly review that.&lt;/p&gt;

&lt;p&gt;I am trying to archive a folder &quot;test&quot; which contains the child folder called &quot;empty folder&quot; with zero entries.&lt;/p&gt;

&lt;p&gt;But Getting the same exception as below&lt;br/&gt;
File Created in PathC:\DOCUME~1\157558\LOCALS~1\Temp\sample738293534710494610.zip&lt;br/&gt;
FileName =test/&lt;br/&gt;
Exception in thread &quot;main&quot; java.io.IOException: This archives contains unclosed entries.&lt;br/&gt;
	at org.apache.commons.compress.archivers.zip.ZipArchiveOutputStream.finish(ZipArchiveOutputStream.java:343)&lt;br/&gt;
	at org.apache.commons.compress.archivers.zip.ZipArchiveOutputStream.close(ZipArchiveOutputStream.java:550)&lt;br/&gt;
	at TestDirectory.createArchive(TestDirectory.java:49)&lt;br/&gt;
	at TestDirectory.main(TestDirectory.java:66)&lt;/p&gt;</comment>
                            <comment id="12858480" author="soundararajan@jira" created="Mon, 19 Apr 2010 12:55:34 +0000"  >&lt;p&gt;For your reference . I have attached screen shot of the archive created using Compressed Zip of Windows XP.&lt;/p&gt;</comment>
                            <comment id="12858489" author="bodewig" created="Mon, 19 Apr 2010 13:51:19 +0000"  >&lt;p&gt;I&apos;m having a hard time converting your source file from RTF to a real source file. &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/wink.gif&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;

&lt;p&gt;Does the problem go away if you remove the IOUtils.copy() line from addArchiveEntry?&lt;/p&gt;

&lt;p&gt;I think the exception you see stemming from close() in your finally block is actualy hiding a different exception thrown in addArchiveEntry.&lt;/p&gt;</comment>
                            <comment id="12858571" author="soundararajan@jira" created="Mon, 19 Apr 2010 16:05:35 +0000"  >&lt;p&gt;Hi Stefan,&lt;/p&gt;

&lt;p&gt;    My sincere apologize for the file corruption. !!&lt;span class=&quot;error&quot;&gt;Unable to render embedded object: File (Hurray) not found.&lt;/span&gt;!!!. After removing IOUtils.copy it worked. I can able to generate the Zip archive containing test/emptyfolder. Great help. Bunch of thanks to you.&lt;/p&gt;</comment>
                            <comment id="12858582" author="bodewig" created="Mon, 19 Apr 2010 16:17:06 +0000"  >&lt;p&gt;this is between &quot;not a problem&quot; and &quot;fixed via better documentation&quot;&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12442180" name="ArchiveIssue.JPG" size="79807" author="soundararajan@jira" created="Mon, 19 Apr 2010 12:55:34 +0000"/>
                            <attachment id="12442179" name="TestDirectory.java" size="4237" author="soundararajan@jira" created="Mon, 19 Apr 2010 12:48:28 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Mon, 19 Apr 2010 10:05:11 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>40277</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            6 years, 33 weeks, 3 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0b4jj:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>62848</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        </customfields>
    </item>
</channel>
</rss>