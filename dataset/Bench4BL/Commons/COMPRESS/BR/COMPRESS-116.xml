<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Fri Dec 02 18:24:06 UTC 2016

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/COMPRESS-116/COMPRESS-116.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[COMPRESS-116] ZipArchiveInputStream fails to uncompress stream generated by InfoZip</title>
                <link>https://issues.apache.org/jira/browse/COMPRESS-116</link>
                <project id="12310904" key="COMPRESS">Commons Compress</project>
                    <description>&lt;p&gt;Current Compress implementation silently fails to uncompress streaming zip coming from Info-ZIP. &lt;br/&gt;
Should this behaviour proven to be adherent to spec, some sort of Exception should be thrown instead of silencing the error.&lt;/p&gt;

&lt;p&gt;Steps to reproduce:&lt;/p&gt;

&lt;p&gt;1. Download sample-*.zip. These two files were generated with Info-ZIP. &lt;/p&gt;

&lt;p&gt;sample-ordinary.zip was generated with &quot;zip -r sample-ordinary.zip temp/&quot;.&lt;/p&gt;

&lt;p&gt;sample-streaming.zip was generated with &quot;zip -fd -r - temp/ &amp;gt; sample-streaming.zip&quot;. Note that &quot;-fd&quot; flag forces data descriptors in stream. This is enabled automatically if the pipe sink is not the file, e.g. if you call it as &quot;zip -r - temp/ | pv &amp;gt; sample-streaming.zip&quot;. For convenience, I did it by forcing descriptors via flag.&lt;/p&gt;

&lt;p&gt;2. Download, compile and run TestInfoZip.java, placing Compress on classpath.&lt;/p&gt;

&lt;p&gt;3. Observe the following output:&lt;/p&gt;

&lt;p&gt;Reading sample-ordinary.zip&lt;br/&gt;
name=temp/, size=0&lt;br/&gt;
Read 0 bytes&lt;br/&gt;
name=temp/test.100, size=100&lt;br/&gt;
Read 100 bytes&lt;br/&gt;
name=temp/test.10000, size=10000&lt;br/&gt;
Read 10000 bytes&lt;br/&gt;
name=temp/test.10000.zip, size=10170&lt;br/&gt;
Read 10170 bytes&lt;br/&gt;
name=temp/test.1M, size=1048576&lt;br/&gt;
Read 1048576 bytes&lt;br/&gt;
name=temp/test.10M, size=10485760&lt;br/&gt;
Read 10485760 bytes&lt;/p&gt;

&lt;p&gt;Reading sample-streaming.zip&lt;br/&gt;
name=temp/, size=0&lt;br/&gt;
Read 0 bytes&lt;br/&gt;
name=temp/test.100, size=-1&lt;br/&gt;
Read 100 bytes&lt;br/&gt;
name=temp/test.10000, size=-1&lt;br/&gt;
Read 10000 bytes&lt;br/&gt;
name=temp/test.10M, size=-1&lt;br/&gt;
Read 10485760 bytes&lt;br/&gt;
name=temp/test.10000.zip, size=-1&lt;br/&gt;
Read 0 bytes&lt;/p&gt;

&lt;p&gt;Note that sample-ordinary is read OK, while streaming version had failed read on one of the entries. &lt;br/&gt;
No exceptions are thrown, the implementation thinks the stream is actually over.&lt;/p&gt;

&lt;p&gt;Another finding: this reproduces perfectly when there&apos;s at least one STORED entry in the stream. &lt;br/&gt;
Generating Info-ZIP files with maximum compression (e.g. all entries are DEFLATED) works around this problem.&lt;/p&gt;</description>
                <environment>&lt;p&gt;Linux, Info-ZIP 3.0 (July 5th 2008), Compress 1.0&lt;/p&gt;</environment>
        <key id="12468556">COMPRESS-116</key>
            <summary>ZipArchiveInputStream fails to uncompress stream generated by InfoZip</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/bug.png">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.png">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="3">Duplicate</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="aleksey.shipilev">Aleksey Shipilev</reporter>
                        <labels>
                    </labels>
                <created>Mon, 5 Jul 2010 12:27:05 +0000</created>
                <updated>Mon, 5 Jul 2010 13:53:00 +0000</updated>
                            <resolved>Mon, 5 Jul 2010 13:09:03 +0000</resolved>
                                    <version>1.0</version>
                                    <fixVersion>1.1</fixVersion>
                                    <component>Archivers</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                <comments>
                            <comment id="12885204" author="aleksey.shipilev" created="Mon, 5 Jul 2010 12:28:08 +0000"  >&lt;p&gt;Sample ZIP files and test.&lt;/p&gt;</comment>
                            <comment id="12885209" author="bodewig" created="Mon, 5 Jul 2010 12:48:42 +0000"  >&lt;p&gt;I think this is a duplicate of &lt;a href=&quot;https://issues.apache.org/jira/browse/COMPRESS-103&quot; title=&quot;allow data descriptors to follow STORED entries in ZIP archives being read&quot; class=&quot;issue-link&quot; data-issue-key=&quot;COMPRESS-103&quot;&gt;&lt;del&gt;COMPRESS-103&lt;/del&gt;&lt;/a&gt; which is fixed in trunk.&lt;/p&gt;</comment>
                            <comment id="12885221" author="aleksey.shipilev" created="Mon, 5 Jul 2010 13:05:44 +0000"  >&lt;p&gt;Hi Stefan, thanks for the pointer!&lt;br/&gt;
This is with today&apos;s trunk:&lt;/p&gt;

&lt;p&gt;------------------- cut ---------------------&lt;/p&gt;

&lt;p&gt;$ java -cp ~/trunks/commons-compress/target/commons-compress-1.1-SNAPSHOT.jar:. TestInfoZip&lt;br/&gt;
Reading sample-ordinary.zip&lt;br/&gt;
name=temp/, size=0&lt;br/&gt;
Read 0 bytes&lt;br/&gt;
name=temp/test.100, size=100&lt;br/&gt;
Read 100 bytes&lt;br/&gt;
name=temp/test.10000, size=10000&lt;br/&gt;
Read 10000 bytes&lt;br/&gt;
name=temp/test.10000.zip, size=10170&lt;br/&gt;
Read 10170 bytes&lt;br/&gt;
name=temp/test.1M, size=1048576&lt;br/&gt;
Read 1048576 bytes&lt;br/&gt;
name=temp/test.10M, size=10485760&lt;br/&gt;
Read 10485760 bytes&lt;/p&gt;


&lt;p&gt;Reading sample-streaming.zip&lt;br/&gt;
name=temp/, size=0&lt;br/&gt;
Read 0 bytes&lt;br/&gt;
name=temp/test.100, size=-1&lt;br/&gt;
Read 100 bytes&lt;br/&gt;
name=temp/test.10000, size=-1&lt;br/&gt;
Read 10000 bytes&lt;br/&gt;
name=temp/test.10M, size=-1&lt;br/&gt;
Read 10485760 bytes&lt;br/&gt;
name=temp/test.10000.zip, size=-1&lt;br/&gt;
Exception in thread &quot;main&quot; org.apache.commons.compress.archivers.zip.UnsupportedZipFeatureException: unsupported feature data descriptor used in entry temp/test.10000.zip&lt;br/&gt;
	at org.apache.commons.compress.archivers.zip.ZipArchiveInputStream.read(ZipArchiveInputStream.java:245)&lt;br/&gt;
	at java.io.InputStream.read(InputStream.java:85)&lt;br/&gt;
	at TestInfoZip.read(TestInfoZip.java:27)&lt;br/&gt;
	at TestInfoZip.main(TestInfoZip.java:13)&lt;/p&gt;

&lt;p&gt;------------------- cut ---------------------&lt;/p&gt;

&lt;p&gt;Is this intended behaviour?&lt;/p&gt;</comment>
                            <comment id="12885227" author="bodewig" created="Mon, 5 Jul 2010 13:09:03 +0000"  >&lt;p&gt;Yep, I&apos;ve tested your test archive against trunk, enabling data descriptors for STORED entries explicitly, and it extracts just fine.&lt;/p&gt;

&lt;p&gt;Duplicate of &lt;a href=&quot;https://issues.apache.org/jira/browse/COMPRESS-103&quot; title=&quot;allow data descriptors to follow STORED entries in ZIP archives being read&quot; class=&quot;issue-link&quot; data-issue-key=&quot;COMPRESS-103&quot;&gt;&lt;del&gt;COMPRESS-103&lt;/del&gt;&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="12885229" author="aleksey.shipilev" created="Mon, 5 Jul 2010 13:14:51 +0000"  >&lt;p&gt;Stafan, I&apos;m puzzled. You had tested against the fresh trunk, with these two archives attached to this issue, and had not see the exception?&lt;br/&gt;
Because I seem to be doing precisely the same, and exception is there.&lt;/p&gt;</comment>
                            <comment id="12885232" author="bodewig" created="Mon, 5 Jul 2010 13:24:33 +0000"  >&lt;p&gt;The piece you&apos;ve missed from my comment was &quot;enabling data descriptors for STORED entries explicitly&quot; 8-)&lt;/p&gt;

&lt;p&gt;Data Descriptors, STORED entries and streaming are a dangerous combination and you must explicitly&lt;br/&gt;
enable it with a new constructor argument in order to use it.  If you don&apos;t enable it you get the exception&lt;br/&gt;
(rather than a truncated entry like in 1.0).&lt;/p&gt;</comment>
                            <comment id="12885233" author="bodewig" created="Mon, 5 Jul 2010 13:30:23 +0000"  >&lt;p&gt;Background: &lt;a href=&quot;http://svn.apache.org/viewvc/commons/proper/compress/trunk/src/site/xdoc/zip.xml?p2=%2Fcommons%2Fproper%2Fcompress%2Ftrunk%2Fsrc%2Fsite%2Fxdoc%2Fzip.xml&amp;amp;p1=%2Fcommons%2Fproper%2Fcompress%2Ftrunk%2Fsrc%2Fsite%2Fxdoc%2Fzip.xml&amp;amp;r1=925271&amp;amp;r2=925270&amp;amp;view=diff&amp;amp;pathrev=925271&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://svn.apache.org/viewvc/commons/proper/compress/trunk/src/site/xdoc/zip.xml?p2=%2Fcommons%2Fproper%2Fcompress%2Ftrunk%2Fsrc%2Fsite%2Fxdoc%2Fzip.xml&amp;amp;p1=%2Fcommons%2Fproper%2Fcompress%2Ftrunk%2Fsrc%2Fsite%2Fxdoc%2Fzip.xml&amp;amp;r1=925271&amp;amp;r2=925270&amp;amp;view=diff&amp;amp;pathrev=925271&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="12885237" author="aleksey.shipilev" created="Mon, 5 Jul 2010 13:53:00 +0000"  >&lt;p&gt;Right, I see now. The proposed workaround seem to be very dangerous.&lt;br/&gt;
Let me think about it.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12448694" name="TestInfoZip.java" size="1213" author="aleksey.shipilev" created="Mon, 5 Jul 2010 12:28:07 +0000"/>
                            <attachment id="12448692" name="sample-ordinary.zip" size="32437" author="aleksey.shipilev" created="Mon, 5 Jul 2010 12:28:07 +0000"/>
                            <attachment id="12448693" name="sample-streaming.zip" size="32527" author="aleksey.shipilev" created="Mon, 5 Jul 2010 12:28:07 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>3.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Mon, 5 Jul 2010 12:48:42 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>40274</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            6 years, 22 weeks, 4 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0th0v:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>170067</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        </customfields>
    </item>
</channel>
</rss>