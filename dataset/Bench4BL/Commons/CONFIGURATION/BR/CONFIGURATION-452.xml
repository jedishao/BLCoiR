<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Thu Dec 01 19:40:06 UTC 2016

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/CONFIGURATION-452/CONFIGURATION-452.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[CONFIGURATION-452] HierarchicalConfiguration with XPathExpressionEngine does not work when setting a new property</title>
                <link>https://issues.apache.org/jira/browse/CONFIGURATION-452</link>
                <project id="12310467" key="CONFIGURATION">Commons Configuration</project>
                    <description>&lt;p&gt;The following code does not work as expected&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-style: solid;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeHeader panelHeader&quot; style=&quot;border-bottom-width: 1px;border-bottom-style: solid;&quot;&gt;&lt;b&gt;Bug.java&lt;/b&gt;&lt;/div&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
&lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; class Bug {

	&lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;static&lt;/span&gt; void main(&lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt;[] args) {
		&lt;span class=&quot;code-keyword&quot;&gt;try&lt;/span&gt; {
			XMLConfiguration config = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; XMLConfiguration();
			&lt;span class=&quot;code-comment&quot;&gt;// works
&lt;/span&gt;			config.setProperty(&lt;span class=&quot;code-quote&quot;&gt;&quot;test.property[@attribute]&quot;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&quot;value&quot;&lt;/span&gt;);
			config.setExpressionEngine(&lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; XPathExpressionEngine());
			config.save(&lt;span class=&quot;code-object&quot;&gt;System&lt;/span&gt;.out);
			&lt;span class=&quot;code-comment&quot;&gt;// works
&lt;/span&gt;			config.setProperty(&lt;span class=&quot;code-quote&quot;&gt;&quot;test/property/@attribute&quot;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&quot;value&quot;&lt;/span&gt;);
                        &lt;span class=&quot;code-comment&quot;&gt;// does not work
&lt;/span&gt;			config.setProperty(&lt;span class=&quot;code-quote&quot;&gt;&quot;test/property/@attribute2&quot;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&quot;value&quot;&lt;/span&gt;);
		} &lt;span class=&quot;code-keyword&quot;&gt;catch&lt;/span&gt; (ConfigurationException e) {
			&lt;span class=&quot;code-comment&quot;&gt;// @FIXME Traitement d&apos;exception par defaut
&lt;/span&gt;			&lt;span class=&quot;code-keyword&quot;&gt;throw&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; RuntimeException(e);
		}

	}
}
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;hangs with the following exception:&lt;/p&gt;


&lt;p&gt;Exception in thread &quot;main&quot; java.lang.IllegalArgumentException: prepareAdd: Passed in key must contain a whitespace!&lt;br/&gt;
	at org.apache.commons.configuration.tree.xpath.XPathExpressionEngine.prepareAdd(XPathExpressionEngine.java:223)&lt;br/&gt;
	at org.apache.commons.configuration.HierarchicalConfiguration.addPropertyDirect(HierarchicalConfiguration.java:371)&lt;br/&gt;
	at org.apache.commons.configuration.AbstractHierarchicalFileConfiguration.addPropertyDirect(AbstractHierarchicalFileConfiguration.java:140)&lt;br/&gt;
	at org.apache.commons.configuration.HierarchicalConfiguration.setProperty(HierarchicalConfiguration.java:749)&lt;br/&gt;
	at org.apache.commons.configuration.AbstractHierarchicalFileConfiguration.setProperty(AbstractHierarchicalFileConfiguration.java:158)&lt;br/&gt;
	at Bug.main(Bug.java:29)&lt;/p&gt;

&lt;p&gt;the setProperty() method does not work if the property have to be added. This behavior is not really wanted, because in some generic cases, we don&apos;t know if the property is set or not before trying to set it.&lt;/p&gt;</description>
                <environment>&lt;p&gt;all&lt;/p&gt;</environment>
        <key id="12509855">CONFIGURATION-452</key>
            <summary>HierarchicalConfiguration with XPathExpressionEngine does not work when setting a new property</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/bug.png">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.png">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="oliver.heger@t-online.de">Oliver Heger</assignee>
                                    <reporter username="fabien_nisol">Fabien Nisol</reporter>
                        <labels>
                    </labels>
                <created>Fri, 10 Jun 2011 18:12:42 +0000</created>
                <updated>Thu, 8 Sep 2011 09:20:11 +0000</updated>
                            <resolved>Thu, 4 Aug 2011 20:12:10 +0000</resolved>
                                    <version>1.6</version>
                                    <fixVersion>1.7</fixVersion>
                                    <component>Expression engine</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                <comments>
                            <comment id="13051726" author="oliver.heger@t-online.de" created="Sun, 19 Jun 2011 19:46:02 +0000"  >&lt;p&gt;Thanks for reporting this.&lt;/p&gt;

&lt;p&gt;This is probably not trivial to fix because the XPATH expression passed to setProperty() has to be interpreted to find the parent of the selected node. Is there a way in XPATH to retrieve the parent of an expression?&lt;/p&gt;

&lt;p&gt;Will have to think about it and have a look at the XPATH spec. Ideas or even patches are welcome.&lt;/p&gt;</comment>
                            <comment id="13052158" author="fabien_nisol" created="Mon, 20 Jun 2011 19:01:07 +0000"  >&lt;p&gt;The following scenario si probably not the best concerning performance, but it maybe worth a try:&lt;/p&gt;

&lt;ol&gt;
	&lt;li&gt;check if the xpath expression leads to an existing node
	&lt;ol&gt;
		&lt;li&gt;if it does, simply modify it&lt;/li&gt;
	&lt;/ol&gt;
	&lt;/li&gt;
	&lt;li&gt;if it does not
	&lt;ol&gt;
		&lt;li&gt;decompose the xpath into sub-paths using &quot;/&quot;&lt;/li&gt;
		&lt;li&gt;recompose the path, one after the other&lt;/li&gt;
		&lt;li&gt;when the element cannot be found, create it&lt;/li&gt;
	&lt;/ol&gt;
	&lt;/li&gt;
&lt;/ol&gt;


&lt;p&gt;However, the rule to recreate the node could be quite complex. &lt;/p&gt;

&lt;p&gt;For example:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
&amp;lt;property&amp;gt;
  &amp;lt;to&amp;gt;
  &amp;lt;/to&amp;gt;
&amp;lt;/property&amp;gt;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;calling setProperty(&quot;/property/to&lt;span class=&quot;error&quot;&gt;&amp;#91;@set=&amp;#39;a_selector&amp;#39;&amp;#93;&lt;/span&gt;/@attribute&quot;,&quot;a_value&quot;);&lt;/p&gt;

&lt;p&gt;would need to create a @set attribute with the value &apos;a_selector&apos; , and then add an attribute &apos;@attribute&apos; with the value &apos;a_value&apos;&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
&amp;lt;property&amp;gt;
  &amp;lt;to set=&lt;span class=&quot;code-quote&quot;&gt;&quot;a_selector&quot;&lt;/span&gt; attribute=&lt;span class=&quot;code-quote&quot;&gt;&quot;a_value&quot;&lt;/span&gt;/&amp;gt;
&amp;lt;/property&amp;gt;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;I agree, all this seem easier to say than to realize !&lt;/p&gt;


</comment>
                            <comment id="13054048" author="oliver.heger@t-online.de" created="Thu, 23 Jun 2011 19:26:19 +0000"  >&lt;p&gt;Yes, this is the reason why it was never implemented &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/wink.gif&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;

&lt;p&gt;I am currently busy with other things, but this issue is on my radar. I will continue thinking about a solution.&lt;/p&gt;</comment>
                            <comment id="13072989" author="oliver.heger@t-online.de" created="Fri, 29 Jul 2011 19:28:48 +0000"  >&lt;p&gt;A fix was committed in revision 1152343. XPathExpressionEngine can now deal with keys for adding or setting properties which do not have to contain a whitespace. It tries to guess the location where to insert the new nodes.&lt;/p&gt;

&lt;p&gt;I am not sure whether this fixes all problems or works with all possible keys. It would be good if you could give it a try. Simple scenarios as in your example should be supported now; I have added a new unit test class to verify this.&lt;/p&gt;

&lt;p&gt;I still have to update the Javadocs and the documentation accordingly.&lt;/p&gt;</comment>
                            <comment id="13072996" author="fabien_nisol" created="Fri, 29 Jul 2011 19:41:26 +0000"  >&lt;p&gt;Thanks, I will test this revision as soon as I am back working on the project that needed that &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/tongue.gif&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;</comment>
                            <comment id="13079562" author="oliver.heger@t-online.de" created="Thu, 4 Aug 2011 20:12:10 +0000"  >&lt;p&gt;Marking this issue as fixed because the reported problem should be solved. Feel free to reopen - or create a new issue - if you encounter further problems.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Sun, 19 Jun 2011 19:46:02 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>61952</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            5 years, 17 weeks, 6 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0l69j:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>121665</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        </customfields>
    </item>
</channel>
</rss>