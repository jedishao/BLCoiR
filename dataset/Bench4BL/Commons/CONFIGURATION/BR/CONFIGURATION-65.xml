<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Thu Dec 01 20:05:13 UTC 2016

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/CONFIGURATION-65/CONFIGURATION-65.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[CONFIGURATION-65] [configuration] XMLConfiguration cannot load from a jar</title>
                <link>https://issues.apache.org/jira/browse/CONFIGURATION-65</link>
                <project id="12310467" key="CONFIGURATION">Commons Configuration</project>
                    <description>&lt;p&gt;In the current RC1 codebase, the XMLConfiguration class cannot read an xml &lt;br/&gt;
configuration file packaged in a jar file. The PropertiesConfiguration class &lt;br/&gt;
handles this correctly using an InputStream rather than a File object, but the &lt;br/&gt;
XMLConfiguration does not.&lt;/p&gt;

&lt;p&gt;Here is a patch for XMLConfiguration that lets you put XML files into a jar &lt;br/&gt;
file.&lt;/p&gt;

&lt;p&gt;Index: XMLConfiguration.java&lt;br/&gt;
===================================================================&lt;br/&gt;
RCS file: /home/cvspublic/jakarta-&lt;br/&gt;
commons/configuration/src/java/org/apache/commons/configuration/XMLConfiguration&lt;br/&gt;
.java,v&lt;br/&gt;
retrieving revision 1.10&lt;br/&gt;
diff -u -r1.10 XMLConfiguration.java&lt;br/&gt;
&amp;#8212; XMLConfiguration.java	14 Aug 2004 11:32:06 -0000	1.10&lt;br/&gt;
+++ XMLConfiguration.java	16 Aug 2004 21:55:26 -0000&lt;br/&gt;
@@ -19,6 +19,7 @@&lt;br/&gt;
 import java.io.File;&lt;br/&gt;
 import java.io.FileWriter;&lt;br/&gt;
 import java.io.IOException;&lt;br/&gt;
+import java.io.InputStream;&lt;br/&gt;
 import java.io.OutputStream;&lt;br/&gt;
 import java.io.OutputStreamWriter;&lt;br/&gt;
 import java.io.StringWriter;&lt;br/&gt;
@@ -142,20 +143,20 @@&lt;br/&gt;
     }&lt;/p&gt;

&lt;p&gt;     public void load() throws ConfigurationException {&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;File file = null;&lt;br/&gt;
+        InputStream resource = null;&lt;br/&gt;
         try 
{
             URL url = ConfigurationUtils.getURL(getBasePath(), getFileName());
-            file = new File(url.getFile());
+            resource = url.openStream();
             DocumentBuilder builder = DocumentBuilderFactory.newInstance
().newDocumentBuilder();
-            document = builder.parse(file);
+            document = builder.parse(resource);
         }
&lt;p&gt; catch (IOException de) &lt;/p&gt;
{
-            throw new ConfigurationException(&quot;Could not load from &quot; + 
file.getAbsolutePath(), de);
+            throw new ConfigurationException(&quot;Could not load from &quot; + 
getFileName(), de);
         }
&lt;p&gt; catch (ParserConfigurationException ex) &lt;/p&gt;
{
             throw new ConfigurationException(&quot;Could not configure parser&quot;, ex);
         }
&lt;p&gt; catch (FactoryConfigurationError ex) &lt;/p&gt;
{
             throw new ConfigurationException(&quot;Could not create parser&quot;, ex);
         }
&lt;p&gt; catch (SAXException ex) &lt;/p&gt;
{
-            throw new ConfigurationException(&quot;Error parsing file &quot; + 
file.getAbsolutePath(), ex);
+            throw new ConfigurationException(&quot;Error parsing file &quot; + 
getFileName(), ex);
         }&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;         initProperties(document.getDocumentElement(), new StringBuffer());&lt;/p&gt;</description>
                <environment>&lt;p&gt;Operating System: other&lt;br/&gt;
Platform: All&lt;/p&gt;</environment>
        <key id="12341644">CONFIGURATION-65</key>
            <summary>[configuration] XMLConfiguration cannot load from a jar</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/bug.png">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.png">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="jromanda@infophase.com">J.C. Romanda</reporter>
                        <labels>
                    </labels>
                <created>Tue, 17 Aug 2004 05:09:42 +0000</created>
                <updated>Tue, 16 May 2006 12:22:20 +0000</updated>
                            <resolved>Tue, 16 May 2006 12:22:20 +0000</resolved>
                                    <version>Nightly Builds</version>
                                                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                <comments>
                            <comment id="12407267" author="ebourg" created="Wed, 18 Aug 2004 16:54:48 +0000"  >&lt;p&gt;JC, do you have a test case for this by chance ?&lt;/p&gt;</comment>
                            <comment id="12407268" author="ebourg" created="Fri, 20 Aug 2004 21:26:39 +0000"  >&lt;p&gt;With the patch you suggest the ConfigurationExceptions no longer mention the&lt;br/&gt;
path of the file :/ Also the input stream must be closed in a finally block, I&apos;m&lt;br/&gt;
not sure the parser will close it on its own.&lt;/p&gt;

&lt;p&gt;What error did you get on loading a configuration from a jar initially ?&lt;/p&gt;</comment>
                            <comment id="12407269" author="jromanda@infophase.com" created="Sat, 21 Aug 2004 02:22:11 +0000"  >&lt;p&gt;Created an attachment (id=12499)&lt;br/&gt;
Test case to demonstrate the reported bug&lt;/p&gt;</comment>
                            <comment id="12407270" author="jromanda@infophase.com" created="Sat, 21 Aug 2004 02:37:48 +0000"  >&lt;p&gt;Good point about closing the InputStream. &lt;/p&gt;

&lt;p&gt;The previously attached jar file contains the src, class, and config files to &lt;br/&gt;
reproduce the problem (requires commons configuration and supporting jars).  If &lt;br/&gt;
you run the test from the jar file, the ConfigurationFactory will fail caused &lt;br/&gt;
by an underlying FileNotFoundException.  The entire stack trace is below.  If &lt;br/&gt;
you extract the files from the jar and run the test the ConfigurationFactory &lt;br/&gt;
loads ok.&lt;/p&gt;

&lt;p&gt;I looking into this a little more and tried loading the XMLConfiguration &lt;br/&gt;
directly which fails either way and is also demonstrated in the test.  The &lt;br/&gt;
XMLConfiguration fails in the constructor using an InputStream with a &lt;br/&gt;
NullPointerException.  Most likely this is because the XMLConfiguration tries &lt;br/&gt;
to treat the InputStream as a File.&lt;/p&gt;

&lt;p&gt;The XMLConfiguration class should probably treat source config files as &lt;br/&gt;
InputStreams like the PropertiesConfiguration class does rather than try to &lt;br/&gt;
convert all InputStreams back to Files like it currently does.  My patch &lt;br/&gt;
doesn&apos;t completely resolve the issue, it simply demonstrated the fix for my &lt;br/&gt;
issue.  &lt;/p&gt;

&lt;p&gt;Here&apos;s the stack trace generated by the test class:&lt;br/&gt;
Start test ConfigurationFactory from jar file...&lt;br/&gt;
Aug 20, 2004 1:56:34 PM org.apache.commons.digester.Digester endElement&lt;br/&gt;
SEVERE: End event threw exception&lt;br/&gt;
java.lang.reflect.InvocationTargetException&lt;br/&gt;
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)&lt;br/&gt;
	at sun.reflect.NativeMethodAccessorImpl.invoke(Unknown Source)&lt;br/&gt;
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(Unknown Source)&lt;br/&gt;
	at java.lang.reflect.Method.invoke(Unknown Source)&lt;br/&gt;
	at org.apache.commons.beanutils.MethodUtils.invokeMethod&lt;br/&gt;
(MethodUtils.java:258)&lt;br/&gt;
	at org.apache.commons.digester.CallMethodRule.end&lt;br/&gt;
(CallMethodRule.java:505)&lt;br/&gt;
	at org.apache.commons.digester.Rule.end(Rule.java:276)&lt;br/&gt;
	at org.apache.commons.digester.Digester.endElement(Digester.java:1058)&lt;br/&gt;
	at org.apache.crimson.parser.Parser2.maybeElement(Unknown Source)&lt;br/&gt;
	at org.apache.crimson.parser.Parser2.content(Unknown Source)&lt;br/&gt;
	at org.apache.crimson.parser.Parser2.maybeElement(Unknown Source)&lt;br/&gt;
	at org.apache.crimson.parser.Parser2.parseInternal(Unknown Source)&lt;br/&gt;
	at org.apache.crimson.parser.Parser2.parse(Unknown Source)&lt;br/&gt;
	at org.apache.crimson.parser.XMLReaderImpl.parse(Unknown Source)&lt;br/&gt;
	at org.apache.commons.digester.Digester.parse(Digester.java:1567)&lt;br/&gt;
	at &lt;br/&gt;
org.apache.commons.configuration.ConfigurationFactory.getConfiguration&lt;br/&gt;
(ConfigurationFactory.java:158)&lt;br/&gt;
	at ConfigurationBug30702.testFactory(ConfigurationBug30702.java:75)&lt;br/&gt;
	at ConfigurationBug30702.main(ConfigurationBug30702.java:28)&lt;br/&gt;
Caused by: org.apache.commons.configuration.ConfigurationException: Could not &lt;br/&gt;
load from D:\projects\commons-configuration\&lt;a href=&quot;file:D:projectscommons-&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;file:\D:\projects\commons-&lt;/a&gt;&lt;br/&gt;
configuration\commons-configuration-bug30702.jar!\conf\test.xml&lt;br/&gt;
	at org.apache.commons.configuration.XMLConfiguration.load&lt;br/&gt;
(XMLConfiguration.java:152)&lt;br/&gt;
	... 18 more&lt;br/&gt;
Caused by: java.io.FileNotFoundException: D:\projects\commons-&lt;br/&gt;
configuration\&lt;a href=&quot;file:D:projectscommons-configurationcommons-configuration-&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;file:\D:\projects\commons-configuration\commons-configuration-&lt;/a&gt;&lt;br/&gt;
bug30702.jar!\conf\test.xml (The filename, directory name, or volume label &lt;br/&gt;
syntax is incorrect)&lt;br/&gt;
	at java.io.FileInputStream.open(Native Method)&lt;br/&gt;
	at java.io.FileInputStream.&amp;lt;init&amp;gt;(Unknown Source)&lt;br/&gt;
	at java.io.FileInputStream.&amp;lt;init&amp;gt;(Unknown Source)&lt;br/&gt;
	at sun.net.www.protocol.file.FileURLConnection.connect(Unknown Source)&lt;br/&gt;
	at sun.net.www.protocol.file.FileURLConnection.getInputStream(Unknown &lt;br/&gt;
Source)&lt;br/&gt;
	at java.net.URL.openStream(Unknown Source)&lt;br/&gt;
	at org.apache.crimson.parser.InputEntity.init(Unknown Source)&lt;br/&gt;
	at org.apache.crimson.parser.Parser2.parseInternal(Unknown Source)&lt;br/&gt;
	at org.apache.crimson.parser.Parser2.parse(Unknown Source)&lt;br/&gt;
	at org.apache.crimson.parser.XMLReaderImpl.parse(Unknown Source)&lt;br/&gt;
	at org.apache.crimson.jaxp.DocumentBuilderImpl.parse(Unknown Source)&lt;br/&gt;
	at javax.xml.parsers.DocumentBuilder.parse(Unknown Source)&lt;br/&gt;
	at org.apache.commons.configuration.XMLConfiguration.load&lt;br/&gt;
(XMLConfiguration.java:150)&lt;br/&gt;
	... 18 more&lt;/p&gt;


&lt;p&gt;If it&apos;s acceptable to rework the XMLConfiguration class to use InputStreams, &lt;br/&gt;
I&apos;ll gladly try to do that and submit a complete patch.  Just didn&apos;t have the &lt;br/&gt;
time to do this previously.&lt;/p&gt;</comment>
                            <comment id="12407271" author="dep4b" created="Mon, 6 Sep 2004 20:21:15 +0000"  >&lt;p&gt;Should we mark this as an enhancement?  JC, if you can rework it, and provide&lt;br/&gt;
the unit test, then I&apos;d be happy to add it for 1.0.  It does seem like a pretty&lt;br/&gt;
common situtation.  Otherwise, maybe we should mark it as a 1.1 thing?&lt;/p&gt;

&lt;p&gt;Eric&lt;/p&gt;</comment>
                            <comment id="12407272" author="ebourg" created="Mon, 6 Sep 2004 20:29:36 +0000"  >&lt;p&gt;Yes this should be addressed for the 1.0 release, as well as unifying the&lt;br/&gt;
loading mechanisms for the other file based configurations.&lt;/p&gt;</comment>
                            <comment id="12407273" author="ebourg" created="Thu, 9 Sep 2004 00:34:56 +0000"  >&lt;p&gt;Taking the bug, I have a test case and I&apos;m working on a generic solution for all&lt;br/&gt;
file based configurations.&lt;/p&gt;</comment>
                            <comment id="12407274" author="ebourg" created="Thu, 23 Sep 2004 00:25:53 +0000"  >&lt;p&gt;Fixed, let us know how it works for you JC.&lt;/p&gt;</comment>
                            <comment id="12407275" author="jromanda@infophase.com" created="Wed, 29 Sep 2004 01:25:50 +0000"  >&lt;p&gt;Works like a charm.  thanks!!!&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12333060" name="ASF.LICENSE.NOT.GRANTED--commons-configuration-bug30702.jar" size="4559" author="jromanda@infophase.com" created="Sat, 21 Aug 2004 02:22:11 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_10010" key="com.atlassian.jira.plugin.system.customfieldtypes:importid">
                        <customfieldname>Bugzilla Id</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>30702</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Wed, 18 Aug 2004 16:54:48 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>110665</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            12 years, 11 weeks, 1 day ago
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0tffj:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>169809</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>