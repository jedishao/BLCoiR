<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Thu Dec 01 19:38:19 UTC 2016

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/CONFIGURATION-119/CONFIGURATION-119.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[CONFIGURATION-119] [configuration] ConfigurationFactory auto save overwrites properties file</title>
                <link>https://issues.apache.org/jira/browse/CONFIGURATION-119</link>
                <project id="12310467" key="CONFIGURATION">Commons Configuration</project>
                    <description>&lt;p&gt;Setting a PropertiesConfiguration autoSave=true via a ConfigurationFactory can&lt;br/&gt;
cause the underlying properties file to be completely overwritten.&lt;/p&gt;

&lt;p&gt;Example:&lt;/p&gt;

&lt;p&gt;config.xml:&lt;br/&gt;
  &amp;lt;?xml version=&quot;1.0&quot; encoding=&quot;ISO-8859-1&quot; ?&amp;gt;&lt;br/&gt;
  &amp;lt;configuration&amp;gt;&lt;br/&gt;
    &amp;lt;properties fileName=&quot;application.properties&quot; /&amp;gt;&lt;br/&gt;
    &amp;lt;properties fileName=&quot;ui.properties&quot;  autoSave=&quot;true&quot;/&amp;gt;&lt;br/&gt;
  &amp;lt;/configuration&amp;gt;&lt;/p&gt;

&lt;p&gt;application.properties:&lt;br/&gt;
  application.name=Test App&lt;br/&gt;
  application.version = 0.01&lt;br/&gt;
  application.title = $&lt;/p&gt;
{application.name} V${application.version}&lt;br/&gt;
&lt;br/&gt;
ui.properties:&lt;br/&gt;
  ui.test=&quot;stuff here&quot;&lt;br/&gt;
&lt;br/&gt;
Execute the code:&lt;br/&gt;
  ConfigurationFactory factory = new ConfigurationFactory();&lt;br/&gt;
  URL configURL = getClass().getResource(&quot;/config.xml&quot;);&lt;br/&gt;
  factory.setConfigurationURL(configURL);&lt;br/&gt;
  try {
    config = factory.getConfiguration();
    System.out.println(config.getString(&quot;application.title&quot;));

    System.out.println(config.getString(&quot;ui.test&quot;));
    config.setProperty(&quot;ui.test&quot;, &quot;will this get saved ?&quot;);
    System.out.println(config.getString(&quot;ui.test&quot;));
  } catch (ConfigurationException e) {
    e.printStackTrace();
  }&lt;br/&gt;
&lt;br/&gt;
Program output:&lt;br/&gt;
12/04/2005 10:24:00&lt;br/&gt;
org.apache.commons.configuration.ConfigurationFactory$FileConfigurationFactory&lt;br/&gt;
createObject&lt;br/&gt;
INFO: Trying to load configuration application.properties&lt;br/&gt;
12/04/2005 10:24:00&lt;br/&gt;
org.apache.commons.configuration.ConfigurationFactory$FileConfigurationFactory&lt;br/&gt;
createObject&lt;br/&gt;
INFO: Trying to load configuration ui.properties&lt;br/&gt;
Test App V0.01&lt;br/&gt;
&quot;stuff here&quot;&lt;br/&gt;
will this get saved ?&lt;br/&gt;
&lt;br/&gt;
After execution&lt;br/&gt;
---------------&lt;br/&gt;
application.properties:&lt;br/&gt;
  application.name=Test App&lt;br/&gt;
  application.version = 0.01&lt;br/&gt;
  application.title = ${application.name}
&lt;p&gt; V$&lt;/p&gt;
{application.version}

&lt;p&gt;ui.properties:&lt;/p&gt;
&lt;ol&gt;
	&lt;li&gt;written by PropertiesConfiguration&lt;/li&gt;
	&lt;li&gt;Tue Apr 12 10:24:00 EST 2005&lt;/li&gt;
&lt;/ol&gt;


&lt;p&gt;NOTE ui.test doesn&apos;t appear with either the old value or the modified one.&lt;/p&gt;</description>
                <environment>&lt;p&gt;Operating System: other&lt;br/&gt;
Platform: Other&lt;/p&gt;</environment>
        <key id="12342178">CONFIGURATION-119</key>
            <summary>[configuration] ConfigurationFactory auto save overwrites properties file</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/bug.png">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.png">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="petec33@gmail.com">Pete Cain</reporter>
                        <labels>
                    </labels>
                <created>Tue, 12 Apr 2005 09:33:03 +0000</created>
                <updated>Tue, 16 May 2006 12:14:35 +0000</updated>
                            <resolved>Tue, 16 May 2006 12:14:35 +0000</resolved>
                                    <version>1.1</version>
                                                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                <comments>
                            <comment id="12409114" author="oliver.heger@t-online.de" created="Sun, 8 May 2005 00:29:28 +0000"  >&lt;p&gt;Created an attachment (id=14961)&lt;br/&gt;
Unit test for loading a PropertiesConfiguration with enabled auto save&lt;/p&gt;

&lt;p&gt;The attached unit test shows the heart of the bug: the combination of enabled&lt;br/&gt;
auto save flag and the load() method of PropertiesConfiguration.&lt;/p&gt;

&lt;p&gt;On my system (Win XP) this test causes an endless loop, but this may depend on&lt;br/&gt;
the platform and factors like default sizes of the used buffered streams. Fact&lt;br/&gt;
is that the properties file is overwritten while it is being loaded, which will&lt;br/&gt;
cause unpredictable behavior.&lt;/p&gt;</comment>
                            <comment id="12409115" author="oliver.heger@t-online.de" created="Sun, 8 May 2005 00:41:16 +0000"  >&lt;p&gt;The following seems to happen:&lt;/p&gt;

&lt;p&gt;PropertiesConfiguration.load() loads the specified properties file line by line&lt;br/&gt;
and calls addProperty() for each detected property. In&lt;br/&gt;
AbstractFileConfiguration.addProperty() the new property value is stored and&lt;br/&gt;
then possiblySave() is called. If the auto save flag is set, this method will&lt;br/&gt;
trigger the save() method, which in turn will immediately overwrite the current&lt;br/&gt;
configuration file.&lt;/p&gt;

&lt;p&gt;As a solution I suggest to store the old value of the auto save flag at the&lt;br/&gt;
beginning of PropertiesConfiguration.load() and set it always to false. At the&lt;br/&gt;
end of the method (in a finally block) the flag&apos;s old value can be reset. &lt;/p&gt;

&lt;p&gt;autoSave really should not be enabled during execution of a load method. So it&lt;br/&gt;
might be better to implement such a mechanism already in&lt;br/&gt;
AbstractFileConfiguration (but where?). Any thoughts or comments?&lt;/p&gt;</comment>
                            <comment id="12409116" author="oliver.heger@t-online.de" created="Wed, 18 May 2005 02:51:24 +0000"  >&lt;p&gt;Committed a patch, should be fixed in the next nightly builds.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12333454" name="ASF.LICENSE.NOT.GRANTED--TestPropertiesConfiguration.diff" size="1839" author="oliver.heger@t-online.de" created="Sun, 8 May 2005 00:29:28 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_10010" key="com.atlassian.jira.plugin.system.customfieldtypes:importid">
                        <customfieldname>Bugzilla Id</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>34410</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Sun, 8 May 2005 00:29:28 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>18548</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            11 years, 30 weeks, 1 day ago
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0tfrz:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>169865</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>