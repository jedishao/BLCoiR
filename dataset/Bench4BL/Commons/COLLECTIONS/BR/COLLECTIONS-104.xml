<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Sat Nov 19 20:51:32 UTC 2016

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/COLLECTIONS-104/COLLECTIONS-104.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[COLLECTIONS-104] [collections] Only last element is removeable when CircularFifoBuffer is full</title>
                <link>https://issues.apache.org/jira/browse/COLLECTIONS-104</link>
                <project id="12310465" key="COLLECTIONS">Commons Collections</project>
                    <description>&lt;p&gt;If the circular fifo buffer is full and you remove an item, that is not the last&lt;br/&gt;
one, it breaks.&lt;/p&gt;

&lt;p&gt;code example:&lt;/p&gt;

&lt;p&gt;import java.io.*;&lt;br/&gt;
import org.apache.commons.collections.buffer.*;&lt;/p&gt;

&lt;p&gt;class Stub {&lt;br/&gt;
    public static void main(String[] args) &lt;/p&gt;
{
        CircularFifoBuffer fifo = new CircularFifoBuffer(5);
        System.out.println(fifo);

        fifo.add(new String(&quot;1&quot;));
        System.out.println(fifo);

        fifo.add(new String(&quot;2&quot;));
        System.out.println(fifo);

        fifo.add(new String(&quot;3&quot;));
        System.out.println(fifo);

        fifo.add(new String(&quot;4&quot;));
        System.out.println(fifo);

        System.out.println(&quot;adding 5&quot;);
        fifo.add(new String(&quot;5&quot;));
        System.out.println(fifo);

        String six = new String(&quot;6&quot;);
        System.out.println(&quot;adding 6&quot;);
        fifo.add(six);
        System.out.println(fifo);

/* uncomment the following block to avoid problem
        System.out.println(&quot;fifo.isFull?:&quot;+fifo.isFull());
        System.out.println(&quot;removing 6&quot;);
        fifo.remove(new String(&quot;6&quot;));
        System.out.println(fifo);
*/

        System.out.println(&quot;fifo.isFull?:&quot;+fifo.isFull());

        System.out.println(&quot;removing 3&quot;);
        fifo.remove(new String(&quot;3&quot;));
        System.out.println(fifo);

        System.out.println(&quot;removing 4&quot;);
        fifo.remove(new String(&quot;4&quot;));
        System.out.println(fifo);

        System.out.println(&quot;clearing&quot;);
        fifo.clear();
        System.out.println(&quot;removing 4&quot;);
        fifo.remove(new String(&quot;4&quot;));
        System.out.println(fifo);

    }
&lt;p&gt;}&lt;/p&gt;



&lt;p&gt;==============&lt;/p&gt;

&lt;p&gt;output busted:&lt;/p&gt;

&lt;p&gt;[]&lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;1&amp;#93;&lt;/span&gt;&lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;1, 2&amp;#93;&lt;/span&gt;&lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;1, 2, 3&amp;#93;&lt;/span&gt;&lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;1, 2, 3, 4&amp;#93;&lt;/span&gt;&lt;br/&gt;
adding 5&lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;1, 2, 3, 4, 5&amp;#93;&lt;/span&gt;&lt;br/&gt;
adding 6&lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;2, 3, 4, 5, 6&amp;#93;&lt;/span&gt;&lt;br/&gt;
fifo.isFull?:true&lt;br/&gt;
removing 3&lt;br/&gt;
Exception in thread &quot;main&quot; java.lang.ArrayIndexOutOfBoundsException: -1&lt;br/&gt;
        at&lt;br/&gt;
org.apache.commons.collections.buffer.BoundedFifoBuffer$1.remove(BoundedFifoBuffer.java:347)&lt;br/&gt;
        at java.util.AbstractCollection.remove(AbstractCollection.java:255)&lt;br/&gt;
        at Stub.main(Stub.java:40)&lt;/p&gt;</description>
                <environment>&lt;p&gt;Operating System: Linux&lt;br/&gt;
Platform: PC&lt;/p&gt;</environment>
        <key id="12341996">COLLECTIONS-104</key>
            <summary>[collections] Only last element is removeable when CircularFifoBuffer is full</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/bug.png">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.png">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="amir@mathforum.org">Amir Tahvildaran</reporter>
                        <labels>
                    </labels>
                <created>Thu, 13 Jan 2005 03:30:28 +0000</created>
                <updated>Sat, 15 Mar 2008 21:36:01 +0000</updated>
                            <resolved>Sat, 15 Mar 2008 21:36:01 +0000</resolved>
                                    <version>3.1</version>
                                                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                <comments>
                            <comment id="12408547" author="amir@mathforum.org" created="Thu, 13 Jan 2005 06:12:43 +0000"  >&lt;p&gt;It seems like I incorrectly stated the problem.&lt;/p&gt;

&lt;p&gt;It turns out the error can happen when the buffer is not full also.&lt;/p&gt;

&lt;p&gt;My new theory is that you can only remove an item from a non-boundary position&lt;br/&gt;
if there has not been a shift (shift=adding N+1 items to a buffer of size N).&lt;/p&gt;

&lt;p&gt;In these examples the buffer is not full when the remove(object) is called.&lt;br/&gt;
As you can see the size of the buffer remains the same (6) however in the second&lt;br/&gt;
example a 7th item is added which causes a shift.&lt;/p&gt;

&lt;p&gt;[]&lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;1&amp;#93;&lt;/span&gt;&lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;1, 2&amp;#93;&lt;/span&gt;&lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;1, 2, 3&amp;#93;&lt;/span&gt;&lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;1, 2, 3, 4&amp;#93;&lt;/span&gt;&lt;br/&gt;
adding 5&lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;1, 2, 3, 4, 5&amp;#93;&lt;/span&gt;&lt;br/&gt;
adding 6&lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;1, 2, 3, 4, 5, 6&amp;#93;&lt;/span&gt;&lt;br/&gt;
removing&lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;2, 3, 4, 5, 6&amp;#93;&lt;/span&gt;&lt;br/&gt;
fifo.isFull?:false&lt;br/&gt;
removing 4&lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;2, 3, 5, 6&amp;#93;&lt;/span&gt;&lt;br/&gt;
removing 4&lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;2, 3, 5, 6&amp;#93;&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;=======&lt;/p&gt;

&lt;p&gt;[]&lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;1&amp;#93;&lt;/span&gt;&lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;1, 2&amp;#93;&lt;/span&gt;&lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;1, 2, 3&amp;#93;&lt;/span&gt;&lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;1, 2, 3, 4&amp;#93;&lt;/span&gt;&lt;br/&gt;
adding 5&lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;1, 2, 3, 4, 5&amp;#93;&lt;/span&gt;&lt;br/&gt;
adding 6&lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;1, 2, 3, 4, 5, 6&amp;#93;&lt;/span&gt;&lt;br/&gt;
adding 7&lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;2, 3, 4, 5, 6, 7&amp;#93;&lt;/span&gt;&lt;br/&gt;
removing&lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;3, 4, 5, 6, 7&amp;#93;&lt;/span&gt;&lt;br/&gt;
fifo.isFull?:false&lt;br/&gt;
removing 4&lt;br/&gt;
Exception in thread &quot;main&quot; java.lang.ArrayIndexOutOfBoundsException: -1&lt;br/&gt;
        at&lt;br/&gt;
org.apache.commons.collections.buffer.BoundedFifoBuffer$1.remove(BoundedFifoBuffer.java:347)&lt;br/&gt;
        at java.util.AbstractCollection.remove(AbstractCollection.java:255)&lt;br/&gt;
        at Stub.main(Stub.java:51)&lt;/p&gt;


&lt;p&gt;Thanks,&lt;br/&gt;
Amir&lt;/p&gt;</comment>
                            <comment id="12408548" author="phil@steitz.com" created="Fri, 14 Jan 2005 23:16:38 +0000"  >&lt;p&gt;Thank you for reporting this.  Looks like the problem is in BoundedFifoBuffer. &lt;br/&gt;
IIUC how this field is supposed to be maintained, the end field is not being&lt;br/&gt;
updated correctly. &lt;/p&gt;</comment>
                            <comment id="12408549" author="phil@steitz.com" created="Sun, 16 Jan 2005 07:52:05 +0000"  >&lt;p&gt;The problem was in BoundedFifoBuffer&apos;s iterator.remove method.  The shift&lt;br/&gt;
operation was not correctly incrementing / decrementing array indexes.  Changes&lt;br/&gt;
have been committed to fix this. Should be fixed in the nightly build starting&lt;br/&gt;
1/15/05.&lt;/p&gt;</comment>
                            <comment id="12408550" author="gudnabrsam@yahoo.com" created="Thu, 9 Feb 2006 01:05:37 +0000"  >&lt;ul&gt;
	&lt;li&gt;
	&lt;ul&gt;
		&lt;li&gt;
		&lt;ul&gt;
			&lt;li&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/COLLECTIONS-72&quot; title=&quot;[collections] java.lang.ArrayIndexOutOfBoundsException&quot; class=&quot;issue-link&quot; data-issue-key=&quot;COLLECTIONS-72&quot;&gt;&lt;del&gt;COM-2741&lt;/del&gt;&lt;/a&gt; has been marked as a duplicate of this bug. ***&lt;/li&gt;
		&lt;/ul&gt;
		&lt;/li&gt;
	&lt;/ul&gt;
	&lt;/li&gt;
&lt;/ul&gt;
</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_10010" key="com.atlassian.jira.plugin.system.customfieldtypes:importid">
                        <customfieldname>Bugzilla Id</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>33071</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Fri, 14 Jan 2005 23:16:38 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>18894</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            10 years, 42 weeks, 2 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0sjav:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>164604</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        </customfields>
    </item>
</channel>
</rss>