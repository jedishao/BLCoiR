<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Sat Nov 19 21:12:40 UTC 2016

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/MATH-843/MATH-843.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[MATH-843] Precision.EPSILON: wrong documentation</title>
                <link>https://issues.apache.org/jira/browse/MATH-843</link>
                <project id="12310485" key="MATH">Commons Math</project>
                    <description>&lt;p&gt;The documentation of the Field &lt;tt&gt;EPSILON&lt;/tt&gt; in class &lt;tt&gt;org.apache.commons.math3.util.Precision&lt;/tt&gt; states, that &lt;tt&gt;EPSILON&lt;/tt&gt; is the smallest positive number such that &lt;tt&gt;1 - EPSILON&lt;/tt&gt; is not numerically equal to 1, and its value is defined as 1.1102230246251565E-16.&lt;/p&gt;

&lt;p&gt;However, this is NOT the smallest positive number with this property.&lt;/p&gt;

&lt;p&gt;Consider the following program:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
&lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; class Eps {
  &lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;static&lt;/span&gt; void main(&lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt;[] args) {
    &lt;span class=&quot;code-object&quot;&gt;double&lt;/span&gt; e = &lt;span class=&quot;code-object&quot;&gt;Double&lt;/span&gt;.longBitsToDouble(0x3c90000000000001L);
	&lt;span class=&quot;code-object&quot;&gt;double&lt;/span&gt; e1 = 1-e;
	&lt;span class=&quot;code-object&quot;&gt;System&lt;/span&gt;.out.println(e);
	&lt;span class=&quot;code-object&quot;&gt;System&lt;/span&gt;.out.println(1-e);
	&lt;span class=&quot;code-object&quot;&gt;System&lt;/span&gt;.out.println(1-e != 1);
  }
}
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;The output is:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
% java Eps
5.551115123125784E-17
0.9999999999999999
&lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;This proves, that there are smaller positive numbers with the property that 1-eps != 1.&lt;/p&gt;

&lt;p&gt;I propose not to change the constant value, but to update the documentation. The value &lt;tt&gt;Precision.EPSILON&lt;/tt&gt; is &lt;br/&gt;
an upper bound on the relative error which occurs when a real number is&lt;br/&gt;
rounded to its nearest Double floating-point number. I propose to update &lt;br/&gt;
the api docs in this sense.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12602075">MATH-843</key>
            <summary>Precision.EPSILON: wrong documentation</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/bug.png">Bug</type>
                                            <priority id="4" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.png">Minor</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="dgruntz">Dominik Gruntz</reporter>
                        <labels>
                            <label>documentation</label>
                    </labels>
                <created>Tue, 7 Aug 2012 19:13:28 +0000</created>
                <updated>Mon, 4 Mar 2013 18:53:37 +0000</updated>
                            <resolved>Mon, 20 Aug 2012 07:56:20 +0000</resolved>
                                    <version>3.0</version>
                                    <fixVersion>3.1</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>3</watches>
                                    <timeoriginalestimate seconds="1800">0.5h</timeoriginalestimate>
                            <timeestimate seconds="1800">0.5h</timeestimate>
                                        <comments>
                            <comment id="13430648" author="erans" created="Tue, 7 Aug 2012 21:42:09 +0000"  >&lt;p&gt;Thanks for the report.&lt;/p&gt;

&lt;p&gt;I&apos;ve updated the documentation in revision 1370547. Do you agree with the new version?&lt;/p&gt;</comment>
                            <comment id="13430699" author="dgruntz" created="Tue, 7 Aug 2012 22:50:25 +0000"  >&lt;p&gt;yes, the new documentation in rev 1370547 is correct; 2^(-53) has that property (i.e. it is the largest double eps such that 1+eps = 1):&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
scala&amp;gt; math.pow(2, -53)
res1: &lt;span class=&quot;code-object&quot;&gt;Double&lt;/span&gt; = 1.1102230246251565E-16

scala&amp;gt; 1+res1 == 1
res2: &lt;span class=&quot;code-object&quot;&gt;Boolean&lt;/span&gt; = &lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;

scala&amp;gt; java.lang.&lt;span class=&quot;code-object&quot;&gt;Double&lt;/span&gt;.longBitsToDouble(java.lang.&lt;span class=&quot;code-object&quot;&gt;Double&lt;/span&gt;.doubleToLongBits(res1)+1)
res3: &lt;span class=&quot;code-object&quot;&gt;Double&lt;/span&gt; = 1.1102230246251568E-16

scala&amp;gt; 1+res3
res4: &lt;span class=&quot;code-object&quot;&gt;Double&lt;/span&gt; = 1.0000000000000002
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;So I agree, but I do not like it. I would not define this constant over 1+eps == 1 (as if executed in extended precision the result may be different), but I would define it as upper bound on the relative error due to rounding real numbers to &lt;tt&gt;double&lt;/tt&gt; floating-point numbers. &lt;/p&gt;</comment>
                            <comment id="13430988" author="erans" created="Wed, 8 Aug 2012 09:49:23 +0000"  >&lt;blockquote&gt;&lt;p&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;...&amp;#93;&lt;/span&gt; but I do not like it.&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;I like it because it is more straightforward to understand while I must admit that I don&apos;t fully understand your definition...&lt;br/&gt;
I&apos;ve added a trivial unit test (&quot;testMath841&quot;) that verifies the claim made in the documentation.&lt;/p&gt;

&lt;p&gt;Please provide a unit test that makes your point clear, and I&apos;ll see no problem adding your proposed comment in the Javadoc.&lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;...&amp;#93;&lt;/span&gt; if executed in extended precision the result may be different &lt;span class=&quot;error&quot;&gt;&amp;#91;...&amp;#93;&lt;/span&gt;&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;I don&apos;t understand: The Javadoc now explicitly states &quot;double-precision&quot;.&lt;br/&gt;
Let me know whether it can be made clearer.&lt;/p&gt;</comment>
                            <comment id="13431197" author="dgruntz" created="Wed, 8 Aug 2012 16:16:10 +0000"  >&lt;blockquote&gt;
&lt;p&gt;I don&apos;t understand: The Javadoc now explicitly states &quot;double-precision&quot;.&lt;br/&gt;
Let me know whether it can be made clearer.&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;The computation may be done in the registers of your processor and these registers may provide more accuracy (typically 80bits). In Java this extended precision can be prevented by using the &lt;tt&gt;strictfp&lt;/tt&gt; keyword.&lt;/p&gt;

&lt;p&gt;The same holds for your test. It should be marked with &lt;tt&gt;strictfp&lt;/tt&gt; as well. On some machines, the expression &lt;tt&gt;1 + Precision.EPSILON&lt;/tt&gt; in the test &lt;tt&gt;1 + Precision.EPSILON == 1&lt;/tt&gt; might be hold in a register with extended precision and thus may be greater than &lt;tt&gt;1&lt;/tt&gt;. The expression then returns false.&lt;/p&gt;

&lt;p&gt;Regarding the other definition: This is the one which can be found in &lt;a href=&quot;http://en.wikipedia.org/wiki/Machine_epsilon&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;Wikipedia&lt;/a&gt; and in the &lt;a href=&quot;http://docs.oracle.com/cd/E19957-01/806-3568/ncg_goldberg.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;Computing Surveys article by Goldberg&lt;/a&gt;. The machine epsilon is defined as upper bound of the relative error which may occur when a real number is rounded to its closest floating-point approximation. This upper bound is &lt;tt&gt;B^(-(p-1))/2&lt;/tt&gt; where &lt;tt&gt;B&lt;/tt&gt; is the base and &lt;tt&gt;p&lt;/tt&gt; is the precision or length of the mantissa. For IEEE754 64-bit numbers (e.g. for &lt;tt&gt;double&lt;/tt&gt;) this value is &lt;tt&gt;2^(-53)&lt;/tt&gt;.&lt;/p&gt;</comment>
                            <comment id="13431763" author="erans" created="Thu, 9 Aug 2012 12:14:31 +0000"  >&lt;blockquote&gt;&lt;p&gt;On some machines, the expression 1 + Precision.EPSILON in the test 1 + Precision.EPSILON == 1 might be hold in a register with extended precision and thus may be greater than 1. The expression then returns false.&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;Did you actually see that?&lt;br/&gt;
I would (maybe naively) think that &quot;1 + ESPILON&quot; would be cast to a 64-bit double before the comparison. If so, wouldn&apos;t the equality still hold?&lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;Regarding the other definition: &lt;span class=&quot;error&quot;&gt;&amp;#91;...&amp;#93;&lt;/span&gt;&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;No problem to add this comment if you provide it here in a &quot;noformat&quot; block with all the references as HTML links (&quot;&amp;lt;a href=&quot;...&quot;&amp;gt;...&amp;lt;/a&amp;gt;&quot;) which I can copy/paste into the code.&lt;br/&gt;
Thanks.&lt;/p&gt;</comment>
                            <comment id="13436962" author="celestin" created="Fri, 17 Aug 2012 18:50:37 +0000"  >&lt;p&gt;Dominik,&lt;br/&gt;
could you please review &lt;tt&gt;r1374395&lt;/tt&gt; before we resolve this issue?&lt;br/&gt;
Thanks&lt;/p&gt;</comment>
                            <comment id="13437716" author="dgruntz" created="Mon, 20 Aug 2012 07:51:19 +0000"  >&lt;p&gt;looks good to me, thanks. Or is there another place for reviewing?&lt;br/&gt;
Dominik&lt;/p&gt;</comment>
                            <comment id="13437719" author="celestin" created="Mon, 20 Aug 2012 07:56:07 +0000"  >&lt;p&gt;Thanks, Dominik, that will do!&lt;br/&gt;
I&apos;m resolving this issue right now.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Tue, 7 Aug 2012 21:42:09 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>292279</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            4 years, 13 weeks, 5 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0rt07:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>160343</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        </customfields>
    </item>
</channel>
</rss>