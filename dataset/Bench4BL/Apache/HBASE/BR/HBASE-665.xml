<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Fri Dec 02 19:35:07 UTC 2016

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/HBASE-665/HBASE-665.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[HBASE-665] server side scanner doesn&apos;t honor stop row</title>
                <link>https://issues.apache.org/jira/browse/HBASE-665</link>
                <project id="12310753" key="HBASE">HBase</project>
                    <description>&lt;p&gt;I have a large table.  If I create a scanner with a stop row near the beginning of the table, the last hasNext call hangs for a while.  If I do the same with the stop row near the end of the table, the last hasNext call is pretty quick.&lt;/p&gt;

&lt;p&gt;I suspect that the server side scanner isn&apos;t terminating early, and is actually scanning through the whole table returning nothing.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12397497">HBASE-665</key>
            <summary>server side scanner doesn&apos;t honor stop row</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/bug.png">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.png">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="stack">stack</assignee>
                                    <reporter username="bien">Michael Bieniosek</reporter>
                        <labels>
                    </labels>
                <created>Wed, 4 Jun 2008 18:48:43 +0000</created>
                <updated>Fri, 22 Aug 2008 21:13:17 +0000</updated>
                            <resolved>Mon, 9 Jun 2008 22:46:56 +0000</resolved>
                                                    <fixVersion>0.1.3</fixVersion>
                    <fixVersion>0.2.0</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                <comments>
                            <comment id="12602420" author="clint.morgan" created="Wed, 4 Jun 2008 19:11:04 +0000"  >&lt;p&gt;Looks like filter problem, try this out.&lt;/p&gt;</comment>
                            <comment id="12602760" author="stack" created="Thu, 5 Jun 2008 19:49:15 +0000"  >&lt;p&gt;Marking for branch and trunk... Testing now.&lt;/p&gt;</comment>
                            <comment id="12602917" author="stack" created="Fri, 6 Jun 2008 05:04:36 +0000"  >&lt;p&gt;Part of the problem here, I think, is the scanner client side is dumb to the stop row.  Here&apos;s what I see w/ client-side debug enabled (Before Clint&apos;s patch):&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
hbase&amp;gt; c = HBaseConfiguration.&lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt;()#&amp;lt;Java::OrgApacheHadoopHbase::HBaseConfiguration:0xf549de @java_object=Configuration: hadoop-&lt;span class=&quot;code-keyword&quot;&gt;default&lt;/span&gt;.xml, hadoop-site.xml, hbase-&lt;span class=&quot;code-keyword&quot;&gt;default&lt;/span&gt;.xml, hbase-site.xml&amp;gt;hbase&amp;gt; t = HTable.&lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt;(c, &lt;span class=&quot;code-quote&quot;&gt;&quot;TestTable&quot;&lt;/span&gt;)08/06/06 05:01:22 DEBUG client.HConnectionManager$TableServers: Found ROOT regionname: -ROOT-,,0, startKey: &amp;lt;&amp;gt;, endKey: &amp;lt;&amp;gt;, encodedName: 70236052, tableDesc: {name: -ROOT-, families: [{name: info, max versions: 1, compression: NONE, in memory: &lt;span class=&quot;code-keyword&quot;&gt;false&lt;/span&gt;, block cache enabled: &lt;span class=&quot;code-keyword&quot;&gt;false&lt;/span&gt;, max length: 2147483647, time to live: FOREVER, bloom filter: none}]}#&amp;lt;Java::OrgApacheHadoopHbaseClient::HTable:0x5f7d3f @java_object=org.apache.hadoop.hbase.client.HTable@117b450&amp;gt;hbase&amp;gt; columns = [&lt;span class=&quot;code-quote&quot;&gt;&quot;info:&quot;&lt;/span&gt;].to_java(java.lang.&lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt;)#&amp;lt;#&amp;lt;&lt;span class=&quot;code-object&quot;&gt;Class&lt;/span&gt;:01xb398da&amp;gt;:0xf84b0a @java_object=[Ljava.lang.&lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt;;@106b56a&amp;gt;
hbase&amp;gt; s = t.getScanner(columns, &lt;span class=&quot;code-quote&quot;&gt;&quot;&quot;, &quot;&lt;/span&gt;0000000003&quot;, HConstants::LATEST_TIMESTAMP).iterator()
08/06/06 04:34:05 DEBUG client.HTable$ClientScanner: Creating scanner over TestTable starting at key &apos;&apos;
08/06/06 04:34:05 DEBUG client.HTable$ClientScanner: Advancing internal scanner to startKey at
08/06/06 04:34:05 DEBUG client.HConnectionManager$TableServers: Cache hit in table locations &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; row &amp;lt;&amp;gt; and tableName TestTable: location server 208.76.44.141:60020, location region name TestTable,,1212686166322
#&amp;lt;#&amp;lt;&lt;span class=&quot;code-object&quot;&gt;Class&lt;/span&gt;:01x37504d&amp;gt;:0x178feba @java_object=org.apache.hadoop.hbase.client.HTable$ClientScanner$1@81933a&amp;gt;
hbase&amp;gt; s.each &lt;span class=&quot;code-keyword&quot;&gt;do&lt;/span&gt; |r|
?&amp;gt;     puts &lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt;.from_java_bytes r.getRow()
hbase&amp;gt; end
0000000000
0000000001
0000000002
08/06/06 04:34:05 DEBUG client.HTable$ClientScanner: Advancing forward from region regionname: TestTable,,1212686166322, startKey: &amp;lt;&amp;gt;, endKey: &amp;lt;0001086183&amp;gt;, encodedName: 591865778, tableDesc: {name: TestTable, families: [{name: info, max versions: 3, compression: NONE, in memory: &lt;span class=&quot;code-keyword&quot;&gt;false&lt;/span&gt;, block cache enabled: &lt;span class=&quot;code-keyword&quot;&gt;false&lt;/span&gt;, max length: 2147483647, time to live: FOREVER, bloom filter: none}]}
08/06/06 04:34:05 DEBUG client.HTable$ClientScanner: Advancing internal scanner to startKey at 0001086183
08/06/06 04:34:05 DEBUG client.HTable$ClientScanner: Advancing forward from region regionname: TestTable,0001086183,1212686166323, startKey: &amp;lt;0001086183&amp;gt;, endKey: &amp;lt;0003154574&amp;gt;, encodedName: 1619485603, tableDesc: {name: TestTable, families: [{name: info, max versions: 3, compression: NONE, in memory: &lt;span class=&quot;code-keyword&quot;&gt;false&lt;/span&gt;, block cache enabled: &lt;span class=&quot;code-keyword&quot;&gt;false&lt;/span&gt;, max length: 2147483647, time to live: FOREVER, bloom filter: none}]}
08/06/06 04:34:05 DEBUG client.HTable$ClientScanner: Advancing internal scanner to startKey at 0003154574
....
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;We&apos;re getting all regions regardless.&lt;/p&gt;</comment>
                            <comment id="12603096" author="clint.morgan" created="Fri, 6 Jun 2008 16:59:06 +0000"  >&lt;p&gt;Yeah, I looked a little closer, and it does not seem that it is a filter issue. The WhileMatch-&amp;gt;StopRow filter should cause each individual store scanner to stop early. &lt;/p&gt;

&lt;p&gt;Still we should be checking filterAllRemaining in the higer-level region filter (as in my patch). This is where the filterRow is called, so if filters make a filterAllRemaining decision based on fully assembled rows, then we need the check there to respect it...&lt;/p&gt;

&lt;p&gt;Perhaps its best to just put all the stopRow smarts on the client-side scanner?&lt;/p&gt;</comment>
                            <comment id="12603215" author="stack" created="Fri, 6 Jun 2008 22:59:48 +0000"  >&lt;p&gt;Thanks for the patch Clint.  I applied it.&lt;/p&gt;

&lt;p&gt;Regards client-side filtering, what you think of the the attached patch?  I tried it here with simple stop row &amp;#8211; which makes a stop row inside a whilerow filter &amp;#8211; and it seems to do the right thing.  Any repercussions you can think of?&lt;/p&gt;

&lt;p&gt;Thanks.&lt;/p&gt;</comment>
                            <comment id="12603603" author="clint.morgan" created="Mon, 9 Jun 2008 16:24:00 +0000"  >&lt;p&gt;Looks good to me.&lt;/p&gt;</comment>
                            <comment id="12603720" author="stack" created="Mon, 9 Jun 2008 22:46:56 +0000"  >&lt;p&gt;Thanks for the review Cilnt.&lt;/p&gt;

&lt;p&gt;Committed to trunk and branch.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12383606" name="client-side-filtering.patch" size="2157" author="stack" created="Fri, 6 Jun 2008 22:59:48 +0000"/>
                            <attachment id="12383406" name="hbase-665.patch" size="657" author="clint.morgan" created="Wed, 4 Jun 2008 19:11:04 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Wed, 4 Jun 2008 19:11:04 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>25322</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            8 years, 26 weeks, 3 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0h8p3:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>98671</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        </customfields>
    </item>
</channel>
</rss>