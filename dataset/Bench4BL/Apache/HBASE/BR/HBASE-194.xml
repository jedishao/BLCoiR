<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Fri Dec 02 19:39:20 UTC 2016

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/HBASE-194/HBASE-194.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[HBASE-194] [hbase] Still multi-assigning regions</title>
                <link>https://issues.apache.org/jira/browse/HBASE-194</link>
                <project id="12310753" key="HBASE">HBase</project>
                    <description>&lt;p&gt;Start key is img216/1725/22236401lvh6.gif.  We doubly assign.  In between assignments, master rules &apos;should not have opened region&apos; and sends a shutdown region to remote server &amp;#8211; which it obeys. Meantime, master thinks regions are deployed.&lt;/p&gt;

&lt;p&gt;Here is master log:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;...
2007-11-27 04:26:21,818 INFO  hbase.HMaster - region postlog,img216/1725/22236401lvh6.gif,1196164441230 split. New regions are: postlog,img216/1725/22236401lvh6.gif,1196166373235, postlog,img216/3961/aasaxonlivene6.jpg,1196166373241
2007-11-27 04:26:23,261 INFO  hbase.HMaster - assigning region postlog,img216/1725/22236401lvh6.gif,1196166373235 to server XX.XX.XX.33:60020
2007-11-27 04:26:27,462 DEBUG hbase.HMaster - HMaster.metaScanner scanner: -400573094926830852 regioninfo: {regionname: postlog,img216/1725/22236401lvh6.gif,1196164441230, startKey: &amp;lt;img216/1725/22236401lvh6.gif&amp;gt;, offline: &lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;, split: &lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;, tableDesc: {name: postlog, families: {cookie:={name: cookie, max versions: 1, compression: NONE, in memory: &lt;span class=&quot;code-keyword&quot;&gt;false&lt;/span&gt;, max length: 2147483647, bloom filter: none}, ip:={name: ip, max versions: 1, compression: NONE, in memory: &lt;span class=&quot;code-keyword&quot;&gt;false&lt;/span&gt;, max length: 2147483647, bloom filter: none}}}}, server: XX.XX.XX.25:60020, startCode: 1196155489036
2007-11-27 04:26:27,464 DEBUG hbase.HMaster - HMaster.metaScanner scanner: -400573094926830852 regioninfo: {regionname: postlog,img216/1725/22236401lvh6.gif,1196166373235, startKey: &amp;lt;img216/1725/22236401lvh6.gif&amp;gt;, tableDesc: {name: postlog, families: {cookie:={name: cookie, max versions: 1, compression: NONE, in memory: &lt;span class=&quot;code-keyword&quot;&gt;false&lt;/span&gt;, max length: 2147483647, bloom filter: none}, ip:={name: ip, max versions: 1, compression: NONE, in memory: &lt;span class=&quot;code-keyword&quot;&gt;false&lt;/span&gt;, max length: 2147483647, bloom filter: none}}}}, server: , startCode: -1
2007-11-27 04:26:27,464 DEBUG hbase.HMaster - Checking postlog,img216/1725/22236401lvh6.gif,1196166373235 is assigned
2007-11-27 04:26:27,671 DEBUG hbase.HMaster - Checked postlog,img216/1725/22236401lvh6.gif,1196164441230 &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; references: splitA: &lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;, splitB: &lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;
2007-11-27 04:26:53,328 INFO  hbase.HMaster - assigning region postlog,img216/1725/22236401lvh6.gif,1196166373235 to server XX.XX.XX.33:60020
2007-11-27 04:27:05,364 INFO  hbase.HMaster - XX.XX.XX.33:60020 serving postlog,img216/1725/22236401lvh6.gif,1196166373235
2007-11-27 04:27:05,364 DEBUG hbase.HMaster - region server XX.XX.XX.33:60020 should not have opened region postlog,img216/1725/22236401lvh6.gif,1196166373235
2007-11-27 04:27:05,367 INFO  hbase.HMaster - regionname: postlog,img216/1725/22236401lvh6.gif,1196166373235, startKey: &amp;lt;img216/1725/22236401lvh6.gif&amp;gt;, tableDesc: {name: postlog, families: {cookie:={name: cookie, max versions: 1, compression: NONE, in memory: &lt;span class=&quot;code-keyword&quot;&gt;false&lt;/span&gt;, max length: 2147483647, bloom filter: none}, ip:={name: ip, max versions: 1, compression: NONE, in memory: &lt;span class=&quot;code-keyword&quot;&gt;false&lt;/span&gt;, max length: 2147483647, bloom filter: none}}} open on XX.XX.XX.33:60020
2007-11-27 04:27:05,368 INFO  hbase.HMaster - updating row postlog,img216/1725/22236401lvh6.gif,1196166373235 in table .META.,,1 with startcode 1196155493271 and server XX.XX.XX.33:60020
2007-11-27 04:27:26,380 DEBUG hbase.HMaster - HMaster.metaScanner scanner: -4876467680083821318 regioninfo: {regionname: postlog,img216/1725/22236401lvh6.gif,1196164441230, startKey: &amp;lt;img216/1725/22236401lvh6.gif&amp;gt;, offline: &lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;, split: &lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;, tableDesc: {name: postlog, families: {cookie:={name: cookie, max versions: 1, compression: NONE, in memory: &lt;span class=&quot;code-keyword&quot;&gt;false&lt;/span&gt;, max length: 2147483647, bloom filter: none}, ip:={name: ip, max versions: 1, compression: NONE, in memory: &lt;span class=&quot;code-keyword&quot;&gt;false&lt;/span&gt;, max length: 2147483647, bloom filter: none}}}}, server: XX.XX.XX.25:60020, startCode: 1196155489036
2007-11-27 04:27:26,381 DEBUG hbase.HMaster - HMaster.metaScanner scanner: -4876467680083821318 regioninfo: {regionname: postlog,img216/1725/22236401lvh6.gif,1196166373235, startKey: &amp;lt;img216/1725/22236401lvh6.gif&amp;gt;, tableDesc: {name: postlog, families: {cookie:={name: cookie, max versions: 1, compression: NONE, in memory: &lt;span class=&quot;code-keyword&quot;&gt;false&lt;/span&gt;, max length: 2147483647, bloom filter: none}, ip:={name: ip, max versions: 1, compression: NONE, in memory: &lt;span class=&quot;code-keyword&quot;&gt;false&lt;/span&gt;, max length: 2147483647, bloom filter: none}}}}, server: XX.XX.XX.33:60020, startCode: 1196155493271
2007-11-27 04:27:26,381 DEBUG hbase.HMaster - Checking postlog,img216/1725/22236401lvh6.gif,1196166373235 is assigned
2007-11-27 04:27:26,511 DEBUG hbase.HMaster - Checked postlog,img216/1725/22236401lvh6.gif,1196164441230 &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; references: splitA: &lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;, splitB: &lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;
2007-11-27 04:28:26,444 DEBUG hbase.HMaster - HMaster.metaScanner scanner: -7699450087241029374 regioninfo: {regionname: postlog,img216/1725/22236401lvh6.gif,1196164441230, startKey: &amp;lt;img216/1725/22236401lvh6.gif&amp;gt;, offline: &lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;, split: &lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;, tableDesc: {name: postlog, families: {cookie:={name: cookie, max versions: 1, compression: NONE, in memory: &lt;span class=&quot;code-keyword&quot;&gt;false&lt;/span&gt;, max length: 2147483647, bloom filter: none}, ip:={name: ip, max versions: 1, compression: NONE, in memory: &lt;span class=&quot;code-keyword&quot;&gt;false&lt;/span&gt;, max length: 2147483647, bloom filter: none}}}}, server: XX.XX.XX.25:60020, startCode: 1196155489036
2007-11-27 04:28:26,446 DEBUG hbase.HMaster - HMaster.metaScanner scanner: -7699450087241029374 regioninfo: {regionname: postlog,img216/1725/22236401lvh6.gif,1196166373235, startKey: &amp;lt;img216/1725/22236401lvh6.gif&amp;gt;, tableDesc: {name: postlog, families: {cookie:={name: cookie, max versions: 1, compression: NONE, in memory: &lt;span class=&quot;code-keyword&quot;&gt;false&lt;/span&gt;, max length: 2147483647, bloom filter: none}, ip:={name: ip, max versions: 1, compression: NONE, in memory: &lt;span class=&quot;code-keyword&quot;&gt;false&lt;/span&gt;, max length: 2147483647, bloom filter: none}}}}, server: XX.XX.XX.33:60020, startCode: 1196155493271
2007-11-27 04:28:26,446 DEBUG hbase.HMaster - Checking postlog,img216/1725/22236401lvh6.gif,1196166373235 is assigned
2007-11-27 04:28:26,590 DEBUG hbase.HMaster - Checked postlog,img216/1725/22236401lvh6.gif,1196164441230 &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; references: splitA: &lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;, splitB: &lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;
2007-11-27 04:29:26,459 DEBUG hbase.HMaster - HMaster.metaScanner scanner: 5846860608957952540 regioninfo: {regionname: postlog,img216/1725/22236401lvh6.gif,1196164441230, startKey: &amp;lt;img216/1401lvh6.gif&amp;gt;, offline: &lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;, split: &lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;, tableDesc: {name: po: 1, compression: NONE, in memory: &lt;span class=&quot;code-keyword&quot;&gt;false&lt;/span&gt;, max length: 21474836s: 1, compression: NONE, in memory: &lt;span class=&quot;code-keyword&quot;&gt;false&lt;/span&gt;, max length: 21474836er: none}}}}, server: XX.XX.XX.25:60020, startCode: 11961554890ase.HMaster - HMaster.metaScanner scanner: 5846860608957952540 /1725/22236401lvh6.gif,1196166373235, startKey: &amp;lt;img216/1725/22okie:={name: cookie, max versions: 1, compression: NONE, in mem NONE, in memory: &lt;span class=&quot;code-keyword&quot;&gt;false&lt;/span&gt;, max length: 2147483647, bloom filter: artCode: 1196155493271
2007-11-27 04:29:26,461 DEBUG hbase.HMas235 is assigned
2007-11-27 04:29:26,622 DEBUG hbase.HMaster - Cces: splitA: &lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;, splitB: &lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;
...
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Here is regionserver log on node XX.XX.XX.33:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;...
2007-11-27 04:26:29,318 INFO  hbase.HRegionServer - MSG_REGION_OPEN : regionname: postlog,img216/1725/22236401lvh6.gif,1196166373235, startKey: &amp;lt;img216/1725/22236401lvh6.gif&amp;gt;, tableDesc: {name: postlog, families: {cookie:={name: cookie, max versions: 1, compression: NONE, in memory: &lt;span class=&quot;code-keyword&quot;&gt;false&lt;/span&gt;, max length: 2147483647, bloom filter: none}, ip:={name: ip, max versions: 1, compression: NONE, in memory: &lt;span class=&quot;code-keyword&quot;&gt;false&lt;/span&gt;, max length: 2147483647, bloom filter: none}}}
2007-11-27 04:26:29,325 DEBUG hbase.HStore - starting 51396220/cookie (no reconstruction log)
2007-11-27 04:26:30,420 DEBUG hbase.HRegionServer - flushing region postlog,img100/941/brandyfn6.gif,1196158363481
2007-11-27 04:26:30,420 DEBUG hbase.HRegion - Not flushing cache &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; region postlog,img100/941/brandyfn6.gif,1196158363481: snapshotMemcaches() determined that there was nothing to &lt;span class=&quot;code-keyword&quot;&gt;do&lt;/span&gt;
2007-11-27 04:26:31,752 DEBUG hbase.HRegionServer - flushing region postlog,img149/2019/liyanaum6.gif,1196164996321
2007-11-27 04:26:31,753 DEBUG hbase.HRegion - Not flushing cache &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; region postlog,img149/2019/liyanaum6.gif,1196164996321: snapshotMemcaches() determined that there was nothing to &lt;span class=&quot;code-keyword&quot;&gt;do&lt;/span&gt;
2007-11-27 04:26:31,753 DEBUG hbase.HRegionServer - flushing region postlog,img148/6048/p9290339kb0.jpg,1196162613173
2007-11-27 04:26:31,753 DEBUG hbase.HRegion - Not flushing cache &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; region postlog,img148/6048/p9290339kb0.jpg,1196162613173: snapshotMemcaches() determined that there was nothing to &lt;span class=&quot;code-keyword&quot;&gt;do&lt;/span&gt;
2007-11-27 04:26:31,754 DEBUG hbase.HRegionServer - flushing region postlog,img132/5512/timeline8bx.png,1196159744555
2007-11-27 04:26:31,754 DEBUG hbase.HRegion - Not flushing cache &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; region postlog,img132/5512/timeline8bx.png,1196159744555: snapshotMemcaches() determined that there was nothing to &lt;span class=&quot;code-keyword&quot;&gt;do&lt;/span&gt;
2007-11-27 04:26:37,915 DEBUG hbase.HRegionServer - flushing region postlog,img149/3724/whosherne4.jpg,1196164996322
2007-11-27 04:26:37,915 DEBUG hbase.HRegion - Not flushing cache &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; region postlog,img149/3724/whosherne4.jpg,1196164996322: snapshotMemcaches() determined that there was nothing to &lt;span class=&quot;code-keyword&quot;&gt;do&lt;/span&gt;
2007-11-27 04:26:57,059 DEBUG hbase.HRegionServer - flushing region postlog,img148/8339/361de8578d356flip0hd.png,1196165445439
2007-11-27 04:26:57,060 DEBUG hbase.HRegion - Not flushing cache &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; region postlog,img148/8339/361de8578d356flip0hd.png,1196165445439: snapshotMemcaches() determined that there was nothing to &lt;span class=&quot;code-keyword&quot;&gt;do&lt;/span&gt;
2007-11-27 04:27:03,604 DEBUG hbase.HStore - maximum sequence id &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; hstore 51396220/cookie is 30625781
2007-11-27 04:27:03,761 DEBUG hbase.HStore - starting 51396220/ip (no reconstruction log)
2007-11-27 04:27:03,859 DEBUG hbase.HStore - maximum sequence id &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; hstore 51396220/ip is 30625781
2007-11-27 04:27:03,965 DEBUG hbase.HRegion - Next sequence id &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; region postlog,img216/1725/22236401lvh6.gif,1196166373235 is 30625782
2007-11-27 04:27:03,969 INFO  hbase.HRegion - region postlog,img216/1725/22236401lvh6.gif,1196166373235 available
2007-11-27 04:27:03,969 INFO  hbase.HRegionServer - MSG_REGION_OPEN : regionname: postlog,img216/1725/22236401lvh6.gif,1196166373235, startKey: &amp;lt;img216/1725/22236401lvh6.gif&amp;gt;, tableDesc: {name: postlog, families: {cookie:={name: cookie, max versions: 1, compression: NONE, in memory: &lt;span class=&quot;code-keyword&quot;&gt;false&lt;/span&gt;, max length: 2147483647, bloom filter: none}, ip:={name: ip, max versions: 1, compression: NONE, in memory: &lt;span class=&quot;code-keyword&quot;&gt;false&lt;/span&gt;, max length: 2147483647, bloom filter: none}}}
2007-11-27 04:27:04,578 INFO  hbase.HRegionServer - MSG_REGION_CLOSE_WITHOUT_REPORT : regionname: postlog,img216/1725/22236401lvh6.gif,1196166373235, startKey: &amp;lt;img216/1725/22236401lvh6.gif&amp;gt;, tableDesc: {name: postlog, families: {cookie:={name: cookie, max versions: 1, compression: NONE, in memory: &lt;span class=&quot;code-keyword&quot;&gt;false&lt;/span&gt;, max length: 2147483647, bloom filter: none}, ip:={name: ip, max versions: 1, compression: NONE, in memory: &lt;span class=&quot;code-keyword&quot;&gt;false&lt;/span&gt;, max length: 2147483647, bloom filter: none}}}
2007-11-27 04:27:04,578 DEBUG hbase.HRegion - Not flushing cache &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; region postlog,img216/1725/22236401lvh6.gif,1196166373235: snapshotMemcaches() determined that there was nothing to &lt;span class=&quot;code-keyword&quot;&gt;do&lt;/span&gt;
2007-11-27 04:27:04,579 DEBUG hbase.HStore - closed 51396220/ip
2007-11-27 04:27:04,580 DEBUG hbase.HStore - closed 51396220/cookie
2007-11-27 04:27:04,580 INFO  hbase.HRegion - closed postlog,img216/1725/22236401lvh6.gif,1196166373235
..
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;


&lt;p&gt;It looks like the assigned region hasn&apos;t been cleared from the unassigned regions list when the report comes in.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12383364">HBASE-194</key>
            <summary>[hbase] Still multi-assigning regions</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/bug.png">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.png">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="stack">stack</reporter>
                        <labels>
                    </labels>
                <created>Tue, 27 Nov 2007 23:28:28 +0000</created>
                <updated>Thu, 2 May 2013 02:29:02 +0000</updated>
                            <resolved>Thu, 29 Nov 2007 21:10:34 +0000</resolved>
                                                                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                <comments>
                            <comment id="12546087" author="jimk" created="Wed, 28 Nov 2007 02:52:58 +0000"  >&lt;p&gt;We figured out a likely scenario for how this could happen.&lt;/p&gt;

&lt;p&gt; 1. master assigns region to a region server&lt;br/&gt;
 2. region server puts open region on its &apos;todo list&apos; &lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;todo list executes in a separate thread because actions on the todo list may take longer than a heartbeat interval to complete.&lt;br/&gt;
 3. region server is still processing todo list when it is time to send a heartbeat to the master&lt;br/&gt;
 4. master assigns the same region to the server because it is still unassigned and no region server is serving it&lt;br/&gt;
 5. region server completes bringing region on-line and tells the master in the next heartbeat message&lt;br/&gt;
 6. master replies saying &quot;Ive assigned this region to someone else. close it and don&apos;t tell me you&apos;ve closed it.&lt;br/&gt;
 7. region server queues close request and this stops the region from coming online.&lt;br/&gt;
 8. master thinks region server should be serving the region so it is removed from unassigned regions list.&lt;br/&gt;
 9. no region server ends up serving the region even though the master thinks it is not an unserved region&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;To fix this we propose that when the master assigns a region it puts the region in a delay queue with a timeout of 2 * lease interval.&lt;br/&gt;
If the region server responds in 2 * lease interval saying it is serving the region, then the master finishes processing the event of the region coming online.&lt;br/&gt;
If the region server does not respond in 2 * lease interval that it is serving the region, the master assumes that either:&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;the region server has died and will never serve the region&lt;/li&gt;
	&lt;li&gt;the region server never got the message to serve the region&lt;br/&gt;
and consequently will assign the region to the next appropriate region server.&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="12546267" author="stack" created="Wed, 28 Nov 2007 15:14:35 +0000"  >&lt;p&gt;The sense is that this issue has been around for a long time and that it has been responsible for profusion of unexplainable NotServerRegionExceptions.&lt;/p&gt;

&lt;p&gt;Whats happening is that the master double-assigns a region.  Because of the context at the time of assignment hasn&apos;t changed when the second assignment happens, the two assignments go to the same host.  When the first assignment reports back to the master that region is open, because of the state in the master, it thinks it a rogue regionserver coming up deploying regions it shouldn&apos;t have.  So the master sends a &apos;you-shouldn&apos;t-have-opened-that-region-shut-it-down&apos; message.  Regionserver dutifully closes the region.  As far as the master is concerned, its accounting shows the region properly assigned though no regionserver is now carrying the region.  Clients come in looking for a row from the problematic region.  Master sends them to where it thinks the region has been deployed.  When client goes to identified regionserver, it throws the NotServingRegionException.&lt;/p&gt;</comment>
                            <comment id="12546440" author="jimk" created="Wed, 28 Nov 2007 22:24:02 +0000"  >&lt;p&gt;When the master assigned a region twice to the same server, what happened was that on the second assignment, the region server returned two &apos;region is opened&apos; messages in the same message to the master (code bug in HRegionServer). The first message was processed properly and the master queued a task to update the meta. The master then looped to process the second message, and now the region was no longer in the &apos;unassigned regions&apos; list so the master told the region server to close it. In the mean time, the update of the meta completes, clients start trying to access the region but the region server has closed the region so the client gets a NotServingRegion exception.&lt;/p&gt;

&lt;p&gt;The master was doing the &apos;right thing&apos; by reassigning the region because the region server took longer than &apos;hbase.hbasemaster.maxregionopen&apos; (30 seconds) to open the region.&lt;/p&gt;

&lt;p&gt;Fixing the aforementioned bug will prevent this from occurring, but if the master should assign the same region to two different region servers, this could easily result in corrupting the region beyond repair as there is a lot of file i/o associated with bringing a region on-line. To avoid this, we propose that a region server acknowledge that it is opening the region, and when the master receives the ack, it extends the region reassignment timeout. If the region server subsequently fails to open the region, the master can reassign the region after the additional grace period and we can be pretty certain that there will be no interference between multiple region servers opening the same region.&lt;/p&gt;</comment>
                            <comment id="12546546" author="hadoopqa" created="Thu, 29 Nov 2007 02:49:24 +0000"  >&lt;p&gt;-1 overall.  Here are the results of testing the latest attachment &lt;br/&gt;
&lt;a href=&quot;http://issues.apache.org/jira/secure/attachment/12370479/patch.txt&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/secure/attachment/12370479/patch.txt&lt;/a&gt;&lt;br/&gt;
against trunk revision r599223.&lt;/p&gt;

&lt;p&gt;    @author +1.  The patch does not contain any @author tags.&lt;/p&gt;

&lt;p&gt;    javadoc +1.  The javadoc tool did not generate any warning messages.&lt;/p&gt;

&lt;p&gt;    javac +1.  The applied patch does not generate any new compiler warnings.&lt;/p&gt;

&lt;p&gt;    findbugs +1.  The patch does not introduce any new Findbugs warnings.&lt;/p&gt;

&lt;p&gt;    core tests -1.  The patch failed core unit tests.&lt;/p&gt;

&lt;p&gt;    contrib tests -1.  The patch failed contrib unit tests.&lt;/p&gt;

&lt;p&gt;Test results: &lt;a href=&quot;http://lucene.zones.apache.org:8080/hudson/job/Hadoop-Patch/1195/testReport/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://lucene.zones.apache.org:8080/hudson/job/Hadoop-Patch/1195/testReport/&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;http://lucene.zones.apache.org:8080/hudson/job/Hadoop-Patch/1195/artifact/trunk/build/test/findbugs/newPatchFindbugsWarnings.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://lucene.zones.apache.org:8080/hudson/job/Hadoop-Patch/1195/artifact/trunk/build/test/findbugs/newPatchFindbugsWarnings.html&lt;/a&gt;&lt;br/&gt;
Checkstyle results: &lt;a href=&quot;http://lucene.zones.apache.org:8080/hudson/job/Hadoop-Patch/1195/artifact/trunk/build/test/checkstyle-errors.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://lucene.zones.apache.org:8080/hudson/job/Hadoop-Patch/1195/artifact/trunk/build/test/checkstyle-errors.html&lt;/a&gt;&lt;br/&gt;
Console output: &lt;a href=&quot;http://lucene.zones.apache.org:8080/hudson/job/Hadoop-Patch/1195/console&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://lucene.zones.apache.org:8080/hudson/job/Hadoop-Patch/1195/console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="12546555" author="jimk" created="Thu, 29 Nov 2007 04:06:32 +0000"  >&lt;p&gt;Address race condition between main processing loop and meta/root scanners.&lt;/p&gt;

&lt;p&gt;May also fix &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-122&quot; title=&quot;[hbase] patch-build test failures (#1194, #1193, #1192)&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-122&quot;&gt;&lt;del&gt;HADOOP-2303&lt;/del&gt;&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="12546599" author="hadoopqa" created="Thu, 29 Nov 2007 08:14:05 +0000"  >&lt;p&gt;-1 overall.  Here are the results of testing the latest attachment &lt;br/&gt;
&lt;a href=&quot;http://issues.apache.org/jira/secure/attachment/12370498/patch.txt&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/secure/attachment/12370498/patch.txt&lt;/a&gt;&lt;br/&gt;
against trunk revision r599223.&lt;/p&gt;

&lt;p&gt;    @author +1.  The patch does not contain any @author tags.&lt;/p&gt;

&lt;p&gt;    javadoc +1.  The javadoc tool did not generate any warning messages.&lt;/p&gt;

&lt;p&gt;    javac +1.  The applied patch does not generate any new compiler warnings.&lt;/p&gt;

&lt;p&gt;    findbugs +1.  The patch does not introduce any new Findbugs warnings.&lt;/p&gt;

&lt;p&gt;    core tests +1.  The patch passed core unit tests.&lt;/p&gt;

&lt;p&gt;    contrib tests -1.  The patch failed contrib unit tests.&lt;/p&gt;

&lt;p&gt;Test results: &lt;a href=&quot;http://lucene.zones.apache.org:8080/hudson/job/Hadoop-Patch/1198/testReport/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://lucene.zones.apache.org:8080/hudson/job/Hadoop-Patch/1198/testReport/&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;http://lucene.zones.apache.org:8080/hudson/job/Hadoop-Patch/1198/artifact/trunk/build/test/findbugs/newPatchFindbugsWarnings.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://lucene.zones.apache.org:8080/hudson/job/Hadoop-Patch/1198/artifact/trunk/build/test/findbugs/newPatchFindbugsWarnings.html&lt;/a&gt;&lt;br/&gt;
Checkstyle results: &lt;a href=&quot;http://lucene.zones.apache.org:8080/hudson/job/Hadoop-Patch/1198/artifact/trunk/build/test/checkstyle-errors.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://lucene.zones.apache.org:8080/hudson/job/Hadoop-Patch/1198/artifact/trunk/build/test/checkstyle-errors.html&lt;/a&gt;&lt;br/&gt;
Console output: &lt;a href=&quot;http://lucene.zones.apache.org:8080/hudson/job/Hadoop-Patch/1198/console&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://lucene.zones.apache.org:8080/hudson/job/Hadoop-Patch/1198/console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="12546828" author="jimk" created="Thu, 29 Nov 2007 18:18:36 +0000"  >&lt;p&gt;Clean up some shut down code.&lt;/p&gt;</comment>
                            <comment id="12546852" author="hadoopqa" created="Thu, 29 Nov 2007 19:36:47 +0000"  >&lt;p&gt;+1 overall.  Here are the results of testing the latest attachment &lt;br/&gt;
&lt;a href=&quot;http://issues.apache.org/jira/secure/attachment/12370566/patch.txt&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/secure/attachment/12370566/patch.txt&lt;/a&gt;&lt;br/&gt;
against trunk revision r599447.&lt;/p&gt;

&lt;p&gt;    @author +1.  The patch does not contain any @author tags.&lt;/p&gt;

&lt;p&gt;    javadoc +1.  The javadoc tool did not generate any warning messages.&lt;/p&gt;

&lt;p&gt;    javac +1.  The applied patch does not generate any new compiler warnings.&lt;/p&gt;

&lt;p&gt;    findbugs +1.  The patch does not introduce any new Findbugs warnings.&lt;/p&gt;

&lt;p&gt;    core tests +1.  The patch passed core unit tests.&lt;/p&gt;

&lt;p&gt;    contrib tests +1.  The patch passed contrib unit tests.&lt;/p&gt;

&lt;p&gt;Test results: &lt;a href=&quot;http://lucene.zones.apache.org:8080/hudson/job/Hadoop-Patch/1206/testReport/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://lucene.zones.apache.org:8080/hudson/job/Hadoop-Patch/1206/testReport/&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;http://lucene.zones.apache.org:8080/hudson/job/Hadoop-Patch/1206/artifact/trunk/build/test/findbugs/newPatchFindbugsWarnings.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://lucene.zones.apache.org:8080/hudson/job/Hadoop-Patch/1206/artifact/trunk/build/test/findbugs/newPatchFindbugsWarnings.html&lt;/a&gt;&lt;br/&gt;
Checkstyle results: &lt;a href=&quot;http://lucene.zones.apache.org:8080/hudson/job/Hadoop-Patch/1206/artifact/trunk/build/test/checkstyle-errors.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://lucene.zones.apache.org:8080/hudson/job/Hadoop-Patch/1206/artifact/trunk/build/test/checkstyle-errors.html&lt;/a&gt;&lt;br/&gt;
Console output: &lt;a href=&quot;http://lucene.zones.apache.org:8080/hudson/job/Hadoop-Patch/1206/console&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://lucene.zones.apache.org:8080/hudson/job/Hadoop-Patch/1206/console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="12546895" author="jimk" created="Thu, 29 Nov 2007 21:10:34 +0000"  >&lt;p&gt;Tests passed. Committed.&lt;/p&gt;</comment>
                            <comment id="12547104" author="hudson" created="Fri, 30 Nov 2007 12:17:03 +0000"  >&lt;p&gt;Integrated in Hadoop-Nightly #318 (See &lt;a href=&quot;http://lucene.zones.apache.org:8080/hudson/job/Hadoop-Nightly/318/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://lucene.zones.apache.org:8080/hudson/job/Hadoop-Nightly/318/&lt;/a&gt;)&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10001">
                    <name>dependent</name>
                                            <outwardlinks description="depends upon">
                                        <issuelink>
            <issuekey id="12383237">HBASE-249</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12370566" name="patch.txt" size="13108" author="jimk" created="Thu, 29 Nov 2007 18:18:36 +0000"/>
                            <attachment id="12370498" name="patch.txt" size="5287" author="jimk" created="Thu, 29 Nov 2007 04:06:31 +0000"/>
                            <attachment id="12370479" name="patch.txt" size="3300" author="jimk" created="Wed, 28 Nov 2007 23:50:45 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>3.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Wed, 28 Nov 2007 02:52:58 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>24978</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            9 years, 2 weeks ago
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0h5bj:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>98124</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        </customfields>
    </item>
</channel>
</rss>