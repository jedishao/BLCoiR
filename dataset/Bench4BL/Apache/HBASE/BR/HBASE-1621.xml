<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Fri Dec 02 20:43:56 UTC 2016

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/HBASE-1621/HBASE-1621.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[HBASE-1621] merge tool should work on online cluster</title>
                <link>https://issues.apache.org/jira/browse/HBASE-1621</link>
                <project id="12310753" key="HBASE">HBase</project>
                    <description>&lt;p&gt;taking down the entire cluster to merge 2 regions is a pain, i dont see why the table or regions specifically couldnt be taken offline, then merged then brought back up.&lt;/p&gt;

&lt;p&gt;this might need a new API to the regionservers so they can take direction from not just the master.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12429691">HBASE-1621</key>
            <summary>merge tool should work on online cluster</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/bug.png">Bug</type>
                                            <priority id="2" iconUrl="https://issues.apache.org/jira/images/icons/priorities/critical.png">Critical</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="3">Duplicate</resolution>
                                        <assignee username="stack">stack</assignee>
                                    <reporter username="ryanobjc">ryan rawson</reporter>
                        <labels>
                    </labels>
                <created>Tue, 7 Jul 2009 08:11:57 +0000</created>
                <updated>Mon, 23 Sep 2013 18:23:56 +0000</updated>
                            <resolved>Wed, 9 Jan 2013 23:58:09 +0000</resolved>
                                                                        <due></due>
                            <votes>9</votes>
                                    <watches>28</watches>
                                                                <comments>
                            <comment id="12728180" author="stack" created="Tue, 7 Jul 2009 16:34:44 +0000"  >&lt;p&gt;Agreed.&lt;/p&gt;</comment>
                            <comment id="12751309" author="stack" created="Fri, 4 Sep 2009 05:04:01 +0000"  >&lt;p&gt;Move out of 0.20.1?&lt;/p&gt;</comment>
                            <comment id="12753425" author="stack" created="Thu, 10 Sep 2009 05:17:35 +0000"  >&lt;p&gt;Moving out of 0.20.1 after chatting with Ryan.&lt;/p&gt;</comment>
                            <comment id="12879843" author="stack" created="Thu, 17 Jun 2010 16:53:28 +0000"  >&lt;p&gt;Or rather, we shouldn&apos;t have to take the table offline at all... just close regions to be merged, merge them while all else is online, then update meta.&lt;/p&gt;</comment>
                            <comment id="12879999" author="jdcryans" created="Thu, 17 Jun 2010 23:27:50 +0000"  >&lt;p&gt;Here&apos;s an initial implementation for online merging, along with a unit test. I tested it on a small table in a small cluster, worked as advertised. There&apos;s currently no rollbacking so if anything happens during the merge then the 2 regions will stay OFFLINE which means that you need to disable/enable the table to get them back.&lt;/p&gt;

&lt;p&gt;Based off branch.&lt;/p&gt;</comment>
                            <comment id="12880008" author="jdcryans" created="Thu, 17 Jun 2010 23:50:08 +0000"  >&lt;p&gt;Patch that actually only merges the specified table. &lt;/p&gt;

&lt;p&gt;After fixing it I tried it on a cluster, shaved off around 350 regions on a big table in about 8 minutes.&lt;/p&gt;</comment>
                            <comment id="12902218" author="jdcryans" created="Wed, 25 Aug 2010 00:43:28 +0000"  >&lt;p&gt;This won&apos;t happen in 0.90 unless someone really needs it.&lt;/p&gt;</comment>
                            <comment id="12902261" author="streamy" created="Wed, 25 Aug 2010 01:18:05 +0000"  >&lt;p&gt;There is a slight chance that we will implement this with a bunch of HBCK improvements we are working on.  In any case, I&apos;m +1 on punting the jira.&lt;/p&gt;</comment>
                            <comment id="12928229" author="deinspanjer" created="Thu, 4 Nov 2010 14:52:16 +0000"  >&lt;p&gt;Curious if the idea could be pushed even further and allow the merge to analyze the regions to find pairs to be merged, then specifically offline those regions and merge them rather than disabling the table..&lt;/p&gt;</comment>
                            <comment id="12993441" author="anih" created="Fri, 11 Feb 2011 11:00:49 +0000"  >&lt;p&gt;new patch is working with trunk rev:1069743, all tests passed and later today i will test it in our cluster&lt;/p&gt;</comment>
                            <comment id="12993465" author="anih" created="Fri, 11 Feb 2011 12:08:46 +0000"  >&lt;p&gt;issu with new patch:&lt;/p&gt;

&lt;p&gt;11/02/11 12:48:52 DEBUG regionserver.HRegion: Opening region: REGION =&amp;gt; {NAME =&amp;gt; &apos;Golden_ATU,6863-g_75FAEC36055608836CA66DCF3F587EF5,1297363213791.25a54a0a31f43b31c3273ea8124febc3.&apos;, STARTKEY =&amp;gt; &apos;6863-g_75FAEC36055608836CA66DCF3F587EF5&apos;, ENDKEY =&amp;gt; &apos;6867-d_2010_8_8_23B88FA03D74F4A93374B12F60292B4F&apos;, ENCODED =&amp;gt; 25a54a0a31f43b31c3273ea8124febc3, OFFLINE =&amp;gt; true, TABLE =&amp;gt; {{NAME =&amp;gt; &apos;Golden_ATU&apos;, FAMILIES =&amp;gt; [&lt;/p&gt;
{NAME =&amp;gt; &apos;c&apos;, BLOOMFILTER =&amp;gt; &apos;ROW&apos;, REPLICATION_SCOPE =&amp;gt; &apos;0&apos;, COMPRESSION =&amp;gt; &apos;LZO&apos;, VERSIONS =&amp;gt; &apos;1&apos;, TTL =&amp;gt; &apos;-1&apos;, BLOCKSIZE =&amp;gt; &apos;65536&apos;, IN_MEMORY =&amp;gt; &apos;false&apos;, BLOCKCACHE =&amp;gt; &apos;true&apos;}
&lt;p&gt;]}}&lt;br/&gt;
                11/02/11 12:48:52 DEBUG regionserver.HRegion: Instantiated Golden_ATU,6863-g_75FAEC36055608836CA66DCF3F587EF5,1297363213791.25a54a0a31f43b31c3273ea8124febc3.&lt;br/&gt;
                        11/02/11 12:48:52 INFO lzo.GPLNativeCodeLoader: Loaded native gpl library&lt;br/&gt;
                        11/02/11 12:48:52 INFO lzo.LzoCodec: Successfully loaded &amp;amp; initialized native-lzo library &lt;span class=&quot;error&quot;&gt;&amp;#91;hadoop-lzo rev /home/django/hadoop-lzo/src/get_build_revision.sh: line 4: git: command not found&amp;#93;&lt;/span&gt;&lt;br/&gt;
                        11/02/11 12:48:52 INFO compress.CodecPool: Got brand-new compressor&lt;br/&gt;
                        11/02/11 12:48:52 FATAL util.Merge: Merge failed&lt;br/&gt;
                        java.lang.IllegalArgumentException: Wrong FS: hdfs://db2a:50001/hbase/Golden_ATU/25a54a0a31f43b31c3273ea8124febc3/.regioninfo, expected: &lt;a href=&quot;file:///&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;file:///&lt;/a&gt;&lt;br/&gt;
                        at org.apache.hadoop.fs.FileSystem.checkPath(FileSystem.java:310)&lt;br/&gt;
                        at org.apache.hadoop.fs.RawLocalFileSystem.pathToFile(RawLocalFileSystem.java:47)&lt;br/&gt;
                        at org.apache.hadoop.fs.RawLocalFileSystem.getFileStatus(RawLocalFileSystem.java:357)&lt;br/&gt;
                        at org.apache.hadoop.fs.FilterFileSystem.getFileStatus(FilterFileSystem.java:245)&lt;br/&gt;
                        at org.apache.hadoop.fs.FileSystem.exists(FileSystem.java:648)&lt;br/&gt;
                        at org.apache.hadoop.hbase.regionserver.HRegion.checkRegioninfoOnFilesystem(HRegion.java:430)&lt;br/&gt;
                        at org.apache.hadoop.hbase.regionserver.HRegion.initialize(HRegion.java:355)&lt;br/&gt;
                        at org.apache.hadoop.hbase.regionserver.HRegion.openHRegion(HRegion.java:2713)&lt;br/&gt;
                        at org.apache.hadoop.hbase.regionserver.HRegion.openHRegion(HRegion.java:2699)&lt;br/&gt;
                        at org.apache.hadoop.hbase.regionserver.HRegion.openHRegion(HRegion.java:2668)&lt;br/&gt;
                        at org.apache.hadoop.hbase.util.OnlineMerge.merge(OnlineMerge.java:290)&lt;br/&gt;
                        at org.apache.hadoop.hbase.util.OnlineMerge.mergeRegions(OnlineMerge.java:230)&lt;br/&gt;
                        at org.apache.hadoop.hbase.util.OnlineMerge.run(OnlineMerge.java:118)&lt;br/&gt;
                        at org.apache.hadoop.util.ToolRunner.run(ToolRunner.java:65)&lt;br/&gt;
                        at org.apache.hadoop.util.ToolRunner.run(ToolRunner.java:79)&lt;br/&gt;
                        at org.apache.hadoop.hbase.util.OnlineMerge.main(OnlineMerge.java:393)&lt;/p&gt;</comment>
                            <comment id="12993477" author="anih" created="Fri, 11 Feb 2011 13:01:29 +0000"  >&lt;p&gt;last traceback was because onlinemerger was running from client and doesn&apos;t have hadoop configuration, but this is something to track down:&lt;/p&gt;

&lt;p&gt;11/02/11 13:56:52 DEBUG regionserver.Store: closed c&lt;br/&gt;
11/02/11 13:56:52 INFO regionserver.HRegion: Closed Golden_ATU,6879-w_2010_27_6CC5E20C77D7EA4771A44B432B281BD7,1287089222938.6dac71a9736509ad4cbbfa3f58df2f41.&lt;br/&gt;
11/02/11 13:56:52 DEBUG regionserver.HRegion: Closing Golden_ATU,6879-w_2010_28_383BE4774DBF96F224EEE3A41282E0D8,1287089224381.abb281eff02fdb5bc935d71a8dd7f27a.: disabling compactions &amp;amp; flushes&lt;br/&gt;
11/02/11 13:56:52 DEBUG regionserver.HRegion: Updates disabled for region Golden_ATU,6879-w_2010_28_383BE4774DBF96F224EEE3A41282E0D8,1287089224381.abb281eff02fdb5bc935d71a8dd7f27a.&lt;br/&gt;
11/02/11 13:56:52 DEBUG hfile.HFile: On close of file hdfs://db2a:50001/hbase/Golden_ATU/abb281eff02fdb5bc935d71a8dd7f27a/c/5936293646315145921 evicted 0 block(s) of 149 total blocks&lt;br/&gt;
11/02/11 13:56:52 DEBUG regionserver.Store: closed c&lt;br/&gt;
11/02/11 13:56:52 INFO regionserver.HRegion: Closed Golden_ATU,6879-w_2010_28_383BE4774DBF96F224EEE3A41282E0D8,1287089224381.abb281eff02fdb5bc935d71a8dd7f27a.&lt;br/&gt;
11/02/11 13:56:52 FATAL util.Merge: Merge failed&lt;br/&gt;
        java.io.IOException: Files have same sequenceid: 1305035413&lt;br/&gt;
        at org.apache.hadoop.hbase.regionserver.HRegion.merge(HRegion.java:2952)&lt;br/&gt;
        at org.apache.hadoop.hbase.util.OnlineMerge.merge(OnlineMerge.java:294)&lt;br/&gt;
        at org.apache.hadoop.hbase.util.OnlineMerge.mergeRegions(OnlineMerge.java:230)&lt;br/&gt;
        at org.apache.hadoop.hbase.util.OnlineMerge.run(OnlineMerge.java:118)&lt;br/&gt;
        at org.apache.hadoop.util.ToolRunner.run(ToolRunner.java:65)&lt;br/&gt;
        at org.apache.hadoop.util.ToolRunner.run(ToolRunner.java:79)&lt;br/&gt;
at org.apache.hadoop.hbase.util.OnlineMerge.main(OnlineMerge.java:393)&lt;br/&gt;
        11/02/11 13:56:52 DEBUG wal.HLog: main.logSyncer interrupted while waiting for sync requests&lt;br/&gt;
        11/02/11 13:56:52 INFO wal.HLog: main.logSyncer exiting&lt;br/&gt;
        11/02/11 13:56:52 DEBUG wal.HLog: closing hlog writer in hdfs://db2a:50001/user/hbase/.logs_1297429009717&lt;br/&gt;
        11/02/11 13:56:52 DEBUG wal.HLog: Moved 1 log files to /user/hbase/.oldlogs&lt;br/&gt;
        11/02/11 13:56:53 INFO util.Merge: Verifying that file system is available...&lt;br/&gt;
        11/02/11 13:56:53 INFO util.Merge: Verifying that HBase is running...&lt;br/&gt;
        11/02/11 13:56:53 INFO zookeeper.ZooKeeper: Client environment:zookeeper.version=3.3.2-1031432, built on 11/05/2010 05:32 GMT&lt;br/&gt;
        11/02/11 13:56:53 INFO zookeeper.ZooKeeper: Client environment:host.name=db2a.goldenline.pl&lt;/p&gt;</comment>
                            <comment id="13002362" author="stack" created="Fri, 4 Mar 2011 00:36:56 +0000"  >&lt;p&gt;Need to fix this issue before can do merges.&lt;/p&gt;</comment>
                            <comment id="13009467" author="stack" created="Mon, 21 Mar 2011 23:19:07 +0000"  >&lt;p&gt;We need this in 0.92.&lt;/p&gt;</comment>
                            <comment id="13060933" author="yuzhihong@gmail.com" created="Thu, 7 Jul 2011 00:02:07 +0000"  >&lt;p&gt;Adapted onlinemerge to TRUNK.&lt;/p&gt;

&lt;p&gt;The unit test didn&apos;t seem to make progress and repeatedly printed:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
2011-07-06 16:50:56,131 DEBUG [main] client.HTable$ClientScanner(1103): Finished with scanning at REGION =&amp;gt; {NAME =&amp;gt; &apos;.META.,,1 TableName =&amp;gt; .META.&apos;, STARTKEY =&amp;gt; &apos;&apos;, ENDKEY =&amp;gt; &apos;&apos;, ENCODED =&amp;gt; 1028785192,}
2011-07-06 16:50:56,331 DEBUG [main] client.HTable$ClientScanner(1023): Creating scanner over .META. starting at key &apos;&apos;
2011-07-06 16:50:56,331 DEBUG [main] client.HTable$ClientScanner(1116): Advancing internal scanner to startKey at &apos;&apos;
2011-07-06 16:50:56,332 INFO  [main] util.OnlineMerge(265): mrtest,,1309996082762.1688f19bfa69d68a090aa8b90bfa1129.
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="13066284" author="stack" created="Fri, 15 Jul 2011 23:02:47 +0000"  >&lt;p&gt;Just ran into this trying to do some table surgery.  Its silly.  We need to fix.&lt;/p&gt;</comment>
                            <comment id="13071505" author="stack" created="Wed, 27 Jul 2011 04:23:57 +0000"  >&lt;p&gt;Pulling this back into 0.92 and assigning myself.  This is a pretty critical one.  I&apos;d like to try do it for 0.92 (Thanks Ted for being more of a man than me moving the issues out 0.92.. I was unable to cut more).&lt;/p&gt;</comment>
                            <comment id="13072904" author="stack" created="Fri, 29 Jul 2011 16:39:14 +0000"  >&lt;p&gt;Need this so can do improvements to hbck --fix (The improvements to hbck --fix) can happen out of band with 0.92 release but need this in place)&lt;/p&gt;</comment>
                            <comment id="13081149" author="asautins" created="Mon, 8 Aug 2011 19:33:50 +0000"  >&lt;p&gt;Would it be possible for the implementation to not have to compact before and after the merge is done?  Looking at HRegion.merge it starts by compacting stores on both regions and then at the end compacts the stores for the new merged region before completing.  Would it be possible to just merge all the store files and let the next major compaction on the new region handle store compaction?  It would be nice to keep the amount of time the table needs to be disabled to a minimum.  If one or both of the regions being merged is large it could take a meaningful amount of time to complete the merge.&lt;/p&gt;</comment>
                            <comment id="13081151" author="stack" created="Mon, 8 Aug 2011 19:38:12 +0000"  >&lt;p&gt;I was thinking of an implementation that just ensured that the regions to merge were first all closed out on the cluster and then it&apos;d create the new merge region and just move the storefiles from the old regions into place under the new merge region &amp;#8211; then deploy.  No writing of new store files.  Let any compactions, etc., happen post assign.&lt;/p&gt;</comment>
                            <comment id="13093142" author="jdcryans" created="Mon, 29 Aug 2011 19:48:29 +0000"  >&lt;p&gt;This is my current WIP on an online merging script.&lt;/p&gt;

&lt;p&gt;It requires you download this file and put it on the ruby path (on put it in the folder you are when running online_merge): &lt;a href=&quot;http://gitorious.org/trollop/mainline/blobs/raw/master/lib/trollop.rb&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://gitorious.org/trollop/mainline/blobs/raw/master/lib/trollop.rb&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;(learn more about trollop here: &lt;a href=&quot;http://trollop.rubyforge.org/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://trollop.rubyforge.org/&lt;/a&gt;)&lt;/p&gt;

&lt;p&gt;Currently it:&lt;/p&gt;

&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;merges whole table or a range of regions&lt;/li&gt;
	&lt;li&gt;skips the regions that are splitting or just split&lt;/li&gt;
	&lt;li&gt;merges any number of regions together, default being 5&lt;/li&gt;
	&lt;li&gt;does a dry run by default&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;Work needed:&lt;/p&gt;

&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;a ton of refactoring&lt;/li&gt;
	&lt;li&gt;a log to be able to continue a merge if anything weird happened&lt;/li&gt;
	&lt;li&gt;more smarts on handling splits&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;We removed thousands of regions already on our clusters with this script (or some older and buggier version of it).&lt;/p&gt;</comment>
                            <comment id="13094119" author="jdcryans" created="Tue, 30 Aug 2011 21:44:31 +0000"  >&lt;p&gt;New version of the script, this time without the errors included by some last minute changes.&lt;/p&gt;</comment>
                            <comment id="13098669" author="sunnygao" created="Wed, 7 Sep 2011 07:14:50 +0000"  >&lt;p&gt;@J-D&lt;/p&gt;

&lt;p&gt;Will the java api be supported?  We want to use these api to do some automatic monitoring.&lt;br/&gt;
If can&apos;t do it. We will convert your code. &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.gif&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;</comment>
                            <comment id="13099015" author="deinspanjer" created="Wed, 7 Sep 2011 15:16:56 +0000"  >&lt;p&gt;@J-D&lt;/p&gt;

&lt;p&gt;I noticed a potential small problem with the script while reading through it.&lt;br/&gt;
At the beginning, it calls HBaseAdmin.balanceSwitch(false), but after the initial scan, there are two Trollop:die statements that would prevent the balancer from being turned back on.&lt;/p&gt;

&lt;p&gt;I think that you need to test the two break conditions in an if block, and then turn the balancer back on before you call die.&lt;/p&gt;</comment>
                            <comment id="13099089" author="jdcryans" created="Wed, 7 Sep 2011 16:50:41 +0000"  >&lt;blockquote&gt;&lt;p&gt;Will the java api be supported?&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;I&apos;m not sure I understand the question, but the reason a script was built in the first place (instead of java code) is to be able to include it in a 0.90 release without breaking compatibility, while offering development flexibility. It could eventually be included in hbck.&lt;/p&gt;</comment>
                            <comment id="13099091" author="jdcryans" created="Wed, 7 Sep 2011 16:51:32 +0000"  >&lt;blockquote&gt;&lt;p&gt;I think that you need to test the two break conditions in an if block, and then turn the balancer back on before you call die.&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;True, also it needs to handle the case where the balancer was already switched off and shouldn&apos;t be turned back on at the end.&lt;/p&gt;</comment>
                            <comment id="13106949" author="stack" created="Sat, 17 Sep 2011 00:20:26 +0000"  >&lt;p&gt;So I think the fact that we have this script to do online merge takes the heat off this issue.  I do not think it a blocker on 0.92 anymore.&lt;/p&gt;</comment>
                            <comment id="13122339" author="stack" created="Thu, 6 Oct 2011 21:53:14 +0000"  >&lt;p&gt;Undoing this as blocker now we have a merge script that has been run a few times in production; having such script takes the heat off the need for this... but we still need it.  Marking major.&lt;/p&gt;</comment>
                            <comment id="13126103" author="jimmy888" created="Wed, 12 Oct 2011 20:13:35 +0000"  >&lt;p&gt;I have run this command in cdh3u0 version, and got the following error:&lt;/p&gt;

&lt;p&gt;online_merge.rb.bak:112: undefined method `each&apos; for #&amp;lt;#&amp;lt;Class:01x4eb3c24f&amp;gt;:0x7b&lt;br/&gt;
99f8e6&amp;gt; (NoMethodError).&lt;br/&gt;
line 112 is&lt;br/&gt;
for result in resultScanner&lt;/p&gt;

&lt;p&gt;the hbase version is 0.90.1 . Does this script only work with 0.92.0 hbase version ?&lt;/p&gt;</comment>
                            <comment id="13126288" author="streamy" created="Thu, 13 Oct 2011 01:23:44 +0000"  >&lt;p&gt;Punt to 0.92.1 or 0.94.0?&lt;/p&gt;</comment>
                            <comment id="13142484" author="yuzhihong@gmail.com" created="Wed, 2 Nov 2011 20:23:39 +0000"  >&lt;p&gt;This feature can be implemented in 0.94&lt;/p&gt;</comment>
                            <comment id="13182949" author="jmhsieh" created="Tue, 10 Jan 2012 00:18:46 +0000"  >&lt;p&gt;I&apos;ve written some merging code in &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-5128&quot; title=&quot;[uber hbck] Online automated repair of table integrity and region consistency problems&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-5128&quot;&gt;&lt;del&gt;HBASE-5128&lt;/del&gt;&lt;/a&gt; but having some problems with closing regions and regions in transition.  Will likely borrow code from here.&lt;/p&gt;</comment>
                            <comment id="13188386" author="hudson" created="Wed, 18 Jan 2012 10:35:08 +0000"  >&lt;p&gt;Integrated in HBase-TRUNK-security #81 (See &lt;a href=&quot;https://builds.apache.org/job/HBase-TRUNK-security/81/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/HBase-TRUNK-security/81/&lt;/a&gt;)&lt;br/&gt;
    &lt;span class=&quot;error&quot;&gt;&amp;#91;book&amp;#93;&lt;/span&gt; book.xml, ops_mgt.xml  additional clarification that compaction does not do region merging&lt;br/&gt;
also, added link to script in &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-1621&quot; title=&quot;merge tool should work on online cluster&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-1621&quot;&gt;&lt;del&gt;HBASE-1621&lt;/del&gt;&lt;/a&gt; in Ops Mgt chapter.&lt;/p&gt;

&lt;p&gt;dmeil : &lt;br/&gt;
Files : &lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/hbase/trunk/src/docbkx/book.xml&lt;/li&gt;
	&lt;li&gt;/hbase/trunk/src/docbkx/ops_mgt.xml&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="13189010" author="hudson" created="Thu, 19 Jan 2012 08:53:07 +0000"  >&lt;p&gt;Integrated in HBase-TRUNK #2639 (See &lt;a href=&quot;https://builds.apache.org/job/HBase-TRUNK/2639/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/HBase-TRUNK/2639/&lt;/a&gt;)&lt;br/&gt;
    &lt;span class=&quot;error&quot;&gt;&amp;#91;book&amp;#93;&lt;/span&gt; book.xml, ops_mgt.xml  additional clarification that compaction does not do region merging&lt;br/&gt;
also, added link to script in &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-1621&quot; title=&quot;merge tool should work on online cluster&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-1621&quot;&gt;&lt;del&gt;HBASE-1621&lt;/del&gt;&lt;/a&gt; in Ops Mgt chapter.&lt;/p&gt;

&lt;p&gt;dmeil : &lt;br/&gt;
Files : &lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/hbase/trunk/src/docbkx/book.xml&lt;/li&gt;
	&lt;li&gt;/hbase/trunk/src/docbkx/ops_mgt.xml&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="13197670" author="azotcsit" created="Wed, 1 Feb 2012 08:14:42 +0000"  >&lt;p&gt;We use merge_online.rb script. It has a small bug.&lt;/p&gt;

&lt;p&gt;When we start script in dry-run mode (without &quot;-n&quot; option) it creates empty directories in HDFS:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
0           hdfs:&lt;span class=&quot;code-comment&quot;&gt;//&amp;lt;HOSTNAME&amp;gt;/hbase/&amp;lt;TABLE_NAME&amp;gt;/0d5a0784d3ce2450ce1936efe3d0232a
&lt;/span&gt;1975581     hdfs:&lt;span class=&quot;code-comment&quot;&gt;//&amp;lt;HOSTNAME&amp;gt;/hbase/&amp;lt;TABLE_NAME&amp;gt;/2005c8cfd13b48bda6fb7faaacaf8cd4
&lt;/span&gt;0           hdfs:&lt;span class=&quot;code-comment&quot;&gt;//&amp;lt;HOSTNAME&amp;gt;/hbase/&amp;lt;TABLE_NAME&amp;gt;/45b75d9c4cc1bbef6dec0326a8bc42a1
&lt;/span&gt;1941609     hdfs:&lt;span class=&quot;code-comment&quot;&gt;//&amp;lt;HOSTNAME&amp;gt;/hbase/&amp;lt;TABLE_NAME&amp;gt;/66c227828b9404762cea8f7d8890957c
&lt;/span&gt;0           hdfs:&lt;span class=&quot;code-comment&quot;&gt;//&amp;lt;HOSTNAME&amp;gt;/hbase/&amp;lt;TABLE_NAME&amp;gt;/7cc710a1ef01dd5c4805bb8b4ee9f79b
&lt;/span&gt;0           hdfs:&lt;span class=&quot;code-comment&quot;&gt;//&amp;lt;HOSTNAME&amp;gt;/hbase/&amp;lt;TABLE_NAME&amp;gt;/a0f510e86fcc69fbacae68536dd496ae
&lt;/span&gt;1905306     hdfs:&lt;span class=&quot;code-comment&quot;&gt;//&amp;lt;HOSTNAME&amp;gt;/hbase/&amp;lt;TABLE_NAME&amp;gt;/dc9ca1251fd4f1a48392b37c7a7c2fcc
&lt;/span&gt;1971976     hdfs:&lt;span class=&quot;code-comment&quot;&gt;//&amp;lt;HOSTNAME&amp;gt;/hbase/&amp;lt;TABLE_NAME&amp;gt;/f4bfae7e508ca852f54806d954f49029&lt;/span&gt;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;We&apos;ve created the patch:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
--- online_merge.rb	2012-02-01 00:11:25.000000000 -0800
+++ online_merge_fixed.rb	2012-02-01 00:11:14.000000000 -0800
@@ -266,7 +266,7 @@
 
   # For each family, move all the files one by one
   &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; family in tableDesc.getFamiliesKeys
-    HRegion.makeColumnFamilyDirs(fs, tableDir, newHRI, family)
+    HRegion.makeColumnFamilyDirs(fs, tableDir, newHRI, family) &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; normalRun
     newFamilyPath = Store.getStoreHomedir(tableDir, newHRI.getEncodedName, family)
     
     &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; row in toMerge
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="13197942" author="stack" created="Wed, 1 Feb 2012 16:38:21 +0000"  >&lt;p&gt;Would you mind uploading a version of online_merge.rb w/ patch included Alexey to make it easier for others using the script.  Thank you.&lt;/p&gt;</comment>
                            <comment id="13234520" author="lhofhansl" created="Wed, 21 Mar 2012 17:11:28 +0000"  >&lt;p&gt;Moving out of 0.94&lt;/p&gt;</comment>
                            <comment id="13465407" author="stack" created="Fri, 28 Sep 2012 06:22:22 +0000"  >&lt;p&gt;Making critical though we&apos;ll probably end up punting it.&lt;/p&gt;</comment>
                            <comment id="13549207" author="yuzhihong@gmail.com" created="Wed, 9 Jan 2013 23:58:09 +0000"  >&lt;p&gt;Marking this duplicate with &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-7403&quot; title=&quot;Online Merge&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-7403&quot;&gt;&lt;del&gt;HBASE-7403&lt;/del&gt;&lt;/a&gt;.&lt;br/&gt;
This feature is desirable for 0.96 but shouldn&apos;t block 0.96&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                            <outwardlinks description="relates to">
                                        <issuelink>
            <issuekey id="12415413">HBASE-1212</issuekey>
        </issuelink>
            <issuelink>
            <issuekey id="12537273">HBASE-5128</issuekey>
        </issuelink>
            <issuelink>
            <issuekey id="12534488">HBASE-4991</issuekey>
        </issuelink>
            <issuelink>
            <issuekey id="12544858">HBASE-5504</issuekey>
        </issuelink>
                            </outwardlinks>
                                                                <inwardlinks description="is related to">
                                        <issuelink>
            <issuekey id="12624812">HBASE-7403</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12485506" name="1621-trunk.txt" size="19102" author="yuzhihong@gmail.com" created="Thu, 7 Jul 2011 00:02:07 +0000"/>
                            <attachment id="12447405" name="HBASE-1621-v2.patch" size="17878" author="jdcryans" created="Thu, 17 Jun 2010 23:50:08 +0000"/>
                            <attachment id="12447403" name="HBASE-1621.patch" size="17796" author="jdcryans" created="Thu, 17 Jun 2010 23:27:50 +0000"/>
                            <attachment id="12470851" name="hbase-onlinemerge.patch" size="18956" author="anih" created="Fri, 11 Feb 2011 10:58:57 +0000"/>
                            <attachment id="12492374" name="online_merge.rb" size="10692" author="jdcryans" created="Tue, 30 Aug 2011 21:44:31 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>5.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Tue, 7 Jul 2009 16:34:44 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>25869</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            3 years, 47 weeks, 1 day ago
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i02cun:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>11683</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        </customfields>
    </item>
</channel>
</rss>