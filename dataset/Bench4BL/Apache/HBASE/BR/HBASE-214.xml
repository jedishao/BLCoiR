<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Fri Dec 02 20:17:12 UTC 2016

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/HBASE-214/HBASE-214.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[HBASE-214] Compaction errors after a region splits</title>
                <link>https://issues.apache.org/jira/browse/HBASE-214</link>
                <project id="12310753" key="HBASE">HBase</project>
                    <description>&lt;p&gt;I am getting compaction errors from regions after they split not all of them have this problem but some do&lt;/p&gt;

&lt;p&gt;I attached a log I picked out one region webdata,com.technorati/tag/potiron:http,1200430376177&lt;/p&gt;

&lt;p&gt;it is loaded then splits at &lt;br/&gt;
2008-01-15 14:52:56,116&lt;/p&gt;

&lt;p&gt;the split is finshed at&lt;br/&gt;
2008-01-15 14:53:01,653&lt;/p&gt;

&lt;p&gt;the first compaction for the new top half region starts at&lt;br/&gt;
2008-01-15 14:54:07,612 - webdata,com.technorati/tag/potiron:http,1200430376177&lt;/p&gt;

&lt;p&gt;and ends successful at&lt;br/&gt;
2008-01-15 14:54:30,229&lt;/p&gt;

&lt;p&gt;ten the next compaction starts at&lt;br/&gt;
2008-01-15 14:56:16,315&lt;/p&gt;

&lt;p&gt;This one ends with an error at &lt;br/&gt;
2008-01-15 14:56:40,246&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;2008-01-15 14:57:53,002 ERROR org.apache.hadoop.hbase.HRegionServer: Compaction failed &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; region webdata,com.technorati/tag/potiron:http,1200430376177
org.apache.hadoop.dfs.LeaseExpiredException: org.apache.hadoop.dfs.LeaseExpiredException: No lease on /gfs_storage/hadoop-root/hbase/webdata/compaction.dir/1438658724/in_rank/mapfiles/8222904438849251562/data
	at org.apache.hadoop.dfs.FSNamesystem.checkLease(FSNamesystem.java:1123)
	at org.apache.hadoop.dfs.FSNamesystem.getAdditionalBlock(FSNamesystem.java:1061)
	at org.apache.hadoop.dfs.NameNode.addBlock(NameNode.java:303)
	at sun.reflect.GeneratedMethodAccessor12.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)
	at java.lang.reflect.Method.invoke(Method.java:585)
	at org.apache.hadoop.ipc.RPC$Server.call(RPC.java:409)
	at org.apache.hadoop.ipc.Server$Handler.run(Server.java:908)

	at sun.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method)
	at sun.reflect.NativeConstructorAccessorImpl.newInstance(NativeConstructorAccessorImpl.java:39)
	at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:27)
	at java.lang.reflect.Constructor.newInstance(Constructor.java:494)
	at org.apache.hadoop.hbase.RemoteExceptionHandler.decodeRemoteException(RemoteExceptionHandler.java:82)
	at org.apache.hadoop.hbase.RemoteExceptionHandler.checkIOException(RemoteExceptionHandler.java:48)
	at org.apache.hadoop.hbase.HRegionServer$Compactor.run(HRegionServer.java:418)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;and all other compaction&apos;s for this region fail after this one fail with the same error I will have to keep testing to see if it ever finishes successfully. &lt;br/&gt;
maybe after a restart it will successfully finsh a compaction.&lt;/p&gt;
</description>
                <environment>&lt;p&gt;hadoop snv 612165&lt;/p&gt;</environment>
        <key id="12386328">HBASE-214</key>
            <summary>Compaction errors after a region splits</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/bug.png">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.png">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="viper799">Billy Pearson</reporter>
                        <labels>
                    </labels>
                <created>Tue, 15 Jan 2008 23:35:55 +0000</created>
                <updated>Fri, 22 Aug 2008 21:34:55 +0000</updated>
                            <resolved>Thu, 17 Jan 2008 22:35:38 +0000</resolved>
                                                                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                <comments>
                            <comment id="12559285" author="viper799" created="Tue, 15 Jan 2008 23:36:18 +0000"  >&lt;p&gt;attached Log&lt;/p&gt;</comment>
                            <comment id="12559294" author="viper799" created="Wed, 16 Jan 2008 00:02:15 +0000"  >&lt;p&gt;I tryed to kill the region server that the region was on and it fail over to a different server fine but compaction failed on that server too same error as above.&lt;/p&gt;

&lt;p&gt;but when I tryed to stop the whole cluster stop-hbase.sh and stop-all.sh I get this error on the new regionserver for this region&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
2008-01-15 17:47:30,611 WARN org.apache.hadoop.fs.DFSClient: Problem renewing lease &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; DFSClient_647476091: java.net.ConnectException: Connection refused
        at java.net.PlainSocketImpl.socketConnect(Native Method)
        at java.net.PlainSocketImpl.doConnect(PlainSocketImpl.java:333)
        at java.net.PlainSocketImpl.connectToAddress(PlainSocketImpl.java:195)
        at java.net.PlainSocketImpl.connect(PlainSocketImpl.java:182)
        at java.net.SocksSocketImpl.connect(SocksSocketImpl.java:366)
        at java.net.Socket.connect(Socket.java:519)
        at org.apache.hadoop.ipc.Client$Connection.setupIOstreams(Client.java:159)
        at org.apache.hadoop.ipc.Client.getConnection(Client.java:575)
        at org.apache.hadoop.ipc.Client.call(Client.java:498)
        at org.apache.hadoop.ipc.RPC$Invoker.invoke(RPC.java:198)
        at org.apache.hadoop.dfs.$Proxy1.renewLease(Unknown Source)
        at sun.reflect.GeneratedMethodAccessor5.invoke(Unknown Source)
        at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)
        at java.lang.reflect.Method.invoke(Method.java:585)
        at org.apache.hadoop.io.retry.RetryInvocationHandler.invokeMethod(RetryInvocationHandler.java:82)
        at org.apache.hadoop.io.retry.RetryInvocationHandler.invoke(RetryInvocationHandler.java:59)
        at org.apache.hadoop.dfs.$Proxy1.renewLease(Unknown Source)
        at org.apache.hadoop.dfs.DFSClient$LeaseChecker.run(DFSClient.java:586)
        at java.lang.&lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;.run(&lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;.java:595)

&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;I have to kill the region server my self with kill pid&lt;br/&gt;
then on restart of the cluster I get this meta error reprted many times over and over on the region server serveing .META.&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
2008-01-15 17:55:09,315 INFO org.apache.hadoop.ipc.Server: IPC Server handler 0 on 60020, call openScanner(.META.,,1, [Lorg.apache.hadoop.io.Text;@167e3a5, , 1200441309302, &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;) from 10.0.0.1:49221: error: java.io.IOException: HStoreScanner failed construction
java.io.IOException: HStoreScanner failed construction
        at org.apache.hadoop.hbase.HStore$StoreFileScanner.&amp;lt;init&amp;gt;(HStore.java:2139)
        at org.apache.hadoop.hbase.HStore$HStoreScanner.&amp;lt;init&amp;gt;(HStore.java:2260)
        at org.apache.hadoop.hbase.HStore.getScanner(HStore.java:2050)
        at org.apache.hadoop.hbase.HRegion$HScanner.&amp;lt;init&amp;gt;(HRegion.java:1593)
        at org.apache.hadoop.hbase.HRegion.getScanner(HRegion.java:1167)
        at org.apache.hadoop.hbase.HRegionServer.openScanner(HRegionServer.java:1517)
        at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
        at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)
        at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)
        at java.lang.reflect.Method.invoke(Method.java:585)
        at org.apache.hadoop.hbase.ipc.HbaseRPC$Server.call(HbaseRPC.java:413)
        at org.apache.hadoop.ipc.Server$Handler.run(Server.java:908)
Caused by: org.apache.hadoop.ipc.RemoteException: java.io.IOException: File does not exist: /gfs_storage/hadoop-root/hbase/.META./1028785192/info/mapfiles/5207253989210860351/data
        at org.apache.hadoop.dfs.FSDirectory.getFileInfo(FSDirectory.java:543)
        at org.apache.hadoop.dfs.FSNamesystem.getFileInfo(FSNamesystem.java:1464)
        at org.apache.hadoop.dfs.NameNode.getFileInfo(NameNode.java:439)
        at sun.reflect.GeneratedMethodAccessor5.invoke(Unknown Source)
        at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)
        at java.lang.reflect.Method.invoke(Method.java:585)
        at org.apache.hadoop.ipc.RPC$Server.call(RPC.java:409)
        at org.apache.hadoop.ipc.Server$Handler.run(Server.java:908)

        at org.apache.hadoop.ipc.Client.call(Client.java:509)
        at org.apache.hadoop.ipc.RPC$Invoker.invoke(RPC.java:198)
        at org.apache.hadoop.dfs.$Proxy1.getFileInfo(Unknown Source)
        at sun.reflect.GeneratedMethodAccessor4.invoke(Unknown Source)
        at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)
        at java.lang.reflect.Method.invoke(Method.java:585)
        at org.apache.hadoop.io.retry.RetryInvocationHandler.invokeMethod(RetryInvocationHandler.java:82)
        at org.apache.hadoop.io.retry.RetryInvocationHandler.invoke(RetryInvocationHandler.java:59)
        at org.apache.hadoop.dfs.$Proxy1.getFileInfo(Unknown Source)
        at org.apache.hadoop.dfs.DFSClient.getFileInfo(DFSClient.java:442)
        at org.apache.hadoop.dfs.DistributedFileSystem.getFileStatus(DistributedFileSystem.java:331)
        at org.apache.hadoop.fs.FileSystem.getLength(FileSystem.java:536)
        at org.apache.hadoop.io.SequenceFile$Reader.&amp;lt;init&amp;gt;(SequenceFile.java:1349)
        at org.apache.hadoop.io.SequenceFile$Reader.&amp;lt;init&amp;gt;(SequenceFile.java:1344)
        at org.apache.hadoop.io.MapFile$Reader.&amp;lt;init&amp;gt;(MapFile.java:254)
        at org.apache.hadoop.io.MapFile$Reader.&amp;lt;init&amp;gt;(MapFile.java:242)
        at org.apache.hadoop.hbase.HStoreFile$HbaseMapFile$HbaseReader.&amp;lt;init&amp;gt;(HStoreFile.java:595)
        at org.apache.hadoop.hbase.HStoreFile$BloomFilterMapFile$Reader.&amp;lt;init&amp;gt;(HStoreFile.java:650)
        at org.apache.hadoop.hbase.HStoreFile.getReader(HStoreFile.java:424)
        at org.apache.hadoop.hbase.HStore$StoreFileScanner.&amp;lt;init&amp;gt;(HStore.java:2114)
        ... 11 more

&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="12559804" author="stack" created="Thu, 17 Jan 2008 04:34:21 +0000"  >&lt;p&gt;After refactoring of hbase layout on fs, &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-339&quot; title=&quot;[hbase] restructure how HBase lays out files in the file system&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-339&quot;&gt;&lt;del&gt;HADOOP-2478&lt;/del&gt;&lt;/a&gt;, clean up of old compactions was actually deleting all under compaction.dir; would mean that the remove would kill any other concurrent ongoing compactions.  Patch cleans up the region (Problem was found by Billy Pearson studying logs)&lt;/p&gt;</comment>
                            <comment id="12559806" author="stack" created="Thu, 17 Jan 2008 04:59:34 +0000"  >&lt;p&gt;Passes tests locally and Billy, the reporter, claims it fixes the reported issue.&lt;/p&gt;</comment>
                            <comment id="12560110" author="hadoopqa" created="Thu, 17 Jan 2008 22:19:31 +0000"  >&lt;p&gt;+1 overall.  Here are the results of testing the latest attachment &lt;br/&gt;
&lt;a href=&quot;http://issues.apache.org/jira/secure/attachment/12373348/compactiondir-v4.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/secure/attachment/12373348/compactiondir-v4.patch&lt;/a&gt;&lt;br/&gt;
against trunk revision r612974.&lt;/p&gt;

&lt;p&gt;    @author +1.  The patch does not contain any @author tags.&lt;/p&gt;

&lt;p&gt;    javadoc +1.  The javadoc tool did not generate any warning messages.&lt;/p&gt;

&lt;p&gt;    javac +1.  The applied patch does not generate any new compiler warnings.&lt;/p&gt;

&lt;p&gt;    findbugs +1.  The patch does not introduce any new Findbugs warnings.&lt;/p&gt;

&lt;p&gt;    core tests +1.  The patch passed core unit tests.&lt;/p&gt;

&lt;p&gt;    contrib tests +1.  The patch passed contrib unit tests.&lt;/p&gt;

&lt;p&gt;Test results: &lt;a href=&quot;http://lucene.zones.apache.org:8080/hudson/job/Hadoop-Patch/1627/testReport/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://lucene.zones.apache.org:8080/hudson/job/Hadoop-Patch/1627/testReport/&lt;/a&gt;&lt;br/&gt;
Findbugs warnings: &lt;a href=&quot;http://lucene.zones.apache.org:8080/hudson/job/Hadoop-Patch/1627/artifact/trunk/build/test/findbugs/newPatchFindbugsWarnings.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://lucene.zones.apache.org:8080/hudson/job/Hadoop-Patch/1627/artifact/trunk/build/test/findbugs/newPatchFindbugsWarnings.html&lt;/a&gt;&lt;br/&gt;
Checkstyle results: &lt;a href=&quot;http://lucene.zones.apache.org:8080/hudson/job/Hadoop-Patch/1627/artifact/trunk/build/test/checkstyle-errors.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://lucene.zones.apache.org:8080/hudson/job/Hadoop-Patch/1627/artifact/trunk/build/test/checkstyle-errors.html&lt;/a&gt;&lt;br/&gt;
Console output: &lt;a href=&quot;http://lucene.zones.apache.org:8080/hudson/job/Hadoop-Patch/1627/console&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://lucene.zones.apache.org:8080/hudson/job/Hadoop-Patch/1627/console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="12560125" author="stack" created="Thu, 17 Jan 2008 22:35:38 +0000"  >&lt;p&gt;Committed.  Thanks for figuring out what the issue was Billy.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12373348" name="compactiondir-v4.patch" size="4928" author="stack" created="Thu, 17 Jan 2008 04:34:20 +0000"/>
                            <attachment id="12373212" name="hbase-root-regionserver-PE1750-4.log" size="147631" author="viper799" created="Tue, 15 Jan 2008 23:36:18 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Thu, 17 Jan 2008 04:34:21 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>24998</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            8 years, 47 weeks ago
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0h5hj:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>98151</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        </customfields>
    </item>
</channel>
</rss>