<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Sat Dec 03 17:03:01 UTC 2016

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/HBASE-7465/HBASE-7465.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[HBASE-7465] CleanerChore shouldn&apos;t leak IOException for failed delete of non-empty directory</title>
                <link>https://issues.apache.org/jira/browse/HBASE-7465</link>
                <project id="12310753" key="HBASE">HBase</project>
                    <description>&lt;p&gt;CleanerChore has the following lines:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
    &lt;span class=&quot;code-comment&quot;&gt;// &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; all the children have been deleted, then we should &lt;span class=&quot;code-keyword&quot;&gt;try&lt;/span&gt; to delete &lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt; directory. However,
&lt;/span&gt;    &lt;span class=&quot;code-comment&quot;&gt;// don&apos;t &lt;span class=&quot;code-keyword&quot;&gt;do&lt;/span&gt; so recursively so we don&apos;t delete files that have been added since we checked.
&lt;/span&gt;    &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; canDeleteThis ? fs.delete(toCheck, &lt;span class=&quot;code-keyword&quot;&gt;false&lt;/span&gt;) : &lt;span class=&quot;code-keyword&quot;&gt;false&lt;/span&gt;;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;has a race condition where the directory can have a file added underneath of it between being determined &apos;ok to delete&apos; and not. As the comment mentions, we don&apos;t do a recursive delete to avoid deleting those files. However, the non-recursive delete of the directory throws an IOException.&lt;/p&gt;

&lt;p&gt;This is from &lt;a href=&quot;http://search-hadoop.com/m/MUMTb13obDf2/CleanerChore+exception/v=plain&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://search-hadoop.com/m/MUMTb13obDf2/CleanerChore+exception/v=plain&lt;/a&gt;&lt;/p&gt;</description>
                <environment></environment>
        <key id="12625538">HBASE-7465</key>
            <summary>CleanerChore shouldn&apos;t leak IOException for failed delete of non-empty directory</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/bug.png">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.png">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="3">Duplicate</resolution>
                                        <assignee username="jesse_yates">Jesse Yates</assignee>
                                    <reporter username="jesse_yates">Jesse Yates</reporter>
                        <labels>
                    </labels>
                <created>Mon, 31 Dec 2012 00:12:11 +0000</created>
                <updated>Wed, 2 Jan 2013 23:54:07 +0000</updated>
                            <resolved>Wed, 2 Jan 2013 00:14:44 +0000</resolved>
                                    <version>0.94.4</version>
                    <version>0.95.2</version>
                                                    <component>master</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>4</watches>
                                                                <comments>
                            <comment id="13541206" author="lhofhansl" created="Mon, 31 Dec 2012 01:09:58 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-7467&quot; title=&quot;CleanerChore checkAndDeleteDirectory not deleting empty directories&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-7467&quot;&gt;&lt;del&gt;HBASE-7467&lt;/del&gt;&lt;/a&gt; seems to describe a slightly different scenario.&lt;/p&gt;</comment>
                            <comment id="13541207" author="jesse_yates" created="Mon, 31 Dec 2012 01:12:53 +0000"  >&lt;p&gt;It is indeed, but I don&apos;t think its actually an issue...contining comments there.&lt;/p&gt;</comment>
                            <comment id="13541217" author="jesse_yates" created="Mon, 31 Dec 2012 01:32:33 +0000"  >&lt;p&gt;Attaching patch. Makes CleanerChore#checkAndDeleteDirectory default scoped and adds a test to make sure we don&apos;t throw an exception even when we have the &apos;racey&apos; file condition.&lt;/p&gt;

&lt;p&gt;Added test and existing TestCleanerChore tests pass locally.&lt;/p&gt;</comment>
                            <comment id="13541232" author="jmspaggi" created="Mon, 31 Dec 2012 02:56:48 +0000"  >&lt;p&gt;UTIL.cleanupTestDir(); is not compiling for me &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/sad.gif&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt; Is it for trunk only? I tried to apply on 0.94.4RC0.&lt;/p&gt;</comment>
                            <comment id="13541236" author="jmspaggi" created="Mon, 31 Dec 2012 03:15:32 +0000"  >&lt;p&gt;Ok. I replaced UTIL.cleanupTestDir() by what was there before and everything is working A1 for me. All tests from TestCleanerChore passed.&lt;/p&gt;

&lt;p&gt;So if the UTIL &quot;issue&quot; I have is because I&apos;m not running on trunk, then I will say +1 for me.&lt;/p&gt;</comment>
                            <comment id="13541238" author="lhofhansl" created="Mon, 31 Dec 2012 03:21:36 +0000"  >&lt;p&gt;Looks good to me +1.&lt;br/&gt;
Wanna make the log message debug?&lt;/p&gt;</comment>
                            <comment id="13541949" author="jesse_yates" created="Wed, 2 Jan 2013 00:14:44 +0000"  >&lt;p&gt;This work got picked up in &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-7467&quot; title=&quot;CleanerChore checkAndDeleteDirectory not deleting empty directories&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-7467&quot;&gt;&lt;del&gt;HBASE-7467&lt;/del&gt;&lt;/a&gt;, so just duping it and moving on.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12562744" name="hbase-7465-v0.patch" size="5815" author="jesse_yates" created="Mon, 31 Dec 2012 01:32:33 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Mon, 31 Dec 2012 01:09:58 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>302082</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            3 years, 48 weeks, 3 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i16yhr:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>248723</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        </customfields>
    </item>
</channel>
</rss>