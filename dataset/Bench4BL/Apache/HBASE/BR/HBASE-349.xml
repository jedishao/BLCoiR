<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Fri Dec 02 20:19:37 UTC 2016

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/HBASE-349/HBASE-349.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[HBASE-349] Open HRegionServer/HClient for extension</title>
                <link>https://issues.apache.org/jira/browse/HBASE-349</link>
                <project id="12310753" key="HBASE">HBase</project>
                    <description>&lt;p&gt;For what i&apos;m doing I found it necessary to extend HRegionServer/HRegion/HClient for some custom functionality.&lt;/p&gt;

&lt;p&gt;Following good Java practice I see that the HBase code as been programmed defensively, keeping stuff private as much as possible.&lt;/p&gt;

&lt;p&gt;However, for extensibility it would be nice if the servers/client were easy to extend.&lt;/p&gt;

&lt;p&gt;Attached is a patch that makes several methods protected instead of private, adds getters to fields of inner classes, and some other modifications i found were useful for some simple extension code.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12372067">HBASE-349</key>
            <summary>Open HRegionServer/HClient for extension</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/bug.png">Bug</type>
                                            <priority id="4" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.png">Minor</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="james.kennedy">James Kennedy</reporter>
                        <labels>
                    </labels>
                <created>Wed, 20 Jun 2007 18:45:03 +0000</created>
                <updated>Mon, 4 Feb 2008 18:41:49 +0000</updated>
                            <resolved>Mon, 25 Jun 2007 22:55:57 +0000</resolved>
                                                                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                <comments>
                            <comment id="12506636" author="hadoopqa" created="Wed, 20 Jun 2007 18:59:56 +0000"  >&lt;p&gt;-1, could not apply patch.&lt;/p&gt;

&lt;p&gt;The patch command could not apply the latest attachment &lt;a href=&quot;http://issues.apache.org/jira/secure/attachment/12360222/openForExtension.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/secure/attachment/12360222/openForExtension.patch&lt;/a&gt; as a patch to trunk revision r548794.&lt;/p&gt;

&lt;p&gt;Console output: &lt;a href=&quot;http://lucene.zones.apache.org:8080/hudson/job/Hadoop-Patch/313/console&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://lucene.zones.apache.org:8080/hudson/job/Hadoop-Patch/313/console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Please note that this message is automatically generated and may represent a problem with the automation system and not the patch.&lt;/p&gt;</comment>
                            <comment id="12506647" author="james.kennedy" created="Wed, 20 Jun 2007 19:47:32 +0000"  >&lt;p&gt;Oops, submitted patch prematurely.&lt;/p&gt;</comment>
                            <comment id="12506664" author="james.kennedy" created="Wed, 20 Jun 2007 20:45:57 +0000"  >&lt;p&gt;Followed procedure better this time. New patch includes relative paths and update to CHANGES.txt&lt;/p&gt;</comment>
                            <comment id="12506720" author="stack" created="Wed, 20 Jun 2007 23:37:46 +0000"  >&lt;p&gt;James:&lt;/p&gt;

&lt;p&gt;+ Why make HClient.getConf public rather than protected? (You refer to &apos;server&apos; when you mean &apos;client&apos; in the javadoc)&lt;br/&gt;
+ Regards HClient.getOpenServers, is it wise letting out the servers data structure?  Access probably needs to be synchronized.  Would wrapping the servers map returned by getOpenServers with an Arrays.unmodifiableMap be obnoxious?  (Probably)  Better might be adding (synchronized) &apos;servers&apos; manipulating methods to the base HClient class?&lt;br/&gt;
+ Does HRegion need to be public?  It would be better if HRegions were only manipulated by HRegionServers since instantation of a HRegion will change the on-hdfs state, a problem if two instances of HRegion are pointed at same region  (But maybe your subclass of HRegionServer cannot use HRegion unless its public?)  Same for its internal scanner.&lt;/p&gt;

&lt;p&gt;Otherwise patch looks good.  It applied cleanly and passed all tests.&lt;/p&gt;</comment>
                            <comment id="12506924" author="james.kennedy" created="Thu, 21 Jun 2007 14:45:28 +0000"  >&lt;p&gt;+HClient.getConf doesn&apos;t have to be public though I see no harm in it.  Supposedly the client user already has a handle to the conf object anyway though,  i&apos;ll make it protected.&lt;/p&gt;

&lt;p&gt;+perhaps exposing HClient.getOpenServers was overzealous.  The only place where I use it in my extension is in where I override HClient.getHRegionConnection().  The only reason this override is necessary is because to make RPC work with added methods in my HRegionServer extension (call it QRegionServer), i need to inject the QRegionServerInterface.  &lt;/p&gt;

&lt;p&gt;e.g.&lt;br/&gt;
server = (QRegionInterface) RPC.waitForProxy(&lt;br/&gt;
					QRegionInterface.class, QRegionInterface.versionID,&lt;br/&gt;
					regionServer.getInetSocketAddress(), getConf());&lt;/p&gt;

&lt;p&gt;Incidentally that is also the only place where I use the, now protected, getConf() method.&lt;/p&gt;

&lt;p&gt;If there was a configuration parameter that specified an HRegionServer extending interface, and the base impl of HClient.getHRegionConnection() used that to initialize the server proxy, then all that would become unnecessary.  What do you think of that idea? I guess a similar pattern should exist for injecting specific HClient impls into HMaster too.&lt;/p&gt;

&lt;p&gt;+About public HRegion and its scanner... I&apos;m not sure how to make it accessible only to HRegionServer subclasses without making it an inner class. I have a particular need for it where my QRegionServer perfroms scans on its own HRegions... put perhaps there isn&apos;t a general need for that and I could remove that from this patch. Or maybe HRegion manipulation is a likely need for HRegionServer extensions... what do you think?&lt;/p&gt;


</comment>
                            <comment id="12507061" author="stack" created="Thu, 21 Jun 2007 22:47:12 +0000"  >&lt;p&gt;&quot;...perhaps exposing HClient.getOpenServers was overzealous....If there was a configuration parameter that specified an HRegionServer extending interface, and the base impl of HClient.getHRegionConnection() used that to initialize the server proxy, then all that would become unnecessary. What do you think of that idea?&quot;&lt;/p&gt;

&lt;p&gt;Sounds like a good idea.&lt;/p&gt;

&lt;p&gt;&quot;I guess a similar pattern should exist for injecting specific HClient impls into HMaster too.&quot;&lt;/p&gt;

&lt;p&gt;Unfortunately there is no HClientInterface currently as there is a HRegionInterface (or HMasterInterface) so it would be a bit of work and HClient is still evolving so keeping up interfaces and their implementation will be a bit of a pain &amp;#8211; but its still a good idea.&lt;/p&gt;

&lt;p&gt;&quot;... I&apos;m not sure how to make it accessible only to HRegionServer subclasses without making it an inner class. I have a particular need for it where my QRegionServer perfroms scans on its own HRegions... put perhaps there isn&apos;t a general need for that and I could remove that from this patch. Or maybe HRegion manipulation is a likely need for HRegionServer extensions... what do you think?&quot;&lt;/p&gt;

&lt;p&gt;A region server that can&apos;t manipulate regions is like a herder without his sheep.  Lets just make HRegion public (Any future table-repair tool would need to have public access to HRegions.)&lt;/p&gt;</comment>
                            <comment id="12507439" author="james.kennedy" created="Fri, 22 Jun 2007 16:12:30 +0000"  >&lt;p&gt;Ok. Attached patch v3.&lt;/p&gt;

&lt;p&gt;HClient.getHRegionConnection() no longer needs to be extended since it is aware of the configuration property &quot;hbase.regionserver.class&quot; which is set in hbase-default.xml to HRegionInterface class name.  &lt;/p&gt;

&lt;p&gt;I nixed getOpenServers().&lt;/p&gt;</comment>
                            <comment id="12507522" author="stack" created="Fri, 22 Jun 2007 21:47:09 +0000"  >&lt;p&gt;I like the way you convert comments to javadoc when method goes from private to protected and thanks for adding the missing version check when going to a new region server.  &lt;/p&gt;

&lt;p&gt;One question.  Why make RegionLocation and HRegionInfo mutable?  And HRegion.localput probably shouldn&apos;t be public?&lt;/p&gt;

&lt;p&gt;The patch didn&apos;t apply cleanly for me.  HClient has changed since your add of v3 to this issue.&lt;/p&gt;</comment>
                            <comment id="12507887" author="james.kennedy" created="Mon, 25 Jun 2007 14:41:16 +0000"  >&lt;p&gt;Sorry about that.  Mutabability not required, I used eclipse to generate getters and setters when I should have specified just getters.&lt;/p&gt;

&lt;p&gt;New patch created after full update as of this morning. Removed those setters. HRegion.localput() now package visible only again. &lt;/p&gt;</comment>
                            <comment id="12507930" author="stack" created="Mon, 25 Jun 2007 17:17:41 +0000"  >&lt;p&gt;+1&lt;/p&gt;

&lt;p&gt;Patch looks good to me and it built and passed all tests locally.  I&apos;d suggest this issue is ripe for moving its state to &apos;patch available&apos; so it gets picked up by hudson.&lt;/p&gt;</comment>
                            <comment id="12507931" author="james.kennedy" created="Mon, 25 Jun 2007 17:22:36 +0000"  >&lt;p&gt;Cool, thanks. &lt;/p&gt;

&lt;p&gt;So what&apos;s the process for that step? I figure I just do &apos;Submit Patch&apos;...&lt;/p&gt;</comment>
                            <comment id="12507940" author="hadoopqa" created="Mon, 25 Jun 2007 18:03:57 +0000"  >&lt;p&gt;-1, new javadoc warnings&lt;/p&gt;

&lt;p&gt;The javadoc tool appears to have generated warning messages when testing the latest attachment &lt;a href=&quot;http://issues.apache.org/jira/secure/attachment/12360489/openForExtension-v4.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/secure/attachment/12360489/openForExtension-v4.patch&lt;/a&gt; against trunk revision r549977.&lt;/p&gt;

&lt;p&gt;Test results:   &lt;a href=&quot;http://lucene.zones.apache.org:8080/hudson/job/Hadoop-Patch/325/testReport/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://lucene.zones.apache.org:8080/hudson/job/Hadoop-Patch/325/testReport/&lt;/a&gt;&lt;br/&gt;
Console output: &lt;a href=&quot;http://lucene.zones.apache.org:8080/hudson/job/Hadoop-Patch/325/console&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://lucene.zones.apache.org:8080/hudson/job/Hadoop-Patch/325/console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Please note that this message is automatically generated and may represent a problem with the automation system and not the patch.&lt;/p&gt;</comment>
                            <comment id="12507941" author="stack" created="Mon, 25 Jun 2007 18:05:27 +0000"  >&lt;p&gt;Yep (See &apos;Contributing your work&apos; at end of this page &lt;a href=&quot;http://wiki.apache.org/lucene-hadoop/HowToContribute&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://wiki.apache.org/lucene-hadoop/HowToContribute&lt;/a&gt;).&lt;/p&gt;</comment>
                            <comment id="12507997" author="james.kennedy" created="Mon, 25 Jun 2007 21:13:29 +0000"  >&lt;p&gt;Fixed some javadoc errors that were pre-existing but i guess only became visible when i made HRegion public.&lt;/p&gt;
</comment>
                            <comment id="12508004" author="hadoopqa" created="Mon, 25 Jun 2007 21:50:55 +0000"  >&lt;p&gt;+1&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;http://issues.apache.org/jira/secure/attachment/12360520/openForExtension-v5.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/secure/attachment/12360520/openForExtension-v5.patch&lt;/a&gt; applied and successfully tested against trunk revision r549977.&lt;/p&gt;

&lt;p&gt;Test results:   &lt;a href=&quot;http://lucene.zones.apache.org:8080/hudson/job/Hadoop-Patch/328/testReport/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://lucene.zones.apache.org:8080/hudson/job/Hadoop-Patch/328/testReport/&lt;/a&gt;&lt;br/&gt;
Console output: &lt;a href=&quot;http://lucene.zones.apache.org:8080/hudson/job/Hadoop-Patch/328/console&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://lucene.zones.apache.org:8080/hudson/job/Hadoop-Patch/328/console&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="12508012" author="jimk" created="Mon, 25 Jun 2007 22:55:57 +0000"  >&lt;p&gt;I just committed this. Thanks James!&lt;/p&gt;</comment>
                            <comment id="12508149" author="hudson" created="Tue, 26 Jun 2007 11:28:15 +0000"  >&lt;p&gt;Integrated in Hadoop-Nightly #136 (See &lt;a href=&quot;http://lucene.zones.apache.org:8080/hudson/job/Hadoop-Nightly/136/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://lucene.zones.apache.org:8080/hudson/job/Hadoop-Nightly/136/&lt;/a&gt;)&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12360226" name="openForExtension-v2.patch" size="14013" author="james.kennedy" created="Wed, 20 Jun 2007 20:45:57 +0000"/>
                            <attachment id="12360374" name="openForExtension-v3.patch" size="19103" author="james.kennedy" created="Fri, 22 Jun 2007 16:12:30 +0000"/>
                            <attachment id="12360489" name="openForExtension-v4.patch" size="17855" author="james.kennedy" created="Mon, 25 Jun 2007 14:41:16 +0000"/>
                            <attachment id="12360520" name="openForExtension-v5.patch" size="18245" author="james.kennedy" created="Mon, 25 Jun 2007 21:13:28 +0000"/>
                            <attachment id="12360222" name="openForExtension.patch" size="13927" author="james.kennedy" created="Wed, 20 Jun 2007 18:48:08 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>5.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Wed, 20 Jun 2007 18:59:56 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>25133</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            9 years, 24 weeks, 3 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0h6rr:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>98359</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        </customfields>
    </item>
</channel>
</rss>