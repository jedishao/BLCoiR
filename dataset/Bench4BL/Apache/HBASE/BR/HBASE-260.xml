<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Fri Dec 02 19:57:50 UTC 2016

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/HBASE-260/HBASE-260.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[HBASE-260] [hbase] On region split, master should designate which host should serve daughter splits</title>
                <link>https://issues.apache.org/jira/browse/HBASE-260</link>
                <project id="12310753" key="HBASE">HBase</project>
                    <description>&lt;p&gt;On region split, the daughter regions are deployed on the same host as served the split parent.  This makes it so currently (unless the cluster is restarted), as a table grows, all its regions remain on the one server.&lt;/p&gt;

&lt;p&gt;Instead, jurisdiction over who serves daughter splits should be passed to the master.  If possible, before making a determination, the master should take into consideration current cluster loadings and region distribution.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12375318">HBASE-260</key>
            <summary>[hbase] On region split, master should designate which host should serve daughter splits</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/bug.png">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.png">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="stack">stack</reporter>
                        <labels>
                    </labels>
                <created>Fri, 3 Aug 2007 18:07:16 +0000</created>
                <updated>Mon, 4 Feb 2008 18:41:22 +0000</updated>
                            <resolved>Tue, 14 Aug 2007 03:39:14 +0000</resolved>
                                                                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                <comments>
                            <comment id="12517665" author="jimk" created="Fri, 3 Aug 2007 23:53:02 +0000"  >&lt;p&gt;The region server that performed the split should serve the lower half of the split region.&lt;/p&gt;

&lt;p&gt;It should update the meta with information about the two new regions and change the region info for the old parent region to indicate it is being shared by the two children.&lt;/p&gt;

&lt;p&gt;When it reports the split to the master, the master will assign the upper half region  to the most lightly loaded server.&lt;/p&gt;

&lt;p&gt;In order to determine load, HServerInfo should be augmented to include the number of regions being served by the region server with other statistics such as Runtime.freeMemory(),  Runtime.totalMemory(), Runtime.maxMemory(), Runtime.availableProcessors().request rate, etc. These statistics can be used to determine a region servers &quot;load factor&quot;. (actually the load factor is probably what needs to go into the HServerInfo object - the region server can compute its load factor before sending its regular heartbeat message)&lt;/p&gt;

&lt;p&gt;Should the master miss the split message, it will assign the upper child region during the next meta scan (since the region server updated the meta before reporting the split to the master).&lt;/p&gt;

&lt;p&gt;The master will need to track the load factor of each server so that it can assign new regions to the server with the smallest load factor.&lt;/p&gt;

&lt;p&gt;Periodically, the master should run a thread that attempts to re-balance the load on the cluster. Without detailed statistics such as the request rate per region, however it would be hard for the master to make a determination of which regions should be moved to a different server in order to most effectively balance the load. For example a server could be serving 1000 regions which are receiving little traffic and still be assigned another region without greatly effecting its performance. Another server could be serving two heavy traffic regions yet be so heavily loaded that it should be relieved of one of the regions to more effectively balance load.&lt;/p&gt;

&lt;p&gt;In the near term, computing a load factor from percentage of free memory and request rate is probably the best metric for determining which server should be assigned a new region. As we gain more experience with HBase performance we can include some of the other factors mentioned above.&lt;/p&gt;</comment>
                            <comment id="12518905" author="jimk" created="Fri, 10 Aug 2007 05:29:13 +0000"  >&lt;p&gt;Phase 1: When new regions come on-line or when regions are reassigned from a server that has failed, the master will balance the load across the active region servers.&lt;/p&gt;</comment>
                            <comment id="12518906" author="jimk" created="Fri, 10 Aug 2007 05:33:12 +0000"  >&lt;p&gt;Works in my environment. See if Hudson agrees.&lt;/p&gt;</comment>
                            <comment id="12518907" author="jimk" created="Fri, 10 Aug 2007 05:35:37 +0000"  >&lt;p&gt;While server reassignment worked for server failure when n=1 and one new server replaced the failed server, testing for this patch revealed a bug when there were multiple region servers. This patch also addresses this bug.&lt;/p&gt;</comment>
                            <comment id="12519137" author="jimk" created="Fri, 10 Aug 2007 22:07:34 +0000"  >&lt;p&gt;Phase 1: Master balances load when new regions come on line or if a region server fails.&lt;br/&gt;
Tests run successfully on Fedora core 6 and windows.&lt;/p&gt;</comment>
                            <comment id="12519139" author="jimk" created="Fri, 10 Aug 2007 22:11:34 +0000"  >&lt;p&gt;I just committed phase 1.&lt;/p&gt;</comment>
                            <comment id="12519576" author="jimk" created="Tue, 14 Aug 2007 03:39:14 +0000"  >&lt;p&gt;Tested changes on Fedora core 6 and Windows XP Pro (single and dual processor).&lt;br/&gt;
Committed changes.&lt;/p&gt;

&lt;p&gt;Summary of changes:&lt;/p&gt;

&lt;p&gt;Use new hbase.util.Writables: HBaseAdmin, HConnectionManager, HMaster,&lt;br/&gt;
HMerge, HRegion, HRegiondirReader, HRegionInfo, HRegionServer,&lt;br/&gt;
TestGet, TestScanner, TestScanner2, TestSplit&lt;/p&gt;

&lt;p&gt;HConnectionManager&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;don&apos;t throw IllegalStateException is region is offline and split&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;HConstants&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;added new meta column family members for recording split references&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;HLog, HStoreFile&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;use new FileSystem.listPaths instead of deprecated one&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;HRegion, HMaster:&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;move static functions from HRegion that were only used by the master&lt;br/&gt;
  (and required an ipc as opposed to just manipulating files) to HMaster&lt;/li&gt;
	&lt;li&gt;Master now assigns children of split region instead of HRegionServer&lt;br/&gt;
  serving them automatically.&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;HMaster&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;use BatchUpdate for some communications with region server (more to do)&lt;/li&gt;
	&lt;li&gt;hasReferences uses HRegionInterface instead of HTable&lt;/li&gt;
	&lt;li&gt;changed some SortedMaps to Maps backed by HashMap since access to&lt;br/&gt;
  them was never in sort order.&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;HRegionServer&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;SplitOrCompactChecker keeps HTables for root and meta once&lt;br/&gt;
  instantiated on demand.&lt;/li&gt;
	&lt;li&gt;use batch updates to update meta/root regions&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;HStoreKey&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;new static method returns byte array built from string of&lt;br/&gt;
  concatenation of row and column keys&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;HTable&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;ClientScanner.close() now catches NotServingRegionException&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;Leases&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;Remove some debug level log messages - they were just noise&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;Keying, Writables&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;move some byte to X and X to byte methods from Keying to Writables&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;Unit tests:&lt;/p&gt;

&lt;p&gt;TestScanner2, HRegion: move static functions only used by TestScanner2&lt;br/&gt;
from HRegion to TestScanner2&lt;/p&gt;

&lt;p&gt;TestSplit&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;now uses MiniHBaseCluster to start up cluster on top of&lt;br/&gt;
  MiniDFSCluster instead of starting up a MiniHBaseCluster on top of&lt;br/&gt;
  local file system&lt;/li&gt;
&lt;/ul&gt;

</comment>
                    </comments>
                    <attachments>
                            <attachment id="12363553" name="patch.txt" size="162819" author="jimk" created="Fri, 10 Aug 2007 05:33:10 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Fri, 3 Aug 2007 23:53:02 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>25044</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            9 years, 17 weeks, 3 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0h5zr:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>98233</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        </customfields>
    </item>
</channel>
</rss>