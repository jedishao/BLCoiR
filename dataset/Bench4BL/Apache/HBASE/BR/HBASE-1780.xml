<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Fri Dec 02 20:07:15 UTC 2016

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/HBASE-1780/HBASE-1780.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[HBASE-1780] HTable.flushCommits clears write buffer in finally clause</title>
                <link>https://issues.apache.org/jira/browse/HBASE-1780</link>
                <project id="12310753" key="HBASE">HBase</project>
                    <description>&lt;p&gt;Metthod flushCommits clears the write buffer in a finally clause.&lt;/p&gt;

&lt;p&gt;When using the write buffer, if the call to processBatchOfRows done in flushCommits throws an exception, the write buffer will be cleared thus potentially leading to loss of data on the client side.&lt;/p&gt;</description>
                <environment>&lt;p&gt;All&lt;/p&gt;</environment>
        <key id="12433569">HBASE-1780</key>
            <summary>HTable.flushCommits clears write buffer in finally clause</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/bug.png">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.png">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="apurtell">Andrew Purtell</assignee>
                                    <reporter username="herberts">Mathias Herberts</reporter>
                        <labels>
                    </labels>
                <created>Thu, 20 Aug 2009 13:29:10 +0000</created>
                <updated>Sun, 13 Sep 2009 22:24:55 +0000</updated>
                            <resolved>Thu, 27 Aug 2009 19:41:04 +0000</resolved>
                                                    <fixVersion>0.20.0</fixVersion>
                    <fixVersion>0.90.0</fixVersion>
                                    <component>Client</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                <comments>
                            <comment id="12748313" author="apurtell" created="Thu, 27 Aug 2009 09:30:15 +0000"  >&lt;p&gt;Testing patch now. &lt;/p&gt;</comment>
                            <comment id="12748318" author="herberts" created="Thu, 27 Aug 2009 09:52:39 +0000"  >&lt;p&gt;I think we should specify somewhere that HTable instances are not safe to use in MT environments for writes.&lt;/p&gt;

&lt;p&gt;The manipulation of writebuffer could could lead to ConcurrentModificationException being raised if Puts are added to it while the new write buffer size is computed in flushCommits.&lt;/p&gt;</comment>
                            <comment id="12748334" author="apurtell" created="Thu, 27 Aug 2009 11:12:49 +0000"  >&lt;p&gt;Good point Mathias. Latest patch also synchronizes writeBuffer.&lt;/p&gt;</comment>
                            <comment id="12748404" author="stack" created="Thu, 27 Aug 2009 15:27:14 +0000"  >&lt;p&gt;Do the put methods need to be synchronized now since internally its synchronizing on the write buffer?  (Make currentWriteBufferSize transient so outside of the synch block its most recent value can be seen?) &lt;/p&gt;

&lt;p&gt;Minor: Make the below final and do assigning at same time as declaration?&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
  &lt;span class=&quot;code-keyword&quot;&gt;private&lt;/span&gt; ArrayList&amp;lt;Put&amp;gt; writeBuffer;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Otherwise patch looks great.  Patch is important fix.  &lt;/p&gt;

&lt;p&gt;Now you&apos;ve done the work, add a comment to HTable class javadoc to explicitly say its thread-safe?&lt;/p&gt;

&lt;p&gt;(There are a bunch of unused imports in my HTable.  Are they in yours?  Remove as part of this patch?  They look bad, especially in this most public of our classes).&lt;/p&gt;


</comment>
                            <comment id="12748432" author="apurtell" created="Thu, 27 Aug 2009 16:36:34 +0000"  >&lt;p&gt;@stack:&lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;There are a bunch of unused imports in my HTable. Are they in yours? Remove as part of this patch?&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;If you&apos;re looking at Eclipse warnings, those are due to deprecated includes necessary for old client API, not unused imports.&lt;/p&gt;

&lt;p&gt;I&apos;ll fold your suggestions into the commit. Thanks for the review.&lt;/p&gt;
</comment>
                            <comment id="12748435" author="stack" created="Thu, 27 Aug 2009 16:39:22 +0000"  >&lt;p&gt;Bringing into 0.20.0&lt;/p&gt;

&lt;p&gt;@Andrew You are right.  I&apos;m looking at them on different computer.  Usually deprecated differs in that its strikethrough.  Not so in this case.&lt;/p&gt;</comment>
                            <comment id="12748442" author="stack" created="Thu, 27 Aug 2009 16:53:41 +0000"  >&lt;p&gt;Ryan makes the valid point offline that HTable should NOT be shared by threads.  If its all synchronized on the write, then no performance gain sharing the HTable instance.   That&apos;d mean, remove all synchronization, flag HTable as not thread-safe and just add the bit where writes are not lost on exception.&lt;/p&gt;</comment>
                            <comment id="12748534" author="apurtell" created="Thu, 27 Aug 2009 19:41:04 +0000"  >&lt;p&gt;Committed to branch and trunk with synchronization bits removed and a comment that HTable is not MT safe for writes.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12417870" name="HBASE-1780.patch" size="3938" author="apurtell" created="Thu, 27 Aug 2009 11:12:49 +0000"/>
                            <attachment id="12417866" name="HBASE-1780.patch" size="2592" author="apurtell" created="Thu, 27 Aug 2009 09:32:35 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Thu, 27 Aug 2009 09:30:15 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>25974</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310191" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                        <customfieldname>Hadoop Flags</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10343"><![CDATA[Reviewed]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            7 years, 15 weeks, 1 day ago
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0hf7j:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>99726</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        </customfields>
    </item>
</channel>
</rss>