<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Sat Dec 03 16:40:09 UTC 2016

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/HBASE-5675/HBASE-5675.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[HBASE-5675] Create table fails if we keep refreshing master&apos;s UI for task monitor status</title>
                <link>https://issues.apache.org/jira/browse/HBASE-5675</link>
                <project id="12310753" key="HBASE">HBase</project>
                    <description>&lt;p&gt;I tried to create a table with 2K pre-split regions, region assignment was in middle and i was keep refreshing master&apos;s web UI to find the status of the task using task monitor, table creation was failed and &lt;tt&gt;META&lt;/tt&gt; was showing 2K regions with server location value is &lt;tt&gt;null&lt;/tt&gt; and regions weren&apos;t deployed onto region-servers.&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
table_ACreating table table_A
java.io.IOException: java.io.IOException: java.util.ConcurrentModificationException
	at sun.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method)
	at sun.reflect.NativeConstructorAccessorImpl.newInstance(NativeConstructorAccessorImpl.java:39)
	at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:27)
	at java.lang.reflect.Constructor.newInstance(Constructor.java:513)
	at org.apache.hadoop.ipc.RemoteException.instantiateException(RemoteException.java:95)
	at org.apache.hadoop.ipc.RemoteException.unwrapRemoteException(RemoteException.java:79)
	at org.apache.hadoop.hbase.client.HBaseAdmin.createTableAsync(HBaseAdmin.java:384)
	at org.apache.hadoop.hbase.client.HBaseAdmin.createTable(HBaseAdmin.java:294)
	at com.test.tools.hbase.schema.createIfNotExists(schema.java:520)
	at com.test.tools.hbase.schema.main(schema.java:627)
Caused by: org.apache.hadoop.ipc.RemoteException: java.io.IOException: java.util.ConcurrentModificationException
	at java.util.SubList.checkForComodification(AbstractList.java:752)
	at java.util.SubList.add(AbstractList.java:632)
	at java.util.SubList.add(AbstractList.java:633)
	at java.util.SubList.add(AbstractList.java:633)
	..
	..
	at java.util.SubList.add(AbstractList.java:633)
	at java.util.AbstractList.add(AbstractList.java:91)
	at org.apache.hadoop.hbase.monitoring.TaskMonitor.createStatus(TaskMonitor.java:76)
	at org.apache.hadoop.hbase.regionserver.HRegion.close(HRegion.java:510)
	at org.apache.hadoop.hbase.regionserver.HRegion.close(HRegion.java:490)
	at org.apache.hadoop.hbase.master.HMaster.createTable(HMaster.java:853)
	at org.apache.hadoop.hbase.master.HMaster.createTable(HMaster.java:813)
	at org.apache.hadoop.hbase.master.HMaster.createTable(HMaster.java:780)
	at sun.reflect.GeneratedMethodAccessor27.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)
	at java.lang.reflect.Method.invoke(Method.java:597)
	at org.apache.hadoop.hbase.ipc.HBaseRPC$Server.call(HBaseRPC.java:570)
	at org.apache.hadoop.hbase.ipc.HBaseServer$Handler.run(HBaseServer.java:1039)
	at org.apache.hadoop.hbase.ipc.HBaseClient.call(HBaseClient.java:771)
	at org.apache.hadoop.hbase.ipc.HBaseRPC$Invoker.invoke(HBaseRPC.java:257)
	at $Proxy5.createTable(Unknown Source)
	at org.apache.hadoop.hbase.client.HBaseAdmin.createTableAsync(HBaseAdmin.java:382)	
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</description>
                <environment></environment>
        <key id="12548712">HBASE-5675</key>
            <summary>Create table fails if we keep refreshing master&apos;s UI for task monitor status</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/bug.png">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.png">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="3">Duplicate</resolution>
                                        <assignee username="mubarakseyed">Mubarak Seyed</assignee>
                                    <reporter username="mubarakseyed">Mubarak Seyed</reporter>
                        <labels>
                    </labels>
                <created>Thu, 29 Mar 2012 18:05:00 +0000</created>
                <updated>Tue, 5 Aug 2014 20:11:37 +0000</updated>
                            <resolved>Thu, 29 Mar 2012 22:22:34 +0000</resolved>
                                    <version>0.90.4</version>
                    <version>0.92.0</version>
                                                    <component>master</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>1</watches>
                                                                <comments>
                            <comment id="13241471" author="mubarakseyed" created="Thu, 29 Mar 2012 18:17:36 +0000"  >&lt;p&gt;I could create a table using workarounds&lt;/p&gt;
&lt;ol&gt;
	&lt;li&gt;Increase the RPC timeout value to 10 minutes&lt;/li&gt;
	&lt;li&gt;Create one table at a time&lt;/li&gt;
	&lt;li&gt;No refresh of master&apos;s web UI&lt;/li&gt;
&lt;/ol&gt;
</comment>
                            <comment id="13241477" author="lhofhansl" created="Thu, 29 Mar 2012 18:21:47 +0000"  >&lt;p&gt;TaskMonitor does not seem exist in 0.90.x.&lt;br/&gt;
In 0.92.x it is properly synchronized - although the synchronization was changed in 0.94+ (unnecessarily IMHO).&lt;/p&gt;</comment>
                            <comment id="13241513" author="mubarakseyed" created="Thu, 29 Mar 2012 19:00:32 +0000"  >&lt;p&gt;@Lars&lt;br/&gt;
CDH3u2 backports distributed log splitting to 0.90.x branch and task monitor stuff as well. I have verified the code&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
&lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; List&amp;lt;StoreFile&amp;gt; close(&lt;span class=&quot;code-keyword&quot;&gt;final&lt;/span&gt; &lt;span class=&quot;code-object&quot;&gt;boolean&lt;/span&gt; abort) &lt;span class=&quot;code-keyword&quot;&gt;throws&lt;/span&gt; IOException {
    &lt;span class=&quot;code-comment&quot;&gt;// Only allow one thread to close at a time. Serialize them so dual
&lt;/span&gt;    &lt;span class=&quot;code-comment&quot;&gt;// threads attempting to close will run up against each other.
&lt;/span&gt;    MonitoredTask status = TaskMonitor.get().createStatus(
        &lt;span class=&quot;code-quote&quot;&gt;&quot;Closing region &quot;&lt;/span&gt; + &lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt; +
        (abort ? &lt;span class=&quot;code-quote&quot;&gt;&quot; due to abort&quot;&lt;/span&gt; : &quot;&quot;));

    status.setStatus(&lt;span class=&quot;code-quote&quot;&gt;&quot;Waiting &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; close lock&quot;&lt;/span&gt;);
    &lt;span class=&quot;code-keyword&quot;&gt;try&lt;/span&gt; {
      &lt;span class=&quot;code-keyword&quot;&gt;synchronized&lt;/span&gt; (closeLock) {
        &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; doClose(abort, status);
      }
    } &lt;span class=&quot;code-keyword&quot;&gt;finally&lt;/span&gt; {
      status.cleanup();
    }
  }
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;It is affected in 0.92 and above i believe. Thanks.&lt;/p&gt;</comment>
                            <comment id="13241518" author="stack" created="Thu, 29 Mar 2012 19:02:57 +0000"  >&lt;p&gt;This is still an issue then?&lt;/p&gt;</comment>
                            <comment id="13241531" author="apurtell" created="Thu, 29 Mar 2012 19:19:35 +0000"  >&lt;p&gt;We saw this CME in our internal distro but solved it by bringing forward TaskMonitor to the latest in 0.92.&lt;/p&gt;</comment>
                            <comment id="13241866" author="jmhsieh" created="Thu, 29 Mar 2012 22:19:10 +0000"  >&lt;p&gt;The fix was in &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-5535&quot; title=&quot;Make the functions in task monitor synchronized&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-5535&quot;&gt;&lt;del&gt;HBASE-5535&lt;/del&gt;&lt;/a&gt; and in the 0.94 branch and above.  I&apos;ll mark this issue as duplicate, and get it added into the issues to fix in CDH. &lt;/p&gt;</comment>
                            <comment id="13241877" author="mubarakseyed" created="Thu, 29 Mar 2012 22:29:25 +0000"  >&lt;p&gt;Thanks Jon.&lt;/p&gt;</comment>
                            <comment id="13241938" author="jmhsieh" created="Thu, 29 Mar 2012 23:51:45 +0000"  >&lt;p&gt;I took a closer look and &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-5535&quot; title=&quot;Make the functions in task monitor synchronized&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-5535&quot;&gt;&lt;del&gt;HBASE-5535&lt;/del&gt;&lt;/a&gt; doesn&apos;t seem to really add any new synchronization help on the tasks list.  Another related patch is a part of &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-4057&quot; title=&quot;Implement HBase version of &amp;quot;show processlist&amp;quot;&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-4057&quot;&gt;&lt;del&gt;HBASE-4057&lt;/del&gt;&lt;/a&gt;; investigating further.&lt;/p&gt;</comment>
                            <comment id="13241955" author="jmhsieh" created="Fri, 30 Mar 2012 00:19:31 +0000"  >&lt;p&gt;Mubarak, found it &amp;#8211; the fix is actually &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-4386&quot; title=&quot;NPE in TaskMonitor&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-4386&quot;&gt;&lt;del&gt;HBASE-4386&lt;/del&gt;&lt;/a&gt;, fixed in 0.92/0.94/trunk (and CDH3u3).&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Thu, 29 Mar 2012 18:21:47 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>233809</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            4 years, 36 weeks, 1 day ago
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0690n:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>34392</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        </customfields>
    </item>
</channel>
</rss>