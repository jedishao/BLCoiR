<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Thu Dec 01 21:48:05 UTC 2016

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/HBASE-14897/HBASE-14897.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[HBASE-14897] TestTableLockManager.testReapAllTableLocks is flakey</title>
                <link>https://issues.apache.org/jira/browse/HBASE-14897</link>
                <project id="12310753" key="HBASE">HBase</project>
                    <description>&lt;p&gt;It comes from email list which &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=stack&quot; class=&quot;user-hover&quot; rel=&quot;stack&quot;&gt;stack&lt;/a&gt; post.&lt;/p&gt;

&lt;p&gt;This is the some relates QA information.&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://builds.apache.org/view/H-L/view/HBase/job/HBase-Trunk_matrix/512/jdk=latest1.8,label=Hadoop/testReport/org.apache.hadoop.hbase.master/TestTableLockManager/testReapAllTableLocks/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/view/H-L/view/HBase/job/HBase-Trunk_matrix/512/jdk=latest1.8,label=Hadoop/testReport/org.apache.hadoop.hbase.master/TestTableLockManager/testReapAllTableLocks/&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;The reason is here.&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
    writeLocksObtained.await();
    writeLocksAttempted.await();
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;writeLocksAttempted maybe count down to 0 before created node on ZK,  and main thread will go on to run lockManager.reapWriteLocks(),  And after that node was created on ZK,  so relates lock acquire will timeout.&lt;/p&gt;

&lt;p&gt;I upload a patch which can reproduce this issue.&lt;/p&gt;

</description>
                <environment></environment>
        <key id="12916989">HBASE-14897</key>
            <summary>TestTableLockManager.testReapAllTableLocks is flakey</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/bug.png">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.png">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="chenheng">Heng Chen</assignee>
                                    <reporter username="chenheng">Heng Chen</reporter>
                        <labels>
                    </labels>
                <created>Mon, 30 Nov 2015 15:36:33 +0000</created>
                <updated>Wed, 9 Dec 2015 06:39:11 +0000</updated>
                            <resolved>Wed, 9 Dec 2015 06:32:35 +0000</resolved>
                                                    <fixVersion>2.0.0</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>5</watches>
                                                                <comments>
                            <comment id="15031972" author="chenheng" created="Mon, 30 Nov 2015 15:41:57 +0000"  >&lt;p&gt;upload the real patch&lt;/p&gt;</comment>
                            <comment id="15032069" author="stack" created="Mon, 30 Nov 2015 16:55:41 +0000"  >&lt;p&gt;Thats excellent &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=chenheng&quot; class=&quot;user-hover&quot; rel=&quot;chenheng&quot;&gt;Heng Chen&lt;/a&gt; Lets see how it does. +1 on trying the patch.&lt;/p&gt;</comment>
                            <comment id="15032166" author="enis" created="Mon, 30 Nov 2015 17:58:49 +0000"  >&lt;p&gt;LGTM. &lt;/p&gt;</comment>
                            <comment id="15032390" author="hadoopqa" created="Mon, 30 Nov 2015 20:20:31 +0000"  >&lt;p&gt;&lt;font color=&quot;red&quot;&gt;-1 overall&lt;/font&gt;.  Here are the results of testing the latest attachment &lt;br/&gt;
  &lt;a href=&quot;http://issues.apache.org/jira/secure/attachment/12774835/HBASE-14897.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/secure/attachment/12774835/HBASE-14897.patch&lt;/a&gt;&lt;br/&gt;
  against master branch at commit 999ae691559a49321138eb7718eb204435639db9.&lt;br/&gt;
  ATTACHMENT ID: 12774835&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 @author&lt;/font&gt;.  The patch does not contain any @author tags.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 tests included&lt;/font&gt;.  The patch appears to include 4 new or modified tests.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 hadoop versions&lt;/font&gt;. The patch compiles with all supported hadoop versions (2.4.0 2.4.1 2.5.0 2.5.1 2.5.2 2.6.0 2.6.1 2.7.0 2.7.1)&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 javac&lt;/font&gt;.  The applied patch does not increase the total number of javac compiler warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 protoc&lt;/font&gt;.  The applied patch does not increase the total number of protoc compiler warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;red&quot;&gt;-1 javadoc&lt;/font&gt;.  The javadoc tool appears to have generated 2 warning messages.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 checkstyle&lt;/font&gt;. The applied patch does not generate new checkstyle errors.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 findbugs&lt;/font&gt;.  The patch does not introduce any  new Findbugs (version 2.0.3) warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 release audit&lt;/font&gt;.  The applied patch does not increase the total number of release audit warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 lineLengths&lt;/font&gt;.  The patch does not introduce lines longer than 100&lt;/p&gt;

&lt;p&gt;  &lt;font color=&quot;green&quot;&gt;+1 site&lt;/font&gt;.  The mvn post-site goal succeeds with this patch.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 core tests&lt;/font&gt;.  The patch passed unit tests in .&lt;/p&gt;

&lt;p&gt;Test results: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/16700//testReport/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/16700//testReport/&lt;/a&gt;&lt;br/&gt;
Release Findbugs (version 2.0.3) 	warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/16700//artifact/patchprocess/newFindbugsWarnings.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/16700//artifact/patchprocess/newFindbugsWarnings.html&lt;/a&gt;&lt;br/&gt;
Checkstyle Errors: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/16700//artifact/patchprocess/checkstyle-aggregate.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/16700//artifact/patchprocess/checkstyle-aggregate.html&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;  Javadoc warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/16700//artifact/patchprocess/patchJavadocWarnings.txt&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/16700//artifact/patchprocess/patchJavadocWarnings.txt&lt;/a&gt;&lt;br/&gt;
Console output: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/16700//console&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/16700//console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="15032963" author="chenheng" created="Tue, 1 Dec 2015 02:32:37 +0000"  >&lt;p&gt;push to master.  Thanks &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=stack&quot; class=&quot;user-hover&quot; rel=&quot;stack&quot;&gt;stack&lt;/a&gt; and &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=enis&quot; class=&quot;user-hover&quot; rel=&quot;enis&quot;&gt;Enis Soztutar&lt;/a&gt; for your help to review. &lt;br/&gt;
If this issue not happen in the next week, i will resolve it.&lt;/p&gt;</comment>
                            <comment id="15033313" author="hudson" created="Tue, 1 Dec 2015 08:13:34 +0000"  >&lt;p&gt;SUCCESS: Integrated in HBase-Trunk_matrix #517 (See &lt;a href=&quot;https://builds.apache.org/job/HBase-Trunk_matrix/517/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/HBase-Trunk_matrix/517/&lt;/a&gt;)&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-14897&quot; title=&quot;TestTableLockManager.testReapAllTableLocks is flakey&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-14897&quot;&gt;&lt;del&gt;HBASE-14897&lt;/del&gt;&lt;/a&gt; TestTableLockManager.testReapAllTableLocks is flakey (chenheng: rev 47082579a85fae1b3f7156963609819369b353d8)&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;hbase-server/src/test/java/org/apache/hadoop/hbase/master/TestTableLockManager.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="15048138" author="chenheng" created="Wed, 9 Dec 2015 06:31:34 +0000"  >&lt;p&gt;&lt;a href=&quot;https://builds.apache.org/view/H-L/view/HBase/job/HBase-Trunk_matrix/540/jdk=latest1.8,label=Hadoop/testReport/org.apache.hadoop.hbase.master/TestTableLockManager/testReapAllTableLocks/history/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/view/H-L/view/HBase/job/HBase-Trunk_matrix/540/jdk=latest1.8,label=Hadoop/testReport/org.apache.hadoop.hbase.master/TestTableLockManager/testReapAllTableLocks/history/&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;It seems good now.&lt;/p&gt;</comment>
                            <comment id="15048147" author="stack" created="Wed, 9 Dec 2015 06:39:11 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=chenheng&quot; class=&quot;user-hover&quot; rel=&quot;chenheng&quot;&gt;Heng Chen&lt;/a&gt; Hurray!&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12774835" name="HBASE-14897.patch" size="3207" author="chenheng" created="Mon, 30 Nov 2015 15:41:57 +0000"/>
                            <attachment id="12774834" name="reproduce.patch" size="3775" author="chenheng" created="Mon, 30 Nov 2015 15:37:42 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Mon, 30 Nov 2015 16:55:41 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            51 weeks, 1 day ago
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i2p2kv:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        </customfields>
    </item>
</channel>
</rss>