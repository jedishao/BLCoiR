<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Fri Dec 02 19:15:19 UTC 2016

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/HBASE-1256/HBASE-1256.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[HBASE-1256] NPE in StoreFileScanner durring cache flush</title>
                <link>https://issues.apache.org/jira/browse/HBASE-1256</link>
                <project id="12310753" key="HBASE">HBase</project>
                    <description>&lt;p&gt;About an hour into a bulk upload I&apos;m consistently getting:&lt;/p&gt;

&lt;p&gt;org.apache.hadoop.hbase.DroppedSnapshotException: region: net_troove_coin_transaction_Transaction,,1236293201543&lt;br/&gt;
	at org.apache.hadoop.hbase.regionserver.HRegion.internalFlushcache(HRegion.java:902)&lt;br/&gt;
	at org.apache.hadoop.hbase.regionserver.HRegion.flushcache(HRegion.java:795)&lt;br/&gt;
	at org.apache.hadoop.hbase.regionserver.MemcacheFlusher.flushRegion(MemcacheFlusher.java:228)&lt;br/&gt;
	at org.apache.hadoop.hbase.regionserver.MemcacheFlusher.run(MemcacheFlusher.java:138)&lt;br/&gt;
Caused by: java.lang.NullPointerException&lt;br/&gt;
	at org.apache.hadoop.hbase.regionserver.StoreFileScanner.findFirstRow(StoreFileScanner.java:314)&lt;br/&gt;
	at org.apache.hadoop.hbase.regionserver.StoreFileScanner.advance(StoreFileScanner.java:141)&lt;br/&gt;
	at org.apache.hadoop.hbase.regionserver.StoreFileScanner.openReaders(StoreFileScanner.java:109)&lt;br/&gt;
	at org.apache.hadoop.hbase.regionserver.StoreFileScanner.updateReaders(StoreFileScanner.java:413)&lt;br/&gt;
	at org.apache.hadoop.hbase.regionserver.HStoreScanner.updateReaders(HStoreScanner.java:346)&lt;br/&gt;
	at org.apache.hadoop.hbase.regionserver.HStore.notifyChangedReadersObservers(HStore.java:746)&lt;br/&gt;
	at org.apache.hadoop.hbase.regionserver.HStore.updateReaders(HStore.java:731)&lt;br/&gt;
	at org.apache.hadoop.hbase.regionserver.HStore.internalFlushCache(HStore.java:700)&lt;br/&gt;
	at org.apache.hadoop.hbase.regionserver.HStore.flushCache(HStore.java:636)&lt;br/&gt;
	at org.apache.hadoop.hbase.regionserver.HRegion.internalFlushcache(HRegion.java:887)&lt;/p&gt;</description>
                <environment>&lt;p&gt;latest branch of 0.19 with some unrelated transactional fixes.&lt;/p&gt;

&lt;p&gt;Master, regionserver, and client all in the same JVM&lt;/p&gt;</environment>
        <key id="12416650">HBASE-1256</key>
            <summary>NPE in StoreFileScanner durring cache flush</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/bug.png">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.png">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="clint.morgan">Clint Morgan</reporter>
                        <labels>
                    </labels>
                <created>Wed, 11 Mar 2009 16:02:20 +0000</created>
                <updated>Sun, 13 Sep 2009 22:32:20 +0000</updated>
                            <resolved>Thu, 12 Mar 2009 00:00:35 +0000</resolved>
                                    <version>0.19.0</version>
                                    <fixVersion>0.19.1</fixVersion>
                                    <component>regionserver</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                <comments>
                            <comment id="12680908" author="stack" created="Wed, 11 Mar 2009 16:18:15 +0000"  >&lt;p&gt;When did you update last Clint?   Did you have hbase-1219 and hbase-1220 fixes in your install?&lt;/p&gt;</comment>
                            <comment id="12680909" author="clint.morgan" created="Wed, 11 Mar 2009 16:24:57 +0000"  >&lt;p&gt;I updated yesterday so had 1219 and 12220.&lt;/p&gt;</comment>
                            <comment id="12680930" author="stack" created="Wed, 11 Mar 2009 17:09:30 +0000"  >&lt;p&gt;Pulling into 0.19.1&lt;/p&gt;

&lt;p&gt;I think I see the issue.  It looks like it was introduced by 1219/1220.  Here is the fix I think:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
Index: src/java/org/apache/hadoop/hbase/regionserver/StoreFileScanner.java
===================================================================
--- src/java/org/apache/hadoop/hbase/regionserver/StoreFileScanner.java (revision 752526)
+++ src/java/org/apache/hadoop/hbase/regionserver/StoreFileScanner.java (working copy)
@@ -93,7 +93,7 @@
       } &lt;span class=&quot;code-keyword&quot;&gt;else&lt;/span&gt; {
         &lt;span class=&quot;code-comment&quot;&gt;// Only add in non-&lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt; Readers
&lt;/span&gt;         &lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt; nonulls = 0;
-        &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; (&lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt; i = 1; i &amp;lt; &lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt;.readers.length; i++) {
+        &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; (&lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt; i = 0; i &amp;lt; &lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt;.readers.length; i++) {
           &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (&lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt;.readers[i] != &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;) nonulls++;
         }
         MapFile.Reader [] newReaders = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; MapFile.Reader[nonulls + 1];
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Let me run some tests.&lt;/p&gt;</comment>
                            <comment id="12680966" author="clint.morgan" created="Wed, 11 Mar 2009 18:26:10 +0000"  >&lt;p&gt;A look at that block makes me think that it should also be:&lt;br/&gt;
&amp;lt;code&amp;gt;&lt;br/&gt;
Index: src/java/org/apache/hadoop/hbase/regionserver/StoreFileScanner.java&lt;br/&gt;
===================================================================&lt;br/&gt;
&amp;#8212; src/java/org/apache/hadoop/hbase/regionserver/StoreFileScanner.java	(revision 752549)&lt;br/&gt;
+++ src/java/org/apache/hadoop/hbase/regionserver/StoreFileScanner.java	(working copy)&lt;br/&gt;
@@ -98,7 +98,7 @@&lt;br/&gt;
         }&lt;br/&gt;
         MapFile.Reader [] newReaders = new MapFile.Reader&lt;span class=&quot;error&quot;&gt;&amp;#91;nonulls + 1&amp;#93;&lt;/span&gt;;&lt;br/&gt;
         newReaders&lt;span class=&quot;error&quot;&gt;&amp;#91;0&amp;#93;&lt;/span&gt; = hsf.getReader(store.fs, false, false);&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;int j = 0;&lt;br/&gt;
+        int j = 1;&lt;br/&gt;
         for (int i = 1; i &amp;lt; this.readers.length + 1; i++) {&lt;br/&gt;
           MapFile.Reader r = this.readers&lt;span class=&quot;error&quot;&gt;&amp;#91;i - 1&amp;#93;&lt;/span&gt;;&lt;br/&gt;
           if (r != null) {&lt;br/&gt;
&amp;lt;/code&amp;gt;&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="12681040" author="clint.morgan" created="Wed, 11 Mar 2009 21:34:18 +0000"  >&lt;p&gt;My int j =1 fix above seems to have done it. Stacks fix above that is already in the branch..&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Wed, 11 Mar 2009 16:18:15 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>25649</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            7 years, 39 weeks, 1 day ago
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0hc8f:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>99244</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        </customfields>
    </item>
</channel>
</rss>