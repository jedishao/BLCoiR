<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Fri Dec 02 19:51:25 UTC 2016

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/HBASE-210/HBASE-210.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[HBASE-210] TestHBaseCluster fails with IllegalMonitorStateException</title>
                <link>https://issues.apache.org/jira/browse/HBASE-210</link>
                <project id="12310753" key="HBASE">HBase</project>
                    <description>&lt;p&gt;TestHBaseCluster fails because of the following exceptions:&lt;/p&gt;

&lt;p&gt;    &lt;span class=&quot;error&quot;&gt;&amp;#91;junit&amp;#93;&lt;/span&gt; 07/05/08 16:31:58 INFO ipc.Server: IPC Server handler 3 on 42335, call next(3659548438240671209, -&lt;del&gt;META&lt;/del&gt;-__1//1178667102672) from 127.0.0.1:42391: error: java.io.IOException: java.lang.IllegalMonitorStateException&lt;br/&gt;
    &lt;span class=&quot;error&quot;&gt;&amp;#91;junit&amp;#93;&lt;/span&gt; java.io.IOException: java.lang.IllegalMonitorStateException&lt;br/&gt;
    &lt;span class=&quot;error&quot;&gt;&amp;#91;junit&amp;#93;&lt;/span&gt;     at java.util.concurrent.locks.ReentrantReadWriteLock$Sync.tryReleaseShared(ReentrantReadWriteLock.java:363)&lt;br/&gt;
    &lt;span class=&quot;error&quot;&gt;&amp;#91;junit&amp;#93;&lt;/span&gt;     at java.util.concurrent.locks.AbstractQueuedSynchronizer.releaseShared(AbstractQueuedSynchronizer.java:1218)&lt;br/&gt;
    &lt;span class=&quot;error&quot;&gt;&amp;#91;junit&amp;#93;&lt;/span&gt;     at java.util.concurrent.locks.ReentrantReadWriteLock$ReadLock.unlock(ReentrantReadWriteLock.java:745)&lt;br/&gt;
    &lt;span class=&quot;error&quot;&gt;&amp;#91;junit&amp;#93;&lt;/span&gt;     at org.apache.hadoop.hbase.HStore$HStoreScanner.close(HStore.java:1059)&lt;br/&gt;
    &lt;span class=&quot;error&quot;&gt;&amp;#91;junit&amp;#93;&lt;/span&gt;     at org.apache.hadoop.hbase.HRegion$HScanner.closeScanner(HRegion.java:1302)&lt;br/&gt;
    &lt;span class=&quot;error&quot;&gt;&amp;#91;junit&amp;#93;&lt;/span&gt;     at org.apache.hadoop.hbase.HRegion$HScanner.next(HRegion.java:1279)&lt;br/&gt;
    &lt;span class=&quot;error&quot;&gt;&amp;#91;junit&amp;#93;&lt;/span&gt;     at org.apache.hadoop.hbase.HRegionServer.next(HRegionServer.java:1076)&lt;br/&gt;
    &lt;span class=&quot;error&quot;&gt;&amp;#91;junit&amp;#93;&lt;/span&gt;     at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)&lt;br/&gt;
    &lt;span class=&quot;error&quot;&gt;&amp;#91;junit&amp;#93;&lt;/span&gt;     at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)&lt;br/&gt;
    &lt;span class=&quot;error&quot;&gt;&amp;#91;junit&amp;#93;&lt;/span&gt;     at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)&lt;br/&gt;
    &lt;span class=&quot;error&quot;&gt;&amp;#91;junit&amp;#93;&lt;/span&gt;     at java.lang.reflect.Method.invoke(Method.java:597)&lt;br/&gt;
    &lt;span class=&quot;error&quot;&gt;&amp;#91;junit&amp;#93;&lt;/span&gt;     at org.apache.hadoop.ipc.RPC$Server.call(RPC.java:341)&lt;br/&gt;
    &lt;span class=&quot;error&quot;&gt;&amp;#91;junit&amp;#93;&lt;/span&gt;     at org.apache.hadoop.ipc.Server$Handler.run(Server.java:573)&lt;br/&gt;
    &lt;span class=&quot;error&quot;&gt;&amp;#91;junit&amp;#93;&lt;/span&gt; org.apache.hadoop.ipc.RemoteException: java.io.IOException: java.lang.IllegalMonitorStateException&lt;br/&gt;
    &lt;span class=&quot;error&quot;&gt;&amp;#91;junit&amp;#93;&lt;/span&gt;     at java.util.concurrent.locks.ReentrantReadWriteLock$Sync.tryReleaseShared(ReentrantReadWriteLock.java:363)&lt;br/&gt;
    &lt;span class=&quot;error&quot;&gt;&amp;#91;junit&amp;#93;&lt;/span&gt;     at java.util.concurrent.locks.AbstractQueuedSynchronizer.releaseShared(AbstractQueuedSynchronizer.java:1218)&lt;br/&gt;
    &lt;span class=&quot;error&quot;&gt;&amp;#91;junit&amp;#93;&lt;/span&gt;     at java.util.concurrent.locks.ReentrantReadWriteLock$ReadLock.unlock(ReentrantReadWriteLock.java:745)&lt;br/&gt;
    &lt;span class=&quot;error&quot;&gt;&amp;#91;junit&amp;#93;&lt;/span&gt;     at org.apache.hadoop.hbase.HStore$HStoreScanner.close(HStore.java:1059)&lt;br/&gt;
    &lt;span class=&quot;error&quot;&gt;&amp;#91;junit&amp;#93;&lt;/span&gt;     at org.apache.hadoop.hbase.HRegion$HScanner.closeScanner(HRegion.java:1302)&lt;br/&gt;
    &lt;span class=&quot;error&quot;&gt;&amp;#91;junit&amp;#93;&lt;/span&gt;     at org.apache.hadoop.hbase.HRegion$HScanner.next(HRegion.java:1279)&lt;br/&gt;
    &lt;span class=&quot;error&quot;&gt;&amp;#91;junit&amp;#93;&lt;/span&gt;     at org.apache.hadoop.hbase.HRegionServer.next(HRegionServer.java:1076)&lt;br/&gt;
    &lt;span class=&quot;error&quot;&gt;&amp;#91;junit&amp;#93;&lt;/span&gt;     at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)&lt;br/&gt;
    &lt;span class=&quot;error&quot;&gt;&amp;#91;junit&amp;#93;&lt;/span&gt;     at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)&lt;br/&gt;
    &lt;span class=&quot;error&quot;&gt;&amp;#91;junit&amp;#93;&lt;/span&gt;     at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)&lt;br/&gt;
    &lt;span class=&quot;error&quot;&gt;&amp;#91;junit&amp;#93;&lt;/span&gt;     at java.lang.reflect.Method.invoke(Method.java:597)&lt;br/&gt;
    &lt;span class=&quot;error&quot;&gt;&amp;#91;junit&amp;#93;&lt;/span&gt;     at org.apache.hadoop.ipc.RPC$Server.call(RPC.java:341)&lt;br/&gt;
    &lt;span class=&quot;error&quot;&gt;&amp;#91;junit&amp;#93;&lt;/span&gt;     at org.apache.hadoop.ipc.Server$Handler.run(Server.java:573)&lt;/p&gt;

&lt;p&gt;    &lt;span class=&quot;error&quot;&gt;&amp;#91;junit&amp;#93;&lt;/span&gt;     at org.apache.hadoop.ipc.Client.call(Client.java:471)&lt;br/&gt;
    &lt;span class=&quot;error&quot;&gt;&amp;#91;junit&amp;#93;&lt;/span&gt;     at org.apache.hadoop.ipc.RPC$Invoker.invoke(RPC.java:165)&lt;br/&gt;
    &lt;span class=&quot;error&quot;&gt;&amp;#91;junit&amp;#93;&lt;/span&gt;     at $Proxy8.next(Unknown Source)&lt;br/&gt;
    &lt;span class=&quot;error&quot;&gt;&amp;#91;junit&amp;#93;&lt;/span&gt;     at org.apache.hadoop.hbase.HMaster$BaseScanner.scanRegion(HMaster.java:154)&lt;br/&gt;
    &lt;span class=&quot;error&quot;&gt;&amp;#91;junit&amp;#93;&lt;/span&gt;     at org.apache.hadoop.hbase.HMaster$RootScanner.run(HMaster.java:267)&lt;br/&gt;
    &lt;span class=&quot;error&quot;&gt;&amp;#91;junit&amp;#93;&lt;/span&gt;     at java.lang.Thread.run(Thread.java:619)&lt;br/&gt;
    &lt;span class=&quot;error&quot;&gt;&amp;#91;junit&amp;#93;&lt;/span&gt; 07/05/08 16:32:13 INFO ipc.Server: IPC Server handler 7 on 42333, call createTable(name: test, maxVersions: 3, families: &lt;span class=&quot;error&quot;&gt;&amp;#91;anchor:, contents:&amp;#93;&lt;/span&gt;) from 127.0.0.1:42400: error: java.io.IOException: java.lang.IllegalStateException: Master not running&lt;br/&gt;
    &lt;span class=&quot;error&quot;&gt;&amp;#91;junit&amp;#93;&lt;/span&gt; java.io.IOException: java.lang.IllegalStateException: Master not running&lt;br/&gt;
    &lt;span class=&quot;error&quot;&gt;&amp;#91;junit&amp;#93;&lt;/span&gt;     at org.apache.hadoop.hbase.HMaster.createTable(HMaster.java:1316)&lt;br/&gt;
    &lt;span class=&quot;error&quot;&gt;&amp;#91;junit&amp;#93;&lt;/span&gt;     at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)&lt;br/&gt;
    &lt;span class=&quot;error&quot;&gt;&amp;#91;junit&amp;#93;&lt;/span&gt;     at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)&lt;br/&gt;
    &lt;span class=&quot;error&quot;&gt;&amp;#91;junit&amp;#93;&lt;/span&gt;     at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)&lt;br/&gt;
    &lt;span class=&quot;error&quot;&gt;&amp;#91;junit&amp;#93;&lt;/span&gt;     at java.lang.reflect.Method.invoke(Method.java:597)&lt;br/&gt;
    &lt;span class=&quot;error&quot;&gt;&amp;#91;junit&amp;#93;&lt;/span&gt;     at org.apache.hadoop.ipc.RPC$Server.call(RPC.java:341)&lt;br/&gt;
    &lt;span class=&quot;error&quot;&gt;&amp;#91;junit&amp;#93;&lt;/span&gt;     at org.apache.hadoop.ipc.Server$Handler.run(Server.java:573)&lt;/p&gt;</description>
                <environment>&lt;p&gt;redhat&lt;/p&gt;</environment>
        <key id="12368896">HBASE-210</key>
            <summary>TestHBaseCluster fails with IllegalMonitorStateException</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/bug.png">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.png">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="hairong">Hairong Kuang</reporter>
                        <labels>
                    </labels>
                <created>Tue, 8 May 2007 23:37:51 +0000</created>
                <updated>Mon, 4 Feb 2008 18:41:08 +0000</updated>
                            <resolved>Fri, 11 May 2007 21:12:21 +0000</resolved>
                                                                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                <comments>
                            <comment id="12494516" author="jimk" created="Wed, 9 May 2007 15:51:29 +0000"  >&lt;p&gt;Hairong,&lt;/p&gt;

&lt;p&gt;I am unable to reproduce the problem building either 0.13 or trunk. 0.12.3 does not contain HBase at all.&lt;/p&gt;

&lt;p&gt;Do you have non-default settings in src/contrib/test/hadoop-site.xml,  src/contrib/test/mapred-default.xml,  conf/hadoop-site.xml or conf/mapred-default.xml ?&lt;/p&gt;

&lt;p&gt;TestHBaseCluster takes between 180 to 190 seconds to run on my MacBook Pro Core 2 Duo running Fedora Core 6. If you have set a test timeout, and the test was killed during the run, I can understand why you might see this problem.&lt;/p&gt;

&lt;p&gt;TestHBaseCluster runs a MiniHBaseCluster on top of a MiniDFSCluster which makes for a lot of threads running during the test. It absolutely pegs both of the CPUs on my machine.&lt;/p&gt;

&lt;p&gt;Any additional information you could provide about your environment would be helpful.&lt;/p&gt;

&lt;p&gt;Thanks.&lt;/p&gt;

&lt;p&gt;-Jim&lt;/p&gt;</comment>
                            <comment id="12494518" author="jimk" created="Wed, 9 May 2007 16:11:38 +0000"  >&lt;p&gt;The test also runs successfully in the nightly Hudson builds.&lt;/p&gt;</comment>
                            <comment id="12494596" author="hairong" created="Wed, 9 May 2007 22:48:58 +0000"  >&lt;p&gt;Jim, I wish I could provide your info. But I got the error when I ran ant test using the default configuration.&lt;/p&gt;</comment>
                            <comment id="12494597" author="owen.omalley" created="Wed, 9 May 2007 22:50:29 +0000"  >&lt;p&gt;I&apos;m seeing the failure too. &lt;/p&gt;

&lt;p&gt;I do have changes in conf/&lt;b&gt;.xml, but your test cases need to ignore those. I don&apos;t have any changes in src/&lt;/b&gt;&lt;b&gt;/&lt;/b&gt;.xml.&lt;/p&gt;</comment>
                            <comment id="12494793" author="jimk" created="Thu, 10 May 2007 17:04:08 +0000"  >&lt;p&gt;HBase does not access any of the .xml files directly. It uses a Configuration object which in the test environment grabs the settings out of src//.xml&lt;/p&gt;

&lt;p&gt;The only reason I asked was that there was previously an issue where tests were timed out if they ran longer than a setting in the configuration. Later, that setting was removed from the xml file, but if it was set and the test killed in the middle, I can envision all kinds of errors emerging.&lt;/p&gt;

&lt;p&gt;That not being the case, I&apos;ll see if I can figure out how this is happening.  If you could upload a portion of your log file while that test is running that would be helpful in determining what part of the test this is happening in.&lt;/p&gt;</comment>
                            <comment id="12494812" author="hairong" created="Thu, 10 May 2007 18:34:40 +0000"  >&lt;p&gt;Jim, I had a failed run yesterday. I checked the log and it looks that dfs worked well. The attached file contains all the hbase related logs. Hope that it helps.&lt;/p&gt;</comment>
                            <comment id="12494821" author="jimk" created="Thu, 10 May 2007 19:31:29 +0000"  >&lt;p&gt;That was helpful, thanks!&lt;/p&gt;

&lt;p&gt;I now know what is causing the problem: trying to hold a lock across multiple RPC&apos;s. You can&apos;t be guaranteed that the same proxy that took out the lock is the one that is invoked when trying to unlock the lock.&lt;/p&gt;

&lt;p&gt;This is going to require some restructuring of how we do locking. Hopefully I can figure out something in a couple of days.&lt;/p&gt;</comment>
                            <comment id="12494836" author="jimk" created="Thu, 10 May 2007 21:13:57 +0000"  >&lt;p&gt;I think this patch will solve this issue. I am going to change this issue to patch available so it will go through the next patch build. But since neither Hudson nor I can actually reproduce the problem, would it be possible for one of you who has to try it out once the patch build succeeds?&lt;/p&gt;</comment>
                            <comment id="12494837" author="jimk" created="Thu, 10 May 2007 21:14:43 +0000"  >&lt;p&gt;Test patch in patch build.&lt;/p&gt;</comment>
                            <comment id="12494854" author="hadoopqa" created="Thu, 10 May 2007 21:48:06 +0000"  >&lt;p&gt;+1&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;http://issues.apache.org/jira/secure/attachment/12357060/patch.txt&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/secure/attachment/12357060/patch.txt&lt;/a&gt; applied and successfully tested against trunk revision r536583.&lt;/p&gt;

&lt;p&gt;Test results:   &lt;a href=&quot;http://lucene.zones.apache.org:8080/hudson/job/Hadoop-Patch/129/testReport/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://lucene.zones.apache.org:8080/hudson/job/Hadoop-Patch/129/testReport/&lt;/a&gt;&lt;br/&gt;
Console output: &lt;a href=&quot;http://lucene.zones.apache.org:8080/hudson/job/Hadoop-Patch/129/console&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://lucene.zones.apache.org:8080/hudson/job/Hadoop-Patch/129/console&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="12494890" author="hairong" created="Thu, 10 May 2007 22:55:05 +0000"  >&lt;p&gt;+1. Works on my computer.&lt;/p&gt;</comment>
                            <comment id="12494894" author="jimk" created="Thu, 10 May 2007 23:01:27 +0000"  >&lt;p&gt;Thanks Hairong!&lt;/p&gt;</comment>
                            <comment id="12495139" author="jimk" created="Fri, 11 May 2007 19:22:27 +0000"  >&lt;p&gt;It turns out that the patch can result in thread starvation or possibly deadlock. I have a new version of HLocking.java which fixes this problem.&lt;/p&gt;</comment>
                            <comment id="12495140" author="jimk" created="Fri, 11 May 2007 19:30:55 +0000"  >&lt;p&gt;Fixes thread starvation and/or deadlock in HLocking&lt;/p&gt;</comment>
                            <comment id="12495144" author="hadoopqa" created="Fri, 11 May 2007 20:01:51 +0000"  >&lt;p&gt;+1&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;http://issues.apache.org/jira/secure/attachment/12357129/patch.txt&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/secure/attachment/12357129/patch.txt&lt;/a&gt; applied and successfully tested against trunk revision r536583.&lt;/p&gt;

&lt;p&gt;Test results:   &lt;a href=&quot;http://lucene.zones.apache.org:8080/hudson/job/Hadoop-Patch/134/testReport/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://lucene.zones.apache.org:8080/hudson/job/Hadoop-Patch/134/testReport/&lt;/a&gt;&lt;br/&gt;
Console output: &lt;a href=&quot;http://lucene.zones.apache.org:8080/hudson/job/Hadoop-Patch/134/console&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://lucene.zones.apache.org:8080/hudson/job/Hadoop-Patch/134/console&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="12495172" author="cutting" created="Fri, 11 May 2007 21:12:21 +0000"  >&lt;p&gt;I just committed this.  Thanks, Jim!&lt;/p&gt;</comment>
                            <comment id="12495254" author="hadoopqa" created="Sat, 12 May 2007 11:24:11 +0000"  >&lt;p&gt;Integrated in Hadoop-Nightly #86 (See &lt;a href=&quot;http://lucene.zones.apache.org:8080/hudson/job/Hadoop-Nightly/86/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://lucene.zones.apache.org:8080/hudson/job/Hadoop-Nightly/86/&lt;/a&gt;)&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12357054" name="hbase.log" size="7347" author="hairong" created="Thu, 10 May 2007 18:34:40 +0000"/>
                            <attachment id="12357129" name="patch.txt" size="45671" author="jimk" created="Fri, 11 May 2007 19:30:54 +0000"/>
                            <attachment id="12357060" name="patch.txt" size="45895" author="jimk" created="Thu, 10 May 2007 21:13:57 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>3.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Wed, 9 May 2007 15:51:29 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>24994</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            9 years, 30 weeks, 6 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0h5g7:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>98145</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        </customfields>
    </item>
</channel>
</rss>