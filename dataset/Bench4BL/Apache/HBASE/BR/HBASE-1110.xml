<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Sat Dec 03 16:57:46 UTC 2016

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/HBASE-1110/HBASE-1110.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[HBASE-1110] Distribute the master role to HRS after ZK integration</title>
                <link>https://issues.apache.org/jira/browse/HBASE-1110</link>
                <project id="12310753" key="HBASE">HBase</project>
                    <description>&lt;p&gt;After ZK integration, the master role can be distributed out to the HRS as group behaviors mediated by synchronization and rendezvous points in ZK.&lt;/p&gt;

&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;State sharing, for example load.
	&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
		&lt;li&gt;Load information can be shared with neighbors via ephemeral child status znodes of a znode representing the cluster root.&lt;/li&gt;
		&lt;li&gt;Region servers can periodically walk the status nodes of their neighbors. If they find themselves loaded relative to others, they can release regions. If they find themselves less loaded relative to others, they can be more aggressive about finding unassigned regions (see below).&lt;/li&gt;
	&lt;/ul&gt;
	&lt;/li&gt;
&lt;/ul&gt;


&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;Ephemeral znodes for region ownership, e.g. /hbase//&amp;lt;region&amp;gt;/&amp;lt;ephemeral-node&amp;gt;
	&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
		&lt;li&gt;Use a permanent child of &amp;lt;region&amp;gt; to serve as a &apos;dirty&apos; flag, removed during normal close.&lt;/li&gt;
	&lt;/ul&gt;
	&lt;/li&gt;
&lt;/ul&gt;


&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;A distributed queue for region assignment.
	&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
		&lt;li&gt;When coming up, HRS can check the assignment queue for candidates.&lt;/li&gt;
		&lt;li&gt;HRS shutdown includes marking regions clean and moving them onto assignment queue.&lt;/li&gt;
		&lt;li&gt;All/any HRS can do occasional random walks over region leases looking for expired-dirty state (when timeout causes ZK to delete the ephemeral node representing the lease), and can helpfully move them first to a queue (+ barrier) for splitting then onto the assignment queue.&lt;/li&gt;
	&lt;/ul&gt;
	&lt;/li&gt;
&lt;/ul&gt;
</description>
                <environment></environment>
        <key id="12411923">HBASE-1110</key>
            <summary>Distribute the master role to HRS after ZK integration</summary>
                <type id="4" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/improvement.png">Improvement</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.png">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="3">Duplicate</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="apurtell">Andrew Purtell</reporter>
                        <labels>
                    </labels>
                <created>Thu, 8 Jan 2009 06:03:36 +0000</created>
                <updated>Mon, 12 May 2014 00:27:02 +0000</updated>
                            <resolved>Mon, 12 May 2014 00:27:02 +0000</resolved>
                                                                        <due></due>
                            <votes>0</votes>
                                    <watches>4</watches>
                                                                <comments>
                            <comment id="12662183" author="stack" created="Fri, 9 Jan 2009 00:03:00 +0000"  >&lt;p&gt;Pertaining to master distribution &amp;#8211; not so much to zk integration (though it has a role to play if a crash) &amp;#8211; log splitting is currently a hacked-up master responsibility that needs to be distributed instead so splits are run promptly.  Also, our current split code does not survive a master crash.  In ZK we can keep record of logs processed so on resumption, a distributed splitting process can resume where it last left off.&lt;/p&gt;</comment>
                            <comment id="12707806" author="apparition" created="Sun, 10 May 2009 15:52:11 +0000"  >&lt;ul&gt;
	&lt;li&gt;About first idea (State sharing)&lt;br/&gt;
It is cool idea! I was imagining something like that... going to do something for load balancing using ZK sync and Region local closing for balance (not master central closing like it is done now)&lt;/li&gt;
&lt;/ul&gt;



&lt;ul&gt;
	&lt;li&gt;About second idea (Ephemeral znodes for region ownership)&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;&lt;cite&gt;Each row in the ROOT and META tables is approximately 1KB in size. At the default region size of 256MB, this means that the ROOT region can map 2.6 x 10^5 META regions, which in turn map a total 6.9 x 10^10 user regions....&lt;/cite&gt;&lt;/p&gt;

&lt;p&gt;So you are going to make 6.9 x 10^10 zNodes for each Region, where will be put 6.9 x 10^10 Ephemeral zNodes about Region assignment, in this case? not sure but looks too much for me....  so I think we should find another solution&lt;/p&gt;


&lt;ul&gt;
	&lt;li&gt;Third idea (distributed queue for region assignment ) is nice too&lt;br/&gt;
So HRS can take regions for assignment by their own. &lt;br/&gt;
One problem is that we need someone to put not assigned regions in that queue. Not sure about second idea.. if we can contain information about all Regions assignment in ZK.... &lt;br/&gt;
at least we can use master (or HRS leader) to put unassigned regions in this queue&lt;/li&gt;
&lt;/ul&gt;


&lt;ul&gt;
	&lt;li&gt;About log splitting... we can give task for log split to some of HRS... and make a mark about this task in ZK... So after this task is done (mark in ZK changes state to &quot;DONE&quot;) regions are ready for assignment.&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;Just some ideas.. thoughts... maybe can be useful... &lt;/p&gt;</comment>
                            <comment id="12707808" author="apparition" created="Sun, 10 May 2009 16:14:51 +0000"  >&lt;p&gt;More about second idea... if we do this we will get ROOT and META tables in ZK. &lt;br/&gt;
it can be very nice to have this 2 tables shared... but isn&apos;t it too much for ZK ?&lt;/p&gt;</comment>
                            <comment id="12724599" author="stack" created="Fri, 26 Jun 2009 16:17:33 +0000"  >&lt;p&gt;Lets make this the master redesign issue.  Made it critical and for 0.21&lt;/p&gt;</comment>
                            <comment id="12851306" author="apurtell" created="Tue, 30 Mar 2010 08:15:55 +0000"  >&lt;p&gt;ZK 3.3.0 claims to have a worked distributed queue recipe implementation. &lt;/p&gt;

&lt;p&gt;Use it for region assignment? (Master could release region after log split or table create and one regionservers can coordinate picking them up via the distributed queue.) &lt;/p&gt;

&lt;p&gt;Use it for log splitting? Master can put up logs to split into the queue and regionservers can take it on as their load and health allow?&lt;/p&gt;</comment>
                            <comment id="12852915" author="stack" created="Fri, 2 Apr 2010 18:56:14 +0000"  >&lt;p&gt;.bq Use it for region assignment?&lt;/p&gt;

&lt;p&gt;That is plan as part of master rewrite.&lt;/p&gt;</comment>
                            <comment id="12867018" author="stack" created="Thu, 13 May 2010 04:41:55 +0000"  >&lt;p&gt;Moved from 0.21 to 0.22 just after merge of old 0.20 branch into TRUNK.&lt;/p&gt;</comment>
                            <comment id="13009392" author="stack" created="Mon, 21 Mar 2011 21:18:50 +0000"  >&lt;p&gt;How about as a step toward this ideal we bundle the master into the regionserver such that any regionserver can become master on current master fail?  Then we&apos;d have one &apos;server&apos; type only rather than two as we currently have.&lt;/p&gt;</comment>
                            <comment id="13009418" author="stack" created="Mon, 21 Mar 2011 21:57:19 +0000"  >&lt;p&gt;Knocking down its priority from critical to major&lt;/p&gt;</comment>
                            <comment id="13009435" author="streamy" created="Mon, 21 Mar 2011 22:11:46 +0000"  >&lt;p&gt;Is this really that important to do now?  Seems simple enough to start master processes on slave nodes if you want lots of backups.  If each RS can become a master, then you have to reserve heap in each to handle the master role (which is a non-trivial amount).&lt;/p&gt;

&lt;p&gt;I think this is a fine area to explore and always good to have options (this could make sense on a small cluster).  But I&apos;d opt to move out of 0.92.&lt;/p&gt;</comment>
                            <comment id="13009443" author="ryanobjc" created="Mon, 21 Mar 2011 22:16:23 +0000"  >&lt;p&gt;with distributed log splitting, the master is just a coordinator so that is a big +1 for me. We should probably be seeking to minimize our exposure area to ZK.&lt;/p&gt;</comment>
                            <comment id="13047610" author="stack" created="Fri, 10 Jun 2011 22:46:04 +0000"  >&lt;p&gt;Moving out of 0.92.0. Pull it back in if you think different.&lt;/p&gt;</comment>
                            <comment id="13994715" author="apurtell" created="Mon, 12 May 2014 00:27:02 +0000"  >&lt;p&gt;Resolving as dup of work &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=jxiang&quot; class=&quot;user-hover&quot; rel=&quot;jxiang&quot;&gt;Jimmy Xiang&lt;/a&gt; is working on. Technically I had the idea first but it&apos;s execution that matters. &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.gif&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt; /cc &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=stack&quot; class=&quot;user-hover&quot; rel=&quot;stack&quot;&gt;stack&lt;/a&gt; &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=lhofhansl&quot; class=&quot;user-hover&quot; rel=&quot;lhofhansl&quot;&gt;Lars Hofhansl&lt;/a&gt;&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                            <outwardlinks description="relates to">
                                        <issuelink>
            <issuekey id="12411985">HBASE-1111</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                    </issuelinks>
                <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Fri, 9 Jan 2009 00:03:00 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>31994</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            2 years, 29 weeks, 5 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i02gdb:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>12253</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        </customfields>
    </item>
</channel>
</rss>