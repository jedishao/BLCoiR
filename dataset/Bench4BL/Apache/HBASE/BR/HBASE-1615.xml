<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Fri Dec 02 18:50:17 UTC 2016

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/HBASE-1615/HBASE-1615.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[HBASE-1615] HBASE-1597 introduced a bug when compacting after a split</title>
                <link>https://issues.apache.org/jira/browse/HBASE-1615</link>
                <project id="12310753" key="HBASE">HBase</project>
                    <description>&lt;p&gt;The way &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-1597&quot; title=&quot;Prevent unnecessary caching of blocks during compactions&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-1597&quot;&gt;&lt;del&gt;HBASE-1597&lt;/del&gt;&lt;/a&gt; instantiated the CompactionReader ignored whether the Reader it came from was a half reader or not.&lt;/p&gt;

&lt;p&gt;Need to reimplement CompactionReader.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12429655">HBASE-1615</key>
            <summary>HBASE-1597 introduced a bug when compacting after a split</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/bug.png">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.png">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="stack">stack</assignee>
                                    <reporter username="streamy">Jonathan Gray</reporter>
                        <labels>
                    </labels>
                <created>Mon, 6 Jul 2009 23:39:05 +0000</created>
                <updated>Sun, 13 Sep 2009 22:24:49 +0000</updated>
                            <resolved>Tue, 7 Jul 2009 03:44:51 +0000</resolved>
                                                    <fixVersion>0.20.0</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                <comments>
                            <comment id="12727835" author="stack" created="Mon, 6 Jul 2009 23:41:12 +0000"  >&lt;p&gt;File that delegates to passed Reader rather than create a new one with attributes copied from the passed in Reader.&lt;/p&gt;</comment>
                            <comment id="12727851" author="stack" created="Tue, 7 Jul 2009 00:44:11 +0000"  >&lt;p&gt;Adds logging and toStringBinary on exceptions as well as the CompactionReader fix.&lt;/p&gt;</comment>
                            <comment id="12727854" author="stack" created="Tue, 7 Jul 2009 00:57:10 +0000"  >&lt;p&gt;Was being too clever in my test of split key &amp;#8211; wasn&apos;t allowing for &apos;&apos; key.&lt;/p&gt;</comment>
                            <comment id="12727856" author="apurtell" created="Tue, 7 Jul 2009 00:58:53 +0000"  >&lt;p&gt;Especially nice are the detailed exception messages. Sorry I didn&apos;t catch the reader versus half file reader issue on review of 1597. &lt;/p&gt;</comment>
                            <comment id="12727877" author="streamy" created="Tue, 7 Jul 2009 02:16:14 +0000"  >&lt;p&gt;The patch didn&apos;t get any prettier.&lt;/p&gt;

&lt;p&gt;Issue is that there is a special HFileScanner inside of HalfHFileReader.&lt;/p&gt;

&lt;p&gt;This patch breaks that into an actual class (rather than added on construction).  And since it&apos;s a separate class, you now pass in the HalfHFileReader, and it sets a local top/splitKey.&lt;/p&gt;

&lt;p&gt;Also adds HFile.Reader.Scanner instantiation based on a passed in Reader.  So now we can have an instantiated Scanner from HFile.Reader.Scanner than takes our subclassed CompactionReader (so that we can call our own cacheBlock method).  All other methods are passed along to the delegate (in this case, the HalfHFileReader).  But then the HalfHFileScanner goes atop the HFileScanner (which has our CompactionReader as the Reader, passing along to HalfHFileReader).&lt;/p&gt;

&lt;p&gt;Yeah i think i repeated myself there.  Anyways, it ain&apos;t pretty but it seems to work.&lt;/p&gt;</comment>
                            <comment id="12727878" author="streamy" created="Tue, 7 Jul 2009 02:16:58 +0000"  >&lt;p&gt;Correct filename.&lt;/p&gt;</comment>
                            <comment id="12727880" author="streamy" created="Tue, 7 Jul 2009 02:21:23 +0000"  >&lt;p&gt;Hmm, well that patch passes tests but up on cluster it does weird stuff.  And I think I&apos;m still seeing stuff get cached.&lt;/p&gt;</comment>
                            <comment id="12727881" author="streamy" created="Tue, 7 Jul 2009 02:23:59 +0000"  >&lt;p&gt;Issue is, we have a local readBlock in CompactionReader but that the delegate Reader does not use our cacheBlock method.&lt;/p&gt;

&lt;p&gt;I think this might be much easier if we just upgrade &quot;block should be cached&quot; to a passed boolean to HFile Reader and Scanner instantation, rather than all this subclassing, delegating, and such.&lt;/p&gt;</comment>
                            <comment id="12727886" author="streamy" created="Tue, 7 Jul 2009 02:52:28 +0000"  >&lt;p&gt;Changes implementation of how we&apos;re going to not cache blocks.&lt;/p&gt;

&lt;p&gt;No more CompactionReader.  We now pass a boolean in when we create the HFile.Reader.Scanner as to whether we want to cache blocks or not.  That is passed in to the HFile.Reader.readBlock().&lt;/p&gt;

&lt;p&gt;Much more simple and avoids code duplication and unnecessary complexity.  If we decide to make more optimizations to the reader or scanner, we will revisit this down the road.  Need to stabilize trunk!&lt;/p&gt;

&lt;p&gt;Passes new unit test introduced in 1616.&lt;/p&gt;

&lt;p&gt;This patch takes out a bunch of debugging stuff added by stack&apos;s patches.  Only for clarity purposes and so I could track where I was at.&lt;/p&gt;</comment>
                            <comment id="12727890" author="streamy" created="Tue, 7 Jul 2009 03:00:05 +0000"  >&lt;p&gt;My tests also pass with v5 patch.&lt;/p&gt;</comment>
                            <comment id="12727898" author="stack" created="Tue, 7 Jul 2009 03:40:41 +0000"  >&lt;p&gt;+1 on patch.  Cleaner than new CompactedReader class.&lt;/p&gt;</comment>
                            <comment id="12727899" author="stack" created="Tue, 7 Jul 2009 03:44:51 +0000"  >&lt;p&gt;Thanks for patch Jon.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12412682" name="1615-v2.patch" size="15292" author="stack" created="Tue, 7 Jul 2009 00:44:11 +0000"/>
                            <attachment id="12412683" name="1615-v3.patch" size="13772" author="stack" created="Tue, 7 Jul 2009 00:57:10 +0000"/>
                            <attachment id="12412694" name="HBASE-1615-v4.patch" size="29485" author="streamy" created="Tue, 7 Jul 2009 02:16:58 +0000"/>
                            <attachment id="12412696" name="HBASE-1615-v5.patch" size="9640" author="streamy" created="Tue, 7 Jul 2009 02:52:28 +0000"/>
                            <attachment id="12412673" name="hfile.patch" size="2721" author="stack" created="Mon, 6 Jul 2009 23:41:12 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>5.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Mon, 6 Jul 2009 23:41:12 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>25866</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310191" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                        <customfieldname>Hadoop Flags</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10343"><![CDATA[Reviewed]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            7 years, 22 weeks, 3 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0hean:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>99578</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        </customfields>
    </item>
</channel>
</rss>