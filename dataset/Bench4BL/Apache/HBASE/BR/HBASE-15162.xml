<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Sat Dec 03 15:54:20 UTC 2016

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/HBASE-15162/HBASE-15162.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[HBASE-15162] Add separate metrics for meta/data block hit ratio in cache</title>
                <link>https://issues.apache.org/jira/browse/HBASE-15162</link>
                <project id="12310753" key="HBASE">HBase</project>
                    <description>&lt;p&gt;Currently we already have a metrics in name of &lt;tt&gt;blockCacheExpressHitPercent&lt;/tt&gt; to indicate the cache hit ratio. However, since meta block is small and often cached in memory with a high hit ratio, this &quot;mixed&quot; metrics could not show the real data block hit ratio which is more concerned.&lt;/p&gt;

&lt;p&gt;We propose to add two new metrics to show meta and data block cache hit ratio separately, while reserving the old metrics for backward compatibility.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12933753">HBASE-15162</key>
            <summary>Add separate metrics for meta/data block hit ratio in cache</summary>
                <type id="7" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/subtask_alternate.png">Sub-task</type>
                            <parent id="12933750">HBASE-15161</parent>
                                    <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.png">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="3">Duplicate</resolution>
                                        <assignee username="carp84">Yu Li</assignee>
                                    <reporter username="carp84">Yu Li</reporter>
                        <labels>
                    </labels>
                <created>Mon, 25 Jan 2016 09:18:00 +0000</created>
                <updated>Tue, 26 Jan 2016 07:09:01 +0000</updated>
                            <resolved>Tue, 26 Jan 2016 07:08:12 +0000</resolved>
                                                                        <due></due>
                            <votes>0</votes>
                                    <watches>4</watches>
                                                                <comments>
                            <comment id="15114938" author="carp84" created="Mon, 25 Jan 2016 09:25:10 +0000"  >&lt;p&gt;Attaching the initial patch. Note that this patch depends on &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-15161&quot; title=&quot;Umbrella: Miscellaneous improvements from production usage&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-15161&quot;&gt;HBASE-15161&lt;/a&gt; so could not directly apply on current code base.&lt;/p&gt;

&lt;p&gt;Some data after patch:&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;&quot;blockCacheExpressHitPercent&quot; : 77,
&quot;blockCacheExpressMetaHitPercent&quot; : 83,
&quot;blockCacheExpressDataHitPercent&quot; : 66,
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="15114941" author="carp84" created="Mon, 25 Jan 2016 09:26:34 +0000"  >&lt;p&gt;Depends on &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-15160&quot; title=&quot;Put back HFile&amp;#39;s HDFS op latency sampling code and add metrics for monitoring&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-15160&quot;&gt;HBASE-15160&lt;/a&gt;, sorry for typo in the last comment&lt;/p&gt;</comment>
                            <comment id="15115335" author="carp84" created="Mon, 25 Jan 2016 15:01:49 +0000"  >&lt;p&gt;Add back missing changes in MetricsRegionServerSourceImpl&lt;/p&gt;</comment>
                            <comment id="15115541" author="stack" created="Mon, 25 Jan 2016 16:57:42 +0000"  >&lt;p&gt;Small stuff &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=carp84&quot; class=&quot;user-hover&quot; rel=&quot;carp84&quot;&gt;Yu Li&lt;/a&gt;&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
338	  &lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt; BLOCK_CACHE_EXPRESS_META_HIT_PERCENT = &lt;span class=&quot;code-quote&quot;&gt;&quot;blockCacheExpressMetaHitPercent&quot;&lt;/span&gt;;
339	  &lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt; BLOCK_CACHE_EXPRESS_META_HIT_PERCENT_DESC =
340	      &lt;span class=&quot;code-quote&quot;&gt;&quot;The percent of the time that requests with the cache turned on hit the meta cache.&quot;&lt;/span&gt;;
341	  &lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt; BLOCK_CACHE_EXPRESS_DATA_HIT_PERCENT = &lt;span class=&quot;code-quote&quot;&gt;&quot;blockCacheExpressDataHitPercent&quot;&lt;/span&gt;;
342	  &lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt; BLOCK_CACHE_EXPRESS_DATA_HIT_PERCENT_DESC =
343	      &lt;span class=&quot;code-quote&quot;&gt;&quot;The percent of the time that requests with the cache turned on hit the data cache.&quot;&lt;/span&gt;;

&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;What does the &apos;express&apos; mean in the above? The name of the method seems like a better name for the metric: getBlockCacheMetaHitCachingPercent... i.e. BLOCK_CACHE_META_HIT_PERCENTAGE.&lt;/p&gt;

&lt;p&gt;It is not possible to turn off block cache for meta blocks so the description can drop &apos;with the cache turned on&apos;.&lt;/p&gt;

&lt;p&gt;If L2 is enabled &amp;#8211; i.e. bucket cache &amp;#8211; then all data blocks go into L2 and L1 carries meta blocks only. These metrics will still make &apos;sense&apos; when bucketcache is on? It seems so.  Just asking.... &lt;/p&gt;

&lt;p&gt;Otherwise, patch looks great.&lt;/p&gt;


</comment>
                            <comment id="15115542" author="stack" created="Mon, 25 Jan 2016 16:58:11 +0000"  >&lt;p&gt;Oh, is this dependent on &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-15161&quot; title=&quot;Umbrella: Miscellaneous improvements from production usage&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-15161&quot;&gt;HBASE-15161&lt;/a&gt;? There is no patch attached to &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-15161&quot; title=&quot;Umbrella: Miscellaneous improvements from production usage&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-15161&quot;&gt;HBASE-15161&lt;/a&gt;.&lt;/p&gt;</comment>
                            <comment id="15115569" author="anoop.hbase" created="Mon, 25 Jan 2016 17:13:45 +0000"  >&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
* @deprecated reserved &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; unit test only, use
59	   *             {@link #getBlock(BlockCacheKey, &lt;span class=&quot;code-object&quot;&gt;boolean&lt;/span&gt;, &lt;span class=&quot;code-object&quot;&gt;boolean&lt;/span&gt;, &lt;span class=&quot;code-object&quot;&gt;boolean&lt;/span&gt;, BlockType)} instead
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;BlockCache being private interface, we might not really need a deprecate path like this. You can just change the method by adding the extra param?&lt;/p&gt;

&lt;p&gt;Patch looks good&lt;/p&gt;</comment>
                            <comment id="15116378" author="eclark" created="Tue, 26 Jan 2016 00:34:53 +0000"  >&lt;p&gt;isn&apos;t this a dupe of &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-14983&quot; title=&quot;Create metrics for per block type hit/miss ratios&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-14983&quot;&gt;&lt;del&gt;HBASE-14983&lt;/del&gt;&lt;/a&gt; ?&lt;/p&gt;

&lt;p&gt;lets make sure to not double the metrics for the same thing. They will cause confusion.&lt;/p&gt;</comment>
                            <comment id="15116663" author="carp84" created="Tue, 26 Jan 2016 04:34:34 +0000"  >&lt;blockquote&gt;&lt;p&gt;What does the &apos;express&apos; mean in the above?&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;&apos;express&apos; means &apos;requests set to use the block cache&apos;, and the copy-paste description &apos;with the cache turned on&apos; is to clarify this but seems failed... For details, BLOCK_CACHE_HIT_PERCENT refers to MetricsRegionServerWrapperImpl#getBlockCacheHitPercent and BLOCK_CACHE_EXPRESS_HIT_PERCENT refers to MetricsRegionServerWrapperImpl#getBlockCacheHitCachingPercent.&lt;/p&gt;

&lt;p&gt;Regarding CombinedBlockCache, I agree that the separation seems less useful&lt;/p&gt;</comment>
                            <comment id="15116695" author="carp84" created="Tue, 26 Jan 2016 05:04:45 +0000"  >&lt;p&gt;Thanks for mentioning &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-14983&quot; title=&quot;Create metrics for per block type hit/miss ratios&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-14983&quot;&gt;&lt;del&gt;HBASE-14983&lt;/del&gt;&lt;/a&gt;, checking the changes there I could see a more fine-grained separation on the cache count metrics (great work sir), but I didn&apos;t see  any hit ratio. It seems you prefer counter to gauge and plan to do the aggregation at front-end? Since we already have a gauge for blockCacheHitPercent, I think it would be more convenient to supply a gauge for meta/dataBlockCacheHitPercent, so user could directly monitor on it rather than do additional aggregation.&lt;/p&gt;

&lt;p&gt;It&apos;s ok for me to merge &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-14983&quot; title=&quot;Create metrics for per block type hit/miss ratios&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-14983&quot;&gt;&lt;del&gt;HBASE-14983&lt;/del&gt;&lt;/a&gt; and this JIRA, but I hope we could keep the hit ratio gauge and the metrics name proposed here, so we won&apos;t need to modify our monitoring system in the next upgrade in the future.&lt;/p&gt;</comment>
                            <comment id="15116717" author="eclark" created="Tue, 26 Jan 2016 05:25:43 +0000"  >&lt;p&gt;Sure let me try and get the percent gauges on.&lt;/p&gt;</comment>
                            <comment id="15116833" author="carp84" created="Tue, 26 Jan 2016 07:07:08 +0000"  >&lt;p&gt;Thanks Elliott, let&apos;s track the work in &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-14983&quot; title=&quot;Create metrics for per block type hit/miss ratios&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-14983&quot;&gt;&lt;del&gt;HBASE-14983&lt;/del&gt;&lt;/a&gt; then. Will mark this JIRA duplicated.&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=stack&quot; class=&quot;user-hover&quot; rel=&quot;stack&quot;&gt;stack&lt;/a&gt; and &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=anoop.hbase&quot; class=&quot;user-hover&quot; rel=&quot;anoop.hbase&quot;&gt;Anoop Sam John&lt;/a&gt;, thanks for review all the same!&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="12310000">
                    <name>Duplicate</name>
                                            <outwardlinks description="duplicates">
                                        <issuelink>
            <issuekey id="12922116">HBASE-14983</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                            <issuelinktype id="10001">
                    <name>dependent</name>
                                            <outwardlinks description="depends upon">
                                        <issuelink>
            <issuekey id="12933733">HBASE-15160</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12784115" name="HBASE-15162.patch" size="18467" author="carp84" created="Mon, 25 Jan 2016 09:25:10 +0000"/>
                            <attachment id="12784166" name="HBASE-15162_v2.patch" size="19156" author="carp84" created="Mon, 25 Jan 2016 15:01:49 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Mon, 25 Jan 2016 16:57:42 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            44 weeks, 4 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i2rwxr:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        </customfields>
    </item>
</channel>
</rss>