<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Fri Dec 02 18:45:17 UTC 2016

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/HBASE-421/HBASE-421.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[HBASE-421] TestRegionServerExit broken</title>
                <link>https://issues.apache.org/jira/browse/HBASE-421</link>
                <project id="12310753" key="HBASE">HBase</project>
                    <description>&lt;p&gt;TestRegionServerExit has a couple of problems:&lt;/p&gt;

&lt;p&gt;1. Region server tries to start http server on a port already in use:&lt;br/&gt;
    &lt;span class=&quot;error&quot;&gt;&amp;#91;junit&amp;#93;&lt;/span&gt; 2008-02-07 07:01:06,529 FATAL &lt;span class=&quot;error&quot;&gt;&amp;#91;RegionServer:2&amp;#93;&lt;/span&gt; hbase.HRegionServer(867): Failed init&lt;br/&gt;
    &lt;span class=&quot;error&quot;&gt;&amp;#91;junit&amp;#93;&lt;/span&gt; java.io.IOException: Problem starting http server&lt;br/&gt;
    &lt;span class=&quot;error&quot;&gt;&amp;#91;junit&amp;#93;&lt;/span&gt; 	at org.apache.hadoop.hbase.util.InfoServer.start(InfoServer.java:227)&lt;br/&gt;
    &lt;span class=&quot;error&quot;&gt;&amp;#91;junit&amp;#93;&lt;/span&gt; 	at org.apache.hadoop.hbase.HRegionServer.startServiceThreads(HRegionServer.java:928)&lt;br/&gt;
    &lt;span class=&quot;error&quot;&gt;&amp;#91;junit&amp;#93;&lt;/span&gt; 	at org.apache.hadoop.hbase.HRegionServer.init(HRegionServer.java:863)&lt;br/&gt;
    &lt;span class=&quot;error&quot;&gt;&amp;#91;junit&amp;#93;&lt;/span&gt; 	at org.apache.hadoop.hbase.HRegionServer.run(HRegionServer.java:633)&lt;br/&gt;
    &lt;span class=&quot;error&quot;&gt;&amp;#91;junit&amp;#93;&lt;/span&gt; 	at java.lang.Thread.run(Thread.java:595)&lt;br/&gt;
    &lt;span class=&quot;error&quot;&gt;&amp;#91;junit&amp;#93;&lt;/span&gt; Caused by: org.mortbay.util.MultiException&lt;span class=&quot;error&quot;&gt;&amp;#91;java.net.BindException: Address already in use&amp;#93;&lt;/span&gt;&lt;br/&gt;
    &lt;span class=&quot;error&quot;&gt;&amp;#91;junit&amp;#93;&lt;/span&gt; 	at org.mortbay.http.HttpServer.doStart(HttpServer.java:731)&lt;br/&gt;
    &lt;span class=&quot;error&quot;&gt;&amp;#91;junit&amp;#93;&lt;/span&gt; 	at org.mortbay.util.Container.start(Container.java:72)&lt;br/&gt;
    &lt;span class=&quot;error&quot;&gt;&amp;#91;junit&amp;#93;&lt;/span&gt; 	at org.apache.hadoop.hbase.util.InfoServer.start(InfoServer.java:205)&lt;br/&gt;
    &lt;span class=&quot;error&quot;&gt;&amp;#91;junit&amp;#93;&lt;/span&gt; 	... 4 more&lt;br/&gt;
    &lt;span class=&quot;error&quot;&gt;&amp;#91;junit&amp;#93;&lt;/span&gt; 2008-02-07 07:01:06,530 FATAL &lt;span class=&quot;error&quot;&gt;&amp;#91;RegionServer:2&amp;#93;&lt;/span&gt; hbase.HRegionServer(772): Unhandled exception. Aborting...&lt;/p&gt;

&lt;p&gt;The region server that died apparently was serving the root region.&lt;/p&gt;

&lt;p&gt;The test case apparently has a long timeout for finding the root region because you see a lot of &lt;/p&gt;

&lt;p&gt;    &lt;span class=&quot;error&quot;&gt;&amp;#91;junit&amp;#93;&lt;/span&gt; 2008-02-07 07:04:14,813 DEBUG &lt;span class=&quot;error&quot;&gt;&amp;#91;Thread-540&amp;#93;&lt;/span&gt; hbase.HConnectionManager$TableServers(708): Wake. Retry finding root region.&lt;br/&gt;
    &lt;span class=&quot;error&quot;&gt;&amp;#91;junit&amp;#93;&lt;/span&gt; 2008-02-07 07:04:14,814 DEBUG &lt;span class=&quot;error&quot;&gt;&amp;#91;Thread-540&amp;#93;&lt;/span&gt; hbase.HConnectionManager$TableServers(704): Sleeping. Waiting for root region.&lt;br/&gt;
    &lt;span class=&quot;error&quot;&gt;&amp;#91;junit&amp;#93;&lt;/span&gt; 2008-02-07 07:04:24,823 DEBUG &lt;span class=&quot;error&quot;&gt;&amp;#91;Thread-540&amp;#93;&lt;/span&gt; hbase.HConnectionManager$TableServers(708): Wake. Retry finding root region.&lt;br/&gt;
    &lt;span class=&quot;error&quot;&gt;&amp;#91;junit&amp;#93;&lt;/span&gt; 2008-02-07 07:04:24,827 DEBUG &lt;span class=&quot;error&quot;&gt;&amp;#91;Thread-540&amp;#93;&lt;/span&gt; hbase.HConnectionManager$TableServers(704): Sleeping. Waiting for root region.&lt;br/&gt;
    &lt;span class=&quot;error&quot;&gt;&amp;#91;junit&amp;#93;&lt;/span&gt; 2008-02-07 07:04:34,833 DEBUG &lt;span class=&quot;error&quot;&gt;&amp;#91;Thread-540&amp;#93;&lt;/span&gt; hbase.HConnectionManager$TableServers(708): Wake. Retry finding root region.&lt;br/&gt;
    &lt;span class=&quot;error&quot;&gt;&amp;#91;junit&amp;#93;&lt;/span&gt; 2008-02-07 07:04:34,836 DEBUG &lt;span class=&quot;error&quot;&gt;&amp;#91;Thread-540&amp;#93;&lt;/span&gt; hbase.HConnectionManager$TableServers(704): Sleeping. Waiting for root region.&lt;br/&gt;
    &lt;span class=&quot;error&quot;&gt;&amp;#91;junit&amp;#93;&lt;/span&gt; 2008-02-07 07:04:44,842 DEBUG &lt;span class=&quot;error&quot;&gt;&amp;#91;Thread-540&amp;#93;&lt;/span&gt; hbase.HConnectionManager$TableServers(708): Wake. Retry finding root region.&lt;/p&gt;

&lt;p&gt;until finally the client gives up:&lt;/p&gt;

&lt;p&gt;    &lt;span class=&quot;error&quot;&gt;&amp;#91;junit&amp;#93;&lt;/span&gt; 2008-02-07 07:04:44,843 FATAL &lt;span class=&quot;error&quot;&gt;&amp;#91;Thread-540&amp;#93;&lt;/span&gt; hbase.TestRegionServerExit$1(161): could not re-open meta table because&lt;br/&gt;
    &lt;span class=&quot;error&quot;&gt;&amp;#91;junit&amp;#93;&lt;/span&gt; org.apache.hadoop.hbase.NoServerForRegionException: Timed out trying to locate root region&lt;br/&gt;
    &lt;span class=&quot;error&quot;&gt;&amp;#91;junit&amp;#93;&lt;/span&gt; 	at org.apache.hadoop.hbase.HConnectionManager$TableServers.locateRootRegion(HConnectionManager.java:718)&lt;br/&gt;
    &lt;span class=&quot;error&quot;&gt;&amp;#91;junit&amp;#93;&lt;/span&gt; 	at org.apache.hadoop.hbase.HConnectionManager$TableServers.locateRegion(HConnectionManager.java:329)&lt;br/&gt;
    &lt;span class=&quot;error&quot;&gt;&amp;#91;junit&amp;#93;&lt;/span&gt; 	at org.apache.hadoop.hbase.HConnectionManager$TableServers.relocateRegion(HConnectionManager.java:311)&lt;br/&gt;
    &lt;span class=&quot;error&quot;&gt;&amp;#91;junit&amp;#93;&lt;/span&gt; 	at org.apache.hadoop.hbase.HConnectionManager$TableServers.locateRegionInMeta(HConnectionManager.java:476)&lt;br/&gt;
    &lt;span class=&quot;error&quot;&gt;&amp;#91;junit&amp;#93;&lt;/span&gt; 	at org.apache.hadoop.hbase.HConnectionManager$TableServers.locateRegion(HConnectionManager.java:339)&lt;br/&gt;
    &lt;span class=&quot;error&quot;&gt;&amp;#91;junit&amp;#93;&lt;/span&gt; 	at org.apache.hadoop.hbase.HConnectionManager$TableServers.relocateRegion(HConnectionManager.java:311)&lt;br/&gt;
    &lt;span class=&quot;error&quot;&gt;&amp;#91;junit&amp;#93;&lt;/span&gt; 	at org.apache.hadoop.hbase.HTable.getRegionLocation(HTable.java:114)&lt;br/&gt;
    &lt;span class=&quot;error&quot;&gt;&amp;#91;junit&amp;#93;&lt;/span&gt; 	at org.apache.hadoop.hbase.HTable$ClientScanner.nextScanner(HTable.java:889)&lt;br/&gt;
    &lt;span class=&quot;error&quot;&gt;&amp;#91;junit&amp;#93;&lt;/span&gt; 	at org.apache.hadoop.hbase.HTable$ClientScanner.&amp;lt;init&amp;gt;(HTable.java:817)&lt;br/&gt;
    &lt;span class=&quot;error&quot;&gt;&amp;#91;junit&amp;#93;&lt;/span&gt; 	at org.apache.hadoop.hbase.HTable.obtainScanner(HTable.java:522)&lt;br/&gt;
    &lt;span class=&quot;error&quot;&gt;&amp;#91;junit&amp;#93;&lt;/span&gt; 	at org.apache.hadoop.hbase.HTable.obtainScanner(HTable.java:411)&lt;br/&gt;
    &lt;span class=&quot;error&quot;&gt;&amp;#91;junit&amp;#93;&lt;/span&gt; 	at org.apache.hadoop.hbase.TestRegionServerExit$1.run(TestRegionServerExit.java:156)&lt;br/&gt;
    &lt;span class=&quot;error&quot;&gt;&amp;#91;junit&amp;#93;&lt;/span&gt; 	at java.lang.Thread.run(Thread.java:595)&lt;br/&gt;
    &lt;span class=&quot;error&quot;&gt;&amp;#91;junit&amp;#93;&lt;/span&gt; Exception in thread &quot;Thread-540&quot; junit.framework.AssertionFailedError&lt;br/&gt;
    &lt;span class=&quot;error&quot;&gt;&amp;#91;junit&amp;#93;&lt;/span&gt; 	at junit.framework.Assert.fail(Assert.java:47)&lt;br/&gt;
    &lt;span class=&quot;error&quot;&gt;&amp;#91;junit&amp;#93;&lt;/span&gt; 	at junit.framework.Assert.fail(Assert.java:53)&lt;br/&gt;
    &lt;span class=&quot;error&quot;&gt;&amp;#91;junit&amp;#93;&lt;/span&gt; 	at org.apache.hadoop.hbase.TestRegionServerExit$1.run(TestRegionServerExit.java:162)&lt;br/&gt;
    &lt;span class=&quot;error&quot;&gt;&amp;#91;junit&amp;#93;&lt;/span&gt; 	at java.lang.Thread.run(Thread.java:595)&lt;/p&gt;

&lt;p&gt;Which is not the way the test is supposed to run at all.&lt;br/&gt;
It appears that when we start multiple region servers in a MiniHBaseCluster, they all try to start their http server on the same port. In the past I believe that the http server start failure was not fatal, so the test ran.&lt;/p&gt;

&lt;p&gt;We should either have some kind of setting for MiniHBaseCluster that tells the master and region servers not to start their http servers, or some way of telling multiple servers not to start on the same port, or making http startup failure non-fatal.&lt;/p&gt;

&lt;p&gt;Tests like these are good as they (eventually) point out a regression to us.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12388050">HBASE-421</key>
            <summary>TestRegionServerExit broken</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/bug.png">Bug</type>
                                            <priority id="2" iconUrl="https://issues.apache.org/jira/images/icons/priorities/critical.png">Critical</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="jimk">Jim Kellerman</assignee>
                                    <reporter username="jimk">Jim Kellerman</reporter>
                        <labels>
                    </labels>
                <created>Thu, 7 Feb 2008 08:24:53 +0000</created>
                <updated>Fri, 22 Aug 2008 21:13:08 +0000</updated>
                            <resolved>Fri, 8 Feb 2008 06:45:33 +0000</resolved>
                                    <version>0.1.0</version>
                    <version>0.2.0</version>
                                    <fixVersion>0.1.0</fixVersion>
                    <fixVersion>0.2.0</fixVersion>
                                    <component>test</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                <comments>
                            <comment id="12566699" author="jimk" created="Thu, 7 Feb 2008 17:23:40 +0000"  >&lt;p&gt;TestRegionServerExit does not report failure when if fails. It does write a success message if it succeeds, but does not do a fail() if it never reaches that point.&lt;/p&gt;</comment>
                            <comment id="12566702" author="stack" created="Thu, 7 Feb 2008 17:31:51 +0000"  >&lt;p&gt;(repeat from mail to BD and JK)&lt;/p&gt;

&lt;p&gt;In src/test/hbase-site.xml, it has following configuration:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
  &amp;lt;property&amp;gt;
    &amp;lt;name&amp;gt;hbase.regionserver.info.port&amp;lt;/name&amp;gt;
    &amp;lt;value&amp;gt;-1&amp;lt;/value&amp;gt;
    &amp;lt;description&amp;gt;The port &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; the hbase regionserver web UI
    Set to -1 &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; you &lt;span class=&quot;code-keyword&quot;&gt;do&lt;/span&gt; not want the info server to run.
    &amp;lt;/description&amp;gt;
  &amp;lt;/property&amp;gt;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;This is supposed to disable info servers for tests (only turned on explicitly for the test that tests info server).  Maybe its not working any more?&lt;/p&gt;</comment>
                            <comment id="12566709" author="jimk" created="Thu, 7 Feb 2008 17:40:03 +0000"  >&lt;p&gt;IIRC, both the master and the region servers (but maybe only the region servers - I&apos;ll check) are trying to start their http servers on the default port, meaning either they are not seeing the config setting or are broken in some other manner.&lt;/p&gt;

&lt;p&gt;That they could not was not an issue in the past because not being able to start the http server was not a fatal error (and if they really are supposed to, it should be a fatal error)&lt;/p&gt;</comment>
                            <comment id="12566751" author="bryanduxbury" created="Thu, 7 Feb 2008 19:35:23 +0000"  >&lt;p&gt;This needs to get done ASAP. It&apos;s adding 15 minutes to every test suite run, so let&apos;s get this knocked out.&lt;/p&gt;</comment>
                            <comment id="12566897" author="jimk" created="Fri, 8 Feb 2008 03:07:36 +0000"  >&lt;p&gt;Increase memory for tests, 256M may be too little&lt;/p&gt;</comment>
                            <comment id="12566908" author="bryanduxbury" created="Fri, 8 Feb 2008 04:02:23 +0000"  >&lt;p&gt;v2 patch passes everything. +1, let&apos;s commit.&lt;/p&gt;</comment>
                            <comment id="12566910" author="stack" created="Fri, 8 Feb 2008 04:27:51 +0000"  >&lt;p&gt;Marking this as an issue to backport to 0.1 branch&lt;/p&gt;</comment>
                            <comment id="12566914" author="jimk" created="Fri, 8 Feb 2008 04:58:57 +0000"  >&lt;p&gt;Committed to trunk. Still need to backport to 0.1.0&lt;/p&gt;</comment>
                            <comment id="12566935" author="jimk" created="Fri, 8 Feb 2008 06:45:33 +0000"  >&lt;p&gt;Committed to 0.2.0 and backported to 0.1.0&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12375033" name="patch.txt" size="3938" author="jimk" created="Fri, 8 Feb 2008 03:07:36 +0000"/>
                            <attachment id="12375029" name="patch.txt" size="3589" author="jimk" created="Fri, 8 Feb 2008 00:47:32 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Thu, 7 Feb 2008 17:31:51 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>25189</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            8 years, 44 weeks ago
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0h77j:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>98430</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        </customfields>
    </item>
</channel>
</rss>