<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Sat Dec 03 16:53:15 UTC 2016

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/HBASE-74/HBASE-74.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[HBASE-74] [performance] When a get or scan request spans multiple columns, execute the reads in parallel</title>
                <link>https://issues.apache.org/jira/browse/HBASE-74</link>
                <project id="12310753" key="HBASE">HBase</project>
                    <description>&lt;p&gt;When a get or scan request spans multiple columns, execute the reads in parallel and use a CountDownLatch to wait for them to complete before returning the results.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12380212">HBASE-74</key>
            <summary>[performance] When a get or scan request spans multiple columns, execute the reads in parallel</summary>
                <type id="4" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/improvement.png">Improvement</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.png">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="3">Duplicate</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="jimk">Jim Kellerman</reporter>
                        <labels>
                    </labels>
                <created>Fri, 12 Oct 2007 04:08:08 +0000</created>
                <updated>Wed, 16 Nov 2016 19:53:24 +0000</updated>
                            <resolved>Wed, 16 Nov 2016 19:53:23 +0000</resolved>
                                    <version>2.0.0</version>
                                                    <component>regionserver</component>
                        <due></due>
                            <votes>5</votes>
                                    <watches>14</watches>
                                                                <comments>
                            <comment id="12565524" author="bryanduxbury" created="Mon, 4 Feb 2008 20:58:37 +0000"  >&lt;p&gt;Has anyone tested something like this for performance? It might be a substantial boost.&lt;/p&gt;</comment>
                            <comment id="12642388" author="stack" created="Fri, 24 Oct 2008 05:32:29 +0000"  >&lt;p&gt;Putting into 0.19.  Might be easy to do.&lt;/p&gt;</comment>
                            <comment id="12643579" author="stack" created="Wed, 29 Oct 2008 18:28:23 +0000"  >&lt;p&gt;Moving out of 0.19.0.  Nice feature, but need to do a nice job on it (Eitan at pset can help with this).&lt;/p&gt;</comment>
                            <comment id="12664879" author="stack" created="Sat, 17 Jan 2009 23:06:19 +0000"  >&lt;p&gt;Upping priority because its performance.  If many families, this could help.  We need to talk to our Eitan.  He has written a paper on when to parallelize based on pset frontend experience.&lt;/p&gt;</comment>
                            <comment id="12694320" author="erikholstad@gmail.com" created="Tue, 31 Mar 2009 23:24:15 +0000"  >&lt;p&gt;When working on &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-1249&quot; title=&quot;Rearchitecting of server, client, API, key format, etc for 0.20&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-1249&quot;&gt;&lt;del&gt;HBASE-1249&lt;/del&gt;&lt;/a&gt; this thought came to my mind so I tried to design the new system so that it would be pretty easy to add this. &lt;br/&gt;
There are still a few things that need to be done to make this work properly and I haven&apos;t ran any test to see how much we would gain.&lt;/p&gt;


&lt;p&gt;For making things parallel there are a couple of places where that can be done.&lt;br/&gt;
If start query is a &lt;span class=&quot;error&quot;&gt;&amp;#91;Get&amp;#93;&lt;/span&gt; then we can make things in parallel in multiple places:&lt;br/&gt;
HRegionServer: Every get can be done in parallel.&lt;br/&gt;
HRegion : Every family in the get can be done in parallel&lt;br/&gt;
HStore : Every read from memCache + storefiles can be done in parallel.&lt;/p&gt;


&lt;p&gt;Starting at the bottom to support parallel computation of data.&lt;br/&gt;
HStore :&lt;br/&gt;
  So you have a nunch of lists that you need to compare, they are:&lt;br/&gt;
  1. Data list in sf, storefile&lt;br/&gt;
  2. The get list, with families and columns to look for&lt;br/&gt;
  3. The result&lt;br/&gt;
  4.  The deletes from previous sf&lt;br/&gt;
  5.  The deletes from this read.&lt;br/&gt;
  Data, get, result, oldDeletes, newDeletes.&lt;/p&gt;

&lt;p&gt;  With current layout where puts and deletes are mixed you can :&lt;br/&gt;
  1. Compare the data in the different sf with the get and create a list of&lt;br/&gt;
  candidates and a list of new deletes for that sf. The compare includes checks&lt;br/&gt;
  for TimeRange, TTL and number of versions.&lt;/p&gt;

&lt;p&gt;  2. Merge deletes one by one starting at memCache and moving down the sfs. For&lt;br/&gt;
  every merge you send that new delete list into the serverGet it belongs to and&lt;br/&gt;
  move on to the merge with next new delete list.&lt;/p&gt;

&lt;p&gt;  3. When all delete checks are done you are left with your candidate lists from&lt;br/&gt;
  all the sfs, they now needs to be merged and checked for number of versions.&lt;/p&gt;

&lt;p&gt;  So you have:&lt;br/&gt;
  1. GetCandidates and new deletes&lt;br/&gt;
  2. Merge deletes and check sgets towards the merged deletes&lt;br/&gt;
  3. Merge candidates&lt;/p&gt;


&lt;p&gt;  For parallel you have a list of sget with the same data, sgets&lt;/p&gt;

&lt;p&gt;  // This call can be threaded&lt;br/&gt;
  1. sget.createCandidates(List&amp;lt;KeyValue&amp;gt; data, boolean multiFamily)&lt;/p&gt;


&lt;p&gt;  2. for(int i=0; i&amp;lt;sgets.length; i++)&lt;/p&gt;
{
        oldDeletes = mergeDeletes(oldDeletes, sgets[i].getDeletes())
       
        // This call can be threaded
        sget[i].compareDeletes(oldDeletes)
     }

&lt;p&gt;  3. result = mergeCandidates(list&amp;lt;sget&amp;gt;)&lt;/p&gt;

&lt;p&gt;Doing this can probably increase speed for a lot of cases, but I think that it will have the biggest impact on the GetFamilies query, before getFull, since you for that query need to look in all the storefiles anyways, which might not be the case for other queries. &lt;/p&gt;

&lt;p&gt;I think that it would be too hard to thread the gets from different families, specially now that we don&apos;t need to sort the result on the client side but can just append it to the list.&lt;br/&gt;
Threading multiple gets shouldn&apos;t be too hard either.&lt;/p&gt;</comment>
                            <comment id="12701770" author="stack" created="Thu, 23 Apr 2009 00:55:13 +0000"  >&lt;p&gt;Moving it out (unless someone fixes it meantime).&lt;/p&gt;</comment>
                            <comment id="12772286" author="stack" created="Sat, 31 Oct 2009 21:12:12 +0000"  >&lt;p&gt;Just to say that some lads embedding hbase need this one bad; assigning myself.&lt;/p&gt;</comment>
                            <comment id="12796432" author="zlatinb" created="Mon, 4 Jan 2010 23:28:30 +0000"  >&lt;p&gt;&amp;gt; HRegionServer: Every get can be done in parallel.&lt;br/&gt;
&amp;gt; HRegion : Every family in the get can be done in parallel&lt;br/&gt;
&amp;gt; HStore : Every read from memCache + storefiles can be done in parallel.&lt;/p&gt;

&lt;p&gt;Since &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-1935&quot; title=&quot;Scan in parallel&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-1935&quot;&gt;HBASE-1935&lt;/a&gt; is addressing paralellism at HRegionServer level, is this issue going to tackle both HRegion and HStore levels?   &lt;/p&gt;</comment>
                            <comment id="12796441" author="stack" created="Mon, 4 Jan 2010 23:51:40 +0000"  >&lt;p&gt;@Zlatin Yes.  You&apos;ve scoped this issue well.&lt;/p&gt;</comment>
                            <comment id="12867058" author="streamy" created="Thu, 13 May 2010 05:29:02 +0000"  >&lt;p&gt;Performance, punting to 0.22, can bring it back if someone implements it&lt;/p&gt;</comment>
                            <comment id="12991290" author="larsgeorge" created="Mon, 7 Feb 2011 07:17:02 +0000"  >&lt;p&gt;Stack,&lt;/p&gt;

&lt;blockquote&gt;
&lt;p&gt;&amp;gt; HStore : Every read from memCache + storefiles can be done in parallel.&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;How is that going to work with the ScanQueryMatcher? I mean, the initial seek() I can understand, but then you have to scan the stores by age starting with the MemStore, moving to the on-disk Stores. How can we parallelize that? Just curious.&lt;/p&gt;</comment>
                            <comment id="12991485" author="stack" created="Mon, 7 Feb 2011 17:25:38 +0000"  >&lt;p&gt;@Lars Don&apos;t we do for (family: families) get/scan business now?   I was thinking if families &amp;gt; 1, then we&apos;d run the get/scan business each in its own thread.  When all threads were done we&apos;d have to aggregate the result before return?&lt;/p&gt;</comment>
                            <comment id="12991488" author="streamy" created="Mon, 7 Feb 2011 17:32:22 +0000"  >&lt;p&gt;You could potentially load the first block in each file in parallel.  With any kind of concurrency on the server, it&apos;s unclear to me that this would be a win though.&lt;/p&gt;

&lt;p&gt;Families in parallel seems reasonable as a configurable option, but again, under concurrency this parallelism will have diminishing returns.&lt;/p&gt;</comment>
                            <comment id="13009420" author="stack" created="Mon, 21 Mar 2011 21:58:35 +0000"  >&lt;p&gt;Moving down from critical for 0.92 to major.&lt;/p&gt;</comment>
                            <comment id="13047606" author="stack" created="Fri, 10 Jun 2011 22:46:03 +0000"  >&lt;p&gt;Moving out of 0.92.0. Pull it back in if you think different.&lt;/p&gt;</comment>
                            <comment id="13501677" author="otis" created="Wed, 21 Nov 2012 02:56:39 +0000"  >&lt;p&gt;Let&apos;s dig out this 5+ years old issue with last comment from 4.5+ years ago &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.gif&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;br/&gt;
Maybe this was actually implemented by now?&lt;/p&gt;</comment>
                            <comment id="13502381" author="sershe" created="Wed, 21 Nov 2012 22:28:04 +0000"  >&lt;p&gt;If not, &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-5416&quot; title=&quot;Filter on one CF and if a match, then load and return full row (WAS: Improve performance of scans with some kind of filters)&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-5416&quot;&gt;&lt;del&gt;HBASE-5416&lt;/del&gt;&lt;/a&gt; is in the same area/might be related&lt;/p&gt;</comment>
                            <comment id="13502398" author="stack" created="Wed, 21 Nov 2012 22:57:12 +0000"  >&lt;p&gt;To my knowledge, this issue has yet to be tackled.&lt;/p&gt;</comment>
                            <comment id="13503460" author="otis" created="Sun, 25 Nov 2012 05:26:37 +0000"  >&lt;p&gt;@stack &amp;amp; &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=sershe&quot; class=&quot;user-hover&quot; rel=&quot;sershe&quot;&gt;Sergey Shelukhin&lt;/a&gt; - thanks.  I linked &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-5416&quot; title=&quot;Filter on one CF and if a match, then load and return full row (WAS: Improve performance of scans with some kind of filters)&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-5416&quot;&gt;&lt;del&gt;HBASE-5416&lt;/del&gt;&lt;/a&gt;, but thought it would also be good to set Fix Version to 0.96 so this issue gets some visibility - seems popular in terms of votes and watchers and that &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-5416&quot; title=&quot;Filter on one CF and if a match, then load and return full row (WAS: Improve performance of scans with some kind of filters)&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-5416&quot;&gt;&lt;del&gt;HBASE-5416&lt;/del&gt;&lt;/a&gt; is also set for 0.96.  However, I don&apos;t seem to have enough HBase JIRA karma for this, so if you think setting Fix Version would make sense, could you please do it?&lt;/p&gt;
</comment>
                            <comment id="13503958" author="sershe" created="Mon, 26 Nov 2012 18:19:13 +0000"  >&lt;p&gt;Set. Thanks!&lt;/p&gt;</comment>
                            <comment id="13621611" author="stack" created="Thu, 4 Apr 2013 00:59:30 +0000"  >&lt;p&gt;Unassigned new feature moved out of 0.95&lt;/p&gt;</comment>
                            <comment id="13632620" author="anoop.hbase" created="Tue, 16 Apr 2013 06:21:57 +0000"  >&lt;p&gt;I remember this is done in Trunk as part of some other issue. Not remembering the issue id. &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=yuzhihong%40gmail.com&quot; class=&quot;user-hover&quot; rel=&quot;yuzhihong@gmail.com&quot;&gt;Ted Yu&lt;/a&gt; you know?  May be we can close this issue as duplicate now?&lt;/p&gt;</comment>
                            <comment id="15671430" author="stack" created="Wed, 16 Nov 2016 19:53:24 +0000"  >&lt;p&gt;Resolving as superceded by &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-1935&quot; title=&quot;Scan in parallel&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-1935&quot;&gt;HBASE-1935&lt;/a&gt;&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                                                <inwardlinks description="is related to">
                                        <issuelink>
            <issuekey id="12441379">HBASE-2002</issuekey>
        </issuelink>
            <issuelink>
            <issuekey id="12441373">HBASE-2000</issuekey>
        </issuelink>
            <issuelink>
            <issuekey id="12542919">HBASE-5416</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                            <issuelinktype id="10001">
                    <name>dependent</name>
                                                                <inwardlinks description="is depended upon by">
                                        <issuelink>
            <issuekey id="12421993">HBASE-1307</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Mon, 4 Feb 2008 20:58:37 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>31670</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            2 weeks, 2 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i02fi7:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>12113</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        </customfields>
    </item>
</channel>
</rss>