<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Fri Dec 02 19:32:09 UTC 2016

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/HBASE-1702/HBASE-1702.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[HBASE-1702] TestMergeUtil fails on trunk</title>
                <link>https://issues.apache.org/jira/browse/HBASE-1702</link>
                <project id="12310753" key="HBASE">HBase</project>
                    <description>&lt;p&gt;Last hudson reports a failed test on TestMergeUtil.  Same failure when run locally.&lt;/p&gt;

&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;junit.framework.AssertionFailedError: &apos;merging regions 0 and 1&apos; failed
	at org.apache.hadoop.hbase.util.TestMergeTool.mergeAndVerify(TestMergeTool.java:178)
	at org.apache.hadoop.hbase.util.TestMergeTool.testMergeTool(TestMergeTool.java:253)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</description>
                <environment></environment>
        <key id="12431382">HBASE-1702</key>
            <summary>TestMergeUtil fails on trunk</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/bug.png">Bug</type>
                                            <priority id="2" iconUrl="https://issues.apache.org/jira/images/icons/priorities/critical.png">Critical</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="streamy">Jonathan Gray</reporter>
                        <labels>
                    </labels>
                <created>Fri, 24 Jul 2009 16:58:46 +0000</created>
                <updated>Sun, 13 Sep 2009 22:24:52 +0000</updated>
                            <resolved>Sat, 25 Jul 2009 16:00:11 +0000</resolved>
                                    <version>0.20.0</version>
                                    <fixVersion>0.20.0</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                <comments>
                            <comment id="12735098" author="streamy" created="Fri, 24 Jul 2009 17:01:29 +0000"  >&lt;p&gt;There is an exception thrown that ROOT has been closed:&lt;/p&gt;

&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;2009-07-24 09:53:24,841 FATAL [main] util.Merge(112): Merge failed
java.io.IOException: Region -ROOT-,,0 closed
	at org.apache.hadoop.hbase.regionserver.HRegion.getScanner(HRegion.java:1073)
	at org.apache.hadoop.hbase.regionserver.HRegion.getScanner(HRegion.java:1066)
	at org.apache.hadoop.hbase.util.MetaUtils.scanMetaRegion(MetaUtils.java:209)
	at org.apache.hadoop.hbase.util.MetaUtils.scanRootRegion(MetaUtils.java:195)
	at org.apache.hadoop.hbase.util.Merge.mergeTwoRegions(Merge.java:241)
	at org.apache.hadoop.hbase.util.Merge.run(Merge.java:108)
	at org.apache.hadoop.util.ToolRunner.run(ToolRunner.java:65)
	at org.apache.hadoop.util.ToolRunner.run(ToolRunner.java:79)
	at org.apache.hadoop.hbase.util.TestMergeTool.mergeAndVerify(TestMergeTool.java:175)
	at org.apache.hadoop.hbase.util.TestMergeTool.testMergeTool(TestMergeTool.java:253)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)
	at java.lang.reflect.Method.invoke(Method.java:597)
	at junit.framework.TestCase.runTest(TestCase.java:154)
	at junit.framework.TestCase.runBare(TestCase.java:127)
	at junit.framework.TestResult$1.protect(TestResult.java:106)
	at junit.framework.TestResult.runProtected(TestResult.java:124)
	at junit.framework.TestResult.run(TestResult.java:109)
	at junit.framework.TestCase.run(TestCase.java:118)
	at junit.framework.TestSuite.runTest(TestSuite.java:208)
	at junit.framework.TestSuite.run(TestSuite.java:203)
	at org.eclipse.jdt.internal.junit.runner.junit3.JUnit3TestReference.run(JUnit3TestReference.java:130)
	at org.eclipse.jdt.internal.junit.runner.TestExecution.run(TestExecution.java:38)
	at org.eclipse.jdt.internal.junit.runner.RemoteTestRunner.runTests(RemoteTestRunner.java:460)
	at org.eclipse.jdt.internal.junit.runner.RemoteTestRunner.runTests(RemoteTestRunner.java:673)
	at org.eclipse.jdt.internal.junit.runner.RemoteTestRunner.run(RemoteTestRunner.java:386)
	at org.eclipse.jdt.internal.junit.runner.RemoteTestRunner.main(RemoteTestRunner.java:196)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Weird thing is, there are a number of successful merges prior to this failure.  But if you look above, ROOT was closed immediately after opening for some unknown reason:&lt;/p&gt;

&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;2009-07-24 09:53:23,060 DEBUG [main] regionserver.HRegion(1830): Opening region: REGION =&amp;gt; {NAME =&amp;gt; &apos;-ROOT-,,0&apos;, STARTKEY =&amp;gt; &apos;&apos;, ENDKEY =&amp;gt; &apos;&apos;, ENCODED =&amp;gt; 70236052, TABLE =&amp;gt; {{NAME =&amp;gt; &apos;-ROOT-&apos;, IS_ROOT =&amp;gt; &apos;true&apos;, IS_META =&amp;gt; &apos;true&apos;, MEMSTORE_FLUSHSIZE =&amp;gt; &apos;16384&apos;, FAMILIES =&amp;gt; [{NAME =&amp;gt; &apos;info&apos;, COMPRESSION =&amp;gt; &apos;NONE&apos;, VERSIONS =&amp;gt; &apos;10&apos;, TTL =&amp;gt; &apos;2147483647&apos;, BLOCKSIZE =&amp;gt; &apos;8192&apos;, IN_MEMORY =&amp;gt; &apos;false&apos;, BLOCKCACHE =&amp;gt; &apos;true&apos;}]}}
2009-07-24 09:53:23,060 DEBUG [main] regionserver.HRegion(265): Opening region -ROOT-,,0, encoded=70236052
2009-07-24 09:53:23,075 DEBUG [main] regionserver.Store(386): loaded /user/Administrator/-ROOT-/70236052/info/8350772430627555532, isReference=false, sequence id=2, length=840, majorCompaction=false
2009-07-24 09:53:23,075 INFO  [main] regionserver.HRegion(340): region -ROOT-,,0/70236052 available; sequence id is 3
2009-07-24 09:53:23,075 INFO  [main] regionserver.HRegion(770): Starting compaction on region -ROOT-,,0
2009-07-24 09:53:23,091 INFO  [main] regionserver.HRegion(785): compaction completed on region -ROOT-,,0 in 0sec
2009-07-24 09:53:23,138 DEBUG [main] regionserver.HRegion(451): Closing -ROOT-,,0: compactions &amp;amp; flushes disabled 
2009-07-24 09:53:23,138 DEBUG [main] regionserver.HRegion(468): Updates disabled for region, no outstanding scanners on -ROOT-,,0
2009-07-24 09:53:23,138 DEBUG [main] regionserver.HRegion(475): No more row locks outstanding on region -ROOT-,,0
2009-07-24 09:53:23,138 DEBUG [main] regionserver.Store(451): closed info
2009-07-24 09:53:23,138 INFO  [main] regionserver.HRegion(487): Closed -ROOT-,,0
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;And when we shutdown, we again see ROOT is already closed for some reason:&lt;/p&gt;

&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;2009-07-24 09:53:24,888 DEBUG [main] regionserver.HRegion(451): Closing .META.,,1: compactions &amp;amp; flushes disabled 
2009-07-24 09:53:24,888 DEBUG [main] regionserver.HRegion(468): Updates disabled for region, no outstanding scanners on .META.,,1
2009-07-24 09:53:24,888 DEBUG [main] regionserver.HRegion(475): No more row locks outstanding on region .META.,,1
2009-07-24 09:53:24,888 DEBUG [main] regionserver.Store(451): closed historian
2009-07-24 09:53:24,888 DEBUG [main] regionserver.Store(451): closed info
2009-07-24 09:53:24,888 INFO  [main] regionserver.HRegion(487): Closed .META.,,1
2009-07-24 09:53:24,888 WARN  [main] regionserver.HRegion(442): region -ROOT-,,0 already closed
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="12735292" author="stack" created="Sat, 25 Jul 2009 16:00:11 +0000"  >&lt;p&gt;I broke this as part of refactoring for hbase-1215 removing duplicated code in metautils.  Fix is simple:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
Index: src/java/org/apache/hadoop/hbase/util/MetaUtils.java
===================================================================
--- src/java/org/apache/hadoop/hbase/util/MetaUtils.java        (revision 797713)
+++ src/java/org/apache/hadoop/hbase/util/MetaUtils.java        (working copy)
@@ -228,7 +228,7 @@
         results.clear();
       } &lt;span class=&quot;code-keyword&quot;&gt;while&lt;/span&gt; (hasNext);
     } &lt;span class=&quot;code-keyword&quot;&gt;finally&lt;/span&gt; {
-      r.close();
+      s.close();
     }
   }
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Sat, 25 Jul 2009 16:00:11 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>25923</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            7 years, 19 weeks, 6 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0hes7:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>99657</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        </customfields>
    </item>
</channel>
</rss>