<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Fri Dec 02 19:22:05 UTC 2016

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/HBASE-776/HBASE-776.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[HBASE-776] Master not reassigning .META. from failed/failing regionserver</title>
                <link>https://issues.apache.org/jira/browse/HBASE-776</link>
                <project id="12310753" key="HBASE">HBase</project>
                    <description>&lt;p&gt;In our environment sometimes the regionserver carrying META is also assigned to the &apos;content&apos; table, into which objects retrieved from Internet crawling is stored. For unclear reason the regionserver occasionally goes &quot;deaf&quot; (seperate issue) and when this happens META is no longer available. The master then never reassigns META, so the whole cluster is down from this point and does not recover. Logs attached.&lt;/p&gt;</description>
                <environment>&lt;p&gt;CentOS x86_64, JDK 1.6, Hadoop 0.17.1, HBase 0.2.0, r679585, Fri Jul 25 16:47:26 UTC 2008&lt;/p&gt;</environment>
        <key id="12401055">HBASE-776</key>
            <summary>Master not reassigning .META. from failed/failing regionserver</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/bug.png">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.png">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="apurtell">Andrew Purtell</reporter>
                        <labels>
                    </labels>
                <created>Fri, 25 Jul 2008 21:02:36 +0000</created>
                <updated>Fri, 22 Aug 2008 21:13:21 +0000</updated>
                            <resolved>Tue, 5 Aug 2008 19:07:04 +0000</resolved>
                                    <version>0.2.0</version>
                                    <fixVersion>0.2.0</fixVersion>
                                    <component>master</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                <comments>
                            <comment id="12617062" author="apurtell" created="Fri, 25 Jul 2008 21:07:17 +0000"  >&lt;p&gt;There is no indication in the regionserver log why RPC becomes unresponsive. &lt;/p&gt;</comment>
                            <comment id="12617064" author="apurtell" created="Fri, 25 Jul 2008 21:09:21 +0000"  >&lt;p&gt;During the duration of this incident the regionserver in question was being pounded while the rest of the cluster was idle.  Wouldn&apos;t it make sense to migrate META from a heavily loaded regionserver if another is substantially less loaded in general? &lt;/p&gt;</comment>
                            <comment id="12617115" author="apurtell" created="Sat, 26 Jul 2008 02:30:13 +0000"  >&lt;p&gt;Is 200-500 requests for META per second is normal? The client code is reusing the same HTable object and is just using table.commit(BatchUpdate) to insert data imported from a Postgres DB. &lt;/p&gt;</comment>
                            <comment id="12617116" author="apurtell" created="Sat, 26 Jul 2008 02:35:47 +0000"  >&lt;p&gt;Just saw a period where a new steady state was reached with 1800-2000 requests for META per second. &lt;/p&gt;</comment>
                            <comment id="12617124" author="stack" created="Sat, 26 Jul 2008 05:13:44 +0000"  >&lt;p&gt;Andrew, can you run with DEBUG level logging &amp;#8211; we might get a clue why it goes &apos;deaf&apos; &amp;#8211; and can you up your ulimit for file descriptors from 1024 (because out-of-FDs can manifest in weird ways)?  See FAQ for how.&lt;/p&gt;

&lt;p&gt;A socket timeout when scanning meta should provoke relocation of meta I&apos;d say.  Need to dig more.  From your logs, it happens over and over and the master just sits there dumb.&lt;/p&gt;

&lt;p&gt;Regards pounding META, you&apos;d think the META info cached.  Let me do loading here and log the META region accesses.  How many clients you running?&lt;/p&gt;</comment>
                            <comment id="12617127" author="apurtell" created="Sat, 26 Jul 2008 06:12:10 +0000"  >&lt;p&gt;Ok, I&apos;ll up ulimit to 10K for the hadoop account and see what happens. Was already planning to sit down and try to produce a simple program that reproduces the problem reliably. If I can get something consistent I&apos;ll run in DEBUG and if it still triggers I&apos;ll upload the logs. Maybe I&apos;ll find the client is doing something dumb. However as I can see it is just one client with two threads doing nothing particularly odd or special. &lt;br/&gt;
The cluster configuration is 15 nodes:&lt;br/&gt;
    1 master/regionserver/namenode/datanode/jobtracker&lt;br/&gt;
    14 regionserver/datanode/tasktracker&lt;br/&gt;
Each node is dual processor 4 core Xeons with 8GB RAM. &lt;br/&gt;
The master node does not load up. &lt;br/&gt;
Client is external to the cluster. &lt;/p&gt;</comment>
                            <comment id="12617208" author="stack" created="Sat, 26 Jul 2008 19:44:29 +0000"  >&lt;p&gt;This exception of yours Andrew seems pretty easy to manufacture.  I see it here in a little test I&apos;m running.  Kept getting the exception over and over for 30 mins now.&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
2008-07-26 19:09:22,111 WARN org.apache.hadoop.hbase.master.BaseScanner: Scan one META region: {regionname: .META.,,1, startKey: &amp;lt;&amp;gt;, server: XX.XX.XX.XX:60020}
java.net.SocketTimeoutException: timed out waiting &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; rpc response
        at org.apache.hadoop.ipc.Client.call(Client.java:559)
        at org.apache.hadoop.hbase.ipc.HbaseRPC$Invoker.invoke(HbaseRPC.java:230)
        at $Proxy2.openScanner(Unknown Source)
        at org.apache.hadoop.hbase.master.BaseScanner.scanRegion(BaseScanner.java:159)
        at org.apache.hadoop.hbase.master.MetaScanner.scanOneMetaRegion(MetaScanner.java:69)
        at org.apache.hadoop.hbase.master.MetaScanner.maintenanceScan(MetaScanner.java:124)
        at org.apache.hadoop.hbase.master.BaseScanner.chore(BaseScanner.java:139)
        at org.apache.hadoop.hbase.Chore.run(Chore.java:63)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="12617212" author="stack" created="Sat, 26 Jul 2008 20:58:33 +0000"  >&lt;p&gt;Its looking like this is symptom of &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-751&quot; title=&quot;dfs exception and regionserver stuck during heavy write load&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-751&quot;&gt;&lt;del&gt;HBASE-751&lt;/del&gt;&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="12617375" author="apurtell" created="Mon, 28 Jul 2008 07:20:38 +0000"  >&lt;p&gt;The excessive queries to META was a client issue. Sorry for the noise. There was an existence test buried in some old code which created HBaseAdmin objects. It did apparently serve as a torture test, though. &lt;/p&gt;</comment>
                            <comment id="12620008" author="apurtell" created="Tue, 5 Aug 2008 19:07:04 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-751&quot; title=&quot;dfs exception and regionserver stuck during heavy write load&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-751&quot;&gt;&lt;del&gt;HBASE-751&lt;/del&gt;&lt;/a&gt; is supposed to contain fix. Will reopen if seen again. &lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12386922" name="hbase-hadoop-master-sjdc-atr-dc-1.log" size="266837" author="apurtell" created="Fri, 25 Jul 2008 21:02:56 +0000"/>
                            <attachment id="12386923" name="hbase-hadoop-regionserver-sjdc-atr-dc-13.log" size="49324" author="apurtell" created="Fri, 25 Jul 2008 21:03:13 +0000"/>
                            <attachment id="12386924" name="master_gui.png" size="49700" author="apurtell" created="Fri, 25 Jul 2008 21:03:30 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>3.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Sat, 26 Jul 2008 05:13:44 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>25394</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            8 years, 18 weeks, 3 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0h9dr:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>98782</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        </customfields>
    </item>
</channel>
</rss>