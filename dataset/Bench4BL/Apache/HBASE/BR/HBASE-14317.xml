<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Thu Dec 01 21:41:10 UTC 2016

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/HBASE-14317/HBASE-14317.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[HBASE-14317] Stuck FSHLog: bad disk (HDFS-8960) and can&apos;t roll WAL</title>
                <link>https://issues.apache.org/jira/browse/HBASE-14317</link>
                <project id="12310753" key="HBASE">HBase</project>
                    <description>&lt;p&gt;hbase-1.1.1 and hadoop-2.7.1&lt;/p&gt;

&lt;p&gt;We try to roll logs because can&apos;t append (See &lt;a href=&quot;https://issues.apache.org/jira/browse/HDFS-8960&quot; title=&quot;DFS client says &amp;quot;no more good datanodes being available to try&amp;quot; on a single drive failure&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HDFS-8960&quot;&gt;HDFS-8960&lt;/a&gt;) but we get stuck. See attached thread dump and associated log. What is interesting is that syncers are waiting to take syncs to run and at same time we want to flush so we are waiting on a safe point but there seems to be nothing in our ring buffer; did we go to roll log and not add safe point sync to clear out ringbuffer?&lt;/p&gt;

&lt;p&gt;Needs a bit of study. Try to reproduce.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12859403">HBASE-14317</key>
            <summary>Stuck FSHLog: bad disk (HDFS-8960) and can&apos;t roll WAL</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/bug.png">Bug</type>
                                            <priority id="1" iconUrl="https://issues.apache.org/jira/images/icons/priorities/blocker.png">Blocker</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="stack">stack</assignee>
                                    <reporter username="stack">stack</reporter>
                        <labels>
                    </labels>
                <created>Wed, 26 Aug 2015 18:46:09 +0000</created>
                <updated>Mon, 31 Oct 2016 02:23:38 +0000</updated>
                            <resolved>Mon, 7 Sep 2015 04:55:24 +0000</resolved>
                                    <version>1.2.0</version>
                    <version>1.1.1</version>
                                    <fixVersion>2.0.0</fixVersion>
                    <fixVersion>1.2.0</fixVersion>
                    <fixVersion>1.3.0</fixVersion>
                                    <component>wal</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>25</watches>
                                                                                                            <comments>
                            <comment id="14715324" author="stack" created="Wed, 26 Aug 2015 18:51:04 +0000"  >&lt;p&gt;Thread dump and subset of full RS log&lt;/p&gt;</comment>
                            <comment id="14715325" author="stack" created="Wed, 26 Aug 2015 18:52:41 +0000"  >&lt;p&gt;Raw Thread Dump&lt;/p&gt;</comment>
                            <comment id="14715328" author="stack" created="Wed, 26 Aug 2015 18:54:09 +0000"  >&lt;p&gt;Is the concurrent shutting of regions which are waiting on safe point:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
&lt;span class=&quot;code-quote&quot;&gt;&quot;RS_CLOSE_REGION-r12s16:9104-1&quot;&lt;/span&gt; #33639 prio=5 os_prio=0 tid=0x00007fbf546fe000 nid=0x563 in &lt;span class=&quot;code-object&quot;&gt;Object&lt;/span&gt;.wait() [0x00007fbf38107000]
   java.lang.&lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;.State: WAITING (on object monitor)
	at java.lang.&lt;span class=&quot;code-object&quot;&gt;Object&lt;/span&gt;.wait(Native Method)
	at java.lang.&lt;span class=&quot;code-object&quot;&gt;Object&lt;/span&gt;.wait(&lt;span class=&quot;code-object&quot;&gt;Object&lt;/span&gt;.java:502)
	at org.apache.hadoop.hbase.regionserver.HRegion.waitForFlushesAndCompactions(HRegion.java:1512)
	- locked &amp;lt;0x000000056baa4888&amp;gt; (a org.apache.hadoop.hbase.regionserver.HRegion$WriteState)
	at org.apache.hadoop.hbase.regionserver.HRegion.doClose(HRegion.java:1371)
	- locked &amp;lt;0x000000056baa4888&amp;gt; (a org.apache.hadoop.hbase.regionserver.HRegion$WriteState)
	at org.apache.hadoop.hbase.regionserver.HRegion.close(HRegion.java:1336)
	- locked &amp;lt;0x000000056baaf928&amp;gt; (a java.lang.&lt;span class=&quot;code-object&quot;&gt;Object&lt;/span&gt;)
	at org.apache.hadoop.hbase.regionserver.handler.CloseRegionHandler.process(CloseRegionHandler.java:138)
	at org.apache.hadoop.hbase.executor.EventHandler.run(EventHandler.java:128)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617)
	at java.lang.&lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;.run(&lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;.java:745)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;... and then the FATAL roll of logs happening at same time the issue? Dig.&lt;/p&gt;</comment>
                            <comment id="14716911" author="stack" created="Thu, 27 Aug 2015 15:54:41 +0000"  >&lt;p&gt;Making critical. In this case all app servers were blocked because they could not write to the regions hosted on this server.&lt;/p&gt;</comment>
                            <comment id="14717302" author="eclark" created="Thu, 27 Aug 2015 18:55:28 +0000"  >&lt;p&gt;Just saw something very like this too. Flushes are waiting on getting a committed seq then failing.&lt;br/&gt;
The append thread is just stuck.&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
&lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt; 125 (regionserver/hbase4537.frc3.facebook.com/10.210.81.27:16020.append-pool1-t1):
  State: TIMED_WAITING
  Blocked count: 239951
  Waited count: 37873297
  Stack:
    java.lang.&lt;span class=&quot;code-object&quot;&gt;Object&lt;/span&gt;.wait(Native Method)
    java.lang.&lt;span class=&quot;code-object&quot;&gt;Object&lt;/span&gt;.wait(&lt;span class=&quot;code-object&quot;&gt;Object&lt;/span&gt;.java:460)
    org.apache.hadoop.hbase.regionserver.wal.FSHLog$RingBufferEventHandler.attainSafePoint(FSHLog.java:1786)
    org.apache.hadoop.hbase.regionserver.wal.FSHLog$RingBufferEventHandler.onEvent(FSHLog.java:1761)
    org.apache.hadoop.hbase.regionserver.wal.FSHLog$RingBufferEventHandler.onEvent(FSHLog.java:1672)
    com.lmax.disruptor.BatchEventProcessor.run(BatchEventProcessor.java:128)
    java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142)
    java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617)
    java.lang.&lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;.run(&lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;.java:745)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="14717330" author="stack" created="Thu, 27 Aug 2015 19:05:39 +0000"  >&lt;p&gt;Are you seeing the companion no-pipeline-recovery &lt;a href=&quot;https://issues.apache.org/jira/browse/HDFS-8960&quot; title=&quot;DFS client says &amp;quot;no more good datanodes being available to try&amp;quot; on a single drive failure&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HDFS-8960&quot;&gt;HDFS-8960&lt;/a&gt;? You running hadoop 2.7.1? &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=eclark&quot; class=&quot;user-hover&quot; rel=&quot;eclark&quot;&gt;Elliott Clark&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="14717332" author="eclark" created="Thu, 27 Aug 2015 19:06:44 +0000"  >&lt;p&gt;Nope I&apos;m on 2.6.0.&lt;/p&gt;</comment>
                            <comment id="14717335" author="eclark" created="Thu, 27 Aug 2015 19:10:29 +0000"  >&lt;p&gt;The easiest thing that I see is to time out waiting on attain safepoint. However it would be nice to know how that got lost.&lt;/p&gt;</comment>
                            <comment id="14717381" author="stack" created="Thu, 27 Aug 2015 19:41:54 +0000"  >&lt;p&gt;Anything in logs showing how we might have skipped out in an unorthodox manner? In the original case, no progress because dfsclient stuck... no timeout. Perhaps that the case here but more likely we exited where we shouldn&apos;t have. &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=eclark&quot; class=&quot;user-hover&quot; rel=&quot;eclark&quot;&gt;Elliott Clark&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="14717400" author="eclark" created="Thu, 27 Aug 2015 19:54:49 +0000"  >&lt;p&gt;About an hour before I know that everything was locked up I see this:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
15/08/27 02:53:18 WARN wal.FSHLog: Could not append. Requesting close of wal
java.net.SocketTimeoutException: 70000 millis timeout &lt;span class=&quot;code-keyword&quot;&gt;while&lt;/span&gt; waiting &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; channel to be ready &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; read. ch : java.nio.channels.SocketChannel[connected local=/10.210.81.27:60319 remote=/10.210.81.27:50010]
        at org.apache.hadoop.net.SocketIOWithTimeout.doIO(SocketIOWithTimeout.java:164)
        at org.apache.hadoop.net.SocketInputStream.read(SocketInputStream.java:161)
        at org.apache.hadoop.net.SocketInputStream.read(SocketInputStream.java:131)
        at org.apache.hadoop.net.SocketInputStream.read(SocketInputStream.java:118)
        at java.io.FilterInputStream.read(FilterInputStream.java:83)
        at java.io.FilterInputStream.read(FilterInputStream.java:83)
        at org.apache.hadoop.hdfs.protocolPB.PBHelper.vintPrefixed(PBHelper.java:2201)
        at org.apache.hadoop.hdfs.DFSOutputStream$DataStreamer.transfer(DFSOutputStream.java:1142)
        at org.apache.hadoop.hdfs.DFSOutputStream$DataStreamer.addDatanode2ExistingPipeline(DFSOutputStream.java:1112)
        at org.apache.hadoop.hdfs.DFSOutputStream$DataStreamer.setupPipelineForAppendOrRecovery(DFSOutputStream.java:1253)
        at org.apache.hadoop.hdfs.DFSOutputStream$DataStreamer.processDatanodeError(DFSOutputStream.java:1004)
        at org.apache.hadoop.hdfs.DFSOutputStream$DataStreamer.run(DFSOutputStream.java:548)
15/08/27 02:53:18 ERROR wal.FSHLog: Error syncing, request close of wal
java.net.SocketTimeoutException: 70000 millis timeout &lt;span class=&quot;code-keyword&quot;&gt;while&lt;/span&gt; waiting &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; channel to be ready &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; read. ch : java.nio.channels.SocketChannel[connected local=/10.210.81.27:60319 remote=/10.210.81.27:50010]
        at org.apache.hadoop.net.SocketIOWithTimeout.doIO(SocketIOWithTimeout.java:164)
        at org.apache.hadoop.net.SocketInputStream.read(SocketInputStream.java:161)
        at org.apache.hadoop.net.SocketInputStream.read(SocketInputStream.java:131)
        at org.apache.hadoop.net.SocketInputStream.read(SocketInputStream.java:118)
        at java.io.FilterInputStream.read(FilterInputStream.java:83)
        at java.io.FilterInputStream.read(FilterInputStream.java:83)
        at org.apache.hadoop.hdfs.protocolPB.PBHelper.vintPrefixed(PBHelper.java:2201)
        at org.apache.hadoop.hdfs.DFSOutputStream$DataStreamer.transfer(DFSOutputStream.java:1142)
        at org.apache.hadoop.hdfs.DFSOutputStream$DataStreamer.addDatanode2ExistingPipeline(DFSOutputStream.java:1112)
        at org.apache.hadoop.hdfs.DFSOutputStream$DataStreamer.setupPipelineForAppendOrRecovery(DFSOutputStream.java:1253)
        at org.apache.hadoop.hdfs.DFSOutputStream$DataStreamer.processDatanodeError(DFSOutputStream.java:1004)
        at org.apache.hadoop.hdfs.DFSOutputStream$DataStreamer.run(DFSOutputStream.java:548)
15/08/27 02:53:18 WARN wal.FSHLog: Could not append. Requesting close of wal
java.net.SocketTimeoutException: 70000 millis timeout &lt;span class=&quot;code-keyword&quot;&gt;while&lt;/span&gt; waiting &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; channel to be ready &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; read. ch : java.nio.channels.SocketChannel[connected local=/10.210.81.27:60319 remote=/10.210.81.27:50010]
        at org.apache.hadoop.net.SocketIOWithTimeout.doIO(SocketIOWithTimeout.java:164)
        at org.apache.hadoop.net.SocketInputStream.read(SocketInputStream.java:161)
        at org.apache.hadoop.net.SocketInputStream.read(SocketInputStream.java:131)
        at org.apache.hadoop.net.SocketInputStream.read(SocketInputStream.java:118)
        at java.io.FilterInputStream.read(FilterInputStream.java:83)
        at java.io.FilterInputStream.read(FilterInputStream.java:83)
        at org.apache.hadoop.hdfs.protocolPB.PBHelper.vintPrefixed(PBHelper.java:2201)
        at org.apache.hadoop.hdfs.DFSOutputStream$DataStreamer.transfer(DFSOutputStream.java:1142)
        at org.apache.hadoop.hdfs.DFSOutputStream$DataStreamer.addDatanode2ExistingPipeline(DFSOutputStream.java:1112)
        at org.apache.hadoop.hdfs.DFSOutputStream$DataStreamer.setupPipelineForAppendOrRecovery(DFSOutputStream.java:1253)
        at org.apache.hadoop.hdfs.DFSOutputStream$DataStreamer.processDatanodeError(DFSOutputStream.java:1004)
        at org.apache.hadoop.hdfs.DFSOutputStream$DataStreamer.run(DFSOutputStream.java:548)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Where append and sync errors are repeated several times.&lt;/p&gt;

</comment>
                            <comment id="14717409" author="eclark" created="Thu, 27 Aug 2015 19:59:29 +0000"  >&lt;p&gt;Around the same time that is happening on the regionserver I see this on the datanode:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
15/08/27 02:19:24 ERROR datanode.DataNode: hbase4537:50010:DataXceiver error processing WRITE_BLOCK operation  src: /10.210.81.27:45576 dst: /10.210.81.27:50010
java.io.IOException: Premature EOF from inputStream
	at org.apache.hadoop.io.IOUtils.readFully(IOUtils.java:194)
	at org.apache.hadoop.hdfs.protocol.datatransfer.PacketReceiver.doReadFully(PacketReceiver.java:213)
	at org.apache.hadoop.hdfs.protocol.datatransfer.PacketReceiver.doRead(PacketReceiver.java:134)
	at org.apache.hadoop.hdfs.protocol.datatransfer.PacketReceiver.receiveNextPacket(PacketReceiver.java:109)
	at org.apache.hadoop.hdfs.server.datanode.BlockReceiver.receivePacket(BlockReceiver.java:467)
	at org.apache.hadoop.hdfs.server.datanode.BlockReceiver.receiveBlock(BlockReceiver.java:781)
	at org.apache.hadoop.hdfs.server.datanode.DataXceiver.writeBlock(DataXceiver.java:730)
	at org.apache.hadoop.hdfs.protocol.datatransfer.Receiver.opWriteBlock(Receiver.java:137)
	at org.apache.hadoop.hdfs.protocol.datatransfer.Receiver.processOp(Receiver.java:74)
	at org.apache.hadoop.hdfs.server.datanode.DataXceiver.run(DataXceiver.java:235)
	at java.lang.&lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;.run(&lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;.java:745)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="14717740" author="eclark" created="Thu, 27 Aug 2015 23:15:01 +0000"  >&lt;p&gt;Here&apos;s my first thought for a work around until we have a better handle on what&apos;s not working.&lt;/p&gt;</comment>
                            <comment id="14717769" author="stack" created="Thu, 27 Aug 2015 23:46:03 +0000"  >&lt;p&gt;That patch don&apos;t look bad to me.  Usually we just return immediately out of the wait on safe point so we won&apos;t be doing all the currentTimeMillis calls all the time, only when we waiting on safe point.&lt;/p&gt;</comment>
                            <comment id="14717810" author="eclark" created="Fri, 28 Aug 2015 00:09:16 +0000"  >&lt;p&gt;Yeah the actual patch isn&apos;t too bad. I just hope that it doesn&apos;t obscure the reason why we&apos;re getting stuck.&lt;/p&gt;</comment>
                            <comment id="14717946" author="hadoopqa" created="Fri, 28 Aug 2015 02:36:40 +0000"  >&lt;p&gt;&lt;font color=&quot;red&quot;&gt;-1 overall&lt;/font&gt;.  Here are the results of testing the latest attachment &lt;br/&gt;
  &lt;a href=&quot;http://issues.apache.org/jira/secure/attachment/12752894/HBASE-14317.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/secure/attachment/12752894/HBASE-14317.patch&lt;/a&gt;&lt;br/&gt;
  against master branch at commit cc1542828de93b8d54cc14497fd5937989ea1b6d.&lt;br/&gt;
  ATTACHMENT ID: 12752894&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 @author&lt;/font&gt;.  The patch does not contain any @author tags.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;red&quot;&gt;-1 tests included&lt;/font&gt;.  The patch doesn&apos;t appear to include any new or modified tests.&lt;br/&gt;
                        Please justify why no new tests are needed for this patch.&lt;br/&gt;
                        Also please list what manual steps were performed to verify this patch.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 hadoop versions&lt;/font&gt;. The patch compiles with all supported hadoop versions (2.4.0 2.4.1 2.5.0 2.5.1 2.5.2 2.6.0 2.7.0 2.7.1)&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 javac&lt;/font&gt;.  The applied patch does not increase the total number of javac compiler warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 protoc&lt;/font&gt;.  The applied patch does not increase the total number of protoc compiler warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 javadoc&lt;/font&gt;.  The javadoc tool did not generate any warning messages.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 checkstyle&lt;/font&gt;.  The applied patch does not increase the total number of checkstyle errors&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 findbugs&lt;/font&gt;.  The patch does not introduce any  new Findbugs (version 2.0.3) warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 release audit&lt;/font&gt;.  The applied patch does not increase the total number of release audit warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 lineLengths&lt;/font&gt;.  The patch does not introduce lines longer than 100&lt;/p&gt;

&lt;p&gt;  &lt;font color=&quot;green&quot;&gt;+1 site&lt;/font&gt;.  The mvn post-site goal succeeds with this patch.&lt;/p&gt;

&lt;p&gt;     &lt;font color=&quot;red&quot;&gt;-1 core tests&lt;/font&gt;.  The patch failed these unit tests:&lt;br/&gt;
                       org.apache.hadoop.hbase.snapshot.TestSecureExportSnapshot&lt;/p&gt;

&lt;p&gt;     &lt;font color=&quot;red&quot;&gt;-1 core zombie tests&lt;/font&gt;.  There are 8 zombie test(s): 	at org.apache.hadoop.hbase.mapreduce.TestLoadIncrementalHFiles.testTableWithCFNameStartWithUnderScore(TestLoadIncrementalHFiles.java:530)&lt;br/&gt;
	at org.apache.hadoop.hbase.mapreduce.TestLoadIncrementalHFiles.testNonHfileFolder(TestLoadIncrementalHFiles.java:344)&lt;br/&gt;
	at org.apache.hadoop.hbase.mapreduce.TestLoadIncrementalHFiles.testNonHfileFolderWithUnmatchedFamilyName(TestLoadIncrementalHFiles.java:312)&lt;br/&gt;
	at org.apache.hadoop.hbase.mapreduce.TestLoadIncrementalHFiles.testNonexistentColumnFamilyLoad(TestLoadIncrementalHFiles.java:298)&lt;br/&gt;
	at org.apache.hadoop.hbase.mapreduce.TestLoadIncrementalHFiles.testRegionCrossingHFileSplit(TestLoadIncrementalHFiles.java:193)&lt;br/&gt;
	at org.apache.hadoop.hbase.mapreduce.TestLoadIncrementalHFiles.testRegionCrossingHFileSplitRowColBloom(TestLoadIncrementalHFiles.java:189)&lt;br/&gt;
	at org.apache.hadoop.hbase.mapreduce.TestLoadIncrementalHFiles.testRegionCrossingRowColBloom(TestLoadIncrementalHFiles.java:140)&lt;br/&gt;
	at org.apache.hadoop.hbase.mapreduce.TestLoadIncrementalHFiles.testRegionCrossingRowBloom(TestLoadIncrementalHFiles.java:128)&lt;br/&gt;
	at org.apache.hadoop.hbase.mapreduce.TestLoadIncrementalHFiles.testWithoutAnExistingTableAndCreateTableSetToNo(TestLoadIncrementalHFiles.java:515)&lt;br/&gt;
	at org.apache.hadoop.hbase.security.access.TestAccessController2.testCreateWithCorrectOwner(TestAccessController2.java:177)&lt;/p&gt;

&lt;p&gt;Test results: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/15310//testReport/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/15310//testReport/&lt;/a&gt;&lt;br/&gt;
Release Findbugs (version 2.0.3) 	warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/15310//artifact/patchprocess/newFindbugsWarnings.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/15310//artifact/patchprocess/newFindbugsWarnings.html&lt;/a&gt;&lt;br/&gt;
Checkstyle Errors: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/15310//artifact/patchprocess/checkstyle-aggregate.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/15310//artifact/patchprocess/checkstyle-aggregate.html&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;  Console output: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/15310//console&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/15310//console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="14718051" author="stack" created="Fri, 28 Aug 2015 04:39:37 +0000"  >&lt;p&gt;This is from the attached log from original complaint:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
2015-08-23 07:22:26,060 FATAL [regionserver/r12s16.sjc.aristanetworks.com/172.24.32.16:9104.append-pool1-t1] wal.FSHLog: Could not append. Requesting close of wal
java.io.IOException: Failed to replace a bad datanode on the existing pipeline due to no more good datanodes being available to &lt;span class=&quot;code-keyword&quot;&gt;try&lt;/span&gt;. (Nodes: current=[172.24.32.16:10110, 172.24.32.13:10110], original=[172.24.32.16:10110, 172.24.32.13:10110]). The current failed datanode replacement policy is DEFAULT, and a client may configure &lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt; via &apos;dfs.client.block.write.replace-datanode-on-failure.policy&apos; in its configuration.
	at org.apache.hadoop.hdfs.DFSOutputStream$DataStreamer.findNewDatanode(DFSOutputStream.java:969)
	at org.apache.hadoop.hdfs.DFSOutputStream$DataStreamer.addDatanode2ExistingPipeline(DFSOutputStream.java:1035)
	at org.apache.hadoop.hdfs.DFSOutputStream$DataStreamer.setupPipelineForAppendOrRecovery(DFSOutputStream.java:1184)
	at org.apache.hadoop.hdfs.DFSOutputStream$DataStreamer.processDatanodeError(DFSOutputStream.java:933)
	at org.apache.hadoop.hdfs.DFSOutputStream$DataStreamer.run(DFSOutputStream.java:487)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;it looks like yours in that the complaint is that we cannot append.&lt;/p&gt;

&lt;p&gt;If I manufacture a failed append, I can get a hang. It is this logic in the finally for HRegion#doMiniBatchMutation .. and probably in all other places we do the append/sync dance. At the end of step 5, we do the WAL append and if we get an IOE, which is what you have pasted and is what we have in original complaint&apos;s log, then we go to the finally:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
    } &lt;span class=&quot;code-keyword&quot;&gt;finally&lt;/span&gt; {
      &lt;span class=&quot;code-comment&quot;&gt;// &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; the wal sync was unsuccessful, remove keys from memstore
&lt;/span&gt;      &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (doRollBackMemstore) {
        rollbackMemstore(memstoreCells);
      }
      &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (w != &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;) {
        mvcc.completeMemstoreInsertWithSeqNum(w, walKey);
      }
...
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;The rollback of edits if fine but w is not null in the above and we go to complete the insert in mvcc and inside here, we ask the walKey for its sequenceid... which is assigned AFTER we append ... only the append failed.  So we wait...&lt;/p&gt;

&lt;p&gt;Let me look a bit more.&lt;/p&gt;

&lt;p&gt;I think your patch would break a wait on safe point but am not sure it would unblock all threads. Let me try and manufacture safepoint waiters too.  Will be back.&lt;/p&gt;




</comment>
                            <comment id="14721130" author="stack" created="Sat, 29 Aug 2015 14:51:51 +0000"  >&lt;p&gt;Test that comes close to reproducing the original lockup but not there yet. Will be back.&lt;/p&gt;</comment>
                            <comment id="14721134" author="hadoopqa" created="Sat, 29 Aug 2015 15:00:37 +0000"  >&lt;p&gt;&lt;font color=&quot;red&quot;&gt;-1 overall&lt;/font&gt;.  Here are the results of testing the latest attachment &lt;br/&gt;
  &lt;a href=&quot;http://issues.apache.org/jira/secure/attachment/12753138/14317.test.txt&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/secure/attachment/12753138/14317.test.txt&lt;/a&gt;&lt;br/&gt;
  against master branch at commit 4256128fa248b31c0482bdfc2510011771f84037.&lt;br/&gt;
  ATTACHMENT ID: 12753138&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 @author&lt;/font&gt;.  The patch does not contain any @author tags.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 tests included&lt;/font&gt;.  The patch appears to include 9 new or modified tests.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;red&quot;&gt;-1 patch&lt;/font&gt;.  The patch command could not apply the patch.&lt;/p&gt;

&lt;p&gt;Console output: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/15324//console&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/15324//console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="14721199" author="eclark" created="Sat, 29 Aug 2015 18:17:36 +0000"  >&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
15/08/29 11:02:00 FATAL wal.FSHLog: Waited too &lt;span class=&quot;code-object&quot;&gt;long&lt;/span&gt; in attainSafePoint. Waiting to get to seqId=36243253 However we are only at seqId=36243210 after waiting 60000
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Just had this happen. Here&apos;s the log if it helps. There were way more than just one seqid that was stuck.&lt;/p&gt;</comment>
                            <comment id="14721201" author="stack" created="Sat, 29 Aug 2015 18:25:24 +0000"  >&lt;p&gt;You have &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-13971&quot; title=&quot;Flushes stuck since 6 hours on a regionserver.&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-13971&quot;&gt;&lt;del&gt;HBASE-13971&lt;/del&gt;&lt;/a&gt; &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=eclark&quot; class=&quot;user-hover&quot; rel=&quot;eclark&quot;&gt;Elliott Clark&lt;/a&gt; ? You are on 1.2? It went in here:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
Author: tedyu &amp;lt;yuzhihong@gmail.com&amp;gt;
Date:   Thu Jul 16 16:45:24 2015 -0700

    HBASE-13971 Flushes stuck since 6 hours on a regionserver

commit 2862d68470c546de2a560e8ca2b96d080c50c234
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;It&apos;d be interesting to know if it is in place on your rig. It may have fired but you are still stuck because root cause not addressed. If you do not have it, maybe it would have been enough. Thanks.&lt;/p&gt;</comment>
                            <comment id="14721223" author="stack" created="Sat, 29 Aug 2015 19:10:59 +0000"  >&lt;p&gt;The ringbuffer processor is blocked waiting on outstanding syncs to come in&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
&lt;span class=&quot;code-quote&quot;&gt;&quot;regionserver/r12s16.sjc.aristanetworks.com/172.24.32.16:9104.append-pool1-t1&quot;&lt;/span&gt; #140 prio=5 os_prio=0 tid=0x00007fbf5cc61800 nid=0xb2 in &lt;span class=&quot;code-object&quot;&gt;Object&lt;/span&gt;.wait() [0x00007fbf3a115000]
   java.lang.&lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;.State: TIMED_WAITING (on object monitor)
	at java.lang.&lt;span class=&quot;code-object&quot;&gt;Object&lt;/span&gt;.wait(Native Method)
	at java.lang.&lt;span class=&quot;code-object&quot;&gt;Object&lt;/span&gt;.wait(&lt;span class=&quot;code-object&quot;&gt;Object&lt;/span&gt;.java:460)
	at org.apache.hadoop.hbase.regionserver.wal.FSHLog$RingBufferEventHandler.attainSafePoint(FSHLog.java:2024)
	- locked &amp;lt;0x0000000548756b60&amp;gt; (a java.lang.&lt;span class=&quot;code-object&quot;&gt;Object&lt;/span&gt;)
	at org.apache.hadoop.hbase.regionserver.wal.FSHLog$RingBufferEventHandler.onEvent(FSHLog.java:1999)
	at org.apache.hadoop.hbase.regionserver.wal.FSHLog$RingBufferEventHandler.onEvent(FSHLog.java:1910)
	at com.lmax.disruptor.BatchEventProcessor.run(BatchEventProcessor.java:128)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617)
	at java.lang.&lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;.run(&lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;.java:745)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;All processing of the ringbuffer is held up until we attain safe point &amp;#8211; i.e. all syncers must come home (This is by design &amp;#8211; we are trying to roll logs so no more edits allowed in). Same &apos;hang&apos; is to be found over in &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-13974&quot; title=&quot;TestRateLimiter#testFixedIntervalResourceAvailability may fail&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-13974&quot;&gt;&lt;del&gt;HBASE-13974&lt;/del&gt;&lt;/a&gt; looking in its jstack1.txt. The &apos;fix&apos; over in &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-13974&quot; title=&quot;TestRateLimiter#testFixedIntervalResourceAvailability may fail&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-13974&quot;&gt;&lt;del&gt;HBASE-13974&lt;/del&gt;&lt;/a&gt; releases threads that are waiting on their sequenceid to come home; they are in the ring buffer behind the current point-of-processing/blockage. It looks like the blockage would persist after &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-13974&quot; title=&quot;TestRateLimiter#testFixedIntervalResourceAvailability may fail&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-13974&quot;&gt;&lt;del&gt;HBASE-13974&lt;/del&gt;&lt;/a&gt; timeout &apos;fires&apos;. The &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=eclark&quot; class=&quot;user-hover&quot; rel=&quot;eclark&quot;&gt;Elliott Clark&lt;/a&gt; patch attached here where we timeout the root block would be a better workaround IMO till proper fix.&lt;/p&gt;

&lt;p&gt;Still at trying to manufacture the block &apos;naturally&apos;.&lt;/p&gt;</comment>
                            <comment id="14721232" author="eclark" created="Sat, 29 Aug 2015 19:47:40 +0000"  >&lt;p&gt;Dump of the last lockup I saw before applying the workaround.&lt;/p&gt;</comment>
                            <comment id="14721233" author="hadoopqa" created="Sat, 29 Aug 2015 19:50:38 +0000"  >&lt;p&gt;&lt;font color=&quot;red&quot;&gt;-1 overall&lt;/font&gt;.  Here are the results of testing the latest attachment &lt;br/&gt;
  &lt;a href=&quot;http://issues.apache.org/jira/secure/attachment/12753148/san_dump.txt&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/secure/attachment/12753148/san_dump.txt&lt;/a&gt;&lt;br/&gt;
  against master branch at commit 4256128fa248b31c0482bdfc2510011771f84037.&lt;br/&gt;
  ATTACHMENT ID: 12753148&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 @author&lt;/font&gt;.  The patch does not contain any @author tags.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+0 tests included&lt;/font&gt;.  The patch appears to be a documentation, build,&lt;br/&gt;
                        or dev-support patch that doesn&apos;t require tests.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;red&quot;&gt;-1 patch&lt;/font&gt;.  The patch command could not apply the patch.&lt;/p&gt;

&lt;p&gt;Console output: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/15327//console&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/15327//console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="14721234" author="eclark" created="Sat, 29 Aug 2015 19:53:16 +0000"  >&lt;p&gt;The SyncRunners are waiting on new work to process. &lt;br/&gt;
The log roller is waiting on getting to the sequence number.&lt;/p&gt;

&lt;p&gt;It looks like somewhere in between getting the sequence numbers assigned and queueing the syncs something is erroring out and we&apos;re not handling it correctly.&lt;/p&gt;</comment>
                            <comment id="14723907" author="eclark" created="Mon, 31 Aug 2015 19:30:35 +0000"  >&lt;p&gt;here&apos;s the test I ran. when running that no IOE is thrown.&lt;/p&gt;</comment>
                            <comment id="14723993" author="eclark" created="Mon, 31 Aug 2015 20:33:26 +0000"  >&lt;p&gt;Patch that at least fails the put on append erroring and sync not erroring.&lt;/p&gt;</comment>
                            <comment id="14724013" author="stack" created="Mon, 31 Aug 2015 20:51:26 +0000"  >&lt;p&gt;This is the new bit in your patch:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
1705	      &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; (&lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt; i = 0; i &amp;lt; syncFutures.length; i++) {
1706	        &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (syncFutures[i] != &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;) {
1707	          &lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt;.syncFutures[i].done(sequence, e);
1708	        }
1709	      }
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;... running through all possible syncfutures though it is as many futures as there are handlers?  You thinking we&apos;ve just put a syncfuture in but have not updated the count of futures? Is that possible since it single thread doing syncfutures addition and count increment?&lt;/p&gt;</comment>
                            <comment id="14724103" author="hadoopqa" created="Mon, 31 Aug 2015 21:45:17 +0000"  >&lt;p&gt;&lt;font color=&quot;red&quot;&gt;-1 overall&lt;/font&gt;.  Here are the results of testing the latest attachment &lt;br/&gt;
  &lt;a href=&quot;http://issues.apache.org/jira/secure/attachment/12753362/append-only-test.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/secure/attachment/12753362/append-only-test.patch&lt;/a&gt;&lt;br/&gt;
  against master branch at commit 498c1845ab7b01710955153c27501fdc7492849d.&lt;br/&gt;
  ATTACHMENT ID: 12753362&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 @author&lt;/font&gt;.  The patch does not contain any @author tags.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 tests included&lt;/font&gt;.  The patch appears to include 8 new or modified tests.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 hadoop versions&lt;/font&gt;. The patch compiles with all supported hadoop versions (2.4.0 2.4.1 2.5.0 2.5.1 2.5.2 2.6.0 2.7.0 2.7.1)&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 javac&lt;/font&gt;.  The applied patch does not increase the total number of javac compiler warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 protoc&lt;/font&gt;.  The applied patch does not increase the total number of protoc compiler warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 javadoc&lt;/font&gt;.  The javadoc tool did not generate any warning messages.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 checkstyle&lt;/font&gt;.  The applied patch does not increase the total number of checkstyle errors&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 findbugs&lt;/font&gt;.  The patch does not introduce any  new Findbugs (version 2.0.3) warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 release audit&lt;/font&gt;.  The applied patch does not increase the total number of release audit warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 lineLengths&lt;/font&gt;.  The patch does not introduce lines longer than 100&lt;/p&gt;

&lt;p&gt;  &lt;font color=&quot;green&quot;&gt;+1 site&lt;/font&gt;.  The mvn post-site goal succeeds with this patch.&lt;/p&gt;

&lt;p&gt;     &lt;font color=&quot;red&quot;&gt;-1 core tests&lt;/font&gt;.  The patch failed these unit tests:&lt;/p&gt;


&lt;p&gt;Test results: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/15358//testReport/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/15358//testReport/&lt;/a&gt;&lt;br/&gt;
Release Findbugs (version 2.0.3) 	warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/15358//artifact/patchprocess/newFindbugsWarnings.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/15358//artifact/patchprocess/newFindbugsWarnings.html&lt;/a&gt;&lt;br/&gt;
Checkstyle Errors: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/15358//artifact/patchprocess/checkstyle-aggregate.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/15358//artifact/patchprocess/checkstyle-aggregate.html&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;  Console output: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/15358//console&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/15358//console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="14724115" author="eclark" created="Mon, 31 Aug 2015 21:51:27 +0000"  >&lt;p&gt;This patch is a little more thorough about the sync futures. We need to make sure that all of the syncfutures are marked as failed. Other wise it&apos;s possible that others could sneak in.&lt;/p&gt;</comment>
                            <comment id="14724121" author="eclark" created="Mon, 31 Aug 2015 22:02:04 +0000"  >&lt;p&gt;correct patch&lt;/p&gt;</comment>
                            <comment id="14724141" author="eclark" created="Mon, 31 Aug 2015 22:21:22 +0000"  >&lt;p&gt;More extreme test.&lt;/p&gt;

&lt;p&gt;Also I found that I need to reset the sync futures.&lt;/p&gt;</comment>
                            <comment id="14724304" author="hadoopqa" created="Mon, 31 Aug 2015 22:40:16 +0000"  >&lt;p&gt;&lt;font color=&quot;red&quot;&gt;-1 overall&lt;/font&gt;.  Here are the results of testing the latest attachment &lt;br/&gt;
  &lt;a href=&quot;http://issues.apache.org/jira/secure/attachment/12753396/HBASE-14317-v4.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/secure/attachment/12753396/HBASE-14317-v4.patch&lt;/a&gt;&lt;br/&gt;
  against master branch at commit 498c1845ab7b01710955153c27501fdc7492849d.&lt;br/&gt;
  ATTACHMENT ID: 12753396&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 @author&lt;/font&gt;.  The patch does not contain any @author tags.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 tests included&lt;/font&gt;.  The patch appears to include 8 new or modified tests.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 hadoop versions&lt;/font&gt;. The patch compiles with all supported hadoop versions (2.4.0 2.4.1 2.5.0 2.5.1 2.5.2 2.6.0 2.7.0 2.7.1)&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 javac&lt;/font&gt;.  The applied patch does not increase the total number of javac compiler warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 protoc&lt;/font&gt;.  The applied patch does not increase the total number of protoc compiler warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 javadoc&lt;/font&gt;.  The javadoc tool did not generate any warning messages.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 checkstyle&lt;/font&gt;.  The applied patch does not increase the total number of checkstyle errors&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;red&quot;&gt;-1 findbugs&lt;/font&gt;.  The patch appears to cause Findbugs (version 2.0.3) to fail.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 release audit&lt;/font&gt;.  The applied patch does not increase the total number of release audit warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 lineLengths&lt;/font&gt;.  The patch does not introduce lines longer than 100&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;red&quot;&gt;-1 site&lt;/font&gt;.  The patch appears to cause mvn post-site goal to fail.&lt;/p&gt;

&lt;p&gt;     &lt;font color=&quot;red&quot;&gt;-1 core tests&lt;/font&gt;.  The patch failed these unit tests:&lt;/p&gt;


&lt;p&gt;Test results: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/15369//testReport/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/15369//testReport/&lt;/a&gt;&lt;br/&gt;
Checkstyle Errors: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/15369//artifact/patchprocess/checkstyle-aggregate.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/15369//artifact/patchprocess/checkstyle-aggregate.html&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;  Console output: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/15369//console&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/15369//console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="14724342" author="hadoopqa" created="Mon, 31 Aug 2015 22:58:34 +0000"  >&lt;p&gt;&lt;font color=&quot;red&quot;&gt;-1 overall&lt;/font&gt;.  Here are the results of testing the latest attachment &lt;br/&gt;
  &lt;a href=&quot;http://issues.apache.org/jira/secure/attachment/12753371/HBASE-14317-v1.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/secure/attachment/12753371/HBASE-14317-v1.patch&lt;/a&gt;&lt;br/&gt;
  against master branch at commit 498c1845ab7b01710955153c27501fdc7492849d.&lt;br/&gt;
  ATTACHMENT ID: 12753371&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 @author&lt;/font&gt;.  The patch does not contain any @author tags.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 tests included&lt;/font&gt;.  The patch appears to include 8 new or modified tests.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 hadoop versions&lt;/font&gt;. The patch compiles with all supported hadoop versions (2.4.0 2.4.1 2.5.0 2.5.1 2.5.2 2.6.0 2.7.0 2.7.1)&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 javac&lt;/font&gt;.  The applied patch does not increase the total number of javac compiler warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 protoc&lt;/font&gt;.  The applied patch does not increase the total number of protoc compiler warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 javadoc&lt;/font&gt;.  The javadoc tool did not generate any warning messages.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 checkstyle&lt;/font&gt;.  The applied patch does not increase the total number of checkstyle errors&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 findbugs&lt;/font&gt;.  The patch does not introduce any  new Findbugs (version 2.0.3) warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 release audit&lt;/font&gt;.  The applied patch does not increase the total number of release audit warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 lineLengths&lt;/font&gt;.  The patch does not introduce lines longer than 100&lt;/p&gt;

&lt;p&gt;  &lt;font color=&quot;green&quot;&gt;+1 site&lt;/font&gt;.  The mvn post-site goal succeeds with this patch.&lt;/p&gt;

&lt;p&gt;     &lt;font color=&quot;red&quot;&gt;-1 core tests&lt;/font&gt;.  The patch failed these unit tests:&lt;br/&gt;
                       org.apache.hadoop.hbase.util.TestProcessBasedCluster&lt;/p&gt;

&lt;p&gt;Test results: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/15360//testReport/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/15360//testReport/&lt;/a&gt;&lt;br/&gt;
Release Findbugs (version 2.0.3) 	warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/15360//artifact/patchprocess/newFindbugsWarnings.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/15360//artifact/patchprocess/newFindbugsWarnings.html&lt;/a&gt;&lt;br/&gt;
Checkstyle Errors: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/15360//artifact/patchprocess/checkstyle-aggregate.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/15360//artifact/patchprocess/checkstyle-aggregate.html&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;  Console output: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/15360//console&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/15360//console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="14724829" author="stack" created="Tue, 1 Sep 2015 05:51:01 +0000"  >&lt;p&gt;Repro of the hang seen in the original attachment raw.php. We cannot replace log because we are waiting on the zig zag latch. We cannot close the region because we are waiting on a flush. Flushes cannot progress because they are waiting on their sequenceid. Test timeouts after 60 seconds of hang. Test is testLockedUpWALSystem. Test is ugly because have to standup a region and log roller... full of boilerplate mostly. Also reverts &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-13971&quot; title=&quot;Flushes stuck since 6 hours on a regionserver.&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-13971&quot;&gt;&lt;del&gt;HBASE-13971&lt;/del&gt;&lt;/a&gt;. It only confuses. Adds a method to FSHLog so I can hold processing around zigzaglatch creation.&lt;/p&gt;

&lt;p&gt;Hang happens if a sync comes off the ring buffer AFTER we&apos;ve created a SafePointZigZagLatch &amp;#8211; the very existence of this object means the ringbuffer consuming thread will fall into the attain safe point code block (even if the interrupting sync just throws an exception) &amp;#8211; but BEFORE we have published the replaceWriter zigzag sync on to the ringbuffer: i.e if the sync comes in AFTER line #794 in the below but BEFORE #806.&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
 784   Path replaceWriter(&lt;span class=&quot;code-keyword&quot;&gt;final&lt;/span&gt; Path oldPath, &lt;span class=&quot;code-keyword&quot;&gt;final&lt;/span&gt; Path newPath, Writer nextWriter,
 785       &lt;span class=&quot;code-keyword&quot;&gt;final&lt;/span&gt; FSDataOutputStream nextHdfsOut)
 786   &lt;span class=&quot;code-keyword&quot;&gt;throws&lt;/span&gt; IOException {
 787     &lt;span class=&quot;code-comment&quot;&gt;// Ask the ring buffer writer to pause at a safe point.  Once we &lt;span class=&quot;code-keyword&quot;&gt;do&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt;, the writer
&lt;/span&gt; 788     &lt;span class=&quot;code-comment&quot;&gt;// thread will eventually pause. An error hereafter needs to release the writer thread
&lt;/span&gt; 789     &lt;span class=&quot;code-comment&quot;&gt;// regardless -- hence the &lt;span class=&quot;code-keyword&quot;&gt;finally&lt;/span&gt; block below.  Note, &lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt; method is called from the FSHLog
&lt;/span&gt; 790     &lt;span class=&quot;code-comment&quot;&gt;// constructor BEFORE the ring buffer is set running so it is &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt; on first time through
&lt;/span&gt; 791     &lt;span class=&quot;code-comment&quot;&gt;// here; allow &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; that.
&lt;/span&gt; 792     SyncFuture syncFuture = &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;;
 793     SafePointZigZagLatch zigzagLatch = (&lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt;.ringBufferEventHandler == &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;)?
 794       &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;: &lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt;.ringBufferEventHandler.attainSafePoint();
 795     afterZigZagLatch();
 796     TraceScope scope = Trace.startSpan(&lt;span class=&quot;code-quote&quot;&gt;&quot;FSHFile.replaceWriter&quot;&lt;/span&gt;);
 797     &lt;span class=&quot;code-keyword&quot;&gt;try&lt;/span&gt; {
 798       &lt;span class=&quot;code-comment&quot;&gt;// Wait on the safe point to be achieved.  Send in a sync in &lt;span class=&quot;code-keyword&quot;&gt;case&lt;/span&gt; nothing has hit the
&lt;/span&gt; 799       &lt;span class=&quot;code-comment&quot;&gt;// ring buffer between the above notification of writer that we want it to go to
&lt;/span&gt; 800       &lt;span class=&quot;code-comment&quot;&gt;// &apos;safe point&apos; and then here where we are waiting on it to attain safe point.  Use
&lt;/span&gt; 801       &lt;span class=&quot;code-comment&quot;&gt;// &apos;sendSync&apos; instead of &apos;sync&apos; because we &lt;span class=&quot;code-keyword&quot;&gt;do&lt;/span&gt; not want &lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt; thread to block waiting on it
&lt;/span&gt; 802       &lt;span class=&quot;code-comment&quot;&gt;// to come back.  Cleanup &lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt; syncFuture down below after we are ready to run again.
&lt;/span&gt; 803       &lt;span class=&quot;code-keyword&quot;&gt;try&lt;/span&gt; {
 804         &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (zigzagLatch != &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;) {
 805           Trace.addTimelineAnnotation(&lt;span class=&quot;code-quote&quot;&gt;&quot;awaiting safepoint&quot;&lt;/span&gt;);
 806           syncFuture = zigzagLatch.waitSafePoint(publishSyncOnRingBuffer());
...&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Fix is here abouts:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
    &lt;span class=&quot;code-keyword&quot;&gt;private&lt;/span&gt; void attainSafePoint(&lt;span class=&quot;code-keyword&quot;&gt;final&lt;/span&gt; &lt;span class=&quot;code-object&quot;&gt;long&lt;/span&gt; currentSequence) {
      &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (&lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt;.zigzagLatch == &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt; || !&lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt;.zigzagLatch.isCocked()) &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt;;
...
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;.... needs to be more than existence of zigzagLatch and that it is cocked...  Let me chat w/ &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=eclark&quot; class=&quot;user-hover&quot; rel=&quot;eclark&quot;&gt;Elliott Clark&lt;/a&gt;&lt;/p&gt;


</comment>
                            <comment id="14724844" author="hadoopqa" created="Tue, 1 Sep 2015 06:01:59 +0000"  >&lt;p&gt;&lt;font color=&quot;red&quot;&gt;-1 overall&lt;/font&gt;.  Here are the results of testing the latest attachment &lt;br/&gt;
  &lt;a href=&quot;http://issues.apache.org/jira/secure/attachment/12753464/repro.txt&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/secure/attachment/12753464/repro.txt&lt;/a&gt;&lt;br/&gt;
  against master branch at commit 498c1845ab7b01710955153c27501fdc7492849d.&lt;br/&gt;
  ATTACHMENT ID: 12753464&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 @author&lt;/font&gt;.  The patch does not contain any @author tags.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 tests included&lt;/font&gt;.  The patch appears to include 3 new or modified tests.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;red&quot;&gt;-1 patch&lt;/font&gt;.  The patch command could not apply the patch.&lt;/p&gt;

&lt;p&gt;Console output: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/15378//console&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/15378//console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="14724870" author="stack" created="Tue, 1 Sep 2015 06:40:35 +0000"  >&lt;p&gt;Patch is for 1.2. Will make a patch for master when have fix.&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=eclark&quot; class=&quot;user-hover&quot; rel=&quot;eclark&quot;&gt;Elliott Clark&lt;/a&gt; I took a look at your patch. I get now what you mean by a sync-after-a-failed-append should always fail. Agree. Lets fix that too. I think we should be able to have more finesse than what is here where we stamp out everything &amp;#8211; smile. I think a sync could come in even after all we&apos;ve made all our noise stamping on everything (let me do the server mocks they way you have them in the patch too... and integrate your test).&lt;/p&gt;</comment>
                            <comment id="14725888" author="stack" created="Tue, 1 Sep 2015 19:02:08 +0000"  >&lt;p&gt;Trying out this for a fix for the hang: i.e. we can fall into the wait on zigzaglatch though all outstanding appends and syncs are failing and will never complete (and up the sync number to overwhelm current sequence id).&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
@@ -1792,9 +1797,10 @@ &lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; class FSHLog &lt;span class=&quot;code-keyword&quot;&gt;implements&lt;/span&gt; WAL {
       &lt;span class=&quot;code-comment&quot;&gt;// If here, another thread is waiting on us to get to safe point.  Don&apos;t leave it hanging.
&lt;/span&gt;       &lt;span class=&quot;code-keyword&quot;&gt;try&lt;/span&gt; {
         &lt;span class=&quot;code-comment&quot;&gt;// Wait on outstanding syncers; wait &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; them to finish syncing (unless we&apos;ve been
&lt;/span&gt;-        &lt;span class=&quot;code-comment&quot;&gt;// shutdown or unless our latch has been thrown because we have been aborted).
&lt;/span&gt;+        &lt;span class=&quot;code-comment&quot;&gt;// shutdown or unless our latch has been thrown because we have been aborted or unless
&lt;/span&gt;+        &lt;span class=&quot;code-comment&quot;&gt;// &lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt; WAL is broken and we can&apos;t get a sync/append to complete).
&lt;/span&gt;         &lt;span class=&quot;code-keyword&quot;&gt;while&lt;/span&gt; (!&lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt;.shutdown &amp;amp;&amp;amp; &lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt;.zigzagLatch.isCocked() &amp;amp;&amp;amp;
-            highestSyncedSequence.get() &amp;lt; currentSequence) {
+            highestSyncedSequence.get() &amp;lt; currentSequence &amp;amp;&amp;amp; &lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt;.syncFuturesCount &amp;gt; 0) {
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Will be back on the highly-unlikely but possible case where an append fails but sync does not (a sync may be ongoing at time of append and may &apos;finish&apos; after the append &apos;succesfully&apos; so... let me see)&lt;/p&gt;</comment>
                            <comment id="14725933" author="busbey" created="Tue, 1 Sep 2015 19:32:46 +0000"  >&lt;p&gt;moving to blocker per email from Elliot.&lt;/p&gt;</comment>
                            <comment id="14725940" author="eclark" created="Tue, 1 Sep 2015 19:37:16 +0000"  >&lt;blockquote&gt;&lt;p&gt;I think we should be able to have more finesse than what is here where we stamp out everything &lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;That would be nice. Though I wasn&apos;t sure how to do it since we don&apos;t know for sure what order the subsequent syncs are going to come in. If I just stamp on one sync it&apos;s possible that that some other thread takes that sync and fails while the failed append thread creates a new sync.&lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;I think a sync could come in even after all we&apos;ve made all our noise stamping on everything&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;We&apos;re doing the fail syncs on the append thread. So the only new syncs that can come in will be after this single threaded method completes. Anything that&apos;s racing with this method can succeed and not change correctness.&lt;/p&gt;

</comment>
                            <comment id="14726384" author="stack" created="Tue, 1 Sep 2015 23:03:47 +0000"  >&lt;p&gt;Thanks for input &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=eclark&quot; class=&quot;user-hover&quot; rel=&quot;eclark&quot;&gt;Elliott Clark&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;On your first comment, I think the fact that consumer is single-threaded lets us reason about who we can stamp on (though syncs are running elsewhere on their own threads) and I think I agree with your second comment.&lt;/p&gt;

&lt;p&gt;Here is a patch to throw exception if the append fails, even if sync succeeds (in fact anything after a failed append will fail until the WAL is replaced). It also fixes the lock up. Reverts &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-13971&quot; title=&quot;Flushes stuck since 6 hours on a regionserver.&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-13971&quot;&gt;&lt;del&gt;HBASE-13971&lt;/del&gt;&lt;/a&gt;. Will work some more on it making tests more stringent.&lt;/p&gt;

&lt;p&gt;+ Adds to mvcc a new cancelMemstoreInsert that removes entry from Q and does NOT advance read point (w/o this change, we were trying to complete the memstore insert but the sequenceid was far in excess of the last successful sync &amp;#8211; especially on failure... we&apos;d get stuck).&lt;br/&gt;
+ In FSHLog, keep around exception thrown when appending. Throw same exception for all subsequent appends. Fail syncs too. Do this till WAL has been changed out from under us. Changed the wait on zigzaglatch so it checks if outstanding syncs. There may be none if syncs just fail. Need this to break loop also for case when syncs are failing and are NOT going to up the sequence id beyond where we want it so we can break out.&lt;br/&gt;
+ TestHRegion, added tests for both conditions (Elliott did the append test stuff).&lt;/p&gt;</comment>
                            <comment id="14726389" author="stack" created="Tue, 1 Sep 2015 23:04:55 +0000"  >&lt;p&gt;See if will build against branch-1.2 (patch is for 1.2 currently)&lt;/p&gt;</comment>
                            <comment id="14726394" author="stack" created="Tue, 1 Sep 2015 23:07:51 +0000"  >&lt;p&gt;&lt;a href=&quot;https://reviews.apache.org/r/38024/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/38024/&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="14726684" author="hadoopqa" created="Wed, 2 Sep 2015 03:27:24 +0000"  >&lt;p&gt;&lt;font color=&quot;red&quot;&gt;-1 overall&lt;/font&gt;.  Here are the results of testing the latest attachment &lt;br/&gt;
  &lt;a href=&quot;http://issues.apache.org/jira/secure/attachment/12753621/14317v5.branch-1.2.txt&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/secure/attachment/12753621/14317v5.branch-1.2.txt&lt;/a&gt;&lt;br/&gt;
  against branch-1.2 branch at commit 5bb36f1594f7bc70d245ffa475e1393964c496b0.&lt;br/&gt;
  ATTACHMENT ID: 12753621&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 @author&lt;/font&gt;.  The patch does not contain any @author tags.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 tests included&lt;/font&gt;.  The patch appears to include 3 new or modified tests.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 hadoop versions&lt;/font&gt;. The patch compiles with all supported hadoop versions (2.4.0 2.4.1 2.5.0 2.5.1 2.5.2 2.6.0 2.7.0 2.7.1)&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 javac&lt;/font&gt;.  The applied patch does not increase the total number of javac compiler warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 protoc&lt;/font&gt;.  The applied patch does not increase the total number of protoc compiler warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 javadoc&lt;/font&gt;.  The javadoc tool did not generate any warning messages.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 checkstyle&lt;/font&gt;.  The applied patch does not increase the total number of checkstyle errors&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 findbugs&lt;/font&gt;.  The patch does not introduce any  new Findbugs (version 2.0.3) warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 release audit&lt;/font&gt;.  The applied patch does not increase the total number of release audit warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 lineLengths&lt;/font&gt;.  The patch does not introduce lines longer than 100&lt;/p&gt;

&lt;p&gt;  &lt;font color=&quot;green&quot;&gt;+1 site&lt;/font&gt;.  The mvn post-site goal succeeds with this patch.&lt;/p&gt;

&lt;p&gt;     &lt;font color=&quot;red&quot;&gt;-1 core tests&lt;/font&gt;.  The patch failed these unit tests:&lt;/p&gt;


&lt;p&gt;     &lt;font color=&quot;red&quot;&gt;-1 core zombie tests&lt;/font&gt;.  There are 4 zombie test(s): 	at org.apache.hadoop.hdfs.server.namenode.TestStorageRestore.testDfsAdminCmd(TestStorageRestore.java:260)&lt;br/&gt;
	at org.apache.hadoop.hbase.regionserver.TestHRegion.testFlushMarkersWALFail(TestHRegion.java:1337)&lt;/p&gt;

&lt;p&gt;Test results: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/15386//testReport/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/15386//testReport/&lt;/a&gt;&lt;br/&gt;
Release Findbugs (version 2.0.3) 	warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/15386//artifact/patchprocess/newFindbugsWarnings.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/15386//artifact/patchprocess/newFindbugsWarnings.html&lt;/a&gt;&lt;br/&gt;
Checkstyle Errors: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/15386//artifact/patchprocess/checkstyle-aggregate.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/15386//artifact/patchprocess/checkstyle-aggregate.html&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;  Console output: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/15386//console&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/15386//console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="14726822" author="eclark" created="Wed, 2 Sep 2015 06:19:07 +0000"  >&lt;blockquote&gt;&lt;p&gt;TestHRegion.testFlushMarkersWALFail&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;That looks related?&lt;/p&gt;

&lt;p&gt;Everything else looks good to me.&lt;/p&gt;</comment>
                            <comment id="14726850" author="stack" created="Wed, 2 Sep 2015 06:44:33 +0000"  >&lt;p&gt;Carry over from rb. Lets see what hadoopqa thinks. I see two tests in TestHRegion failing. Will look at them. What else?&lt;/p&gt;</comment>
                            <comment id="14726855" author="hadoopqa" created="Wed, 2 Sep 2015 06:51:58 +0000"  >&lt;p&gt;&lt;font color=&quot;red&quot;&gt;-1 overall&lt;/font&gt;.  Here are the results of testing the latest attachment &lt;br/&gt;
  &lt;a href=&quot;http://issues.apache.org/jira/secure/attachment/12753695/14317v9.txt&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/secure/attachment/12753695/14317v9.txt&lt;/a&gt;&lt;br/&gt;
  against master branch at commit f8dd99d7380e5eafae62a9f0c526ba24f98eb2e5.&lt;br/&gt;
  ATTACHMENT ID: 12753695&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 @author&lt;/font&gt;.  The patch does not contain any @author tags.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 tests included&lt;/font&gt;.  The patch appears to include 8 new or modified tests.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;red&quot;&gt;-1 javac&lt;/font&gt;.  The patch appears to cause mvn compile goal to fail with Hadoop version 2.4.0.&lt;/p&gt;

&lt;p&gt;    Compilation errors resume:&lt;br/&gt;
    &lt;span class=&quot;error&quot;&gt;&amp;#91;ERROR&amp;#93;&lt;/span&gt; Error invoking method &apos;get(java.lang.Integer)&apos; in java.util.ArrayList at META-INF/LICENSE.vm&lt;span class=&quot;error&quot;&gt;&amp;#91;line 1619, column 22&amp;#93;&lt;/span&gt;&lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;ERROR&amp;#93;&lt;/span&gt; Failed to execute goal org.apache.maven.plugins:maven-remote-resources-plugin:1.5:process (default) on project hbase-assembly: Error rendering velocity resource. Error invoking method &apos;get(java.lang.Integer)&apos; in java.util.ArrayList at META-INF/LICENSE.vm&lt;span class=&quot;error&quot;&gt;&amp;#91;line 1619, column 22&amp;#93;&lt;/span&gt;: InvocationTargetException: Index: 0, Size: 0 -&amp;gt; &lt;span class=&quot;error&quot;&gt;&amp;#91;Help 1&amp;#93;&lt;/span&gt;&lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;ERROR&amp;#93;&lt;/span&gt; &lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;ERROR&amp;#93;&lt;/span&gt; To see the full stack trace of the errors, re-run Maven with the -e switch.&lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;ERROR&amp;#93;&lt;/span&gt; Re-run Maven using the -X switch to enable full debug logging.&lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;ERROR&amp;#93;&lt;/span&gt; &lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;ERROR&amp;#93;&lt;/span&gt; For more information about the errors and possible solutions, please read the following articles:&lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;ERROR&amp;#93;&lt;/span&gt; &lt;span class=&quot;error&quot;&gt;&amp;#91;Help 1&amp;#93;&lt;/span&gt; &lt;a href=&quot;http://cwiki.apache.org/confluence/display/MAVEN/MojoExecutionException&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://cwiki.apache.org/confluence/display/MAVEN/MojoExecutionException&lt;/a&gt;&lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;ERROR&amp;#93;&lt;/span&gt; &lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;ERROR&amp;#93;&lt;/span&gt; After correcting the problems, you can resume the build with the command&lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;ERROR&amp;#93;&lt;/span&gt;   mvn &amp;lt;goals&amp;gt; -rf :hbase-assembly&lt;/p&gt;


&lt;p&gt;Console output: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/15387//console&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/15387//console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="14726977" author="stack" created="Wed, 2 Sep 2015 08:21:42 +0000"  >&lt;p&gt;Failed because of this:&lt;/p&gt;

&lt;p&gt;Error invoking method &apos;get(java.lang.Integer)&apos; in java.util.ArrayList at META-INF/LICENSE.vm&lt;span class=&quot;error&quot;&gt;&amp;#91;line 1619, column 22&amp;#93;&lt;/span&gt;: InvocationTargetException: Index: 0, Size: 0 -&amp;gt; &lt;span class=&quot;error&quot;&gt;&amp;#91;Help 1&amp;#93;&lt;/span&gt;&lt;/p&gt;
</comment>
                            <comment id="14726979" author="stack" created="Wed, 2 Sep 2015 08:22:36 +0000"  >&lt;p&gt;Retry. Fail in TestHRegion of testFlushMarkersWALFail looks to be a fun mockito issue. Will have to redo the test (Just saw your comment &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=eclark&quot; class=&quot;user-hover&quot; rel=&quot;eclark&quot;&gt;Elliott Clark&lt;/a&gt; &amp;#8211; mockito is not passing through all that makes up an entry in a spied-upon WAL.... so NPEing down in its guts.... let me refactor the test to not use mockito spying)&lt;/p&gt;</comment>
                            <comment id="14727186" author="hadoopqa" created="Wed, 2 Sep 2015 11:23:36 +0000"  >&lt;p&gt;&lt;font color=&quot;red&quot;&gt;-1 overall&lt;/font&gt;.  Here are the results of testing the latest attachment &lt;br/&gt;
  &lt;a href=&quot;http://issues.apache.org/jira/secure/attachment/12753719/14317v10.txt&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/secure/attachment/12753719/14317v10.txt&lt;/a&gt;&lt;br/&gt;
  against master branch at commit f8dd99d7380e5eafae62a9f0c526ba24f98eb2e5.&lt;br/&gt;
  ATTACHMENT ID: 12753719&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 @author&lt;/font&gt;.  The patch does not contain any @author tags.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 tests included&lt;/font&gt;.  The patch appears to include 12 new or modified tests.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 hadoop versions&lt;/font&gt;. The patch compiles with all supported hadoop versions (2.4.0 2.4.1 2.5.0 2.5.1 2.5.2 2.6.0 2.7.0 2.7.1)&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 javac&lt;/font&gt;.  The applied patch does not increase the total number of javac compiler warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 protoc&lt;/font&gt;.  The applied patch does not increase the total number of protoc compiler warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 javadoc&lt;/font&gt;.  The javadoc tool did not generate any warning messages.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 checkstyle&lt;/font&gt;.  The applied patch does not increase the total number of checkstyle errors&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 findbugs&lt;/font&gt;.  The patch does not introduce any  new Findbugs (version 2.0.3) warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 release audit&lt;/font&gt;.  The applied patch does not increase the total number of release audit warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 lineLengths&lt;/font&gt;.  The patch does not introduce lines longer than 100&lt;/p&gt;

&lt;p&gt;  &lt;font color=&quot;green&quot;&gt;+1 site&lt;/font&gt;.  The mvn post-site goal succeeds with this patch.&lt;/p&gt;

&lt;p&gt;     &lt;font color=&quot;red&quot;&gt;-1 core tests&lt;/font&gt;.  The patch failed these unit tests:&lt;br/&gt;
                       org.apache.hadoop.hbase.regionserver.TestFSErrorsExposed&lt;/p&gt;

&lt;p&gt;     &lt;font color=&quot;red&quot;&gt;-1 core zombie tests&lt;/font&gt;.  There are 2 zombie test(s): 	at org.apache.hadoop.hbase.regionserver.TestHRegion.testFlushMarkersWALFail(TestHRegion.java:1073)&lt;/p&gt;

&lt;p&gt;Test results: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/15390//testReport/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/15390//testReport/&lt;/a&gt;&lt;br/&gt;
Release Findbugs (version 2.0.3) 	warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/15390//artifact/patchprocess/newFindbugsWarnings.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/15390//artifact/patchprocess/newFindbugsWarnings.html&lt;/a&gt;&lt;br/&gt;
Checkstyle Errors: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/15390//artifact/patchprocess/checkstyle-aggregate.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/15390//artifact/patchprocess/checkstyle-aggregate.html&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;  Console output: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/15390//console&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/15390//console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="14727193" author="busbey" created="Wed, 2 Sep 2015 11:28:55 +0000"  >&lt;blockquote&gt;
&lt;p&gt;Failed because of this:&lt;/p&gt;

&lt;p&gt;Error invoking method &apos;get(java.lang.Integer)&apos; in java.util.ArrayList at META-INF/LICENSE.vm&lt;span class=&quot;error&quot;&gt;&amp;#91;line 1619, column 22&amp;#93;&lt;/span&gt;: InvocationTargetException: Index: 0, Size: 0 -&amp;gt; &lt;span class=&quot;error&quot;&gt;&amp;#91;Help 1&amp;#93;&lt;/span&gt;&lt;br/&gt;
Reply&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;That&apos;s &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-14337&quot; title=&quot;build error on master&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-14337&quot;&gt;&lt;del&gt;HBASE-14337&lt;/del&gt;&lt;/a&gt;. If I could get a review on v2 there we can figure out which dependency is getting corrupted.&lt;/p&gt;</comment>
                            <comment id="14727661" author="stack" created="Wed, 2 Sep 2015 17:19:53 +0000"  >&lt;p&gt;testFlushMarkersWALFail failure was interesting. The Mockito matcher was failing for me. Fields were null.  Undid the mockito matcher for this test.&lt;/p&gt;

&lt;p&gt;The second issue has to do with sloppy semantics. Previous, you could have append throw an exception and then a sync could go in and succeed. You could then carry on using the WAL as though no exception had been thrown.&lt;/p&gt;

&lt;p&gt;This patch hardens our semantic such that once a WAL throws an exception, no new appends or syncs will succeed, not untill you replace the WAL. For testFlushMarkersWALFail, because there is no log rolling thread running, we&apos;d just hang making no progress because the WAL had gone bad. I added forced log rolling after each test step. Also fixed weird stuff like this:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
         } &lt;span class=&quot;code-keyword&quot;&gt;catch&lt;/span&gt; (IOException ioe) {
-          LOG.warn(&lt;span class=&quot;code-quote&quot;&gt;&quot;Unexpected exception &lt;span class=&quot;code-keyword&quot;&gt;while&lt;/span&gt; wal.sync(), ignoring. Exception: &quot;&lt;/span&gt;
-              + StringUtils.stringifyException(ioe));
+          wal.abortCacheFlush(&lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt;.getRegionInfo().getEncodedNameAsBytes());
+          &lt;span class=&quot;code-keyword&quot;&gt;throw&lt;/span&gt; ioe;
         }
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;See how we used to ignore a failed sync, just log it at WARN.&lt;/p&gt;

&lt;p&gt;One implication of the new hardening of the semantic is that the dodgy getting of a sequenceid by adding an &apos;empty append&apos; now fails if the WAL is bad. A log roll will fix it. I&apos;ve been seeing some of this in tests and fix is to add in a log roll (in a server, we have the log rolling thread running... not in tests of regions only).&lt;/p&gt;</comment>
                            <comment id="14728042" author="stack" created="Wed, 2 Sep 2015 21:22:25 +0000"  >&lt;p&gt;Added back timeout on getting of sequenceid. We were failing some tests because of improper log management (WAL append or sync failed but not log roll to move the test forward... ). I fixed a few tests but let the sequenceid timeout; it will be easier to find the offenders.&lt;/p&gt;

&lt;p&gt;Added note on new tighter semantic to head of FSHLog.&lt;/p&gt;

&lt;p&gt;Lets see how this one does (got stuck on TestFSErrorExposure... couldn&apos;t figure why it hung).&lt;/p&gt;</comment>
                            <comment id="14728214" author="hadoopqa" created="Wed, 2 Sep 2015 23:12:57 +0000"  >&lt;p&gt;&lt;font color=&quot;red&quot;&gt;-1 overall&lt;/font&gt;.  Here are the results of testing the latest attachment &lt;br/&gt;
  &lt;a href=&quot;http://issues.apache.org/jira/secure/attachment/12753849/14317v11.txt&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/secure/attachment/12753849/14317v11.txt&lt;/a&gt;&lt;br/&gt;
  against master branch at commit a5261b6f44f338e3f4bd46fb29bed2c30e223bd4.&lt;br/&gt;
  ATTACHMENT ID: 12753849&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 @author&lt;/font&gt;.  The patch does not contain any @author tags.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 tests included&lt;/font&gt;.  The patch appears to include 15 new or modified tests.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 hadoop versions&lt;/font&gt;. The patch compiles with all supported hadoop versions (2.4.0 2.4.1 2.5.0 2.5.1 2.5.2 2.6.0 2.7.0 2.7.1)&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 javac&lt;/font&gt;.  The applied patch does not increase the total number of javac compiler warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 protoc&lt;/font&gt;.  The applied patch does not increase the total number of protoc compiler warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 javadoc&lt;/font&gt;.  The javadoc tool did not generate any warning messages.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 checkstyle&lt;/font&gt;.  The applied patch does not increase the total number of checkstyle errors&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 findbugs&lt;/font&gt;.  The patch does not introduce any  new Findbugs (version 2.0.3) warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 release audit&lt;/font&gt;.  The applied patch does not increase the total number of release audit warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 lineLengths&lt;/font&gt;.  The patch does not introduce lines longer than 100&lt;/p&gt;

&lt;p&gt;  &lt;font color=&quot;green&quot;&gt;+1 site&lt;/font&gt;.  The mvn post-site goal succeeds with this patch.&lt;/p&gt;

&lt;p&gt;     &lt;font color=&quot;red&quot;&gt;-1 core tests&lt;/font&gt;.  The patch failed these unit tests:&lt;br/&gt;
                       org.apache.hadoop.hbase.io.TestHeapSize&lt;/p&gt;

&lt;p&gt;Test results: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/15396//testReport/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/15396//testReport/&lt;/a&gt;&lt;br/&gt;
Release Findbugs (version 2.0.3) 	warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/15396//artifact/patchprocess/newFindbugsWarnings.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/15396//artifact/patchprocess/newFindbugsWarnings.html&lt;/a&gt;&lt;br/&gt;
Checkstyle Errors: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/15396//artifact/patchprocess/checkstyle-aggregate.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/15396//artifact/patchprocess/checkstyle-aggregate.html&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;  Console output: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/15396//console&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/15396//console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="14728265" author="stack" created="Thu, 3 Sep 2015 00:10:33 +0000"  >&lt;p&gt;Fix the size issue.&lt;/p&gt;</comment>
                            <comment id="14728450" author="hadoopqa" created="Thu, 3 Sep 2015 03:22:24 +0000"  >&lt;p&gt;&lt;font color=&quot;red&quot;&gt;-1 overall&lt;/font&gt;.  Here are the results of testing the latest attachment &lt;br/&gt;
  &lt;a href=&quot;http://issues.apache.org/jira/secure/attachment/12753885/14317v12.txt&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/secure/attachment/12753885/14317v12.txt&lt;/a&gt;&lt;br/&gt;
  against master branch at commit a5261b6f44f338e3f4bd46fb29bed2c30e223bd4.&lt;br/&gt;
  ATTACHMENT ID: 12753885&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 @author&lt;/font&gt;.  The patch does not contain any @author tags.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 tests included&lt;/font&gt;.  The patch appears to include 15 new or modified tests.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 hadoop versions&lt;/font&gt;. The patch compiles with all supported hadoop versions (2.4.0 2.4.1 2.5.0 2.5.1 2.5.2 2.6.0 2.7.0 2.7.1)&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 javac&lt;/font&gt;.  The applied patch does not increase the total number of javac compiler warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 protoc&lt;/font&gt;.  The applied patch does not increase the total number of protoc compiler warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 javadoc&lt;/font&gt;.  The javadoc tool did not generate any warning messages.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 checkstyle&lt;/font&gt;.  The applied patch does not increase the total number of checkstyle errors&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 findbugs&lt;/font&gt;.  The patch does not introduce any  new Findbugs (version 2.0.3) warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 release audit&lt;/font&gt;.  The applied patch does not increase the total number of release audit warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 lineLengths&lt;/font&gt;.  The patch does not introduce lines longer than 100&lt;/p&gt;

&lt;p&gt;  &lt;font color=&quot;green&quot;&gt;+1 site&lt;/font&gt;.  The mvn post-site goal succeeds with this patch.&lt;/p&gt;

&lt;p&gt;     &lt;font color=&quot;red&quot;&gt;-1 core tests&lt;/font&gt;.  The patch failed these unit tests:&lt;br/&gt;
                       org.apache.hadoop.hbase.regionserver.TestFailedAppendAndSync&lt;/p&gt;

&lt;p&gt;     &lt;font color=&quot;red&quot;&gt;-1 core zombie tests&lt;/font&gt;.  There are 2 zombie test(s): 	at org.apache.hadoop.hbase.regionserver.TestCorruptedRegionStoreFile.testLosingFileAfterScannerInit(TestCorruptedRegionStoreFile.java:173)&lt;br/&gt;
	at org.apache.hadoop.hbase.regionserver.wal.TestLogRolling.testLogRollOnPipelineRestart(TestLogRolling.java:490)&lt;/p&gt;

&lt;p&gt;Test results: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/15398//testReport/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/15398//testReport/&lt;/a&gt;&lt;br/&gt;
Release Findbugs (version 2.0.3) 	warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/15398//artifact/patchprocess/newFindbugsWarnings.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/15398//artifact/patchprocess/newFindbugsWarnings.html&lt;/a&gt;&lt;br/&gt;
Checkstyle Errors: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/15398//artifact/patchprocess/checkstyle-aggregate.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/15398//artifact/patchprocess/checkstyle-aggregate.html&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;  Console output: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/15398//console&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/15398//console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="14728510" author="stack" created="Thu, 3 Sep 2015 05:07:36 +0000"  >&lt;p&gt;Fix failed test (set close to agree with aborting state)&lt;/p&gt;</comment>
                            <comment id="14728723" author="hadoopqa" created="Thu, 3 Sep 2015 09:01:09 +0000"  >&lt;p&gt;&lt;font color=&quot;red&quot;&gt;-1 overall&lt;/font&gt;.  Here are the results of testing the latest attachment &lt;br/&gt;
  &lt;a href=&quot;http://issues.apache.org/jira/secure/attachment/12753923/14317v13.txt&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/secure/attachment/12753923/14317v13.txt&lt;/a&gt;&lt;br/&gt;
  against master branch at commit 3341f13e71a25bf3f8eb5a6a57ce330b3d8a3495.&lt;br/&gt;
  ATTACHMENT ID: 12753923&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 @author&lt;/font&gt;.  The patch does not contain any @author tags.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 tests included&lt;/font&gt;.  The patch appears to include 15 new or modified tests.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 hadoop versions&lt;/font&gt;. The patch compiles with all supported hadoop versions (2.4.0 2.4.1 2.5.0 2.5.1 2.5.2 2.6.0 2.7.0 2.7.1)&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 javac&lt;/font&gt;.  The applied patch does not increase the total number of javac compiler warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 protoc&lt;/font&gt;.  The applied patch does not increase the total number of protoc compiler warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 javadoc&lt;/font&gt;.  The javadoc tool did not generate any warning messages.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 checkstyle&lt;/font&gt;.  The applied patch does not increase the total number of checkstyle errors&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 findbugs&lt;/font&gt;.  The patch does not introduce any  new Findbugs (version 2.0.3) warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 release audit&lt;/font&gt;.  The applied patch does not increase the total number of release audit warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 lineLengths&lt;/font&gt;.  The patch does not introduce lines longer than 100&lt;/p&gt;

&lt;p&gt;  &lt;font color=&quot;green&quot;&gt;+1 site&lt;/font&gt;.  The mvn post-site goal succeeds with this patch.&lt;/p&gt;

&lt;p&gt;     &lt;font color=&quot;red&quot;&gt;-1 core tests&lt;/font&gt;.  The patch failed these unit tests:&lt;br/&gt;
                       org.apache.hadoop.hbase.regionserver.wal.TestLogRolling&lt;/p&gt;

&lt;p&gt;Test results: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/15403//testReport/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/15403//testReport/&lt;/a&gt;&lt;br/&gt;
Release Findbugs (version 2.0.3) 	warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/15403//artifact/patchprocess/newFindbugsWarnings.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/15403//artifact/patchprocess/newFindbugsWarnings.html&lt;/a&gt;&lt;br/&gt;
Checkstyle Errors: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/15403//artifact/patchprocess/checkstyle-aggregate.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/15403//artifact/patchprocess/checkstyle-aggregate.html&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;  Console output: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/15403//console&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/15403//console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="14729538" author="stack" created="Thu, 3 Sep 2015 18:36:39 +0000"  >&lt;p&gt;Ran on small cluster (1B ITBLL with monkeys and confirmed all data there). Checked logs. No hang or no complaints related to this patch. Just the usual complaint about slow HDFS including stuff like this:&lt;/p&gt;

&lt;p&gt;2015-09-02 23:56:52,790 WARN  &lt;span class=&quot;error&quot;&gt;&amp;#91;regionserver/c2023.halxg.cloudera.com/10.20.84.29:16020.logRoller&amp;#93;&lt;/span&gt; hdfs.DFSClient: Slow waitForAckedSeqno took 2577ms (threshold=20ms)&lt;/p&gt;

&lt;p&gt;Also dfs client complaints and exceptions... but nothing from RS or related to WAL.&lt;/p&gt;

&lt;p&gt;Looking at the failed test, on the one hand, the lease was just robbed on all WALs out from under the cluster. Let me make sure the fail is because of stricter semantic and not from any other byproduct. Looking at it, we should be able to ride over the HDFS restart. Will be back.&lt;/p&gt;</comment>
                            <comment id="14729572" author="ndimiduk" created="Thu, 3 Sep 2015 18:53:17 +0000"  >&lt;blockquote&gt;&lt;p&gt;Looking at it, we should be able to ride over the HDFS restart.&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;Brilliant!&lt;/p&gt;</comment>
                            <comment id="14729578" author="stack" created="Thu, 3 Sep 2015 18:56:59 +0000"  >&lt;blockquote&gt;&lt;p&gt;Brilliant!&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;Smile. This is how it was working. I just broke it by not allowing syncs-after-failed-appends. Sorry if gave wrong impression. Smile.&lt;/p&gt;</comment>
                            <comment id="14729965" author="stack" created="Thu, 3 Sep 2015 22:47:50 +0000"  >&lt;p&gt;Fix TestLogRolling. Failure was because an append was failing but the sync was allowed succeed.&lt;/p&gt;</comment>
                            <comment id="14730227" author="hadoopqa" created="Fri, 4 Sep 2015 02:49:36 +0000"  >&lt;p&gt;&lt;font color=&quot;red&quot;&gt;-1 overall&lt;/font&gt;.  Here are the results of testing the latest attachment &lt;br/&gt;
  &lt;a href=&quot;http://issues.apache.org/jira/secure/attachment/12754104/14317v14.txt&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/secure/attachment/12754104/14317v14.txt&lt;/a&gt;&lt;br/&gt;
  against master branch at commit 5152ac0e208fd5f720734fb2abf3fae07b39c7e2.&lt;br/&gt;
  ATTACHMENT ID: 12754104&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 @author&lt;/font&gt;.  The patch does not contain any @author tags.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 tests included&lt;/font&gt;.  The patch appears to include 18 new or modified tests.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 hadoop versions&lt;/font&gt;. The patch compiles with all supported hadoop versions (2.4.0 2.4.1 2.5.0 2.5.1 2.5.2 2.6.0 2.7.0 2.7.1)&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 javac&lt;/font&gt;.  The applied patch does not increase the total number of javac compiler warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 protoc&lt;/font&gt;.  The applied patch does not increase the total number of protoc compiler warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 javadoc&lt;/font&gt;.  The javadoc tool did not generate any warning messages.&lt;/p&gt;

&lt;p&gt;                &lt;font color=&quot;red&quot;&gt;-1 checkstyle&lt;/font&gt;.  The applied patch generated 1839 checkstyle errors (more than the master&apos;s current 1838 errors).&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 findbugs&lt;/font&gt;.  The patch does not introduce any  new Findbugs (version 2.0.3) warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 release audit&lt;/font&gt;.  The applied patch does not increase the total number of release audit warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 lineLengths&lt;/font&gt;.  The patch does not introduce lines longer than 100&lt;/p&gt;

&lt;p&gt;  &lt;font color=&quot;green&quot;&gt;+1 site&lt;/font&gt;.  The mvn post-site goal succeeds with this patch.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 core tests&lt;/font&gt;.  The patch passed unit tests in .&lt;/p&gt;

&lt;p&gt;Test results: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/15408//testReport/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/15408//testReport/&lt;/a&gt;&lt;br/&gt;
Release Findbugs (version 2.0.3) 	warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/15408//artifact/patchprocess/newFindbugsWarnings.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/15408//artifact/patchprocess/newFindbugsWarnings.html&lt;/a&gt;&lt;br/&gt;
Checkstyle Errors: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/15408//artifact/patchprocess/checkstyle-aggregate.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/15408//artifact/patchprocess/checkstyle-aggregate.html&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;                Console output: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/15408//console&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/15408//console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="14730243" author="stack" created="Fri, 4 Sep 2015 03:01:24 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=eclark&quot; class=&quot;user-hover&quot; rel=&quot;eclark&quot;&gt;Elliott Clark&lt;/a&gt; Your +1 still stand?&lt;/p&gt;

&lt;p&gt;Changes since then are comments on new stiffer semantic in code,  comments that our latch in getSequenceId is a bad idea (because no registry to go to to cancel all running on abort, log roll, etc), wrapping all sync and append exceptions in a DamagedWalException so clear on origin and the implication, and then a few small test fixes. I posted this last patch to RB. Will fix checkstyle.&lt;/p&gt;</comment>
                            <comment id="14730250" author="stack" created="Fri, 4 Sep 2015 03:09:34 +0000"  >&lt;p&gt;Fix checkstyles&lt;/p&gt;</comment>
                            <comment id="14730287" author="eclark" created="Fri, 4 Sep 2015 04:13:56 +0000"  >&lt;p&gt;+1 still stands. The extra code clean ups are nice.&lt;/p&gt;</comment>
                            <comment id="14730301" author="hadoopqa" created="Fri, 4 Sep 2015 04:44:57 +0000"  >&lt;p&gt;&lt;font color=&quot;red&quot;&gt;-1 overall&lt;/font&gt;.  Here are the results of testing the latest attachment &lt;br/&gt;
  &lt;a href=&quot;http://issues.apache.org/jira/secure/attachment/12754134/14317v15.txt&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/secure/attachment/12754134/14317v15.txt&lt;/a&gt;&lt;br/&gt;
  against master branch at commit 2481b7f76fa7e4f2b120f8dc96004790b357e569.&lt;br/&gt;
  ATTACHMENT ID: 12754134&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 @author&lt;/font&gt;.  The patch does not contain any @author tags.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 tests included&lt;/font&gt;.  The patch appears to include 18 new or modified tests.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 hadoop versions&lt;/font&gt;. The patch compiles with all supported hadoop versions (2.4.0 2.4.1 2.5.0 2.5.1 2.5.2 2.6.0 2.7.0 2.7.1)&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 javac&lt;/font&gt;.  The applied patch does not increase the total number of javac compiler warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 protoc&lt;/font&gt;.  The applied patch does not increase the total number of protoc compiler warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 javadoc&lt;/font&gt;.  The javadoc tool did not generate any warning messages.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 checkstyle&lt;/font&gt;.  The applied patch does not increase the total number of checkstyle errors&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 findbugs&lt;/font&gt;.  The patch does not introduce any  new Findbugs (version 2.0.3) warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 release audit&lt;/font&gt;.  The applied patch does not increase the total number of release audit warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 lineLengths&lt;/font&gt;.  The patch does not introduce lines longer than 100&lt;/p&gt;

&lt;p&gt;  &lt;font color=&quot;green&quot;&gt;+1 site&lt;/font&gt;.  The mvn post-site goal succeeds with this patch.&lt;/p&gt;

&lt;p&gt;     &lt;font color=&quot;red&quot;&gt;-1 core tests&lt;/font&gt;.  The patch failed these unit tests:&lt;/p&gt;


&lt;p&gt;Test results: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/15410//testReport/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/15410//testReport/&lt;/a&gt;&lt;br/&gt;
Release Findbugs (version 2.0.3) 	warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/15410//artifact/patchprocess/newFindbugsWarnings.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/15410//artifact/patchprocess/newFindbugsWarnings.html&lt;/a&gt;&lt;br/&gt;
Checkstyle Errors: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/15410//artifact/patchprocess/checkstyle-aggregate.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/15410//artifact/patchprocess/checkstyle-aggregate.html&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;  Console output: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/15410//console&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/15410//console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="14730360" author="hudson" created="Fri, 4 Sep 2015 05:57:29 +0000"  >&lt;p&gt;FAILURE: Integrated in HBase-TRUNK #6778 (See &lt;a href=&quot;https://builds.apache.org/job/HBase-TRUNK/6778/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/HBase-TRUNK/6778/&lt;/a&gt;)&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-14317&quot; title=&quot;Stuck FSHLog: bad disk (HDFS-8960) and can&amp;#39;t roll WAL&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-14317&quot;&gt;&lt;del&gt;HBASE-14317&lt;/del&gt;&lt;/a&gt; Stuck FSHLog: bad disk (&lt;a href=&quot;https://issues.apache.org/jira/browse/HDFS-8960&quot; title=&quot;DFS client says &amp;quot;no more good datanodes being available to try&amp;quot; on a single drive failure&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HDFS-8960&quot;&gt;HDFS-8960&lt;/a&gt;) and can&apos;t roll WAL (stack: rev 661faf6fe0833726d7ce7ad44a829eba3f8e3e45)&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;hbase-server/src/main/java/org/apache/hadoop/hbase/regionserver/wal/HLogKey.java&lt;/li&gt;
	&lt;li&gt;hbase-server/src/main/java/org/apache/hadoop/hbase/regionserver/wal/SyncFuture.java&lt;/li&gt;
	&lt;li&gt;hbase-server/src/main/java/org/apache/hadoop/hbase/regionserver/wal/ProtobufLogWriter.java&lt;/li&gt;
	&lt;li&gt;hbase-server/src/main/java/org/apache/hadoop/hbase/regionserver/HRegion.java&lt;/li&gt;
	&lt;li&gt;hbase-server/src/test/java/org/apache/hadoop/hbase/regionserver/TestWALLockup.java&lt;/li&gt;
	&lt;li&gt;hbase-server/src/main/java/org/apache/hadoop/hbase/regionserver/LogRoller.java&lt;/li&gt;
	&lt;li&gt;hbase-server/src/test/java/org/apache/hadoop/hbase/regionserver/wal/TestLogRolling.java&lt;/li&gt;
	&lt;li&gt;hbase-server/src/main/java/org/apache/hadoop/hbase/regionserver/wal/ProtobufLogReader.java&lt;/li&gt;
	&lt;li&gt;hbase-server/src/main/java/org/apache/hadoop/hbase/io/hfile/HFile.java&lt;/li&gt;
	&lt;li&gt;hbase-server/src/main/java/org/apache/hadoop/hbase/regionserver/wal/FSHLog.java&lt;/li&gt;
	&lt;li&gt;hbase-server/src/test/java/org/apache/hadoop/hbase/regionserver/TestHRegion.java&lt;/li&gt;
	&lt;li&gt;hbase-server/src/main/java/org/apache/hadoop/hbase/regionserver/MultiVersionConcurrencyControl.java&lt;/li&gt;
	&lt;li&gt;hbase-server/src/main/java/org/apache/hadoop/hbase/regionserver/wal/FSWALEntry.java&lt;/li&gt;
	&lt;li&gt;hbase-server/src/test/java/org/apache/hadoop/hbase/regionserver/TestMultiVersionConcurrencyControlBasic.java&lt;/li&gt;
	&lt;li&gt;hbase-server/src/test/java/org/apache/hadoop/hbase/regionserver/TestMultiVersionConcurrencyControl.java&lt;/li&gt;
	&lt;li&gt;hbase-server/src/main/java/org/apache/hadoop/hbase/wal/WALKey.java&lt;/li&gt;
	&lt;li&gt;hbase-server/src/main/java/org/apache/hadoop/hbase/regionserver/wal/DamagedWALException.java&lt;/li&gt;
	&lt;li&gt;hbase-server/src/test/java/org/apache/hadoop/hbase/regionserver/TestFSErrorsExposed.java&lt;/li&gt;
	&lt;li&gt;hbase-server/src/test/java/org/apache/hadoop/hbase/regionserver/TestFailedAppendAndSync.java&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-14317&quot; title=&quot;Stuck FSHLog: bad disk (HDFS-8960) and can&amp;#39;t roll WAL&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-14317&quot;&gt;&lt;del&gt;HBASE-14317&lt;/del&gt;&lt;/a&gt; Stuck FSHLog: bad disk (&lt;a href=&quot;https://issues.apache.org/jira/browse/HDFS-8960&quot; title=&quot;DFS client says &amp;quot;no more good datanodes being available to try&amp;quot; on a single drive failure&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HDFS-8960&quot;&gt;HDFS-8960&lt;/a&gt;) and can&apos;t roll WAL; addendum (stack: rev 54717a6314ef6673f7607091e5f77321c202d49f)&lt;/li&gt;
	&lt;li&gt;hbase-server/src/test/java/org/apache/hadoop/hbase/regionserver/TestFSErrorsExposed.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="14730446" author="stack" created="Fri, 4 Sep 2015 07:39:20 +0000"  >&lt;p&gt;Here is a patch for branch-1. Its a little different, enough to make me want to get a QA run on it first.&lt;/p&gt;</comment>
                            <comment id="14730452" author="stack" created="Fri, 4 Sep 2015 07:41:52 +0000"  >&lt;p&gt;Testing branch-1, I found this little hole. I committed it as an addendum to master branch. The patch is included what I&apos;ve posted for branch-1.&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
diff --git a/hbase-server/src/main/java/org/apache/hadoop/hbase/regionserver/wal/FSHLog.java b/hbase-server/src/main/java/org/apache/hadoop/hbase/regionserver/wal/FSHLog.java
index 5708c30..c421f5c 100644
--- a/hbase-server/src/main/java/org/apache/hadoop/hbase/regionserver/wal/FSHLog.java
+++ b/hbase-server/src/main/java/org/apache/hadoop/hbase/regionserver/wal/FSHLog.java
@@ -878,8 +878,19 @@ &lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; class FSHLog &lt;span class=&quot;code-keyword&quot;&gt;implements&lt;/span&gt; WAL {
         &lt;span class=&quot;code-comment&quot;&gt;// Let the writer thread go regardless, whether error or not.
&lt;/span&gt;         &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (zigzagLatch != &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;) {
           zigzagLatch.releaseSafePoint();
-          &lt;span class=&quot;code-comment&quot;&gt;// It will be &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; we failed our wait on safe point above.
&lt;/span&gt;-          &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (syncFuture != &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;) blockOnSync(syncFuture);
+          &lt;span class=&quot;code-comment&quot;&gt;// syncFuture will be &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; we failed our wait on safe point above. Otherwise, &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt;
&lt;/span&gt;+          &lt;span class=&quot;code-comment&quot;&gt;// latch was obtained successfully, the sync we threw in either trigger the latch or it
&lt;/span&gt;+          &lt;span class=&quot;code-comment&quot;&gt;// got stamped with an exception because the WAL was damaged and we could not sync. Now
&lt;/span&gt;+          &lt;span class=&quot;code-comment&quot;&gt;// the write pipeline has been opened up again by releasing the safe point, process the
&lt;/span&gt;+          &lt;span class=&quot;code-comment&quot;&gt;// syncFuture we got above. This is probably a noop but it may be stale exception from
&lt;/span&gt;+          &lt;span class=&quot;code-comment&quot;&gt;// when old WAL was in place. Catch it &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; so.
&lt;/span&gt;+          &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (syncFuture != &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;) {
+            &lt;span class=&quot;code-keyword&quot;&gt;try&lt;/span&gt; {
+              blockOnSync(syncFuture);
+            } &lt;span class=&quot;code-keyword&quot;&gt;catch&lt;/span&gt; (IOException ioe) {
+              &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (LOG.isTraceEnabled()) LOG.trace(&lt;span class=&quot;code-quote&quot;&gt;&quot;Stale sync exception&quot;&lt;/span&gt;, ioe);
+            }
+          }
         }
       } &lt;span class=&quot;code-keyword&quot;&gt;finally&lt;/span&gt; {
         scope.close();
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="14730453" author="hadoopqa" created="Fri, 4 Sep 2015 07:42:01 +0000"  >&lt;p&gt;&lt;font color=&quot;red&quot;&gt;-1 overall&lt;/font&gt;.  Here are the results of testing the latest attachment &lt;br/&gt;
  &lt;a href=&quot;http://issues.apache.org/jira/secure/attachment/12754161/14317.branch-1.txt&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/secure/attachment/12754161/14317.branch-1.txt&lt;/a&gt;&lt;br/&gt;
  against branch-1 branch at commit 54717a6314ef6673f7607091e5f77321c202d49f.&lt;br/&gt;
  ATTACHMENT ID: 12754161&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 @author&lt;/font&gt;.  The patch does not contain any @author tags.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 tests included&lt;/font&gt;.  The patch appears to include 18 new or modified tests.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;red&quot;&gt;-1 javac&lt;/font&gt;.  The patch appears to cause mvn compile goal to fail with Hadoop version 2.4.0.&lt;/p&gt;

&lt;p&gt;    Compilation errors resume:&lt;br/&gt;
    &lt;span class=&quot;error&quot;&gt;&amp;#91;ERROR&amp;#93;&lt;/span&gt; Error invoking method &apos;get(java.lang.Integer)&apos; in java.util.ArrayList at META-INF/LICENSE.vm&lt;span class=&quot;error&quot;&gt;&amp;#91;line 1619, column 22&amp;#93;&lt;/span&gt;&lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;ERROR&amp;#93;&lt;/span&gt; Failed to execute goal org.apache.maven.plugins:maven-remote-resources-plugin:1.5:process (default) on project hbase-assembly: Error rendering velocity resource. Error invoking method &apos;get(java.lang.Integer)&apos; in java.util.ArrayList at META-INF/LICENSE.vm&lt;span class=&quot;error&quot;&gt;&amp;#91;line 1619, column 22&amp;#93;&lt;/span&gt;: InvocationTargetException: Index: 0, Size: 0 -&amp;gt; &lt;span class=&quot;error&quot;&gt;&amp;#91;Help 1&amp;#93;&lt;/span&gt;&lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;ERROR&amp;#93;&lt;/span&gt; &lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;ERROR&amp;#93;&lt;/span&gt; To see the full stack trace of the errors, re-run Maven with the -e switch.&lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;ERROR&amp;#93;&lt;/span&gt; Re-run Maven using the -X switch to enable full debug logging.&lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;ERROR&amp;#93;&lt;/span&gt; &lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;ERROR&amp;#93;&lt;/span&gt; For more information about the errors and possible solutions, please read the following articles:&lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;ERROR&amp;#93;&lt;/span&gt; &lt;span class=&quot;error&quot;&gt;&amp;#91;Help 1&amp;#93;&lt;/span&gt; &lt;a href=&quot;http://cwiki.apache.org/confluence/display/MAVEN/MojoExecutionException&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://cwiki.apache.org/confluence/display/MAVEN/MojoExecutionException&lt;/a&gt;&lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;ERROR&amp;#93;&lt;/span&gt; &lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;ERROR&amp;#93;&lt;/span&gt; After correcting the problems, you can resume the build with the command&lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;ERROR&amp;#93;&lt;/span&gt;   mvn &amp;lt;goals&amp;gt; -rf :hbase-assembly&lt;/p&gt;


&lt;p&gt;Console output: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/15412//console&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/15412//console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="14730700" author="hudson" created="Fri, 4 Sep 2015 12:13:09 +0000"  >&lt;p&gt;FAILURE: Integrated in HBase-TRUNK #6780 (See &lt;a href=&quot;https://builds.apache.org/job/HBase-TRUNK/6780/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/HBase-TRUNK/6780/&lt;/a&gt;)&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-14317&quot; title=&quot;Stuck FSHLog: bad disk (HDFS-8960) and can&amp;#39;t roll WAL&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-14317&quot;&gt;&lt;del&gt;HBASE-14317&lt;/del&gt;&lt;/a&gt; Stuck FSHLog: bad disk (&lt;a href=&quot;https://issues.apache.org/jira/browse/HDFS-8960&quot; title=&quot;DFS client says &amp;quot;no more good datanodes being available to try&amp;quot; on a single drive failure&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HDFS-8960&quot;&gt;HDFS-8960&lt;/a&gt;) and can&apos;t roll WAL; addendum2 &amp;#8211; found a fix testing the branch-1 patch (stack: rev ec4d719f1927576d3de321c2e380e4c4acd099db)&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;hbase-server/src/main/java/org/apache/hadoop/hbase/regionserver/wal/FSHLog.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="14730951" author="stack" created="Fri, 4 Sep 2015 15:25:04 +0000"  >&lt;p&gt;This one again: &quot;Failed to execute goal org.apache.maven.plugins:maven-remote-resources-plugin:1.5:process (default) on project hbase-assembly: Error rendering velocity resource. Error invoking method &apos;get(java.lang.Integer)&apos; in java.util.ArrayList at META-INF/LICENSE.vm&lt;span class=&quot;error&quot;&gt;&amp;#91;line 1619, column 22&amp;#93;&lt;/span&gt;: &quot;&lt;/p&gt;

&lt;p&gt;Retry&lt;/p&gt;</comment>
                            <comment id="14730959" author="hadoopqa" created="Fri, 4 Sep 2015 15:31:47 +0000"  >&lt;p&gt;&lt;font color=&quot;red&quot;&gt;-1 overall&lt;/font&gt;.  Here are the results of testing the latest attachment &lt;br/&gt;
  &lt;a href=&quot;http://issues.apache.org/jira/secure/attachment/12754211/14317.branch-1.txt&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/secure/attachment/12754211/14317.branch-1.txt&lt;/a&gt;&lt;br/&gt;
  against branch-1 branch at commit ec4d719f1927576d3de321c2e380e4c4acd099db.&lt;br/&gt;
  ATTACHMENT ID: 12754211&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 @author&lt;/font&gt;.  The patch does not contain any @author tags.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 tests included&lt;/font&gt;.  The patch appears to include 18 new or modified tests.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;red&quot;&gt;-1 javac&lt;/font&gt;.  The patch appears to cause mvn compile goal to fail with Hadoop version 2.4.0.&lt;/p&gt;

&lt;p&gt;    Compilation errors resume:&lt;br/&gt;
    &lt;span class=&quot;error&quot;&gt;&amp;#91;ERROR&amp;#93;&lt;/span&gt; Error invoking method &apos;get(java.lang.Integer)&apos; in java.util.ArrayList at META-INF/LICENSE.vm&lt;span class=&quot;error&quot;&gt;&amp;#91;line 1619, column 22&amp;#93;&lt;/span&gt;&lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;ERROR&amp;#93;&lt;/span&gt; Failed to execute goal org.apache.maven.plugins:maven-remote-resources-plugin:1.5:process (default) on project hbase-assembly: Error rendering velocity resource. Error invoking method &apos;get(java.lang.Integer)&apos; in java.util.ArrayList at META-INF/LICENSE.vm&lt;span class=&quot;error&quot;&gt;&amp;#91;line 1619, column 22&amp;#93;&lt;/span&gt;: InvocationTargetException: Index: 0, Size: 0 -&amp;gt; &lt;span class=&quot;error&quot;&gt;&amp;#91;Help 1&amp;#93;&lt;/span&gt;&lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;ERROR&amp;#93;&lt;/span&gt; &lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;ERROR&amp;#93;&lt;/span&gt; To see the full stack trace of the errors, re-run Maven with the -e switch.&lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;ERROR&amp;#93;&lt;/span&gt; Re-run Maven using the -X switch to enable full debug logging.&lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;ERROR&amp;#93;&lt;/span&gt; &lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;ERROR&amp;#93;&lt;/span&gt; For more information about the errors and possible solutions, please read the following articles:&lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;ERROR&amp;#93;&lt;/span&gt; &lt;span class=&quot;error&quot;&gt;&amp;#91;Help 1&amp;#93;&lt;/span&gt; &lt;a href=&quot;http://cwiki.apache.org/confluence/display/MAVEN/MojoExecutionException&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://cwiki.apache.org/confluence/display/MAVEN/MojoExecutionException&lt;/a&gt;&lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;ERROR&amp;#93;&lt;/span&gt; &lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;ERROR&amp;#93;&lt;/span&gt; After correcting the problems, you can resume the build with the command&lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;ERROR&amp;#93;&lt;/span&gt;   mvn &amp;lt;goals&amp;gt; -rf :hbase-assembly&lt;/p&gt;


&lt;p&gt;Console output: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/15416//console&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/15416//console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="14730962" author="busbey" created="Fri, 4 Sep 2015 15:32:56 +0000"  >&lt;p&gt;dang it. we don&apos;t save the generated LICENSE/NOTICE files, so my new debug code to see the bad dependency doesn&apos;t help. updated the precommit job to start saving them. :/&lt;/p&gt;</comment>
                            <comment id="14730963" author="busbey" created="Fri, 4 Sep 2015 15:34:24 +0000"  >&lt;p&gt;they were both on H2, so the second failure is probably just the stored dep from the first (or an earlier) faliure. on the plus side this means the next job to run on H2 will also fail and then I&apos;ll have the LICENSE file.&lt;/p&gt;</comment>
                            <comment id="14731805" author="stack" created="Sat, 5 Sep 2015 05:05:32 +0000"  >&lt;p&gt;Retry the branch patch. This v2 includes the subtask &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-14368&quot; title=&quot;New TestWALLockup broken by addendum added to parent issue&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-14368&quot;&gt;&lt;del&gt;HBASE-14368&lt;/del&gt;&lt;/a&gt; and all addendums applied to trunk.&lt;/p&gt;</comment>
                            <comment id="14731807" author="hadoopqa" created="Sat, 5 Sep 2015 05:11:51 +0000"  >&lt;p&gt;&lt;font color=&quot;red&quot;&gt;-1 overall&lt;/font&gt;.  Here are the results of testing the latest attachment &lt;br/&gt;
  &lt;a href=&quot;http://issues.apache.org/jira/secure/attachment/12754313/14317.branch-1.v2.txt&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/secure/attachment/12754313/14317.branch-1.v2.txt&lt;/a&gt;&lt;br/&gt;
  against branch-1 branch at commit 2969093b5b39cb950d8710cfffa7e55484d40259.&lt;br/&gt;
  ATTACHMENT ID: 12754313&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 @author&lt;/font&gt;.  The patch does not contain any @author tags.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 tests included&lt;/font&gt;.  The patch appears to include 18 new or modified tests.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;red&quot;&gt;-1 javac&lt;/font&gt;.  The patch appears to cause mvn compile goal to fail with Hadoop version 2.4.0.&lt;/p&gt;

&lt;p&gt;    Compilation errors resume:&lt;br/&gt;
    &lt;span class=&quot;error&quot;&gt;&amp;#91;ERROR&amp;#93;&lt;/span&gt; Error invoking method &apos;get(java.lang.Integer)&apos; in java.util.ArrayList at META-INF/LICENSE.vm&lt;span class=&quot;error&quot;&gt;&amp;#91;line 1619, column 22&amp;#93;&lt;/span&gt;&lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;ERROR&amp;#93;&lt;/span&gt; Failed to execute goal org.apache.maven.plugins:maven-remote-resources-plugin:1.5:process (default) on project hbase-assembly: Error rendering velocity resource. Error invoking method &apos;get(java.lang.Integer)&apos; in java.util.ArrayList at META-INF/LICENSE.vm&lt;span class=&quot;error&quot;&gt;&amp;#91;line 1619, column 22&amp;#93;&lt;/span&gt;: InvocationTargetException: Index: 0, Size: 0 -&amp;gt; &lt;span class=&quot;error&quot;&gt;&amp;#91;Help 1&amp;#93;&lt;/span&gt;&lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;ERROR&amp;#93;&lt;/span&gt; &lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;ERROR&amp;#93;&lt;/span&gt; To see the full stack trace of the errors, re-run Maven with the -e switch.&lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;ERROR&amp;#93;&lt;/span&gt; Re-run Maven using the -X switch to enable full debug logging.&lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;ERROR&amp;#93;&lt;/span&gt; &lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;ERROR&amp;#93;&lt;/span&gt; For more information about the errors and possible solutions, please read the following articles:&lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;ERROR&amp;#93;&lt;/span&gt; &lt;span class=&quot;error&quot;&gt;&amp;#91;Help 1&amp;#93;&lt;/span&gt; &lt;a href=&quot;http://cwiki.apache.org/confluence/display/MAVEN/MojoExecutionException&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://cwiki.apache.org/confluence/display/MAVEN/MojoExecutionException&lt;/a&gt;&lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;ERROR&amp;#93;&lt;/span&gt; &lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;ERROR&amp;#93;&lt;/span&gt; After correcting the problems, you can resume the build with the command&lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;ERROR&amp;#93;&lt;/span&gt;   mvn &amp;lt;goals&amp;gt; -rf :hbase-assembly&lt;/p&gt;


&lt;p&gt;Console output: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/15427//console&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/15427//console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="14731814" author="stack" created="Sat, 5 Sep 2015 05:30:55 +0000"  >&lt;p&gt;Failed because of velocity parse error.&lt;/p&gt;</comment>
                            <comment id="14731820" author="hadoopqa" created="Sat, 5 Sep 2015 05:41:50 +0000"  >&lt;p&gt;&lt;font color=&quot;red&quot;&gt;-1 overall&lt;/font&gt;.  Here are the results of testing the latest attachment &lt;br/&gt;
  &lt;a href=&quot;http://issues.apache.org/jira/secure/attachment/12754314/14317.branch-1.v2.txt&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/secure/attachment/12754314/14317.branch-1.v2.txt&lt;/a&gt;&lt;br/&gt;
  against branch-1 branch at commit 2969093b5b39cb950d8710cfffa7e55484d40259.&lt;br/&gt;
  ATTACHMENT ID: 12754314&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 @author&lt;/font&gt;.  The patch does not contain any @author tags.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 tests included&lt;/font&gt;.  The patch appears to include 18 new or modified tests.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;red&quot;&gt;-1 javac&lt;/font&gt;.  The patch appears to cause mvn compile goal to fail with Hadoop version 2.4.0.&lt;/p&gt;

&lt;p&gt;    Compilation errors resume:&lt;br/&gt;
    &lt;span class=&quot;error&quot;&gt;&amp;#91;ERROR&amp;#93;&lt;/span&gt; Error invoking method &apos;get(java.lang.Integer)&apos; in java.util.ArrayList at META-INF/LICENSE.vm&lt;span class=&quot;error&quot;&gt;&amp;#91;line 1619, column 22&amp;#93;&lt;/span&gt;&lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;ERROR&amp;#93;&lt;/span&gt; Failed to execute goal org.apache.maven.plugins:maven-remote-resources-plugin:1.5:process (default) on project hbase-assembly: Error rendering velocity resource. Error invoking method &apos;get(java.lang.Integer)&apos; in java.util.ArrayList at META-INF/LICENSE.vm&lt;span class=&quot;error&quot;&gt;&amp;#91;line 1619, column 22&amp;#93;&lt;/span&gt;: InvocationTargetException: Index: 0, Size: 0 -&amp;gt; &lt;span class=&quot;error&quot;&gt;&amp;#91;Help 1&amp;#93;&lt;/span&gt;&lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;ERROR&amp;#93;&lt;/span&gt; &lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;ERROR&amp;#93;&lt;/span&gt; To see the full stack trace of the errors, re-run Maven with the -e switch.&lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;ERROR&amp;#93;&lt;/span&gt; Re-run Maven using the -X switch to enable full debug logging.&lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;ERROR&amp;#93;&lt;/span&gt; &lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;ERROR&amp;#93;&lt;/span&gt; For more information about the errors and possible solutions, please read the following articles:&lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;ERROR&amp;#93;&lt;/span&gt; &lt;span class=&quot;error&quot;&gt;&amp;#91;Help 1&amp;#93;&lt;/span&gt; &lt;a href=&quot;http://cwiki.apache.org/confluence/display/MAVEN/MojoExecutionException&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://cwiki.apache.org/confluence/display/MAVEN/MojoExecutionException&lt;/a&gt;&lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;ERROR&amp;#93;&lt;/span&gt; &lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;ERROR&amp;#93;&lt;/span&gt; After correcting the problems, you can resume the build with the command&lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;ERROR&amp;#93;&lt;/span&gt;   mvn &amp;lt;goals&amp;gt; -rf :hbase-assembly&lt;/p&gt;


&lt;p&gt;Console output: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/15429//console&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/15429//console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="14731823" author="stack" created="Sat, 5 Sep 2015 05:48:02 +0000"  >&lt;p&gt;Velocity error. Retry&lt;/p&gt;</comment>
                            <comment id="14731824" author="hadoopqa" created="Sat, 5 Sep 2015 05:51:50 +0000"  >&lt;p&gt;&lt;font color=&quot;red&quot;&gt;-1 overall&lt;/font&gt;.  Here are the results of testing the latest attachment &lt;br/&gt;
  &lt;a href=&quot;http://issues.apache.org/jira/secure/attachment/12754316/14317.branch-1.v2.txt&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/secure/attachment/12754316/14317.branch-1.v2.txt&lt;/a&gt;&lt;br/&gt;
  against branch-1 branch at commit a11f5c55b4d247c3ac0950398624383ec38e6f1b.&lt;br/&gt;
  ATTACHMENT ID: 12754316&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 @author&lt;/font&gt;.  The patch does not contain any @author tags.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 tests included&lt;/font&gt;.  The patch appears to include 18 new or modified tests.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;red&quot;&gt;-1 javac&lt;/font&gt;.  The patch appears to cause mvn compile goal to fail with Hadoop version 2.4.0.&lt;/p&gt;

&lt;p&gt;    Compilation errors resume:&lt;br/&gt;
    &lt;span class=&quot;error&quot;&gt;&amp;#91;ERROR&amp;#93;&lt;/span&gt; Error invoking method &apos;get(java.lang.Integer)&apos; in java.util.ArrayList at META-INF/LICENSE.vm&lt;span class=&quot;error&quot;&gt;&amp;#91;line 1619, column 22&amp;#93;&lt;/span&gt;&lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;ERROR&amp;#93;&lt;/span&gt; Failed to execute goal org.apache.maven.plugins:maven-remote-resources-plugin:1.5:process (default) on project hbase-assembly: Error rendering velocity resource. Error invoking method &apos;get(java.lang.Integer)&apos; in java.util.ArrayList at META-INF/LICENSE.vm&lt;span class=&quot;error&quot;&gt;&amp;#91;line 1619, column 22&amp;#93;&lt;/span&gt;: InvocationTargetException: Index: 0, Size: 0 -&amp;gt; &lt;span class=&quot;error&quot;&gt;&amp;#91;Help 1&amp;#93;&lt;/span&gt;&lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;ERROR&amp;#93;&lt;/span&gt; &lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;ERROR&amp;#93;&lt;/span&gt; To see the full stack trace of the errors, re-run Maven with the -e switch.&lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;ERROR&amp;#93;&lt;/span&gt; Re-run Maven using the -X switch to enable full debug logging.&lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;ERROR&amp;#93;&lt;/span&gt; &lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;ERROR&amp;#93;&lt;/span&gt; For more information about the errors and possible solutions, please read the following articles:&lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;ERROR&amp;#93;&lt;/span&gt; &lt;span class=&quot;error&quot;&gt;&amp;#91;Help 1&amp;#93;&lt;/span&gt; &lt;a href=&quot;http://cwiki.apache.org/confluence/display/MAVEN/MojoExecutionException&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://cwiki.apache.org/confluence/display/MAVEN/MojoExecutionException&lt;/a&gt;&lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;ERROR&amp;#93;&lt;/span&gt; &lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;ERROR&amp;#93;&lt;/span&gt; After correcting the problems, you can resume the build with the command&lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;ERROR&amp;#93;&lt;/span&gt;   mvn &amp;lt;goals&amp;gt; -rf :hbase-assembly&lt;/p&gt;


&lt;p&gt;Console output: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/15430//console&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/15430//console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="14731825" author="stack" created="Sat, 5 Sep 2015 05:59:04 +0000"  >&lt;p&gt;Velocity errors again.&lt;/p&gt;</comment>
                            <comment id="14731827" author="stack" created="Sat, 5 Sep 2015 06:01:16 +0000"  >&lt;p&gt;More velocity&lt;/p&gt;</comment>
                            <comment id="14731830" author="hadoopqa" created="Sat, 5 Sep 2015 06:11:45 +0000"  >&lt;p&gt;&lt;font color=&quot;red&quot;&gt;-1 overall&lt;/font&gt;.  Here are the results of testing the latest attachment &lt;br/&gt;
  &lt;a href=&quot;http://issues.apache.org/jira/secure/attachment/12754317/14317.branch-1.v2.txt&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/secure/attachment/12754317/14317.branch-1.v2.txt&lt;/a&gt;&lt;br/&gt;
  against branch-1 branch at commit a11f5c55b4d247c3ac0950398624383ec38e6f1b.&lt;br/&gt;
  ATTACHMENT ID: 12754317&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 @author&lt;/font&gt;.  The patch does not contain any @author tags.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 tests included&lt;/font&gt;.  The patch appears to include 18 new or modified tests.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;red&quot;&gt;-1 javac&lt;/font&gt;.  The patch appears to cause mvn compile goal to fail with Hadoop version 2.4.0.&lt;/p&gt;

&lt;p&gt;    Compilation errors resume:&lt;br/&gt;
    &lt;span class=&quot;error&quot;&gt;&amp;#91;ERROR&amp;#93;&lt;/span&gt; Error invoking method &apos;get(java.lang.Integer)&apos; in java.util.ArrayList at META-INF/LICENSE.vm&lt;span class=&quot;error&quot;&gt;&amp;#91;line 1619, column 22&amp;#93;&lt;/span&gt;&lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;ERROR&amp;#93;&lt;/span&gt; Failed to execute goal org.apache.maven.plugins:maven-remote-resources-plugin:1.5:process (default) on project hbase-assembly: Error rendering velocity resource. Error invoking method &apos;get(java.lang.Integer)&apos; in java.util.ArrayList at META-INF/LICENSE.vm&lt;span class=&quot;error&quot;&gt;&amp;#91;line 1619, column 22&amp;#93;&lt;/span&gt;: InvocationTargetException: Index: 0, Size: 0 -&amp;gt; &lt;span class=&quot;error&quot;&gt;&amp;#91;Help 1&amp;#93;&lt;/span&gt;&lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;ERROR&amp;#93;&lt;/span&gt; &lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;ERROR&amp;#93;&lt;/span&gt; To see the full stack trace of the errors, re-run Maven with the -e switch.&lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;ERROR&amp;#93;&lt;/span&gt; Re-run Maven using the -X switch to enable full debug logging.&lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;ERROR&amp;#93;&lt;/span&gt; &lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;ERROR&amp;#93;&lt;/span&gt; For more information about the errors and possible solutions, please read the following articles:&lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;ERROR&amp;#93;&lt;/span&gt; &lt;span class=&quot;error&quot;&gt;&amp;#91;Help 1&amp;#93;&lt;/span&gt; &lt;a href=&quot;http://cwiki.apache.org/confluence/display/MAVEN/MojoExecutionException&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://cwiki.apache.org/confluence/display/MAVEN/MojoExecutionException&lt;/a&gt;&lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;ERROR&amp;#93;&lt;/span&gt; &lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;ERROR&amp;#93;&lt;/span&gt; After correcting the problems, you can resume the build with the command&lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;ERROR&amp;#93;&lt;/span&gt;   mvn &amp;lt;goals&amp;gt; -rf :hbase-assembly&lt;/p&gt;


&lt;p&gt;Console output: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/15432//console&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/15432//console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="14732022" author="hadoopqa" created="Sat, 5 Sep 2015 16:03:32 +0000"  >&lt;p&gt;&lt;font color=&quot;red&quot;&gt;-1 overall&lt;/font&gt;.  Here are the results of testing the latest attachment &lt;br/&gt;
  &lt;a href=&quot;http://issues.apache.org/jira/secure/attachment/12754328/14317.branch-1.v2.txt&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/secure/attachment/12754328/14317.branch-1.v2.txt&lt;/a&gt;&lt;br/&gt;
  against branch-1 branch at commit bada19bb54a358233db2b3e23c86d215ac2dc29b.&lt;br/&gt;
  ATTACHMENT ID: 12754328&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 @author&lt;/font&gt;.  The patch does not contain any @author tags.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 tests included&lt;/font&gt;.  The patch appears to include 18 new or modified tests.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;red&quot;&gt;-1 javac&lt;/font&gt;.  The patch appears to cause mvn compile goal to fail with Hadoop version 2.4.0.&lt;/p&gt;

&lt;p&gt;    Compilation errors resume:&lt;br/&gt;
    &lt;span class=&quot;error&quot;&gt;&amp;#91;ERROR&amp;#93;&lt;/span&gt; Error invoking method &apos;get(java.lang.Integer)&apos; in java.util.ArrayList at META-INF/LICENSE.vm&lt;span class=&quot;error&quot;&gt;&amp;#91;line 1619, column 22&amp;#93;&lt;/span&gt;&lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;ERROR&amp;#93;&lt;/span&gt; Failed to execute goal org.apache.maven.plugins:maven-remote-resources-plugin:1.5:process (default) on project hbase-assembly: Error rendering velocity resource. Error invoking method &apos;get(java.lang.Integer)&apos; in java.util.ArrayList at META-INF/LICENSE.vm&lt;span class=&quot;error&quot;&gt;&amp;#91;line 1619, column 22&amp;#93;&lt;/span&gt;: InvocationTargetException: Index: 0, Size: 0 -&amp;gt; &lt;span class=&quot;error&quot;&gt;&amp;#91;Help 1&amp;#93;&lt;/span&gt;&lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;ERROR&amp;#93;&lt;/span&gt; &lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;ERROR&amp;#93;&lt;/span&gt; To see the full stack trace of the errors, re-run Maven with the -e switch.&lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;ERROR&amp;#93;&lt;/span&gt; Re-run Maven using the -X switch to enable full debug logging.&lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;ERROR&amp;#93;&lt;/span&gt; &lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;ERROR&amp;#93;&lt;/span&gt; For more information about the errors and possible solutions, please read the following articles:&lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;ERROR&amp;#93;&lt;/span&gt; &lt;span class=&quot;error&quot;&gt;&amp;#91;Help 1&amp;#93;&lt;/span&gt; &lt;a href=&quot;http://cwiki.apache.org/confluence/display/MAVEN/MojoExecutionException&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://cwiki.apache.org/confluence/display/MAVEN/MojoExecutionException&lt;/a&gt;&lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;ERROR&amp;#93;&lt;/span&gt; &lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;ERROR&amp;#93;&lt;/span&gt; After correcting the problems, you can resume the build with the command&lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;ERROR&amp;#93;&lt;/span&gt;   mvn &amp;lt;goals&amp;gt; -rf :hbase-assembly&lt;/p&gt;


&lt;p&gt;Console output: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/15434//console&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/15434//console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="14732025" author="busbey" created="Sat, 5 Sep 2015 16:12:40 +0000"  >&lt;p&gt;Are these all on H2? Can we just blacklist it?&lt;/p&gt;

&lt;p&gt;&amp;#8211; &lt;br/&gt;
Sean&lt;/p&gt;
</comment>
                            <comment id="14732040" author="stack" created="Sat, 5 Sep 2015 16:57:06 +0000"  >&lt;p&gt;I was just looking, and yeah, seem to be H2. Lets blacklist.&lt;/p&gt;</comment>
                            <comment id="14732043" author="stack" created="Sat, 5 Sep 2015 16:58:36 +0000"  >&lt;p&gt;Looks like you did it &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=busbey&quot; class=&quot;user-hover&quot; rel=&quot;busbey&quot;&gt;Sean Busbey&lt;/a&gt;. Thanks. Let me retry patch.&lt;/p&gt;</comment>
                            <comment id="14732084" author="hadoopqa" created="Sat, 5 Sep 2015 19:43:21 +0000"  >&lt;p&gt;&lt;font color=&quot;red&quot;&gt;-1 overall&lt;/font&gt;.  Here are the results of testing the latest attachment &lt;br/&gt;
  &lt;a href=&quot;http://issues.apache.org/jira/secure/attachment/12754333/14317.branch-1.v2.txt&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/secure/attachment/12754333/14317.branch-1.v2.txt&lt;/a&gt;&lt;br/&gt;
  against branch-1 branch at commit bada19bb54a358233db2b3e23c86d215ac2dc29b.&lt;br/&gt;
  ATTACHMENT ID: 12754333&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 @author&lt;/font&gt;.  The patch does not contain any @author tags.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 tests included&lt;/font&gt;.  The patch appears to include 18 new or modified tests.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 hadoop versions&lt;/font&gt;. The patch compiles with all supported hadoop versions (2.4.0 2.4.1 2.5.0 2.5.1 2.5.2 2.6.0 2.7.0 2.7.1)&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 javac&lt;/font&gt;.  The applied patch does not increase the total number of javac compiler warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 protoc&lt;/font&gt;.  The applied patch does not increase the total number of protoc compiler warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 javadoc&lt;/font&gt;.  The javadoc tool did not generate any warning messages.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 checkstyle&lt;/font&gt;.  The applied patch does not increase the total number of checkstyle errors&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 findbugs&lt;/font&gt;.  The patch does not introduce any  new Findbugs (version 2.0.3) warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 release audit&lt;/font&gt;.  The applied patch does not increase the total number of release audit warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 lineLengths&lt;/font&gt;.  The patch does not introduce lines longer than 100&lt;/p&gt;

&lt;p&gt;  &lt;font color=&quot;green&quot;&gt;+1 site&lt;/font&gt;.  The mvn post-site goal succeeds with this patch.&lt;/p&gt;

&lt;p&gt;     &lt;font color=&quot;red&quot;&gt;-1 core tests&lt;/font&gt;.  The patch failed these unit tests:&lt;/p&gt;


&lt;p&gt;Test results: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/15439//testReport/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/15439//testReport/&lt;/a&gt;&lt;br/&gt;
Release Findbugs (version 2.0.3) 	warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/15439//artifact/patchprocess/newFindbugsWarnings.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/15439//artifact/patchprocess/newFindbugsWarnings.html&lt;/a&gt;&lt;br/&gt;
Checkstyle Errors: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/15439//artifact/patchprocess/checkstyle-aggregate.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/15439//artifact/patchprocess/checkstyle-aggregate.html&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;  Console output: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/15439//console&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/15439//console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="14732145" author="stack" created="Sun, 6 Sep 2015 00:42:32 +0000"  >&lt;p&gt;Hanging tests are:&lt;/p&gt;

&lt;p&gt;Printing hanging tests&lt;br/&gt;
Hanging test : org.apache.hadoop.hbase.security.access.TestWithDisabledAuthorization&lt;br/&gt;
Hanging test : org.apache.hadoop.hbase.security.access.TestAccessController2&lt;br/&gt;
Hanging test : org.apache.hadoop.hbase.client.TestHCM&lt;br/&gt;
Hanging test : org.apache.hadoop.hbase.security.access.TestCellACLs&lt;br/&gt;
Printing Failing tests&lt;br/&gt;
Failing test : org.apache.hadoop.hbase.util.TestHBaseFsck&lt;/p&gt;

&lt;p&gt;... seems unrelated to change. Let me retry.&lt;/p&gt;</comment>
                            <comment id="14732177" author="hadoopqa" created="Sun, 6 Sep 2015 03:32:36 +0000"  >&lt;p&gt;&lt;font color=&quot;red&quot;&gt;-1 overall&lt;/font&gt;.  Here are the results of testing the latest attachment &lt;br/&gt;
  &lt;a href=&quot;http://issues.apache.org/jira/secure/attachment/12754352/14317.branch-1.v2.txt&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/secure/attachment/12754352/14317.branch-1.v2.txt&lt;/a&gt;&lt;br/&gt;
  against branch-1 branch at commit bada19bb54a358233db2b3e23c86d215ac2dc29b.&lt;br/&gt;
  ATTACHMENT ID: 12754352&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 @author&lt;/font&gt;.  The patch does not contain any @author tags.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 tests included&lt;/font&gt;.  The patch appears to include 18 new or modified tests.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 hadoop versions&lt;/font&gt;. The patch compiles with all supported hadoop versions (2.4.0 2.4.1 2.5.0 2.5.1 2.5.2 2.6.0 2.7.0 2.7.1)&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 javac&lt;/font&gt;.  The applied patch does not increase the total number of javac compiler warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 protoc&lt;/font&gt;.  The applied patch does not increase the total number of protoc compiler warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 javadoc&lt;/font&gt;.  The javadoc tool did not generate any warning messages.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 checkstyle&lt;/font&gt;.  The applied patch does not increase the total number of checkstyle errors&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 findbugs&lt;/font&gt;.  The patch does not introduce any  new Findbugs (version 2.0.3) warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 release audit&lt;/font&gt;.  The applied patch does not increase the total number of release audit warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 lineLengths&lt;/font&gt;.  The patch does not introduce lines longer than 100&lt;/p&gt;

&lt;p&gt;  &lt;font color=&quot;green&quot;&gt;+1 site&lt;/font&gt;.  The mvn post-site goal succeeds with this patch.&lt;/p&gt;

&lt;p&gt;     &lt;font color=&quot;red&quot;&gt;-1 core tests&lt;/font&gt;.  The patch failed these unit tests:&lt;/p&gt;


&lt;p&gt;     &lt;font color=&quot;red&quot;&gt;-1 core zombie tests&lt;/font&gt;.  There are 5 zombie test(s): 	at org.apache.hadoop.hbase.client.TestHCM.testConnectionClose(TestHCM.java:398)&lt;br/&gt;
	at org.apache.hadoop.hbase.client.TestHCM.testConnectionCloseAllowsInterrupt(TestHCM.java:281)&lt;/p&gt;

&lt;p&gt;Test results: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/15442//testReport/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/15442//testReport/&lt;/a&gt;&lt;br/&gt;
Release Findbugs (version 2.0.3) 	warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/15442//artifact/patchprocess/newFindbugsWarnings.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/15442//artifact/patchprocess/newFindbugsWarnings.html&lt;/a&gt;&lt;br/&gt;
Checkstyle Errors: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/15442//artifact/patchprocess/checkstyle-aggregate.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/15442//artifact/patchprocess/checkstyle-aggregate.html&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;  Console output: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/15442//console&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/15442//console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="14732181" author="stack" created="Sun, 6 Sep 2015 04:01:29 +0000"  >&lt;p&gt;Hanging tests this time are:&lt;br/&gt;
kalashnikov:hbase.git.commit stack$ python ./dev-support/findHangingTests.py  &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/15442//consoleText&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/15442//consoleText&lt;/a&gt;&lt;br/&gt;
Fetching the console output from the URL&lt;br/&gt;
Printing hanging tests&lt;br/&gt;
Hanging test : org.apache.hadoop.hbase.security.access.TestWithDisabledAuthorization&lt;br/&gt;
Hanging test : org.apache.hadoop.hbase.security.access.TestAccessController2&lt;br/&gt;
Hanging test : org.apache.hadoop.hbase.client.TestHCM&lt;br/&gt;
Hanging test : org.apache.hadoop.hbase.security.access.TestAccessControlFilter&lt;br/&gt;
Printing Failing tests&lt;/p&gt;

&lt;p&gt;Some items in common. Let me retry and look at what happens local. I&apos;ve been trying to run all tests locally too. The two last runs seem to be missing TestWithDisabledAuthorization, TestAccessController2, and TestAccessControlFilter. The other tests all pass for me. Let me rerun and try these tests locally too.&lt;/p&gt;</comment>
                            <comment id="14732242" author="hadoopqa" created="Sun, 6 Sep 2015 06:57:41 +0000"  >&lt;p&gt;&lt;font color=&quot;red&quot;&gt;-1 overall&lt;/font&gt;.  Here are the results of testing the latest attachment &lt;br/&gt;
  &lt;a href=&quot;http://issues.apache.org/jira/secure/attachment/12754360/14317.branch-1.v2.txt&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/secure/attachment/12754360/14317.branch-1.v2.txt&lt;/a&gt;&lt;br/&gt;
  against branch-1 branch at commit bada19bb54a358233db2b3e23c86d215ac2dc29b.&lt;br/&gt;
  ATTACHMENT ID: 12754360&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 @author&lt;/font&gt;.  The patch does not contain any @author tags.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 tests included&lt;/font&gt;.  The patch appears to include 18 new or modified tests.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 hadoop versions&lt;/font&gt;. The patch compiles with all supported hadoop versions (2.4.0 2.4.1 2.5.0 2.5.1 2.5.2 2.6.0 2.7.0 2.7.1)&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 javac&lt;/font&gt;.  The applied patch does not increase the total number of javac compiler warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 protoc&lt;/font&gt;.  The applied patch does not increase the total number of protoc compiler warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 javadoc&lt;/font&gt;.  The javadoc tool did not generate any warning messages.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 checkstyle&lt;/font&gt;.  The applied patch does not increase the total number of checkstyle errors&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 findbugs&lt;/font&gt;.  The patch does not introduce any  new Findbugs (version 2.0.3) warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 release audit&lt;/font&gt;.  The applied patch does not increase the total number of release audit warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 lineLengths&lt;/font&gt;.  The patch does not introduce lines longer than 100&lt;/p&gt;

&lt;p&gt;  &lt;font color=&quot;green&quot;&gt;+1 site&lt;/font&gt;.  The mvn post-site goal succeeds with this patch.&lt;/p&gt;

&lt;p&gt;     &lt;font color=&quot;red&quot;&gt;-1 core tests&lt;/font&gt;.  The patch failed these unit tests:&lt;/p&gt;


&lt;p&gt;     &lt;font color=&quot;red&quot;&gt;-1 core zombie tests&lt;/font&gt;.  There are 5 zombie test(s): 	at org.apache.hadoop.hbase.security.access.TestAccessController.testCheckPermissions(TestAccessController.java:1632)&lt;br/&gt;
	at org.apache.openjpa.persistence.datacache.TestClearableScheduler.testBasic(TestClearableScheduler.java:76)&lt;br/&gt;
	at org.apache.openjpa.persistence.test.AbstractPersistenceTestCase.runTest(AbstractPersistenceTestCase.java:578)&lt;br/&gt;
	at org.apache.openjpa.persistence.test.AbstractPersistenceTestCase.runBare(AbstractPersistenceTestCase.java:565)&lt;br/&gt;
	at org.apache.openjpa.persistence.test.AbstractPersistenceTestCase.runBare(AbstractPersistenceTestCase.java:541)&lt;br/&gt;
	at org.apache.openjpa.persistence.test.AbstractPersistenceTestCase.run(AbstractPersistenceTestCase.java:206)&lt;/p&gt;

&lt;p&gt;Test results: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/15444//testReport/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/15444//testReport/&lt;/a&gt;&lt;br/&gt;
Release Findbugs (version 2.0.3) 	warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/15444//artifact/patchprocess/newFindbugsWarnings.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/15444//artifact/patchprocess/newFindbugsWarnings.html&lt;/a&gt;&lt;br/&gt;
Checkstyle Errors: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/15444//artifact/patchprocess/checkstyle-aggregate.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/15444//artifact/patchprocess/checkstyle-aggregate.html&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;  Console output: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/15444//console&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/15444//console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="14732447" author="stack" created="Sun, 6 Sep 2015 16:22:41 +0000"  >&lt;p&gt;Says these hbase tests are zombies:&lt;/p&gt;

&lt;p&gt;Printing hanging tests&lt;br/&gt;
Hanging test : org.apache.hadoop.hbase.security.access.TestWithDisabledAuthorization&lt;br/&gt;
Hanging test : org.apache.hadoop.hbase.security.access.TestAccessController2&lt;br/&gt;
Hanging test : org.apache.hadoop.hbase.security.access.TestAccessController&lt;br/&gt;
Hanging test : org.apache.hadoop.hbase.security.access.TestAccessControlFilter&lt;/p&gt;</comment>
                            <comment id="14732536" author="stack" created="Sun, 6 Sep 2015 20:39:29 +0000"  >&lt;p&gt;Patch that adds category-based timeouts on the set of tests that have been showing up here as zombies. Lets see if they timeout without my WAL changes.&lt;/p&gt;</comment>
                            <comment id="14733171" author="hadoopqa" created="Sun, 6 Sep 2015 23:31:16 +0000"  >&lt;p&gt;&lt;font color=&quot;red&quot;&gt;-1 overall&lt;/font&gt;.  Here are the results of testing the latest attachment &lt;br/&gt;
  &lt;a href=&quot;http://issues.apache.org/jira/secure/attachment/12754410/timeouts.branch-1.txt&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/secure/attachment/12754410/timeouts.branch-1.txt&lt;/a&gt;&lt;br/&gt;
  against branch-1 branch at commit bada19bb54a358233db2b3e23c86d215ac2dc29b.&lt;br/&gt;
  ATTACHMENT ID: 12754410&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 @author&lt;/font&gt;.  The patch does not contain any @author tags.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 tests included&lt;/font&gt;.  The patch appears to include 15 new or modified tests.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 hadoop versions&lt;/font&gt;. The patch compiles with all supported hadoop versions (2.4.0 2.4.1 2.5.0 2.5.1 2.5.2 2.6.0 2.7.0 2.7.1)&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 javac&lt;/font&gt;.  The applied patch does not increase the total number of javac compiler warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 protoc&lt;/font&gt;.  The applied patch does not increase the total number of protoc compiler warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 javadoc&lt;/font&gt;.  The javadoc tool did not generate any warning messages.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 checkstyle&lt;/font&gt;.  The applied patch does not increase the total number of checkstyle errors&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 findbugs&lt;/font&gt;.  The patch does not introduce any  new Findbugs (version 2.0.3) warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 release audit&lt;/font&gt;.  The applied patch does not increase the total number of release audit warnings.&lt;/p&gt;

&lt;p&gt;    &lt;font color=&quot;green&quot;&gt;+1 lineLengths&lt;/font&gt;.  The patch does not introduce lines longer than 100&lt;/p&gt;

&lt;p&gt;  &lt;font color=&quot;green&quot;&gt;+1 site&lt;/font&gt;.  The mvn post-site goal succeeds with this patch.&lt;/p&gt;

&lt;p&gt;     &lt;font color=&quot;red&quot;&gt;-1 core tests&lt;/font&gt;.  The patch failed these unit tests:&lt;/p&gt;


&lt;p&gt;     &lt;font color=&quot;red&quot;&gt;-1 core zombie tests&lt;/font&gt;.  There are 6 zombie test(s): 	at org.apache.hadoop.hbase.security.visibility.TestVisibilityLabelsWithACL.testScanForUserWithFewerLabelAuthsThanLabelsInScanAuthorizations(TestVisibilityLabelsWithACL.java:121)&lt;br/&gt;
	at org.apache.hadoop.hbase.security.access.TestScanEarlyTermination.testEarlyScanTermination(TestScanEarlyTermination.java:148)&lt;/p&gt;

&lt;p&gt;Test results: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/15446//testReport/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/15446//testReport/&lt;/a&gt;&lt;br/&gt;
Release Findbugs (version 2.0.3) 	warnings: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/15446//artifact/patchprocess/newFindbugsWarnings.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/15446//artifact/patchprocess/newFindbugsWarnings.html&lt;/a&gt;&lt;br/&gt;
Checkstyle Errors: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/15446//artifact/patchprocess/checkstyle-aggregate.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/15446//artifact/patchprocess/checkstyle-aggregate.html&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;  Console output: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/15446//console&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/15446//console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="14733241" author="stack" created="Mon, 7 Sep 2015 04:51:08 +0000"  >&lt;p&gt;This fail has these zombies:&lt;/p&gt;

&lt;p&gt;kalashnikov:hbase.git.commit stack$ python ./dev-support/findHangingTests.py &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/15446//consoleText&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/15446//consoleText&lt;/a&gt;&lt;br/&gt;
Fetching the console output from the URL&lt;br/&gt;
Printing hanging tests&lt;br/&gt;
Hanging test : org.apache.hadoop.hbase.security.access.TestWithDisabledAuthorization&lt;br/&gt;
Hanging test : org.apache.hadoop.hbase.security.access.TestScanEarlyTermination&lt;br/&gt;
Hanging test : org.apache.hadoop.hbase.security.access.TestAccessController2&lt;br/&gt;
Hanging test : org.apache.hadoop.hbase.security.visibility.TestVisibilityLabelsWithACL&lt;br/&gt;
Printing Failing tests&lt;br/&gt;
Failing test : org.apache.hadoop.hbase.client.TestSnapshotCloneIndependence&lt;/p&gt;


&lt;p&gt;Some overlap.&lt;/p&gt;

&lt;p&gt;The hang is easy to reproduce locally. Looking at it, there is nought related to WAL. I see&lt;/p&gt;

&lt;p&gt;	at org.apache.hadoop.hbase.security.access.TestAccessController.testAccessControlClientGlobalGrantRevoke(TestAccessController.java:2226)&lt;/p&gt;

&lt;p&gt;hung... poking around, nothing plain at mo. Will be back.&lt;/p&gt;

&lt;p&gt;I&apos;m just going to commit this fat patch and then work on these seemingly unrelated zombies.&lt;/p&gt;
</comment>
                            <comment id="14733243" author="stack" created="Mon, 7 Sep 2015 04:55:24 +0000"  >&lt;p&gt;Pushed to branch-1 and branch-1.2&lt;/p&gt;

&lt;p&gt;Will make separate issue to backport to 1.1 (MVCC was renamed and other incompatibiilities)&lt;/p&gt;</comment>
                            <comment id="14733266" author="stack" created="Mon, 7 Sep 2015 05:52:05 +0000"  >&lt;p&gt;Looking at recent 1.2 builds before this patch went in, it looks like the tests cited above are already problematic:&lt;/p&gt;


&lt;p&gt;kalashnikov:hbase.git.commit stack$ python ./dev-support/findHangingTests.py  &lt;a href=&quot;https://builds.apache.org/view/H-L/view/HBase/job/HBase-1.2/151/jdk=latest1.7,label=Hadoop/consoleText&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/view/H-L/view/HBase/job/HBase-1.2/151/jdk=latest1.7,label=Hadoop/consoleText&lt;/a&gt;&lt;br/&gt;
Fetching the console output from the URL&lt;br/&gt;
Printing hanging tests&lt;br/&gt;
Hanging test : org.apache.hadoop.hbase.security.access.TestWithDisabledAuthorization&lt;br/&gt;
Hanging test : org.apache.hadoop.hbase.security.access.TestAccessController2&lt;br/&gt;
Hanging test : org.apache.hadoop.hbase.client.TestHCM&lt;br/&gt;
Hanging test : org.apache.hadoop.hbase.regionserver.TestHRegion&lt;br/&gt;
Hanging test : org.apache.hadoop.hbase.security.access.TestAccessController&lt;br/&gt;
Hanging test : org.apache.hadoop.hbase.master.balancer.TestStochasticLoadBalancer&lt;br/&gt;
Printing Failing tests&lt;br/&gt;
Failing test : org.apache.hadoop.hbase.replication.regionserver.TestRegionReplicaReplicationEndpoint&lt;/p&gt;

&lt;p&gt;or &lt;/p&gt;



&lt;p&gt;kalashnikov:hbase.git.commit stack$ python ./dev-support/findHangingTests.py &lt;a href=&quot;https://builds.apache.org/view/H-L/view/HBase/job/HBase-1.2/150/jdk=latest1.7,label=Hadoop/consoleText&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/view/H-L/view/HBase/job/HBase-1.2/150/jdk=latest1.7,label=Hadoop/consoleText&lt;/a&gt;&lt;br/&gt;
Fetching the console output from the URL&lt;br/&gt;
Printing hanging tests&lt;br/&gt;
Hanging test : org.apache.hadoop.hbase.security.access.TestWithDisabledAuthorization&lt;br/&gt;
Hanging test : org.apache.hadoop.hbase.security.access.TestAccessController2&lt;br/&gt;
Printing Failing tests&lt;br/&gt;
Failing test : org.apache.hadoop.hbase.client.TestSnapshotCloneIndependence&lt;br/&gt;
Failing test : org.apache.hadoop.hbase.regionserver.TestSplitWalDataLoss&lt;br/&gt;
Failing test : org.apache.hadoop.hbase.replication.TestReplicationEndpoint&lt;/p&gt;


&lt;p&gt;1.2 builds are failing with a while. Will be back to fix failures.&lt;/p&gt;
</comment>
                            <comment id="14733334" author="hudson" created="Mon, 7 Sep 2015 07:26:25 +0000"  >&lt;p&gt;FAILURE: Integrated in HBase-1.3 #152 (See &lt;a href=&quot;https://builds.apache.org/job/HBase-1.3/152/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/HBase-1.3/152/&lt;/a&gt;)&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-14317&quot; title=&quot;Stuck FSHLog: bad disk (HDFS-8960) and can&amp;#39;t roll WAL&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-14317&quot;&gt;&lt;del&gt;HBASE-14317&lt;/del&gt;&lt;/a&gt; Stuck FSHLog: bad disk (&lt;a href=&quot;https://issues.apache.org/jira/browse/HDFS-8960&quot; title=&quot;DFS client says &amp;quot;no more good datanodes being available to try&amp;quot; on a single drive failure&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HDFS-8960&quot;&gt;HDFS-8960&lt;/a&gt;) and can&apos;t roll WAL (stack: rev bbafb47f7271449d46b46569ca9f0cb227b44c6e)&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;hbase-server/src/test/java/org/apache/hadoop/hbase/regionserver/wal/TestLogRolling.java&lt;/li&gt;
	&lt;li&gt;hbase-server/src/test/java/org/apache/hadoop/hbase/regionserver/TestFSErrorsExposed.java&lt;/li&gt;
	&lt;li&gt;hbase-server/src/main/java/org/apache/hadoop/hbase/regionserver/LogRoller.java&lt;/li&gt;
	&lt;li&gt;hbase-server/src/main/java/org/apache/hadoop/hbase/regionserver/wal/HLogKey.java&lt;/li&gt;
	&lt;li&gt;hbase-server/src/main/java/org/apache/hadoop/hbase/regionserver/wal/DamagedWALException.java&lt;/li&gt;
	&lt;li&gt;hbase-server/src/test/java/org/apache/hadoop/hbase/regionserver/TestFailedAppendAndSync.java&lt;/li&gt;
	&lt;li&gt;hbase-server/src/test/java/org/apache/hadoop/hbase/regionserver/TestMultiVersionConcurrencyControl.java&lt;/li&gt;
	&lt;li&gt;hbase-server/src/test/java/org/apache/hadoop/hbase/regionserver/TestMultiVersionConcurrencyControlBasic.java&lt;/li&gt;
	&lt;li&gt;hbase-server/src/main/java/org/apache/hadoop/hbase/regionserver/wal/ProtobufLogWriter.java&lt;/li&gt;
	&lt;li&gt;hbase-server/src/test/java/org/apache/hadoop/hbase/regionserver/TestWALLockup.java&lt;/li&gt;
	&lt;li&gt;hbase-server/src/main/java/org/apache/hadoop/hbase/regionserver/wal/FSHLog.java&lt;/li&gt;
	&lt;li&gt;hbase-server/src/test/java/org/apache/hadoop/hbase/regionserver/TestHRegion.java&lt;/li&gt;
	&lt;li&gt;hbase-server/src/main/java/org/apache/hadoop/hbase/regionserver/wal/FSWALEntry.java&lt;/li&gt;
	&lt;li&gt;hbase-server/src/main/java/org/apache/hadoop/hbase/io/hfile/HFile.java&lt;/li&gt;
	&lt;li&gt;hbase-server/src/main/java/org/apache/hadoop/hbase/wal/WALKey.java&lt;/li&gt;
	&lt;li&gt;hbase-server/src/main/java/org/apache/hadoop/hbase/regionserver/MultiVersionConcurrencyControl.java&lt;/li&gt;
	&lt;li&gt;hbase-server/src/main/java/org/apache/hadoop/hbase/regionserver/wal/ProtobufLogReader.java&lt;/li&gt;
	&lt;li&gt;hbase-server/src/main/java/org/apache/hadoop/hbase/regionserver/wal/SyncFuture.java&lt;/li&gt;
	&lt;li&gt;hbase-server/src/main/java/org/apache/hadoop/hbase/regionserver/HRegion.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="14733357" author="hudson" created="Mon, 7 Sep 2015 07:54:38 +0000"  >&lt;p&gt;FAILURE: Integrated in HBase-1.2 #154 (See &lt;a href=&quot;https://builds.apache.org/job/HBase-1.2/154/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/HBase-1.2/154/&lt;/a&gt;)&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-14317&quot; title=&quot;Stuck FSHLog: bad disk (HDFS-8960) and can&amp;#39;t roll WAL&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-14317&quot;&gt;&lt;del&gt;HBASE-14317&lt;/del&gt;&lt;/a&gt; Stuck FSHLog: bad disk (&lt;a href=&quot;https://issues.apache.org/jira/browse/HDFS-8960&quot; title=&quot;DFS client says &amp;quot;no more good datanodes being available to try&amp;quot; on a single drive failure&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HDFS-8960&quot;&gt;HDFS-8960&lt;/a&gt;) and can&apos;t roll WAL (stack: rev 990e3698a7ca7e95894150a2905ba4271eb371e9)&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;hbase-server/src/main/java/org/apache/hadoop/hbase/regionserver/wal/FSWALEntry.java&lt;/li&gt;
	&lt;li&gt;hbase-server/src/main/java/org/apache/hadoop/hbase/regionserver/HRegion.java&lt;/li&gt;
	&lt;li&gt;hbase-server/src/main/java/org/apache/hadoop/hbase/regionserver/wal/DamagedWALException.java&lt;/li&gt;
	&lt;li&gt;hbase-server/src/test/java/org/apache/hadoop/hbase/regionserver/TestMultiVersionConcurrencyControl.java&lt;/li&gt;
	&lt;li&gt;hbase-server/src/main/java/org/apache/hadoop/hbase/regionserver/wal/ProtobufLogWriter.java&lt;/li&gt;
	&lt;li&gt;hbase-server/src/main/java/org/apache/hadoop/hbase/io/hfile/HFile.java&lt;/li&gt;
	&lt;li&gt;hbase-server/src/main/java/org/apache/hadoop/hbase/regionserver/MultiVersionConcurrencyControl.java&lt;/li&gt;
	&lt;li&gt;hbase-server/src/main/java/org/apache/hadoop/hbase/regionserver/wal/FSHLog.java&lt;/li&gt;
	&lt;li&gt;hbase-server/src/main/java/org/apache/hadoop/hbase/regionserver/LogRoller.java&lt;/li&gt;
	&lt;li&gt;hbase-server/src/test/java/org/apache/hadoop/hbase/regionserver/TestHRegion.java&lt;/li&gt;
	&lt;li&gt;hbase-server/src/test/java/org/apache/hadoop/hbase/regionserver/wal/TestLogRolling.java&lt;/li&gt;
	&lt;li&gt;hbase-server/src/main/java/org/apache/hadoop/hbase/regionserver/wal/HLogKey.java&lt;/li&gt;
	&lt;li&gt;hbase-server/src/test/java/org/apache/hadoop/hbase/regionserver/TestFSErrorsExposed.java&lt;/li&gt;
	&lt;li&gt;hbase-server/src/main/java/org/apache/hadoop/hbase/regionserver/wal/SyncFuture.java&lt;/li&gt;
	&lt;li&gt;hbase-server/src/main/java/org/apache/hadoop/hbase/regionserver/wal/ProtobufLogReader.java&lt;/li&gt;
	&lt;li&gt;hbase-server/src/main/java/org/apache/hadoop/hbase/wal/WALKey.java&lt;/li&gt;
	&lt;li&gt;hbase-server/src/test/java/org/apache/hadoop/hbase/regionserver/TestFailedAppendAndSync.java&lt;/li&gt;
	&lt;li&gt;hbase-server/src/test/java/org/apache/hadoop/hbase/regionserver/TestMultiVersionConcurrencyControlBasic.java&lt;/li&gt;
	&lt;li&gt;hbase-server/src/test/java/org/apache/hadoop/hbase/regionserver/TestWALLockup.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="14733403" author="hudson" created="Mon, 7 Sep 2015 08:40:29 +0000"  >&lt;p&gt;SUCCESS: Integrated in HBase-1.2-IT #130 (See &lt;a href=&quot;https://builds.apache.org/job/HBase-1.2-IT/130/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/HBase-1.2-IT/130/&lt;/a&gt;)&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-14317&quot; title=&quot;Stuck FSHLog: bad disk (HDFS-8960) and can&amp;#39;t roll WAL&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-14317&quot;&gt;&lt;del&gt;HBASE-14317&lt;/del&gt;&lt;/a&gt; Stuck FSHLog: bad disk (&lt;a href=&quot;https://issues.apache.org/jira/browse/HDFS-8960&quot; title=&quot;DFS client says &amp;quot;no more good datanodes being available to try&amp;quot; on a single drive failure&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HDFS-8960&quot;&gt;HDFS-8960&lt;/a&gt;) and can&apos;t roll WAL (stack: rev 990e3698a7ca7e95894150a2905ba4271eb371e9)&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;hbase-server/src/main/java/org/apache/hadoop/hbase/regionserver/wal/ProtobufLogReader.java&lt;/li&gt;
	&lt;li&gt;hbase-server/src/test/java/org/apache/hadoop/hbase/regionserver/TestFailedAppendAndSync.java&lt;/li&gt;
	&lt;li&gt;hbase-server/src/main/java/org/apache/hadoop/hbase/regionserver/MultiVersionConcurrencyControl.java&lt;/li&gt;
	&lt;li&gt;hbase-server/src/test/java/org/apache/hadoop/hbase/regionserver/TestWALLockup.java&lt;/li&gt;
	&lt;li&gt;hbase-server/src/main/java/org/apache/hadoop/hbase/regionserver/wal/SyncFuture.java&lt;/li&gt;
	&lt;li&gt;hbase-server/src/test/java/org/apache/hadoop/hbase/regionserver/wal/TestLogRolling.java&lt;/li&gt;
	&lt;li&gt;hbase-server/src/test/java/org/apache/hadoop/hbase/regionserver/TestHRegion.java&lt;/li&gt;
	&lt;li&gt;hbase-server/src/main/java/org/apache/hadoop/hbase/regionserver/wal/HLogKey.java&lt;/li&gt;
	&lt;li&gt;hbase-server/src/main/java/org/apache/hadoop/hbase/regionserver/HRegion.java&lt;/li&gt;
	&lt;li&gt;hbase-server/src/main/java/org/apache/hadoop/hbase/regionserver/wal/FSHLog.java&lt;/li&gt;
	&lt;li&gt;hbase-server/src/test/java/org/apache/hadoop/hbase/regionserver/TestMultiVersionConcurrencyControl.java&lt;/li&gt;
	&lt;li&gt;hbase-server/src/main/java/org/apache/hadoop/hbase/wal/WALKey.java&lt;/li&gt;
	&lt;li&gt;hbase-server/src/test/java/org/apache/hadoop/hbase/regionserver/TestFSErrorsExposed.java&lt;/li&gt;
	&lt;li&gt;hbase-server/src/main/java/org/apache/hadoop/hbase/regionserver/wal/ProtobufLogWriter.java&lt;/li&gt;
	&lt;li&gt;hbase-server/src/main/java/org/apache/hadoop/hbase/io/hfile/HFile.java&lt;/li&gt;
	&lt;li&gt;hbase-server/src/main/java/org/apache/hadoop/hbase/regionserver/LogRoller.java&lt;/li&gt;
	&lt;li&gt;hbase-server/src/main/java/org/apache/hadoop/hbase/regionserver/wal/FSWALEntry.java&lt;/li&gt;
	&lt;li&gt;hbase-server/src/main/java/org/apache/hadoop/hbase/regionserver/wal/DamagedWALException.java&lt;/li&gt;
	&lt;li&gt;hbase-server/src/test/java/org/apache/hadoop/hbase/regionserver/TestMultiVersionConcurrencyControlBasic.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="14733445" author="hudson" created="Mon, 7 Sep 2015 09:13:16 +0000"  >&lt;p&gt;FAILURE: Integrated in HBase-1.3-IT #136 (See &lt;a href=&quot;https://builds.apache.org/job/HBase-1.3-IT/136/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/HBase-1.3-IT/136/&lt;/a&gt;)&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-14317&quot; title=&quot;Stuck FSHLog: bad disk (HDFS-8960) and can&amp;#39;t roll WAL&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-14317&quot;&gt;&lt;del&gt;HBASE-14317&lt;/del&gt;&lt;/a&gt; Stuck FSHLog: bad disk (&lt;a href=&quot;https://issues.apache.org/jira/browse/HDFS-8960&quot; title=&quot;DFS client says &amp;quot;no more good datanodes being available to try&amp;quot; on a single drive failure&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HDFS-8960&quot;&gt;HDFS-8960&lt;/a&gt;) and can&apos;t roll WAL (stack: rev bbafb47f7271449d46b46569ca9f0cb227b44c6e)&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;hbase-server/src/test/java/org/apache/hadoop/hbase/regionserver/TestMultiVersionConcurrencyControl.java&lt;/li&gt;
	&lt;li&gt;hbase-server/src/main/java/org/apache/hadoop/hbase/regionserver/wal/ProtobufLogReader.java&lt;/li&gt;
	&lt;li&gt;hbase-server/src/test/java/org/apache/hadoop/hbase/regionserver/TestFSErrorsExposed.java&lt;/li&gt;
	&lt;li&gt;hbase-server/src/main/java/org/apache/hadoop/hbase/regionserver/wal/ProtobufLogWriter.java&lt;/li&gt;
	&lt;li&gt;hbase-server/src/main/java/org/apache/hadoop/hbase/regionserver/LogRoller.java&lt;/li&gt;
	&lt;li&gt;hbase-server/src/main/java/org/apache/hadoop/hbase/regionserver/wal/DamagedWALException.java&lt;/li&gt;
	&lt;li&gt;hbase-server/src/main/java/org/apache/hadoop/hbase/regionserver/wal/FSWALEntry.java&lt;/li&gt;
	&lt;li&gt;hbase-server/src/test/java/org/apache/hadoop/hbase/regionserver/TestHRegion.java&lt;/li&gt;
	&lt;li&gt;hbase-server/src/main/java/org/apache/hadoop/hbase/regionserver/MultiVersionConcurrencyControl.java&lt;/li&gt;
	&lt;li&gt;hbase-server/src/test/java/org/apache/hadoop/hbase/regionserver/wal/TestLogRolling.java&lt;/li&gt;
	&lt;li&gt;hbase-server/src/main/java/org/apache/hadoop/hbase/regionserver/wal/FSHLog.java&lt;/li&gt;
	&lt;li&gt;hbase-server/src/main/java/org/apache/hadoop/hbase/regionserver/wal/HLogKey.java&lt;/li&gt;
	&lt;li&gt;hbase-server/src/main/java/org/apache/hadoop/hbase/regionserver/wal/SyncFuture.java&lt;/li&gt;
	&lt;li&gt;hbase-server/src/main/java/org/apache/hadoop/hbase/io/hfile/HFile.java&lt;/li&gt;
	&lt;li&gt;hbase-server/src/main/java/org/apache/hadoop/hbase/wal/WALKey.java&lt;/li&gt;
	&lt;li&gt;hbase-server/src/test/java/org/apache/hadoop/hbase/regionserver/TestMultiVersionConcurrencyControlBasic.java&lt;/li&gt;
	&lt;li&gt;hbase-server/src/test/java/org/apache/hadoop/hbase/regionserver/TestFailedAppendAndSync.java&lt;/li&gt;
	&lt;li&gt;hbase-server/src/test/java/org/apache/hadoop/hbase/regionserver/TestWALLockup.java&lt;/li&gt;
	&lt;li&gt;hbase-server/src/main/java/org/apache/hadoop/hbase/regionserver/HRegion.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="14903723" author="hudson" created="Wed, 23 Sep 2015 00:37:43 +0000"  >&lt;p&gt;FAILURE: Integrated in HBase-1.1 #676 (See &lt;a href=&quot;https://builds.apache.org/job/HBase-1.1/676/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/HBase-1.1/676/&lt;/a&gt;)&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-14373&quot; title=&quot;PerformanceEvaluation tool should support huge number of rows beyond int range&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-14373&quot;&gt;&lt;del&gt;HBASE-14373&lt;/del&gt;&lt;/a&gt; Backport parent &apos;&lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-14317&quot; title=&quot;Stuck FSHLog: bad disk (HDFS-8960) and can&amp;#39;t roll WAL&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-14317&quot;&gt;&lt;del&gt;HBASE-14317&lt;/del&gt;&lt;/a&gt; Stuck FSHLog&apos; issue to 1.1 and 1.0 (stack: rev 2966e2744a5597a8066f265a49d7528307bcb5f4)&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;hbase-server/src/main/java/org/apache/hadoop/hbase/regionserver/LogRoller.java&lt;/li&gt;
	&lt;li&gt;hbase-server/src/main/java/org/apache/hadoop/hbase/wal/WALKey.java&lt;/li&gt;
	&lt;li&gt;hbase-server/src/test/java/org/apache/hadoop/hbase/regionserver/TestFSErrorsExposed.java&lt;/li&gt;
	&lt;li&gt;hbase-server/src/main/java/org/apache/hadoop/hbase/regionserver/MultiVersionConsistencyControl.java&lt;/li&gt;
	&lt;li&gt;hbase-server/src/main/java/org/apache/hadoop/hbase/regionserver/wal/HLogKey.java&lt;/li&gt;
	&lt;li&gt;hbase-server/src/test/java/org/apache/hadoop/hbase/regionserver/TestHRegion.java&lt;/li&gt;
	&lt;li&gt;hbase-server/src/main/java/org/apache/hadoop/hbase/regionserver/wal/SyncFuture.java&lt;/li&gt;
	&lt;li&gt;hbase-server/src/main/java/org/apache/hadoop/hbase/regionserver/wal/FSHLog.java&lt;/li&gt;
	&lt;li&gt;hbase-server/src/test/java/org/apache/hadoop/hbase/regionserver/TestMultiVersionConsistencyControl.java&lt;/li&gt;
	&lt;li&gt;hbase-server/src/main/java/org/apache/hadoop/hbase/regionserver/HRegion.java&lt;/li&gt;
	&lt;li&gt;hbase-server/src/main/java/org/apache/hadoop/hbase/regionserver/wal/ProtobufLogWriter.java&lt;/li&gt;
	&lt;li&gt;hbase-server/src/main/java/org/apache/hadoop/hbase/regionserver/wal/ProtobufLogReader.java&lt;/li&gt;
	&lt;li&gt;hbase-server/src/test/java/org/apache/hadoop/hbase/regionserver/wal/TestLogRolling.java&lt;/li&gt;
	&lt;li&gt;hbase-server/src/main/java/org/apache/hadoop/hbase/regionserver/wal/FSWALEntry.java&lt;/li&gt;
	&lt;li&gt;hbase-server/src/test/java/org/apache/hadoop/hbase/master/TestDistributedLogSplitting.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="14905268" author="hudson" created="Wed, 23 Sep 2015 21:12:47 +0000"  >&lt;p&gt;FAILURE: Integrated in HBase-1.1 #677 (See &lt;a href=&quot;https://builds.apache.org/job/HBase-1.1/677/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/HBase-1.1/677/&lt;/a&gt;)&lt;br/&gt;
Revert &quot;&lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-14373&quot; title=&quot;PerformanceEvaluation tool should support huge number of rows beyond int range&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-14373&quot;&gt;&lt;del&gt;HBASE-14373&lt;/del&gt;&lt;/a&gt; Backport parent &apos;&lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-14317&quot; title=&quot;Stuck FSHLog: bad disk (HDFS-8960) and can&amp;#39;t roll WAL&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-14317&quot;&gt;&lt;del&gt;HBASE-14317&lt;/del&gt;&lt;/a&gt; Stuck FSHLog&apos; issue to 1.1 and 1.0&quot; (stack: rev 5b0f30d5f4dc71286ac8c6d8ed8dbc6b4f816c28)&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;hbase-server/src/test/java/org/apache/hadoop/hbase/regionserver/TestHRegion.java&lt;/li&gt;
	&lt;li&gt;hbase-server/src/main/java/org/apache/hadoop/hbase/regionserver/MultiVersionConsistencyControl.java&lt;/li&gt;
	&lt;li&gt;hbase-server/src/main/java/org/apache/hadoop/hbase/wal/WALKey.java&lt;/li&gt;
	&lt;li&gt;hbase-server/src/test/java/org/apache/hadoop/hbase/master/TestDistributedLogSplitting.java&lt;/li&gt;
	&lt;li&gt;hbase-server/src/test/java/org/apache/hadoop/hbase/regionserver/TestFSErrorsExposed.java&lt;/li&gt;
	&lt;li&gt;hbase-server/src/test/java/org/apache/hadoop/hbase/regionserver/TestMultiVersionConsistencyControl.java&lt;/li&gt;
	&lt;li&gt;hbase-server/src/main/java/org/apache/hadoop/hbase/regionserver/wal/HLogKey.java&lt;/li&gt;
	&lt;li&gt;hbase-server/src/main/java/org/apache/hadoop/hbase/regionserver/HRegion.java&lt;/li&gt;
	&lt;li&gt;hbase-server/src/main/java/org/apache/hadoop/hbase/regionserver/wal/FSWALEntry.java&lt;/li&gt;
	&lt;li&gt;hbase-server/src/main/java/org/apache/hadoop/hbase/regionserver/LogRoller.java&lt;/li&gt;
	&lt;li&gt;hbase-server/src/test/java/org/apache/hadoop/hbase/regionserver/wal/TestLogRolling.java&lt;/li&gt;
	&lt;li&gt;hbase-server/src/main/java/org/apache/hadoop/hbase/regionserver/wal/ProtobufLogReader.java&lt;/li&gt;
	&lt;li&gt;hbase-server/src/main/java/org/apache/hadoop/hbase/regionserver/wal/ProtobufLogWriter.java&lt;/li&gt;
	&lt;li&gt;hbase-server/src/main/java/org/apache/hadoop/hbase/regionserver/wal/SyncFuture.java&lt;/li&gt;
	&lt;li&gt;hbase-server/src/main/java/org/apache/hadoop/hbase/regionserver/wal/FSHLog.java&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-14374&quot; title=&quot;Backport parent &amp;#39;HBASE-14317 Stuck FSHLog&amp;#39; issue to 1.1&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-14374&quot;&gt;&lt;del&gt;HBASE-14374&lt;/del&gt;&lt;/a&gt; Backport parent &apos;&lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-14317&quot; title=&quot;Stuck FSHLog: bad disk (HDFS-8960) and can&amp;#39;t roll WAL&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-14317&quot;&gt;&lt;del&gt;HBASE-14317&lt;/del&gt;&lt;/a&gt; Stuck FSHLog&apos; issue to 1.1 (stack: rev 0bf97bac2ed564994a0bcda5f1993260bf0b448f)&lt;/li&gt;
	&lt;li&gt;hbase-server/src/test/java/org/apache/hadoop/hbase/regionserver/TestHRegion.java&lt;/li&gt;
	&lt;li&gt;hbase-server/src/main/java/org/apache/hadoop/hbase/regionserver/wal/DamagedWALException.java&lt;/li&gt;
	&lt;li&gt;hbase-server/src/test/java/org/apache/hadoop/hbase/regionserver/TestWALLockup.java&lt;/li&gt;
	&lt;li&gt;hbase-server/src/main/java/org/apache/hadoop/hbase/wal/WALKey.java&lt;/li&gt;
	&lt;li&gt;hbase-server/src/main/java/org/apache/hadoop/hbase/regionserver/LogRoller.java&lt;/li&gt;
	&lt;li&gt;hbase-server/src/main/java/org/apache/hadoop/hbase/regionserver/wal/ProtobufLogWriter.java&lt;/li&gt;
	&lt;li&gt;hbase-server/src/test/java/org/apache/hadoop/hbase/master/TestDistributedLogSplitting.java&lt;/li&gt;
	&lt;li&gt;hbase-server/src/main/java/org/apache/hadoop/hbase/regionserver/wal/FSWALEntry.java&lt;/li&gt;
	&lt;li&gt;hbase-server/src/main/java/org/apache/hadoop/hbase/regionserver/wal/HLogKey.java&lt;/li&gt;
	&lt;li&gt;hbase-server/src/test/java/org/apache/hadoop/hbase/regionserver/TestFailedAppendAndSync.java&lt;/li&gt;
	&lt;li&gt;hbase-server/src/test/java/org/apache/hadoop/hbase/regionserver/TestFSErrorsExposed.java&lt;/li&gt;
	&lt;li&gt;hbase-server/src/test/java/org/apache/hadoop/hbase/regionserver/wal/TestLogRolling.java&lt;/li&gt;
	&lt;li&gt;hbase-server/src/main/java/org/apache/hadoop/hbase/regionserver/HRegion.java&lt;/li&gt;
	&lt;li&gt;hbase-server/src/main/java/org/apache/hadoop/hbase/regionserver/wal/FSHLog.java&lt;/li&gt;
	&lt;li&gt;hbase-server/src/main/java/org/apache/hadoop/hbase/regionserver/wal/SyncFuture.java&lt;/li&gt;
	&lt;li&gt;hbase-server/src/test/java/org/apache/hadoop/hbase/regionserver/TestMultiVersionConsistencyControl.java&lt;/li&gt;
	&lt;li&gt;hbase-server/src/main/java/org/apache/hadoop/hbase/regionserver/wal/ProtobufLogReader.java&lt;/li&gt;
	&lt;li&gt;hbase-server/src/main/java/org/apache/hadoop/hbase/regionserver/MultiVersionConsistencyControl.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                            <outwardlinks description="relates to">
                                        <issuelink>
            <issuekey id="12840618">HBASE-13971</issuekey>
        </issuelink>
            <issuelink>
            <issuekey id="13016031">HBASE-16960</issuekey>
        </issuelink>
                            </outwardlinks>
                                                                <inwardlinks description="is related to">
                                        <issuelink>
            <issuekey id="12859390">HDFS-8960</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12754211" name="14317.branch-1.txt" size="85464" author="stack" created="Fri, 4 Sep 2015 15:25:04 +0000"/>
                            <attachment id="12754161" name="14317.branch-1.txt" size="85464" author="stack" created="Fri, 4 Sep 2015 07:39:20 +0000"/>
                            <attachment id="12754360" name="14317.branch-1.v2.txt" size="85492" author="stack" created="Sun, 6 Sep 2015 04:01:49 +0000"/>
                            <attachment id="12754352" name="14317.branch-1.v2.txt" size="85492" author="stack" created="Sun, 6 Sep 2015 00:42:45 +0000"/>
                            <attachment id="12754333" name="14317.branch-1.v2.txt" size="85492" author="stack" created="Sat, 5 Sep 2015 16:58:48 +0000"/>
                            <attachment id="12754328" name="14317.branch-1.v2.txt" size="85492" author="stack" created="Sat, 5 Sep 2015 16:00:48 +0000"/>
                            <attachment id="12754317" name="14317.branch-1.v2.txt" size="85492" author="stack" created="Sat, 5 Sep 2015 06:01:16 +0000"/>
                            <attachment id="12754316" name="14317.branch-1.v2.txt" size="85492" author="stack" created="Sat, 5 Sep 2015 05:48:02 +0000"/>
                            <attachment id="12754314" name="14317.branch-1.v2.txt" size="85492" author="stack" created="Sat, 5 Sep 2015 05:30:55 +0000"/>
                            <attachment id="12754313" name="14317.branch-1.v2.txt" size="85492" author="stack" created="Sat, 5 Sep 2015 05:05:32 +0000"/>
                            <attachment id="12753138" name="14317.test.txt" size="20885" author="stack" created="Sat, 29 Aug 2015 14:51:51 +0000"/>
                            <attachment id="12753719" name="14317v10.txt" size="58541" author="stack" created="Wed, 2 Sep 2015 08:22:36 +0000"/>
                            <attachment id="12753849" name="14317v11.txt" size="74699" author="stack" created="Wed, 2 Sep 2015 21:22:25 +0000"/>
                            <attachment id="12753885" name="14317v12.txt" size="74299" author="stack" created="Thu, 3 Sep 2015 00:10:33 +0000"/>
                            <attachment id="12753923" name="14317v13.txt" size="74303" author="stack" created="Thu, 3 Sep 2015 05:07:36 +0000"/>
                            <attachment id="12754104" name="14317v14.txt" size="80497" author="stack" created="Thu, 3 Sep 2015 22:47:50 +0000"/>
                            <attachment id="12754134" name="14317v15.txt" size="84117" author="stack" created="Fri, 4 Sep 2015 03:09:34 +0000"/>
                            <attachment id="12753621" name="14317v5.branch-1.2.txt" size="43814" author="stack" created="Tue, 1 Sep 2015 23:04:55 +0000"/>
                            <attachment id="12753620" name="14317v5.txt" size="44261" author="stack" created="Tue, 1 Sep 2015 23:03:47 +0000"/>
                            <attachment id="12753695" name="14317v9.txt" size="50842" author="stack" created="Wed, 2 Sep 2015 06:44:33 +0000"/>
                            <attachment id="12753371" name="HBASE-14317-v1.patch" size="16618" author="eclark" created="Mon, 31 Aug 2015 20:33:26 +0000"/>
                            <attachment id="12753391" name="HBASE-14317-v2.patch" size="16953" author="eclark" created="Mon, 31 Aug 2015 21:51:27 +0000"/>
                            <attachment id="12753393" name="HBASE-14317-v3.patch" size="16955" author="eclark" created="Mon, 31 Aug 2015 22:02:04 +0000"/>
                            <attachment id="12753396" name="HBASE-14317-v4.patch" size="17841" author="eclark" created="Mon, 31 Aug 2015 22:21:22 +0000"/>
                            <attachment id="12752894" name="HBASE-14317.patch" size="4784" author="eclark" created="Thu, 27 Aug 2015 23:15:01 +0000"/>
                            <attachment id="12752548" name="[Java] RS stuck on WAL sync to a dead DN - Pastebin.com.html" size="1252973" author="stack" created="Wed, 26 Aug 2015 18:51:04 +0000"/>
                            <attachment id="12753362" name="append-only-test.patch" size="12469" author="eclark" created="Mon, 31 Aug 2015 19:30:35 +0000"/>
                            <attachment id="12752550" name="raw.php" size="177948" author="stack" created="Wed, 26 Aug 2015 18:52:41 +0000"/>
                            <attachment id="12753464" name="repro.txt" size="33077" author="stack" created="Tue, 1 Sep 2015 05:51:01 +0000"/>
                            <attachment id="12753148" name="san_dump.txt" size="230292" author="eclark" created="Sat, 29 Aug 2015 19:47:40 +0000"/>
                            <attachment id="12752549" name="subset.of.rs.log" size="898153" author="stack" created="Wed, 26 Aug 2015 18:51:04 +0000"/>
                            <attachment id="12754410" name="timeouts.branch-1.txt" size="7275" author="stack" created="Sun, 6 Sep 2015 20:39:29 +0000"/>
                    </attachments>
                <subtasks>
                            <subtask id="12861978">HBASE-14368</subtask>
                            <subtask id="12862140">HBASE-14374</subtask>
                            <subtask id="12862300">HBASE-14378</subtask>
                            <subtask id="12863191">HBASE-14401</subtask>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>32.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Thu, 27 Aug 2015 18:55:28 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310191" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                        <customfieldname>Hadoop Flags</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10343"><![CDATA[Reviewed]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            1 year, 10 weeks, 1 day ago
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i2jey7:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310192" key="com.atlassian.jira.plugin.system.customfieldtypes:textarea">
                        <customfieldname>Release Note</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Tighten up WAL-use semantic.&lt;br/&gt;
&lt;br/&gt;
1. If an append or a sync throws an exception, all subsequent attempts at using the log will also throw this same exception. The WAL is now a lame-duck until you roll it.&lt;br/&gt;
2. If a successful append, and then we fail to sync the append, this is a fatal exception. The container must abort to replay the WAL logs even though we have told the client that the appends failed.&lt;br/&gt;
&lt;br/&gt;
The above rules have been applied laxly up to this; it used to be possible to get a good sync to go in over the top of a failed append. This has been fixed in this patch.&lt;br/&gt;
&lt;br/&gt;
Also fixed a hang in the WAL subsystem if a request to pause the write pipeline took on a failed sync. before the roll requests sync got scheduled.&lt;br/&gt;
&lt;br/&gt;
&lt;br/&gt;
TODO: Revisit our WAL system. &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-12751&quot; title=&quot;Allow RowLock to be reader writer&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-12751&quot;&gt;&lt;strike&gt;HBASE-12751&lt;/strike&gt;&lt;/a&gt; helps rationalize our write pipeline. In particular, it manages sequenceid inside mvcc which should make it so we can purge mechanism that writes empty, unflushed appends just to get the next sequenceid... problematic when WAL goes lame-duck. Lets get it in.&lt;br/&gt;
TODO: A successful append followed by a failed sync probably only needs us replace the WAL (if we have signalled the client that the appends failed). Bummer is that replicating, these last appends might make it to the sink cluster or get replayed during recovery. HBase should keep its own WAL length? Or sequenceid of last successful sync should be passed when doing recovery and replication?</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        </customfields>
    </item>
</channel>
</rss>