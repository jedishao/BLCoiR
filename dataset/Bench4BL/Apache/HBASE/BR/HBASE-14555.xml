<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Thu Dec 01 22:29:58 UTC 2016

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/HBASE-14555/HBASE-14555.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[HBASE-14555] Deadlock in MVCC branch-1.2 toString()</title>
                <link>https://issues.apache.org/jira/browse/HBASE-14555</link>
                <project id="12310753" key="HBASE">HBase</project>
                    <description>&lt;p&gt;Just saw this in an IT test.&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
&lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt; 75 (PriorityRpcServer.handler=3,queue=1,port=16020):
  State: BLOCKED
  Blocked count: 691635
  Waited count: 1557446
  Blocked on java.util.LinkedList@32b53d9e
  Blocked by 81 (PriorityRpcServer.handler=9,queue=1,port=16020)
  Stack:
    org.apache.hadoop.hbase.regionserver.MultiVersionConcurrencyControl.toString(MultiVersionConcurrencyControl.java:234)
    java.lang.&lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt;.valueOf(&lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt;.java:2994)
    java.lang.StringBuilder.append(StringBuilder.java:131)
    org.apache.hadoop.hbase.regionserver.MultiVersionConcurrencyControl.waitForRead(MultiVersionConcurrencyControl.java:209)
    org.apache.hadoop.hbase.regionserver.MultiVersionConcurrencyControl.completeAndWait(MultiVersionConcurrencyControl.java:144)
    org.apache.hadoop.hbase.regionserver.HRegion.doMiniBatchMutation(HRegion.java:3191)
    org.apache.hadoop.hbase.regionserver.HRegion.batchMutate(HRegion.java:2837)
    org.apache.hadoop.hbase.regionserver.HRegion.batchMutate(HRegion.java:2779)
    org.apache.hadoop.hbase.regionserver.RSRpcServices.doBatchOp(RSRpcServices.java:697)
    org.apache.hadoop.hbase.regionserver.RSRpcServices.doNonAtomicRegionMutation(RSRpcServices.java:659)
    org.apache.hadoop.hbase.regionserver.RSRpcServices.multi(RSRpcServices.java:2047)
    org.apache.hadoop.hbase.protobuf.generated.ClientProtos$ClientService$2.callBlockingMethod(ClientProtos.java:32594)
    org.apache.hadoop.hbase.ipc.RpcServer.call(RpcServer.java:2120)
    org.apache.hadoop.hbase.ipc.CallRunner.run(CallRunner.java:106)
    org.apache.hadoop.hbase.ipc.RpcExecutor.consumerLoop(RpcExecutor.java:130)
    org.apache.hadoop.hbase.ipc.RpcExecutor$1.run(RpcExecutor.java:107)
    java.lang.&lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;.run(&lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;.java:745)








&lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt; 81 (PriorityRpcServer.handler=9,queue=1,port=16020):
  State: BLOCKED
  Blocked count: 691858
  Waited count: 1558138
  Blocked on java.lang.&lt;span class=&quot;code-object&quot;&gt;Object&lt;/span&gt;@2a5e9ae8
  Blocked by 75 (PriorityRpcServer.handler=3,queue=1,port=16020)
  Stack:
    org.apache.hadoop.hbase.regionserver.MultiVersionConcurrencyControl.complete(MultiVersionConcurrencyControl.java:191)
    org.apache.hadoop.hbase.regionserver.MultiVersionConcurrencyControl.completeAndWait(MultiVersionConcurrencyControl.java:143)
    org.apache.hadoop.hbase.regionserver.HRegion.doMiniBatchMutation(HRegion.java:3191)
    org.apache.hadoop.hbase.regionserver.HRegion.batchMutate(HRegion.java:2837)
    org.apache.hadoop.hbase.regionserver.HRegion.batchMutate(HRegion.java:2779)
    org.apache.hadoop.hbase.regionserver.RSRpcServices.doBatchOp(RSRpcServices.java:697)
    org.apache.hadoop.hbase.regionserver.RSRpcServices.doNonAtomicRegionMutation(RSRpcServices.java:659)
    org.apache.hadoop.hbase.regionserver.RSRpcServices.multi(RSRpcServices.java:2047)
    org.apache.hadoop.hbase.protobuf.generated.ClientProtos$ClientService$2.callBlockingMethod(ClientProtos.java:32594)
    org.apache.hadoop.hbase.ipc.RpcServer.call(RpcServer.java:2120)
    org.apache.hadoop.hbase.ipc.CallRunner.run(CallRunner.java:106)
    org.apache.hadoop.hbase.ipc.RpcExecutor.consumerLoop(RpcExecutor.java:130)
    org.apache.hadoop.hbase.ipc.RpcExecutor$1.run(RpcExecutor.java:107)
    java.lang.&lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;.run(&lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;.java:745)
&lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt; 80 (PriorityRpcServer.handler=8,queue=0,port=16020):

&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</description>
                <environment></environment>
        <key id="12902553">HBASE-14555</key>
            <summary>Deadlock in MVCC branch-1.2 toString()</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/bug.png">Bug</type>
                                            <priority id="2" iconUrl="https://issues.apache.org/jira/images/icons/priorities/critical.png">Critical</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="eclark">Elliott Clark</assignee>
                                    <reporter username="eclark">Elliott Clark</reporter>
                        <labels>
                    </labels>
                <created>Tue, 6 Oct 2015 00:10:11 +0000</created>
                <updated>Fri, 18 Dec 2015 00:42:38 +0000</updated>
                            <resolved>Tue, 6 Oct 2015 00:51:06 +0000</resolved>
                                    <version>2.0.0</version>
                    <version>1.2.0</version>
                                    <fixVersion>2.0.0</fixVersion>
                    <fixVersion>1.2.0</fixVersion>
                                    <component>regionserver</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>6</watches>
                                                                <comments>
                            <comment id="14944304" author="stack" created="Tue, 6 Oct 2015 00:23:13 +0000"  >&lt;p&gt;Sloppy toString... sure. +1.&lt;/p&gt;</comment>
                            <comment id="14944332" author="eclark" created="Tue, 6 Oct 2015 00:38:50 +0000"  >&lt;p&gt;Second thought don&apos;t even try to list the queue. It&apos;s unlikely that the numbers mean much to anyone.&lt;/p&gt;</comment>
                            <comment id="14944334" author="stack" created="Tue, 6 Oct 2015 00:42:08 +0000"  >&lt;p&gt;+1&lt;/p&gt;</comment>
                            <comment id="14944344" author="enis" created="Tue, 6 Oct 2015 00:49:32 +0000"  >&lt;p&gt;+1. Does this mean the mvcc was stuck coming from the toString() call:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
        &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (count % 100 == 0 &amp;amp;&amp;amp; count &amp;gt; 0) {
          Log.warn(&lt;span class=&quot;code-quote&quot;&gt;&quot;STUCK: &quot;&lt;/span&gt; + &lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt;);
        }
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="14944348" author="eclark" created="Tue, 6 Oct 2015 00:51:06 +0000"  >&lt;p&gt;Pushed to branch-1.2 branch-1 and master.&lt;/p&gt;

&lt;p&gt;Thanks for the review &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=stack&quot; class=&quot;user-hover&quot; rel=&quot;stack&quot;&gt;stack&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="14944351" author="eclark" created="Tue, 6 Oct 2015 00:52:45 +0000"  >&lt;blockquote&gt;&lt;p&gt;+1. Does this mean the mvcc was stuck coming from the toString() call:&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;It means that the thread woke up a few times and hadn&apos;t gotten to it&apos;s read point. It could be stuck or it could be making progress slowly.&lt;br/&gt;
This was on a test cluster running ITBLL. It had passed several times previously so I&apos;m not 100% sure yet.&lt;/p&gt;</comment>
                            <comment id="14944396" author="stack" created="Tue, 6 Oct 2015 02:02:37 +0000"  >&lt;p&gt;On ride home had second thoughts. We&apos;re STUCK. Need or the info we can get on the type of STUCK. First version of patch is better than the second for this reason.&lt;/p&gt;

&lt;p&gt;I spent a bunch of time trying to undo STUCK caused by &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-12751&quot; title=&quot;Allow RowLock to be reader writer&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-12751&quot;&gt;&lt;del&gt;HBASE-12751&lt;/del&gt;&lt;/a&gt;... bit worried you found one &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=eclark&quot; class=&quot;user-hover&quot; rel=&quot;eclark&quot;&gt;Elliott Clark&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="14944490" author="hudson" created="Tue, 6 Oct 2015 04:45:19 +0000"  >&lt;p&gt;FAILURE: Integrated in HBase-1.2 #228 (See &lt;a href=&quot;https://builds.apache.org/job/HBase-1.2/228/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/HBase-1.2/228/&lt;/a&gt;)&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-14555&quot; title=&quot;Deadlock in MVCC branch-1.2 toString()&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-14555&quot;&gt;&lt;del&gt;HBASE-14555&lt;/del&gt;&lt;/a&gt; Fix Deadlock in MVCC branch-1.2 toString() (eclark: rev d5127a1f4089c131d564aecd025c486a59cbf7f3)&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;hbase-server/src/main/java/org/apache/hadoop/hbase/regionserver/MultiVersionConcurrencyControl.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="14944520" author="hudson" created="Tue, 6 Oct 2015 05:13:40 +0000"  >&lt;p&gt;SUCCESS: Integrated in HBase-1.2-IT #191 (See &lt;a href=&quot;https://builds.apache.org/job/HBase-1.2-IT/191/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/HBase-1.2-IT/191/&lt;/a&gt;)&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-14555&quot; title=&quot;Deadlock in MVCC branch-1.2 toString()&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-14555&quot;&gt;&lt;del&gt;HBASE-14555&lt;/del&gt;&lt;/a&gt; Fix Deadlock in MVCC branch-1.2 toString() (eclark: rev d5127a1f4089c131d564aecd025c486a59cbf7f3)&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;hbase-server/src/main/java/org/apache/hadoop/hbase/regionserver/MultiVersionConcurrencyControl.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="14944530" author="hudson" created="Tue, 6 Oct 2015 05:27:48 +0000"  >&lt;p&gt;SUCCESS: Integrated in HBase-1.3-IT #211 (See &lt;a href=&quot;https://builds.apache.org/job/HBase-1.3-IT/211/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/HBase-1.3-IT/211/&lt;/a&gt;)&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-14555&quot; title=&quot;Deadlock in MVCC branch-1.2 toString()&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-14555&quot;&gt;&lt;del&gt;HBASE-14555&lt;/del&gt;&lt;/a&gt; Fix Deadlock in MVCC branch-1.2 toString() (eclark: rev 12fd46cdcadf7426417397fab46e8835bd848cf7)&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;hbase-server/src/main/java/org/apache/hadoop/hbase/regionserver/MultiVersionConcurrencyControl.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="14944556" author="hudson" created="Tue, 6 Oct 2015 06:11:35 +0000"  >&lt;p&gt;FAILURE: Integrated in HBase-1.3 #236 (See &lt;a href=&quot;https://builds.apache.org/job/HBase-1.3/236/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/HBase-1.3/236/&lt;/a&gt;)&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-14555&quot; title=&quot;Deadlock in MVCC branch-1.2 toString()&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-14555&quot;&gt;&lt;del&gt;HBASE-14555&lt;/del&gt;&lt;/a&gt; Fix Deadlock in MVCC branch-1.2 toString() (eclark: rev 12fd46cdcadf7426417397fab46e8835bd848cf7)&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;hbase-server/src/main/java/org/apache/hadoop/hbase/regionserver/MultiVersionConcurrencyControl.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="14944570" author="hudson" created="Tue, 6 Oct 2015 06:28:11 +0000"  >&lt;p&gt;FAILURE: Integrated in HBase-TRUNK #6876 (See &lt;a href=&quot;https://builds.apache.org/job/HBase-TRUNK/6876/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/HBase-TRUNK/6876/&lt;/a&gt;)&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-14555&quot; title=&quot;Deadlock in MVCC branch-1.2 toString()&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-14555&quot;&gt;&lt;del&gt;HBASE-14555&lt;/del&gt;&lt;/a&gt; Fix Deadlock in MVCC branch-1.2 toString() (eclark: rev 39042b6a07e3e206b36f3f8ca69ea4a5b2faa4e4)&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;hbase-server/src/main/java/org/apache/hadoop/hbase/regionserver/MultiVersionConcurrencyControl.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                    </comments>
                    <attachments>
                            <attachment id="12765099" name="HBASE-14555-v1.patch" size="1822" author="eclark" created="Tue, 6 Oct 2015 00:38:50 +0000"/>
                            <attachment id="12765097" name="HBASE-14555.patch" size="1511" author="eclark" created="Tue, 6 Oct 2015 00:21:04 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Tue, 6 Oct 2015 00:23:13 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            1 year, 8 weeks, 2 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i2mm4f:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        </customfields>
    </item>
</channel>
</rss>