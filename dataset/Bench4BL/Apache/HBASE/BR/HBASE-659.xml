<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Fri Dec 02 18:33:00 UTC 2016

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/HBASE-659/HBASE-659.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[HBASE-659] HLog#cacheFlushLock not cleared; hangs a region</title>
                <link>https://issues.apache.org/jira/browse/HBASE-659</link>
                <project id="12310753" key="HBASE">HBase</project>
                    <description>&lt;p&gt;I have a region that is stuck in a close that was ordained by a split.  Here is what I have from the log pertaining to the stuck region:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;4    6416 2008-05-29 22:29:03,433 INFO org.apache.hadoop.hbase.HRegion: checking compaction completed on region enwiki,IK9sWdHJe6ffGZgFPsqIvk==,1212092907061 in 12sec
5    6417 2008-05-29 22:29:03,439 INFO org.apache.hadoop.hbase.HRegion: Splitting enwiki,IK9sWdHJe6ffGZgFPsqIvk==,1212092907061 because largest aggregate size is 288.3m and desired size is 256.0m                                                                    
6    6418 2008-05-29 22:29:03,443 DEBUG org.apache.hadoop.hbase.HRegion: compactions and cache flushes disabled &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; region enwiki,IK9sWdHJe6ffGZgFPsqIvk==,1212092907061
7    6419 2008-05-29 22:29:03,443 DEBUG org.apache.hadoop.hbase.HRegion: &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; updates and scanners &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; region enwiki,IK9sWdHJe6ffGZgFPsqIvk==,1212092907061 disabled                                                                                                    
8    6420 2008-05-29 22:29:03,443 DEBUG org.apache.hadoop.hbase.HRegion: no more active scanners &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; region enwiki,IK9sWdHJe6ffGZgFPsqIvk==,1212092907061
9    6421 2008-05-29 22:29:03,443 DEBUG org.apache.hadoop.hbase.HRegion: no more row locks outstanding on region enwiki,IK9sWdHJe6ffGZgFPsqIvk==,1212092907061                                                                                                        
10   6422 2008-05-29 22:29:03,443 DEBUG org.apache.hadoop.hbase.HRegionServer: enwiki,IK9sWdHJe6ffGZgFPsqIvk==,1212092907061 closing (Adding to retiringRegions)
11   6423 2008-05-29 22:29:03,443 DEBUG org.apache.hadoop.hbase.HRegion: Started memcache flush &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; region enwiki,IK9sWdHJe6ffGZgFPsqIvk==,1212092907061. Current region memcache size 2.1m                                                                           
12    6424 2008-05-29 22:29:03,561 INFO org.apache.hadoop.ipc.Server: IPC Server handler 0 on 60020, call batchUpdate(enwiki,IK9sWdHJe6ffGZgFPsqIvk==,1212092907061, 1171081390000, org.apache.hadoop.hbase.io.BatchUpdate@2eeb0275) from 208.76.44.139:49358: err        or: org.        apache.hadoop.hbase.NotServingRegionException: enwiki,IK9sWdHJe6ffGZgFPsqIvk==,1212092907061                                                                                                                                                        
13   6425 org.apache.hadoop.hbase.NotServingRegionException: enwiki,IK9sWdHJe6ffGZgFPsqIvk==,1212092907061
14   6434 2008-05-29 22:29:03,982 INFO org.apache.hadoop.ipc.Server: IPC Server handler 9 on 60020, call batchUpdate(enwiki,IK9sWdHJe6ffGZgFPsqIvk==,1212092907061, 1202595259000, org.apache.hadoop.hbase.io.BatchUpdate@46ee6763) from 208.76.44.139:49358: err        or: org.        apache.hadoop.hbase.NotServingRegionException: enwiki,IK9sWdHJe6ffGZgFPsqIvk==,1212092907061
15   6435 org.apache.hadoop.hbase.NotServingRegionException: enwiki,IK9sWdHJe6ffGZgFPsqIvk==,1212092907061
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Then in thread dump, I have two threads blocked on the HLog#cacheFlushLock but looking in code, there is no obvious code path that would get a situation where a lock is held and then not released.&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;&lt;span class=&quot;code-quote&quot;&gt;&quot;regionserver/0:0:0:0:0:0:0:0:60020.compactor&quot;&lt;/span&gt; daemon prio=1 tid=0x00002aab381e5fd0 nid=0x6195 waiting on condition [0x0000000041c6c000..0x0000000041c6ce00]
        at sun.misc.Unsafe.park(Native Method)
        at java.util.concurrent.locks.LockSupport.park(Unknown Source)
        at java.util.concurrent.locks.AbstractQueuedSynchronizer.parkAndCheckInterrupt(Unknown Source)
        at java.util.concurrent.locks.AbstractQueuedSynchronizer.acquireQueued(Unknown Source)
        at java.util.concurrent.locks.AbstractQueuedSynchronizer.acquire(Unknown Source)
        at java.util.concurrent.locks.ReentrantLock$NonfairSync.lock(Unknown Source)
        at java.util.concurrent.locks.ReentrantLock.lock(Unknown Source)
        at org.apache.hadoop.hbase.HLog.startCacheFlush(HLog.java:459)
        at org.apache.hadoop.hbase.HRegion.internalFlushcache(HRegion.java:1089)
        at org.apache.hadoop.hbase.HRegion.close(HRegion.java:594)
        - locked &amp;lt;0x00002aaab70bf3a0&amp;gt; (a java.lang.&lt;span class=&quot;code-object&quot;&gt;Integer&lt;/span&gt;)
        at org.apache.hadoop.hbase.HRegion.splitRegion(HRegion.java:759)
        - locked &amp;lt;0x00002aaab70bf3a0&amp;gt; (a java.lang.&lt;span class=&quot;code-object&quot;&gt;Integer&lt;/span&gt;)
        at org.apache.hadoop.hbase.HRegionServer$CompactSplitThread.split(HRegionServer.java:248)
        at org.apache.hadoop.hbase.HRegionServer$CompactSplitThread.run(HRegionServer.java:204)

...


&lt;span class=&quot;code-quote&quot;&gt;&quot;regionserver/0:0:0:0:0:0:0:0:60020.logRoller&quot;&lt;/span&gt; daemon prio=1 tid=0x00002aab38181d70 nid=0x6193 waiting on condition [0x0000000041a6a000..0x0000000041a6ab00]
        at sun.misc.Unsafe.park(Native Method)
        at java.util.concurrent.locks.LockSupport.park(Unknown Source)
        at java.util.concurrent.locks.AbstractQueuedSynchronizer.parkAndCheckInterrupt(Unknown Source)
        at java.util.concurrent.locks.AbstractQueuedSynchronizer.acquireQueued(Unknown Source)
        at java.util.concurrent.locks.AbstractQueuedSynchronizer.acquire(Unknown Source)
        at java.util.concurrent.locks.ReentrantLock$NonfairSync.lock(Unknown Source)
        at java.util.concurrent.locks.ReentrantLock.lock(Unknown Source)
        at org.apache.hadoop.hbase.HLog.rollWriter(HLog.java:219)
        at org.apache.hadoop.hbase.HRegionServer$LogRoller.run(HRegionServer.java:615)
        - locked &amp;lt;0x00002aaab69ccf00&amp;gt; (a java.lang.&lt;span class=&quot;code-object&quot;&gt;Integer&lt;/span&gt;)
...
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</description>
                <environment></environment>
        <key id="12397203">HBASE-659</key>
            <summary>HLog#cacheFlushLock not cleared; hangs a region</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/bug.png">Bug</type>
                                            <priority id="1" iconUrl="https://issues.apache.org/jira/images/icons/priorities/blocker.png">Blocker</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="stack">stack</assignee>
                                    <reporter username="stack">stack</reporter>
                        <labels>
                    </labels>
                <created>Fri, 30 May 2008 20:35:11 +0000</created>
                <updated>Fri, 22 Aug 2008 21:13:16 +0000</updated>
                            <resolved>Sun, 1 Jun 2008 05:21:37 +0000</resolved>
                                    <version>0.1.2</version>
                                    <fixVersion>0.1.3</fixVersion>
                    <fixVersion>0.2.0</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                <comments>
                            <comment id="12601247" author="stack" created="Fri, 30 May 2008 20:57:14 +0000"  >&lt;p&gt;Here&apos;s the thread dump on exit.  Gives a clean view of the deadlock.  Regionserver will not go down when we have this condition, not without a kill -9:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
Full thread dump Java HotSpot(TM) 64-Bit Server VM (1.5.0_13-b05 mixed mode):

&lt;span class=&quot;code-quote&quot;&gt;&quot;&lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;-8&quot;&lt;/span&gt; prio=1 tid=0x00002aab3c696e60 nid=0x38db in &lt;span class=&quot;code-object&quot;&gt;Object&lt;/span&gt;.wait() [0x0000000042f7f000..0x0000000042f7fc80]
        at java.lang.&lt;span class=&quot;code-object&quot;&gt;Object&lt;/span&gt;.wait(Native Method)
        - waiting on &amp;lt;0x00002aaab69a2e90&amp;gt; (a org.apache.hadoop.hbase.HRegionServer$CompactSplitThread)
        at java.lang.&lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;.join(Unknown Source)
        - locked &amp;lt;0x00002aaab69a2e90&amp;gt; (a org.apache.hadoop.hbase.HRegionServer$CompactSplitThread)
        at java.lang.&lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;.join(Unknown Source)
        at org.apache.hadoop.hbase.HRegionServer.join(HRegionServer.java:1081)
        at org.apache.hadoop.hbase.HRegionServer.join(HRegionServer.java:1074)
        at org.apache.hadoop.hbase.HRegionServer$ShutdownThread.run(HRegionServer.java:158)
        
&lt;span class=&quot;code-quote&quot;&gt;&quot;SIGTERM handler&quot;&lt;/span&gt; daemon prio=1 tid=0x00002aab37d61eb0 nid=0x38d8 in &lt;span class=&quot;code-object&quot;&gt;Object&lt;/span&gt;.wait() [0x0000000043282000..0x0000000043282e00]
        at java.lang.&lt;span class=&quot;code-object&quot;&gt;Object&lt;/span&gt;.wait(Native Method)
        - waiting on &amp;lt;0x00002aaab693ad28&amp;gt; (a org.apache.hadoop.hbase.HRegionServer$ShutdownThread)
        at java.lang.&lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;.join(Unknown Source)
        - locked &amp;lt;0x00002aaab693ad28&amp;gt; (a org.apache.hadoop.hbase.HRegionServer$ShutdownThread)
        at java.lang.&lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;.join(Unknown Source)
        at java.lang.Shutdown.runHooks(Unknown Source)
        at java.lang.Shutdown.sequence(Unknown Source)
        at java.lang.Shutdown.exit(Unknown Source)
        - locked &amp;lt;0x00002aaab1bdced8&amp;gt; (a java.lang.&lt;span class=&quot;code-object&quot;&gt;Class&lt;/span&gt;)
        at java.lang.Terminator$1.handle(Unknown Source)
        at sun.misc.Signal$1.run(Unknown Source) 
        at java.lang.&lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;.run(Unknown Source)
        
&lt;span class=&quot;code-quote&quot;&gt;&quot;IPC Client connection to coral-dfs.cluster.powerset.com/208.76.44.135:10000&quot;&lt;/span&gt; daemon prio=1 tid=0x00002aab3c5157d0 nid=0x7db5 runnable [0x0000000043585000..0x0000000043585c80]
        at java.net.SocketInputStream.socketRead0(Native Method)
        at java.net.SocketInputStream.read(Unknown Source)
        at java.io.FilterInputStream.read(Unknown Source)
        at org.apache.hadoop.ipc.Client$Connection$1.read(Client.java:190)
        at java.io.BufferedInputStream.fill(Unknown Source)
        at java.io.BufferedInputStream.read(Unknown Source)
        - locked &amp;lt;0x00002aaab6ef97c8&amp;gt; (a java.io.BufferedInputStream)
        at java.io.DataInputStream.readInt(Unknown Source)
        at org.apache.hadoop.ipc.Client$Connection.run(Client.java:276)

&lt;span class=&quot;code-quote&quot;&gt;&quot;regionserver/0:0:0:0:0:0:0:0:60020.compactor&quot;&lt;/span&gt; daemon prio=1 tid=0x00002aab381e5fd0 nid=0x6195 waiting on condition [0x0000000041c6c000..0x0000000041c6ce00]
        at sun.misc.Unsafe.park(Native Method)
        at java.util.concurrent.locks.LockSupport.park(Unknown Source)
        at java.util.concurrent.locks.AbstractQueuedSynchronizer.parkAndCheckInterrupt(Unknown Source)
        at java.util.concurrent.locks.AbstractQueuedSynchronizer.acquireQueued(Unknown Source)
        at java.util.concurrent.locks.AbstractQueuedSynchronizer.acquire(Unknown Source)
        at java.util.concurrent.locks.ReentrantLock$NonfairSync.lock(Unknown Source)
        at java.util.concurrent.locks.ReentrantLock.lock(Unknown Source)
        at org.apache.hadoop.hbase.HLog.startCacheFlush(HLog.java:459)
        at org.apache.hadoop.hbase.HRegion.internalFlushcache(HRegion.java:1089)
        at org.apache.hadoop.hbase.HRegion.close(HRegion.java:594)
        - locked &amp;lt;0x00002aaab6fa4e60&amp;gt; (a java.lang.&lt;span class=&quot;code-object&quot;&gt;Integer&lt;/span&gt;)
        at org.apache.hadoop.hbase.HRegion.splitRegion(HRegion.java:759)
        - locked &amp;lt;0x00002aaab6fa4e60&amp;gt; (a java.lang.&lt;span class=&quot;code-object&quot;&gt;Integer&lt;/span&gt;)
        at org.apache.hadoop.hbase.HRegionServer$CompactSplitThread.split(HRegionServer.java:248)
        at org.apache.hadoop.hbase.HRegionServer$CompactSplitThread.run(HRegionServer.java:204)

&lt;span class=&quot;code-quote&quot;&gt;&quot;regionserver/0:0:0:0:0:0:0:0:60020.logRoller&quot;&lt;/span&gt; daemon prio=1 tid=0x00002aab38181d70 nid=0x6193 waiting on condition [0x0000000041a6a000..0x0000000041a6ab00]
        at sun.misc.Unsafe.park(Native Method)
        at java.util.concurrent.locks.LockSupport.park(Unknown Source)
        at java.util.concurrent.locks.AbstractQueuedSynchronizer.parkAndCheckInterrupt(Unknown Source)
        at java.util.concurrent.locks.AbstractQueuedSynchronizer.acquireQueued(Unknown Source)
        at java.util.concurrent.locks.AbstractQueuedSynchronizer.acquire(Unknown Source)
        at java.util.concurrent.locks.ReentrantLock$NonfairSync.lock(Unknown Source)
        at java.util.concurrent.locks.ReentrantLock.lock(Unknown Source)
        at org.apache.hadoop.hbase.HLog.rollWriter(HLog.java:219)
        at org.apache.hadoop.hbase.HRegionServer$LogRoller.run(HRegionServer.java:615)
        - locked &amp;lt;0x00002aaab69a3790&amp;gt; (a java.lang.&lt;span class=&quot;code-object&quot;&gt;Integer&lt;/span&gt;)

&lt;span class=&quot;code-quote&quot;&gt;&quot;org.apache.hadoop.io.ObjectWritable Connection Culler&quot;&lt;/span&gt; daemon prio=1 tid=0x00002aab38001280 nid=0x6185 waiting on condition [0x0000000041666000..0x0000000041666d00]
        at java.lang.&lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;.sleep(Native Method)
        at org.apache.hadoop.ipc.Client$ConnectionCuller.run(Client.java:423)

&lt;span class=&quot;code-quote&quot;&gt;&quot;org.apache.hadoop.hbase.io.HbaseObjectWritable Connection Culler&quot;&lt;/span&gt; daemon prio=1 tid=0x00002aab3771f2a0 nid=0x5ea2 waiting on condition [0x0000000041464000..0x0000000041464d00]
        at java.lang.&lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;.sleep(Native Method)
        at org.apache.hadoop.ipc.Client$ConnectionCuller.run(Client.java:423)

&lt;span class=&quot;code-quote&quot;&gt;&quot;DestroyJavaVM&quot;&lt;/span&gt; prio=1 tid=0x0000000040116a20 nid=0x5e70 waiting on condition [0x0000000000000000..0x00007fffb7bdab80]

&lt;span class=&quot;code-quote&quot;&gt;&quot;regionserver/0:0:0:0:0:0:0:0:60020&quot;&lt;/span&gt; prio=1 tid=0x00002aab37b76d60 nid=0x5ea1 waiting &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; monitor entry [0x0000000041363000..0x0000000041363d80]
        at org.apache.hadoop.hbase.HRegionServer.run(HRegionServer.java:862)
        - waiting to lock &amp;lt;0x00002aaab69a3790&amp;gt; (a java.lang.&lt;span class=&quot;code-object&quot;&gt;Integer&lt;/span&gt;)
        at java.lang.&lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;.run(Unknown Source)

&lt;span class=&quot;code-quote&quot;&gt;&quot;Low Memory Detector&quot;&lt;/span&gt; daemon prio=1 tid=0x00002aab37148810 nid=0x5e9f runnable [0x0000000000000000..0x0000000000000000]

&lt;span class=&quot;code-quote&quot;&gt;&quot;CompilerThread1&quot;&lt;/span&gt; daemon prio=1 tid=0x00002aab37146be0 nid=0x5e9e waiting on condition [0x0000000000000000..0x000000004105f3e0]

&lt;span class=&quot;code-quote&quot;&gt;&quot;CompilerThread0&quot;&lt;/span&gt; daemon prio=1 tid=0x00002aab37145630 nid=0x5e9d waiting on condition [0x0000000000000000..0x0000000040f5e4a0]

&lt;span class=&quot;code-quote&quot;&gt;&quot;AdapterThread&quot;&lt;/span&gt; daemon prio=1 tid=0x00002aab37143ed0 nid=0x5e9c waiting on condition [0x0000000000000000..0x0000000000000000]

&lt;span class=&quot;code-quote&quot;&gt;&quot;Signal Dispatcher&quot;&lt;/span&gt; daemon prio=1 tid=0x00002aab37136fd0 nid=0x5e9b waiting on condition [0x0000000000000000..0x0000000040d5dc50]

&lt;span class=&quot;code-quote&quot;&gt;&quot;Finalizer&quot;&lt;/span&gt; daemon prio=1 tid=0x00002aab37130020 nid=0x5e9a in &lt;span class=&quot;code-object&quot;&gt;Object&lt;/span&gt;.wait() [0x0000000040c5c000..0x0000000040c5cd00]
        at java.lang.&lt;span class=&quot;code-object&quot;&gt;Object&lt;/span&gt;.wait(Native Method)
        at java.lang.ref.ReferenceQueue.remove(Unknown Source)
        - locked &amp;lt;0x00002aaab69b91e0&amp;gt; (a java.lang.ref.ReferenceQueue$Lock)
        at java.lang.ref.ReferenceQueue.remove(Unknown Source)
        at java.lang.ref.Finalizer$FinalizerThread.run(Unknown Source)

&lt;span class=&quot;code-quote&quot;&gt;&quot;Reference Handler&quot;&lt;/span&gt; daemon prio=1 tid=0x00002aab3712f740 nid=0x5e99 in &lt;span class=&quot;code-object&quot;&gt;Object&lt;/span&gt;.wait() [0x0000000040b5b000..0x0000000040b5bd80]
        at java.lang.&lt;span class=&quot;code-object&quot;&gt;Object&lt;/span&gt;.wait(Native Method)
        at java.lang.&lt;span class=&quot;code-object&quot;&gt;Object&lt;/span&gt;.wait(Unknown Source)
        at java.lang.ref.Reference$ReferenceHandler.run(Unknown Source)
        - locked &amp;lt;0x00002aaab69b6fa0&amp;gt; (a java.lang.ref.Reference$Lock)

&lt;span class=&quot;code-quote&quot;&gt;&quot;VM &lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;&quot;&lt;/span&gt; prio=1 tid=0x00002aab371283d0 nid=0x5e98 runnable

&lt;span class=&quot;code-quote&quot;&gt;&quot;GC task thread#0 (ParallelGC)&quot;&lt;/span&gt; prio=1 tid=0x0000000040133610 nid=0x5e90 runnable

&lt;span class=&quot;code-quote&quot;&gt;&quot;GC task thread#1 (ParallelGC)&quot;&lt;/span&gt; prio=1 tid=0x0000000040134490 nid=0x5e91 runnable

&lt;span class=&quot;code-quote&quot;&gt;&quot;GC task thread#2 (ParallelGC)&quot;&lt;/span&gt; prio=1 tid=0x0000000040135310 nid=0x5e92 runnable

&lt;span class=&quot;code-quote&quot;&gt;&quot;GC task thread#3 (ParallelGC)&quot;&lt;/span&gt; prio=1 tid=0x0000000040136190 nid=0x5e93 runnable

&lt;span class=&quot;code-quote&quot;&gt;&quot;GC task thread#4 (ParallelGC)&quot;&lt;/span&gt; prio=1 tid=0x0000000040137010 nid=0x5e94 runnable

&lt;span class=&quot;code-quote&quot;&gt;&quot;GC task thread#5 (ParallelGC)&quot;&lt;/span&gt; prio=1 tid=0x0000000040137e90 nid=0x5e95 runnable

&lt;span class=&quot;code-quote&quot;&gt;&quot;GC task thread#6 (ParallelGC)&quot;&lt;/span&gt; prio=1 tid=0x0000000040138d10 nid=0x5e96 runnable

&lt;span class=&quot;code-quote&quot;&gt;&quot;GC task thread#7 (ParallelGC)&quot;&lt;/span&gt; prio=1 tid=0x0000000040139b90 nid=0x5e97 runnable

&lt;span class=&quot;code-quote&quot;&gt;&quot;VM Periodic Task &lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;&quot;&lt;/span&gt; prio=1 tid=0x000000004012a520 nid=0x5ea0 waiting on condition
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="12601416" author="stack" created="Sat, 31 May 2008 21:42:29 +0000"  >&lt;p&gt;It happened again on a new upload.  Here&apos;s the why:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
2008-05-31 03:47:05,806 ERROR org.apache.hadoop.hbase.HRegionServer: Cache flush failed &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; region .META.,,1
java.lang.NullPointerException
        at org.apache.hadoop.hbase.HStore$StoreFileScanner.openReaders(HStore.java:2491)
        at org.apache.hadoop.hbase.HStore$StoreFileScanner.updateReaders(HStore.java:2654)
        at org.apache.hadoop.hbase.HStore.notifyChangedReadersObservers(HStore.java:1371)
        at org.apache.hadoop.hbase.HStore.updateReaders(HStore.java:1358)
        at org.apache.hadoop.hbase.HStore.internalFlushCache(HStore.java:1330)
        at org.apache.hadoop.hbase.HStore.flushCache(HStore.java:1267)
        at org.apache.hadoop.hbase.HRegion.internalFlushcache(HRegion.java:1100)
        at org.apache.hadoop.hbase.HRegion.flushcache(HRegion.java:1020)
        at org.apache.hadoop.hbase.HRegionServer$Flusher.flushRegion(HRegionServer.java:446)
        at org.apache.hadoop.hbase.HRegionServer$Flusher.run(HRegionServer.java:390)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;We&apos;ll clear the lock if its an IOE, but not if its NPE, etc.&lt;/p&gt;</comment>
                            <comment id="12601425" author="stack" created="Sat, 31 May 2008 23:23:16 +0000"  >&lt;p&gt;Changed code so we&apos;ll ALWAYS clear flush lock, even if non-IOE exception.  Also fix code so we don&apos;t NPE.&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
M src/java/org/apache/hadoop/hbase/HStore.java
    Formatting.
    Renamed the readers data member in StoreFileScanner to be sfsReaders
    In openReaders, check &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; readers that have already been nulled/closed
    before closing myself (Avoids NPE).
    Made findFirstRow, closeSubScanner, getNext &lt;span class=&quot;code-keyword&quot;&gt;private&lt;/span&gt;.
M src/java/org/apache/hadoop/hbase/HRegion.java
    Always clear the cache flush lock.  Added exception stacktrace
    to DroppedSnapshotException so we have more info when these things
    happen.
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="12601438" author="stack" created="Sun, 1 Jun 2008 05:21:36 +0000"  >&lt;p&gt;Committed to branch and trunk.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12383177" name="659-0.1.patch" size="7779" author="stack" created="Sat, 31 May 2008 23:23:16 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>25319</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            8 years, 27 weeks, 5 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0h8nr:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>98665</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        </customfields>
    </item>
</channel>
</rss>