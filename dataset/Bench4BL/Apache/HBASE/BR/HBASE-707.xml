<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Fri Dec 02 18:51:56 UTC 2016

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/HBASE-707/HBASE-707.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[HBASE-707] High-load import of data into single table/family never triggers split</title>
                <link>https://issues.apache.org/jira/browse/HBASE-707</link>
                <project id="12310753" key="HBASE">HBase</project>
                    <description>&lt;p&gt;Importing a heavy amount of data into a single table and family.&lt;/p&gt;

&lt;p&gt;One column in that family (the same fam:col for every row) contains a frequently large amount of UTF-8 data.  This column grows and grows but never causes a region split.&lt;/p&gt;

&lt;p&gt;Currently there is a single mapfile containing nearly 10GB.&lt;/p&gt;

&lt;p&gt;Eventually this has caused regions to crash with OOME, as described in &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-706&quot; title=&quot;On OOME, regionserver sticks around and doesn&amp;#39;t go down with cluster&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-706&quot;&gt;&lt;del&gt;HBASE-706&lt;/del&gt;&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;Table in question:&lt;/p&gt;

&lt;p&gt;hql &amp;gt; describe items;&lt;br/&gt;
&lt;ins&gt;-----------------------------------------------------------------------------&lt;/ins&gt;&lt;/p&gt;
&lt;table class=&apos;confluenceTable&apos;&gt;&lt;tbody&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; Column Family Descriptor                                                    &lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;&lt;/table&gt;

&lt;p&gt;&lt;ins&gt;-----------------------------------------------------------------------------&lt;/ins&gt;&lt;/p&gt;
&lt;table class=&apos;confluenceTable&apos;&gt;&lt;tbody&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; name: cfrecs, max versions: 2, compression: NONE, in memory: false, max leng&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; th: 2147483647, bloom filter: none                                          &lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;&lt;/table&gt;

&lt;p&gt;&lt;ins&gt;-----------------------------------------------------------------------------&lt;/ins&gt;&lt;/p&gt;
&lt;table class=&apos;confluenceTable&apos;&gt;&lt;tbody&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; name: clusters, max versions: 2, compression: NONE, in memory: false, max le&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; ngth: 2147483647, bloom filter: none                                        &lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;&lt;/table&gt;

&lt;p&gt;&lt;ins&gt;-----------------------------------------------------------------------------&lt;/ins&gt;&lt;/p&gt;
&lt;table class=&apos;confluenceTable&apos;&gt;&lt;tbody&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; name: content, max versions: 2, compression: NONE, in memory: false, max len&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; gth: 2147483647, bloom filter: none                                         &lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;&lt;/table&gt;

&lt;p&gt;&lt;ins&gt;-----------------------------------------------------------------------------&lt;/ins&gt;&lt;/p&gt;
&lt;table class=&apos;confluenceTable&apos;&gt;&lt;tbody&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; name: readby, max versions: 2, compression: NONE, in memory: false, max leng&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; th: 2147483647, bloom filter: none                                          &lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;&lt;/table&gt;

&lt;p&gt;&lt;ins&gt;-----------------------------------------------------------------------------&lt;/ins&gt;&lt;/p&gt;
&lt;table class=&apos;confluenceTable&apos;&gt;&lt;tbody&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; name: receivedby, max versions: 2, compression: NONE, in memory: false, max &lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; length: 2147483647, bloom filter: none                                      &lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;&lt;/table&gt;

&lt;p&gt;&lt;ins&gt;-----------------------------------------------------------------------------&lt;/ins&gt;&lt;/p&gt;
&lt;table class=&apos;confluenceTable&apos;&gt;&lt;tbody&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; name: savedby, max versions: 2, compression: NONE, in memory: false, max len&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; gth: 2147483647, bloom filter: none                                         &lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;&lt;/table&gt;

&lt;p&gt;&lt;ins&gt;-----------------------------------------------------------------------------&lt;/ins&gt;&lt;/p&gt;
&lt;table class=&apos;confluenceTable&apos;&gt;&lt;tbody&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; name: sentby, max versions: 2, compression: NONE, in memory: false, max leng&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; th: 2147483647, bloom filter: none                                          &lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;&lt;/table&gt;

&lt;p&gt;&lt;ins&gt;-----------------------------------------------------------------------------&lt;/ins&gt;&lt;br/&gt;
7 columnfamily(s) in set. (0.34 sec)&lt;/p&gt;</description>
                <environment>&lt;p&gt;Linux 2.6.25-14.fc9.x86_64, Fedora Core 9&lt;/p&gt;</environment>
        <key id="12399016">HBASE-707</key>
            <summary>High-load import of data into single table/family never triggers split</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/bug.png">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.png">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="stack">stack</assignee>
                                    <reporter username="streamy">Jonathan Gray</reporter>
                        <labels>
                    </labels>
                <created>Wed, 25 Jun 2008 17:46:43 +0000</created>
                <updated>Fri, 22 Aug 2008 21:14:46 +0000</updated>
                            <resolved>Thu, 26 Jun 2008 03:40:48 +0000</resolved>
                                    <version>0.1.3</version>
                                    <fixVersion>0.1.3</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                <comments>
                            <comment id="12608123" author="streamy" created="Wed, 25 Jun 2008 17:47:38 +0000"  >&lt;p&gt;The lack of splitting eventually lead to the OOME when attempting compaction&lt;/p&gt;</comment>
                            <comment id="12608126" author="streamy" created="Wed, 25 Jun 2008 17:52:50 +0000"  >&lt;p&gt;Added table description&lt;/p&gt;</comment>
                            <comment id="12608167" author="stack" created="Wed, 25 Jun 2008 19:49:32 +0000"  >&lt;p&gt;Have been working with John on his cluster on this issue.  This patch seems to fix the issue (more testing to do).&lt;/p&gt;

&lt;p&gt;Splits are triggered if the compaction run returns true.  The return up out of compaction was coming up from the depths of store file and on the way could be mangled if multiple families in a region; one might compact but the subsequent one might not.  Because of the latter, we&apos;d not run split check.&lt;/p&gt;</comment>
                            <comment id="12608229" author="streamy" created="Wed, 25 Jun 2008 23:28:25 +0000"  >&lt;p&gt;Recreated entire use case scenario and the issue is gone.  We are now seeing normal region splits.&lt;/p&gt;

&lt;p&gt;However, we have experienced a new behavior during those splits.  We are writing and the client receives an IllegalStateException:&lt;/p&gt;

&lt;p&gt;Trying to commit: Exception in thread &quot;main&quot; java.lang.RuntimeException: java.lang.IllegalStateException: region offline: items,823ce1e3-d414-474f-ac70-c4081cecef0f,1214434560891&lt;br/&gt;
 at org.apache.hadoop.hbase.HTable.getRegionServerWithRetries(HTable.java:1062)&lt;br/&gt;
 at org.apache.hadoop.hbase.HTable.commit(HTable.java:763)&lt;br/&gt;
 at org.apache.hadoop.hbase.HTable.commit(HTable.java:744)&lt;br/&gt;
 at HBase.AddAttributes(HBase.java:220)&lt;br/&gt;
 at PoJaMigratorItems.Add(PoJaMigratorItems.java:143)&lt;br/&gt;
 at PoJaMigrator.AddItems(PoJaMigrator.java:123)&lt;br/&gt;
 at PoJaMigrator.AddAllData(PoJaMigrator.java:57)&lt;br/&gt;
 at PoJaMigrator.&amp;lt;init&amp;gt;(PoJaMigrator.java:27)&lt;br/&gt;
 at PoJaMigrator.main(PoJaMigrator.java:35)&lt;br/&gt;
Caused by: java.lang.IllegalStateException: region offline: items,823ce1e3-d414-474f-ac70-c4081cecef0f,1214434560891&lt;br/&gt;
 at org.apache.hadoop.hbase.HConnectionManager$TableServers.locateRegionInMeta(HConnectionManager.java:438)&lt;br/&gt;
 at org.apache.hadoop.hbase.HConnectionManager$TableServers.locateRegion(HConnectionManager.java:350)&lt;br/&gt;
 at org.apache.hadoop.hbase.HConnectionManager$TableServers.relocateRegion(HConnectionManager.java:318)&lt;br/&gt;
 at org.apache.hadoop.hbase.HTable.getRegionLocation(HTable.java:114)&lt;br/&gt;
 at org.apache.hadoop.hbase.HTable$ServerCallable.instantiateServer(HTable.java:1021)&lt;br/&gt;
 at org.apache.hadoop.hbase.HTable.getRegionServerWithRetries(HTable.java:1036)&lt;br/&gt;
 ... 8 more&lt;/p&gt;</comment>
                            <comment id="12608240" author="stack" created="Thu, 26 Jun 2008 00:48:47 +0000"  >&lt;p&gt;Thanks for confirming patch Jon. The ISE is because your clocks are way skewed.   Will fix that over in &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-710&quot; title=&quot;If clocks are way off, then we can have daughter split come before rather than after its parent in .META.&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-710&quot;&gt;&lt;del&gt;HBASE-710&lt;/del&gt;&lt;/a&gt;  I&apos;ll commit this patch later tonight.&lt;/p&gt;</comment>
                            <comment id="12608264" author="stack" created="Thu, 26 Jun 2008 03:40:48 +0000"  >&lt;p&gt;Committed to branch.  Trunk doesn&apos;t have this issue.  It has another: &lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                            <outwardlinks description="relates to">
                                        <issuelink>
            <issuekey id="12399013">HBASE-706</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12384702" name="707.patch" size="4195" author="stack" created="Wed, 25 Jun 2008 19:49:32 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Wed, 25 Jun 2008 19:49:32 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>25350</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            8 years, 24 weeks, 1 day ago
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0h8yf:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>98713</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        </customfields>
    </item>
</channel>
</rss>