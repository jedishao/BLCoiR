<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Sat Dec 03 19:36:25 UTC 2016

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/HBASE-6537/HBASE-6537.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[HBASE-6537] Race between balancer and disable table can lead to inconsistent cluster</title>
                <link>https://issues.apache.org/jira/browse/HBASE-6537</link>
                <project id="12310753" key="HBASE">HBase</project>
                    <description>&lt;p&gt;Appear in 94. trunk is ok for the issue&lt;br/&gt;
Balancer will collect the regionplans to move(unassign and then assign).&lt;br/&gt;
before unassign, disable table appears, &lt;br/&gt;
after close the region in rs, master will delete the znode, romove region from RIT,&lt;br/&gt;
and then clean the region from the online regions.&lt;/p&gt;

&lt;p&gt;During romoving region from RIT and cleaning out the region from the online regions. &lt;br/&gt;
balancer begins to unassign, it will get a NotServingRegionException and if the table is disabling, it will deal with the state in master and delete the znode . However the table is disabled now, so the RIT and znode will remain. TimeoutMonitor draws a blank on it.&lt;/p&gt;

&lt;p&gt;It will hold back enabling the table or balancer unless restart&lt;/p&gt;</description>
                <environment></environment>
        <key id="12602431">HBASE-6537</key>
            <summary>Race between balancer and disable table can lead to inconsistent cluster</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/bug.png">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.png">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="zhou wen jian">Zhou wenjian</assignee>
                                    <reporter username="zhou wen jian">Zhou wenjian</reporter>
                        <labels>
                    </labels>
                <created>Thu, 9 Aug 2012 09:16:31 +0000</created>
                <updated>Mon, 31 Mar 2014 10:38:15 +0000</updated>
                            <resolved>Fri, 31 Aug 2012 03:54:33 +0000</resolved>
                                    <version>0.94.0</version>
                                    <fixVersion>0.94.2</fixVersion>
                                    <component>master</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>13</watches>
                                                                <comments>
                            <comment id="13431847" author="rajesh23" created="Thu, 9 Aug 2012 14:36:42 +0000"  >&lt;p&gt;@Zhou wenjian&lt;br/&gt;
clearing from online regions before removing from RIT may not solve the problem completely.&lt;br/&gt;
Its better to check whether table is in disabling and disabled also in case of NotServingRegionException.&lt;/p&gt;

&lt;p&gt;May be this is applicable for trunk also because there also we are checking table is in disabling only.&lt;br/&gt;
Please correct me if i am wrong.&lt;/p&gt;</comment>
                            <comment id="13432485" author="zhou wen jian" created="Fri, 10 Aug 2012 02:10:53 +0000"  >&lt;p&gt;@rajeshbabu&lt;br/&gt;
thanks for your reply.&lt;/p&gt;

&lt;p&gt;agree with you, checking whether table is in disabling and disabled also in case of NotServingRegionException will prevent from the issue too.&lt;/p&gt;

&lt;p&gt;There is no problem in trunk because of it handling well in such scenario, but since we will check table state both disabling and disabled, patch for trunk is also applicable&lt;/p&gt;</comment>
                            <comment id="13432589" author="zhihyu@ebaysf.com" created="Fri, 10 Aug 2012 03:39:48 +0000"  >&lt;p&gt;@Wenjian:&lt;br/&gt;
Can you run trunk patch through test suite and post back the results ?&lt;/p&gt;

&lt;p&gt;See &lt;a href=&quot;https://issues.apache.org/jira/browse/INFRA-5131&quot; title=&quot;IOE when creating a JIRA&quot; class=&quot;issue-link&quot; data-issue-key=&quot;INFRA-5131&quot;&gt;&lt;del&gt;INFRA-5131&lt;/del&gt;&lt;/a&gt; for progress on solving JIRA malfunction.&lt;/p&gt;</comment>
                            <comment id="13432921" author="zhou wen jian" created="Mon, 13 Aug 2012 05:07:28 +0000"  >&lt;p&gt;@Ted&lt;br/&gt;
we have no trunk hudson, just 94 in local&lt;/p&gt;</comment>
                            <comment id="13435765" author="ram_krish" created="Thu, 16 Aug 2012 05:10:06 +0000"  >&lt;p&gt;@Zhou&lt;br/&gt;
I think only the check for Disabling should be enough right? do you think change in regionOffline is needed? Thanks Zhou.&lt;/p&gt;</comment>
                            <comment id="13435771" author="zhou wen jian" created="Thu, 16 Aug 2012 05:32:55 +0000"  >&lt;p&gt;@ramkrishna.s.vasudevan&lt;/p&gt;

&lt;p&gt;We can shutdown the window between RIT and regions with the change, lots of problems may be caused by it.&lt;br/&gt;
Since truck has made the function synchronized, the change in regionOffline does no harm.&lt;/p&gt;
</comment>
                            <comment id="13437639" author="hadoopqa" created="Mon, 20 Aug 2012 02:52:19 +0000"  >&lt;p&gt;-1 overall.  Here are the results of testing the latest attachment &lt;br/&gt;
  &lt;a href=&quot;http://issues.apache.org/jira/secure/attachment/12540261/HBASE-6537-94-v2.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/secure/attachment/12540261/HBASE-6537-94-v2.patch&lt;/a&gt;&lt;br/&gt;
  against trunk revision .&lt;/p&gt;

&lt;p&gt;    +1 @author.  The patch does not contain any @author tags.&lt;/p&gt;

&lt;p&gt;    -1 tests included.  The patch doesn&apos;t appear to include any new or modified tests.&lt;br/&gt;
                        Please justify why no new tests are needed for this patch.&lt;br/&gt;
                        Also please list what manual steps were performed to verify this patch.&lt;/p&gt;

&lt;p&gt;    -1 patch.  The patch command could not apply the patch.&lt;/p&gt;

&lt;p&gt;Console output: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/2624//console&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/2624//console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="13441350" author="stack" created="Fri, 24 Aug 2012 18:08:33 +0000"  >&lt;p&gt;Patch seems fine to me.  Ram, are you good w/ it?  (Or Rajesh?)&lt;/p&gt;</comment>
                            <comment id="13441387" author="ram_krish" created="Fri, 24 Aug 2012 18:47:22 +0000"  >&lt;p&gt;+1 Stack.&lt;/p&gt;</comment>
                            <comment id="13441977" author="lhofhansl" created="Sat, 25 Aug 2012 22:08:32 +0000"  >&lt;p&gt;Issue says this if for 0.94 only, but the patches against trunk. Confusing...&lt;br/&gt;
+1 on patch otherwise.&lt;/p&gt;</comment>
                            <comment id="13442055" author="rajesh23" created="Sun, 26 Aug 2012 07:18:44 +0000"  >&lt;p&gt;+1 Stack&lt;/p&gt;

&lt;p&gt;@Lars,&lt;br/&gt;
Initially Zhou attached patch for 94 only but now not able to find these attachments.&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/secure/attachment/12540000/HBASE-6537-94.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/secure/attachment/12540000/HBASE-6537-94.patch&lt;/a&gt;&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/secure/attachment/12540261/HBASE-6537-94-v2.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/secure/attachment/12540261/HBASE-6537-94-v2.patch&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="13442254" author="zhou wen jian" created="Mon, 27 Aug 2012 02:57:28 +0000"  >&lt;p&gt;@Lars &amp;amp; rajeshbabu.&lt;br/&gt;
i found it unavailable to run hudson, i do not know why, so i just delete the 94 attach. I&apos;ll resubmit it if nesscery&lt;/p&gt;</comment>
                            <comment id="13445536" author="lhofhansl" created="Fri, 31 Aug 2012 01:04:45 +0000"  >&lt;p&gt;HadoopQA can only run against trunk. So if you want a HadoopQA run you need a trunk patch.&lt;br/&gt;
But since this issue does not occur in trunk (as you say) we only really need the 0.94 patch.&lt;/p&gt;</comment>
                            <comment id="13445538" author="lhofhansl" created="Fri, 31 Aug 2012 01:05:48 +0000"  >&lt;p&gt;I&apos;m happy to make a 0.94 patch. But just to be doubly sure, we only want this in 0.94, right?&lt;/p&gt;</comment>
                            <comment id="13445545" author="lhofhansl" created="Fri, 31 Aug 2012 01:12:54 +0000"  >&lt;p&gt;Hmm... There was no RegionStates in 0.94. (added in the ginormous &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-6272&quot; title=&quot;In-memory region state is inconsistent&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-6272&quot;&gt;&lt;del&gt;HBASE-6272&lt;/del&gt;&lt;/a&gt; patch)&lt;/p&gt;</comment>
                            <comment id="13445591" author="zhou wenjian" created="Fri, 31 Aug 2012 03:01:48 +0000"  >&lt;p&gt;@Lars,thanks for reply.&lt;br/&gt;
update patch for 94&lt;/p&gt;</comment>
                            <comment id="13445592" author="hadoopqa" created="Fri, 31 Aug 2012 03:02:34 +0000"  >&lt;p&gt;-1 overall.  Here are the results of testing the latest attachment &lt;br/&gt;
  &lt;a href=&quot;http://issues.apache.org/jira/secure/attachment/12543222/HBASE-6537-94-v2.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://issues.apache.org/jira/secure/attachment/12543222/HBASE-6537-94-v2.patch&lt;/a&gt;&lt;br/&gt;
  against trunk revision .&lt;/p&gt;

&lt;p&gt;    +1 @author.  The patch does not contain any @author tags.&lt;/p&gt;

&lt;p&gt;    -1 tests included.  The patch doesn&apos;t appear to include any new or modified tests.&lt;br/&gt;
                        Please justify why no new tests are needed for this patch.&lt;br/&gt;
                        Also please list what manual steps were performed to verify this patch.&lt;/p&gt;

&lt;p&gt;    -1 patch.  The patch command could not apply the patch.&lt;/p&gt;

&lt;p&gt;Console output: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/2746//console&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/2746//console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;</comment>
                            <comment id="13445617" author="lhofhansl" created="Fri, 31 Aug 2012 03:54:33 +0000"  >&lt;p&gt;Committed to 0.94.&lt;br/&gt;
Thank you for the patch Zhou.&lt;/p&gt;</comment>
                            <comment id="13445661" author="hudson" created="Fri, 31 Aug 2012 04:57:24 +0000"  >&lt;p&gt;Integrated in HBase-0.94 #444 (See &lt;a href=&quot;https://builds.apache.org/job/HBase-0.94/444/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/HBase-0.94/444/&lt;/a&gt;)&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-6537&quot; title=&quot;Race between balancer and disable table can lead to inconsistent cluster&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-6537&quot;&gt;&lt;del&gt;HBASE-6537&lt;/del&gt;&lt;/a&gt; Race between balancer and disable table can lead to inconsistent cluster (Zhou wenjian) (Revision 1379277)&lt;/p&gt;

&lt;p&gt;     Result = FAILURE&lt;br/&gt;
larsh : &lt;br/&gt;
Files : &lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/hbase/branches/0.94/src/main/java/org/apache/hadoop/hbase/master/AssignmentManager.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="13448263" author="hudson" created="Wed, 5 Sep 2012 00:31:38 +0000"  >&lt;p&gt;Integrated in HBase-0.94-security #51 (See &lt;a href=&quot;https://builds.apache.org/job/HBase-0.94-security/51/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/HBase-0.94-security/51/&lt;/a&gt;)&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-6537&quot; title=&quot;Race between balancer and disable table can lead to inconsistent cluster&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-6537&quot;&gt;&lt;del&gt;HBASE-6537&lt;/del&gt;&lt;/a&gt; Race between balancer and disable table can lead to inconsistent cluster (Zhou wenjian) (Revision 1379277)&lt;/p&gt;

&lt;p&gt;     Result = FAILURE&lt;br/&gt;
larsh : &lt;br/&gt;
Files : &lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/hbase/branches/0.94/src/main/java/org/apache/hadoop/hbase/master/AssignmentManager.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="13448315" author="hudson" created="Wed, 5 Sep 2012 00:57:15 +0000"  >&lt;p&gt;Integrated in HBase-0.94-security-on-Hadoop-23 #7 (See &lt;a href=&quot;https://builds.apache.org/job/HBase-0.94-security-on-Hadoop-23/7/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/HBase-0.94-security-on-Hadoop-23/7/&lt;/a&gt;)&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-6537&quot; title=&quot;Race between balancer and disable table can lead to inconsistent cluster&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-6537&quot;&gt;&lt;del&gt;HBASE-6537&lt;/del&gt;&lt;/a&gt; Race between balancer and disable table can lead to inconsistent cluster (Zhou wenjian) (Revision 1379277)&lt;/p&gt;

&lt;p&gt;     Result = FAILURE&lt;br/&gt;
larsh : &lt;br/&gt;
Files : &lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/hbase/branches/0.94/src/main/java/org/apache/hadoop/hbase/master/AssignmentManager.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="12310000">
                    <name>Duplicate</name>
                                                                <inwardlinks description="is duplicated by">
                                        <issuelink>
            <issuekey id="12478310">HBASE-3152</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12543222" name="HBASE-6537-94-v2.patch" size="1451" author="zhou wenjian" created="Fri, 31 Aug 2012 03:00:38 +0000"/>
                            <attachment id="12542111" name="HBASE-6537-trunk-v2.patch" size="1714" author="zhou wen jian" created="Thu, 23 Aug 2012 12:19:43 +0000"/>
                            <attachment id="12540260" name="HBASE-6537-trunk.patch" size="1714" author="zhou wen jian" created="Fri, 10 Aug 2012 02:16:15 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>3.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Thu, 9 Aug 2012 14:36:42 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>245277</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            4 years, 13 weeks, 3 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i067j3:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>34151</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        </customfields>
    </item>
</channel>
</rss>