<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Sat Dec 03 16:47:09 UTC 2016

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/HBASE-2372/HBASE-2372.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[HBASE-2372] hbase trunk should check dfs.support.append and use append() to recovery logfiles (as in branch)</title>
                <link>https://issues.apache.org/jira/browse/HBASE-2372</link>
                <project id="12310753" key="HBASE">HBase</project>
                    <description>&lt;p&gt;this is a backport of the feature in the hlog recovery where we call fs.append(logfile); then fs.close() to recover a logfile in a situation where we run with &lt;a href=&quot;https://issues.apache.org/jira/browse/HDFS-200&quot; title=&quot;In HDFS, sync() not yet guarantees data available to the new readers&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HDFS-200&quot;&gt;&lt;del&gt;HDFS-200&lt;/del&gt;&lt;/a&gt; (ie: dfs.support.append = true)&lt;/p&gt;</description>
                <environment></environment>
        <key id="12460160">HBASE-2372</key>
            <summary>hbase trunk should check dfs.support.append and use append() to recovery logfiles (as in branch)</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/bug.png">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.png">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="3">Duplicate</resolution>
                                        <assignee username="ryanobjc">ryan rawson</assignee>
                                    <reporter username="ryanobjc">ryan rawson</reporter>
                        <labels>
                    </labels>
                <created>Wed, 24 Mar 2010 21:00:01 +0000</created>
                <updated>Fri, 20 Nov 2015 12:41:49 +0000</updated>
                            <resolved>Tue, 1 Jun 2010 23:55:51 +0000</resolved>
                                                    <fixVersion>0.90.0</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>3</watches>
                                                                <comments>
                            <comment id="12849444" author="kannanm" created="Wed, 24 Mar 2010 21:15:05 +0000"  >&lt;p&gt;Looks good to me. Have also requested asked Nicolas to do a sanity check (since he added this to branch).&lt;/p&gt;</comment>
                            <comment id="12849449" author="jdcryans" created="Wed, 24 Mar 2010 21:24:00 +0000"  >&lt;p&gt;I&apos;m not a fan of this loop:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
+    &lt;span class=&quot;code-keyword&quot;&gt;while&lt;/span&gt; (!recovered) {
+      &lt;span class=&quot;code-keyword&quot;&gt;try&lt;/span&gt; {
+        FSDataOutputStream out = fs.append(p);
+        out.close();
+        recovered = &lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;;
+      } &lt;span class=&quot;code-keyword&quot;&gt;catch&lt;/span&gt; (IOException e) {
+        LOG.info(&lt;span class=&quot;code-quote&quot;&gt;&quot;Failed open &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; append, waiting on lease recovery: &quot;&lt;/span&gt; + p, e);
+        &lt;span class=&quot;code-keyword&quot;&gt;try&lt;/span&gt; {
+          &lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;.sleep(1000);
+        } &lt;span class=&quot;code-keyword&quot;&gt;catch&lt;/span&gt; (InterruptedException ex) {
+          &lt;span class=&quot;code-comment&quot;&gt;// ignore it and &lt;span class=&quot;code-keyword&quot;&gt;try&lt;/span&gt; again
&lt;/span&gt;+        }
+      }
+    }
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Looks like if there&apos;s any other kind of exception, like a missing block or whatnot, we&apos;ll get stuck in that loop forever? I guess this also applies for 0.20&lt;/p&gt;</comment>
                            <comment id="12849470" author="ryanobjc" created="Wed, 24 Mar 2010 21:46:33 +0000"  >&lt;p&gt;This is probably a good place for a hook to &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-2363&quot; title=&quot;Add configuration for tunable dataloss sensitivity&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-2363&quot;&gt;&lt;del&gt;HBASE-2363&lt;/del&gt;&lt;/a&gt; - tunable&lt;br/&gt;
settings for data loss.&lt;/p&gt;

&lt;p&gt;Also I guess there is the notion of when is a file really totally&lt;br/&gt;
lost?  Can we detect this?&lt;/p&gt;

&lt;p&gt;On Wed, Mar 24, 2010 at 2:24 PM, Jean-Daniel Cryans (JIRA)&lt;/p&gt;</comment>
                            <comment id="12849498" author="jdcryans" created="Wed, 24 Mar 2010 22:24:31 +0000"  >&lt;p&gt;Another thing I&apos;m not sure of is the reflection used in isAppend, it was useful when we supported both plain hadoop 0.20 and hadoop 0.20 + hdfs-200. Now this is not true for trunk since in SequenceFileLogWriter.sync we call syncFs, it wouldn&apos;t compile if hadoop wasn&apos;t patched.&lt;/p&gt;

&lt;p&gt;Finally with trunk I think that if dfs.support.append is false, then we should not even boot.&lt;/p&gt;</comment>
                            <comment id="12849499" author="jdcryans" created="Wed, 24 Mar 2010 22:26:59 +0000"  >&lt;p&gt;And we can probably get rid of the FSDataOutputStream field in SequenceFileLogWriter.&lt;/p&gt;</comment>
                            <comment id="12849597" author="dhruba" created="Thu, 25 Mar 2010 06:21:12 +0000"  >&lt;p&gt;One possiblity is to make this loop continue only if AlreadyBeingCreated exception is thrown (instead of IOException). I will leave it to Nicolas to see if this can be done.&lt;/p&gt;</comment>
                            <comment id="12856469" author="apurtell" created="Tue, 13 Apr 2010 16:19:34 +0000"  >&lt;p&gt;Cancelling patch. Comments indicate it is not ready.&lt;/p&gt;</comment>
                            <comment id="12874316" author="stack" created="Tue, 1 Jun 2010 23:55:51 +0000"  >&lt;p&gt;This was done as part of &apos;&lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-2544&quot; title=&quot;Forward port branch 0.20 WAL to TRUNK&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-2544&quot;&gt;&lt;del&gt;HBASE-2544&lt;/del&gt;&lt;/a&gt;&apos;&lt;/p&gt;</comment>
                            <comment id="15017082" author="lars_francke" created="Fri, 20 Nov 2015 12:41:49 +0000"  >&lt;p&gt;This issue was closed as part of a bulk closing operation on 2015-11-20. All issues that have been resolved and where all fixVersions have been released have been closed (following discussions on the mailing list).&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12439705" name="HBASE-2372.txt" size="4209" author="ryanobjc" created="Wed, 24 Mar 2010 21:05:24 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Wed, 24 Mar 2010 21:15:05 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>26280</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            1 year, 2 weeks, 1 day ago
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0hhgv:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>100092</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        </customfields>
    </item>
</channel>
</rss>