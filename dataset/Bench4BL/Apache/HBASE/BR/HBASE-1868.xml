<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Fri Dec 02 18:53:45 UTC 2016

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/HBASE-1868/HBASE-1868.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[HBASE-1868] Spew about rebalancing but none done....</title>
                <link>https://issues.apache.org/jira/browse/HBASE-1868</link>
                <project id="12310753" key="HBASE">HBase</project>
                    <description>&lt;p&gt;I&apos;m seeing loads of this in logs:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
2009-09-24 21:27:22,130 DEBUG org.apache.hadoop.hbase.master.RegionManager: Server XX.XX.XX.100,20020,1253219583523 will be unloaded &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; balance. Server load: 5 avg: 3.78, regions can be moved: 4
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Its like balancer is coming up w/ wrong answer to question... I don&apos;t see subsequent stuff going on... It does it over and over for hours.&lt;/p&gt;

&lt;p&gt;Then a split comes in and its seems to shake things up.  I see it do a bunch of assigning.&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
2009-09-24 21:41:02,784 INFO org.apache.hadoop.hbase.master.ServerManager: Processing MSG_REPORT_SPLIT: locations,,1253657949707: Daughters; locations,,1253
828460677, locations,http:\x2F\x2Fen.wikipedia.org\x2Fwiki\x2FLarry_Lucchino,1253828460677 from aa0-009-2.u.powerset.com,20020,1253219584971; 1 of 3
2009-09-24 21:41:02,784 DEBUG org.apache.hadoop.hbase.master.RegionManager: Assigning &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; address: XX.XX.XX.6:20020, startcode: 1253219584971, load: (reque
sts=5213, regions=3, usedHeap=114, maxHeap=2031): total nregions to assign=2, nregions to reach balance=4, isMetaAssign=&lt;span class=&quot;code-keyword&quot;&gt;false&lt;/span&gt;
2009-09-24 21:41:02,820 DEBUG org.apache.hadoop.hbase.master.RegionManager: Assigning &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; address: XX.XX.XX.96:20020, startcode: 1253219584175, load: (requ
ests=12, regions=4, usedHeap=404, maxHeap=2031): total nregions to assign=2, nregions to reach balance=4, isMetaAssign=&lt;span class=&quot;code-keyword&quot;&gt;false&lt;/span&gt;
...
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Then back to the &apos;will be unloaded&apos;... message.&lt;/p&gt;


&lt;p&gt;A new split comes in and then the assigning gets triggered again... a few regions are opened but not enough.&lt;/p&gt;

&lt;p&gt;Eventually it goes back to &apos;normal&apos; (average load went to 3.85 from 3.8?)&lt;/p&gt;
</description>
                <environment>&lt;p&gt;0.20.0 RC2&lt;/p&gt;</environment>
        <key id="12436620">HBASE-1868</key>
            <summary>Spew about rebalancing but none done....</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/bug.png">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.png">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="stack">stack</assignee>
                                    <reporter username="stack">stack</reporter>
                        <labels>
                    </labels>
                <created>Fri, 25 Sep 2009 16:54:22 +0000</created>
                <updated>Fri, 20 Nov 2015 13:02:07 +0000</updated>
                            <resolved>Mon, 5 Oct 2009 22:44:31 +0000</resolved>
                                                    <fixVersion>0.20.1</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>1</watches>
                                                                <comments>
                            <comment id="12759628" author="stack" created="Fri, 25 Sep 2009 17:08:05 +0000"  >&lt;p&gt;Looking.. but this seems to be at least part of why things were off:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
2009-09-25 00:46:26,187 INFO org.apache.hadoop.ipc.HBaseServer: IPC Server handler 10 on 20020, call getClosestRowBefore([B@1c5fbf52, [B@5209af0b, [B@79c325
40) from XX.XX.XX.126:39465: error: java.io.IOException: Could not obtain block: blk_-4524474748365854543_61342811 file=/hbase/coral_hbase/.META./102878519
2/info/1652111193973935565
java.io.IOException: Could not obtain block: blk_-4524474748365854543_61342811 file=/hbase/coral_hbase/.META./1028785192/info/1652111193973935565
        at org.apache.hadoop.hdfs.DFSClient$DFSInputStream.chooseDataNode(DFSClient.java:1757)  
        at org.apache.hadoop.hdfs.DFSClient$DFSInputStream.blockSeekTo(DFSClient.java:1585)  
        at org.apache.hadoop.hdfs.DFSClient$DFSInputStream.read(DFSClient.java:1712)
        at java.io.DataInputStream.read(Unknown Source)
        at org.apache.hadoop.hbase.io.hfile.BoundedRangeFileInputStream.read(BoundedRangeFileInputStream.java:99)
        at org.apache.hadoop.io.IOUtils.readFully(IOUtils.java:100)
        at org.apache.hadoop.hbase.io.hfile.HFile$Reader.decompress(HFile.java:979)
        at org.apache.hadoop.hbase.io.hfile.HFile$Reader.readBlock(HFile.java:936)
        at org.apache.hadoop.hbase.io.hfile.HFile$Reader$Scanner.loadBlock(HFile.java:1258)
        at org.apache.hadoop.hbase.io.hfile.HFile$Reader$Scanner.seekTo(HFile.java:1141)  
        at org.apache.hadoop.hbase.regionserver.Store.seekToScanner(Store.java:1134)   
        at org.apache.hadoop.hbase.regionserver.Store.rowAtOrBeforeFromStoreFile(Store.java:1101)
        at org.apache.hadoop.hbase.regionserver.Store.getRowKeyAtOrBefore(Store.java:1063)
        at org.apache.hadoop.hbase.regionserver.HRegion.getClosestRowBefore(HRegion.java:1036)
        at org.apache.hadoop.hbase.regionserver.HRegionServer.getClosestRowBefore(HRegionServer.java:1755)
        at sun.reflect.GeneratedMethodAccessor3.invoke(Unknown Source)
        at sun.reflect.DelegatingMethodAccessorImpl.invoke(Unknown Source)
        at java.lang.reflect.Method.invoke(Unknown Source) 
        at org.apache.hadoop.hbase.ipc.HBaseRPC$Server.call(HBaseRPC.java:650)
        at org.apache.hadoop.hbase.ipc.HBaseServer$Handler.run(HBaseServer.java:915)
2009-09-25 00:46:26,224 DEBUG org.apache.hadoop.hbase.regionserver.Store: Completed major compaction of info; &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; storefile is hdfs:&lt;span class=&quot;code-comment&quot;&gt;//coral-dfs.cluster.powe
&lt;/span&gt;rset.com:10000/hbase/coral_hbase/.META./1028785192/info/5419371614376079003; store size is 746.2k
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;It was complaining for a long while.. then got &apos;fixed&apos; by the major compaction.&lt;/p&gt;</comment>
                            <comment id="12759720" author="stack" created="Fri, 25 Sep 2009 20:01:35 +0000"  >&lt;p&gt;So, just before the first instance of the above IOE, I see an instance of the NPE over in &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-1809&quot; title=&quot;NPE thrown in BoundedRangeFileInputStream&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-1809&quot;&gt;&lt;del&gt;HBASE-1809&lt;/del&gt;&lt;/a&gt;.  After the NPE is thrown because there was no read-lock doing gets, I see a few java.io.IOException: Stream closed.  I wonder what file these were going against?  The old file that was doing the NPE or the newly opened compaction file, 1652111193973935565 (This is the file that was made by the compaction around the time of the NPE).  These two strikes may have been made against the 1652111193973935565 file.  If no hdfs-127 in place, could have hosed the dfsclient for this file.  This may have been why this file went bad.  Looking...&lt;/p&gt;

&lt;p&gt;So, reads from meta were failing while this issue was in place.&lt;/p&gt;</comment>
                            <comment id="12759722" author="stack" created="Fri, 25 Sep 2009 20:09:09 +0000"  >&lt;p&gt;It looks like the &apos;will be assigned&apos; started when a new RS came online:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
2009-09-22 22:37:23,466 INFO org.apache.hadoop.hbase.master.ServerManager: Received start message from: XX.XX.XX.XX,20020,1253659043416
2009-09-22 22:37:23,468 DEBUG org.apache.hadoop.hbase.zookeeper.ZooKeeperWrapper: Updated ZNode /hbase/rs/1253659043416 with data 208.76.44.55:20020
2009-09-22 22:37:23,547 DEBUG org.apache.hadoop.hbase.master.RegionManager: ServerXX.XX.XX-2.u.powerset.com,20020,1253219585276 will be unloaded &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; balance
. Server load: 5 avg: 3.8181818181818183, regions can be moved: 2
2009-09-22 22:37:23,640 DEBUG org.apache.hadoop.hbase.master.RegionManager: Server XX.XX.XX-17.u.powerset.com,20020,1253219582748 will be unloaded &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; balanc
e. Server load: 5 avg: 3.8181818181818183, regions can be moved: 2
2009-09-22 22:37:23,843 DEBUG org.apache.hadoop.hbase.master.RegionManager: Server XX.XX.XX-10.u.powerset.com,20020,1253219585277 will be unloaded &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; balanc
e. Server load: 5 avg: 3.8181818181818183, regions can be moved: 2
...
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="12760756" author="stack" created="Tue, 29 Sep 2009 22:41:08 +0000"  >&lt;p&gt;Working with Cheddar over in IRC, he figured what was up here.  Down in assignRegionsToMultipleServers, if nRegions == nRegionsToAssign, we don&apos;t assign.&lt;/p&gt;

&lt;p&gt;It also looks like if nRegion &amp;gt; nRegionsToAssign, we have same issue:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
22:28 &amp;lt; cheddar&amp;gt; LOL, St^Ack, the plot thickens, my master is now in a loop with
22:28 &amp;lt; cheddar&amp;gt; 09/09/29 22:28:35 DEBUG master.RegionManager: Assigning &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; address: 10.18.52.61:60020, startcode: 1254261590467, load: (requests=0,
                 regions=37, usedHeap=134, maxHeap=2009): total nregions to assign=2, nregions to reach balance=6, isMetaAssign=&lt;span class=&quot;code-keyword&quot;&gt;false&lt;/span&gt;
22:29 &amp;lt; cheddar&amp;gt; so, it&apos;s not just when nRegionsToAssign == nregions, but also when nregions &amp;gt; nRegionsToAssign
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="12760824" author="stack" created="Wed, 30 Sep 2009 03:26:08 +0000"  >&lt;p&gt;An ugly patch that notices the condition where the regions to assign is &amp;lt;= number to assign to balance.  When it sees this condition, it just hands out a single region and returns.&lt;/p&gt;

&lt;p&gt;This code is beyond my powers of comprehension.  When I see this kind of stuff normally, I rip it out and start over with test code to verify its operation.  I don&apos;t want to do this in 0.20.1 bug fix context.  Hence this compromise patch.&lt;/p&gt;

&lt;p&gt;Trying to test it actually does the right thing before commiting.&lt;/p&gt;</comment>
                            <comment id="12760828" author="stack" created="Wed, 30 Sep 2009 04:38:13 +0000"  >&lt;p&gt;Spent some time trying to manufacture the condition to no avail.  I&apos;m thinking of committing this patch as is.  It flags if we hit the &apos;condition&apos;.&lt;/p&gt;</comment>
                            <comment id="12760829" author="stack" created="Wed, 30 Sep 2009 04:41:17 +0000"  >&lt;p&gt;Just committing it.  Won&apos;t close it till sure we don&apos;t see this issue any more.&lt;/p&gt;</comment>
                            <comment id="12762434" author="stack" created="Mon, 5 Oct 2009 22:44:31 +0000"  >&lt;p&gt;Committing. Reopen or open new issue if we see this again.&lt;/p&gt;</comment>
                            <comment id="12872839" author="ryanobjc" created="Fri, 28 May 2010 04:05:21 +0000"  >&lt;p&gt;in case it wasnt clear I am +1 on this &lt;/p&gt;</comment>
                            <comment id="15017985" author="lars_francke" created="Fri, 20 Nov 2015 13:02:07 +0000"  >&lt;p&gt;This issue was closed as part of a bulk closing operation on 2015-11-20. All issues that have been resolved and where all fixVersions have been released have been closed (following discussions on the mailing list).&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12420875" name="1868.patch" size="7353" author="stack" created="Wed, 30 Sep 2009 03:26:08 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Fri, 28 May 2010 04:05:21 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>26027</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            1 year, 2 weeks ago
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0hfov:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>99804</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        </customfields>
    </item>
</channel>
</rss>