<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Thu Dec 01 22:15:32 UTC 2016

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/HBASE-15184/HBASE-15184.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[HBASE-15184] SparkSQL Scan operation doesn&apos;t work on kerberos cluster</title>
                <link>https://issues.apache.org/jira/browse/HBASE-15184</link>
                <project id="12310753" key="HBASE">HBase</project>
                    <description>&lt;p&gt;I was using the HBase Spark Module at a client with Kerberos and I ran into an issue with the Scan.  &lt;/p&gt;

&lt;p&gt;I made a fix for the client but we need to put it back into HBase.  I will attach my solution, but it has a major problem.  I had to over ride a protected class in spark.  I will need help to decover a better approach&lt;/p&gt;</description>
                <environment></environment>
        <key id="12934954">HBASE-15184</key>
            <summary>SparkSQL Scan operation doesn&apos;t work on kerberos cluster</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/bug.png">Bug</type>
                                            <priority id="2" iconUrl="https://issues.apache.org/jira/images/icons/priorities/critical.png">Critical</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="ted.m">Theodore michael Malaska</assignee>
                                    <reporter username="ted.m">Theodore michael Malaska</reporter>
                        <labels>
                    </labels>
                <created>Thu, 28 Jan 2016 23:54:39 +0000</created>
                <updated>Wed, 24 Feb 2016 16:16:57 +0000</updated>
                            <resolved>Wed, 24 Feb 2016 00:52:30 +0000</resolved>
                                                    <fixVersion>2.0.0</fixVersion>
                                    <component>spark</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>8</watches>
                                                                <comments>
                            <comment id="15122568" author="ted.m" created="Thu, 28 Jan 2016 23:56:31 +0000"  >&lt;p&gt;Solution that worked on CDH 5.5 on client kerberos cluster, but also includes spark package to override a protected class.&lt;/p&gt;</comment>
                            <comment id="15129074" author="asrabkin" created="Tue, 2 Feb 2016 21:32:34 +0000"  >&lt;p&gt;Hi &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=ted.m&quot; class=&quot;user-hover&quot; rel=&quot;ted.m&quot;&gt;Theodore michael Malaska&lt;/a&gt;!  Can you describe in a few sentences what the problem was and what needed overriding? &lt;/p&gt;</comment>
                            <comment id="15136082" author="ted.m" created="Sun, 7 Feb 2016 01:07:02 +0000"  >&lt;p&gt;ok I&apos;m back from vacation I will try to finish a patch by mid week.&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=asrabkin&quot; class=&quot;user-hover&quot; rel=&quot;asrabkin&quot;&gt;Ari Rabkin&lt;/a&gt; the problem is really simple.  If a scan operation is the first operation you are doing in your spark context (you haven&apos;t done a map or foreach yet for example)  Then the readers will not have the kerberos creds applied yet and the scan will fail.  &lt;/p&gt;

&lt;p&gt;In the Zip file and in &lt;a href=&quot;https://github.com/tmalaska/SparkOnHBase&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://github.com/tmalaska/SparkOnHBase&lt;/a&gt; I solved this in one way that required a extension of class that I shouldn&apos;t have extended.  Sense the creation of this Jira I had a vacation and on that vacation I figured out how to implement this solution with out doing that extension that is a no no.&lt;/p&gt;

&lt;p&gt;I have a busy week, but I will try to get this jira in.&lt;/p&gt;

&lt;p&gt;Thx&lt;/p&gt;</comment>
                            <comment id="15141275" author="woj_in" created="Wed, 10 Feb 2016 17:41:21 +0000"  >&lt;p&gt;Hello &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=ted.m&quot; class=&quot;user-hover&quot; rel=&quot;ted.m&quot;&gt;Theodore michael Malaska&lt;/a&gt; and &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=asrabkin&quot; class=&quot;user-hover&quot; rel=&quot;asrabkin&quot;&gt;Ari Rabkin&lt;/a&gt;&lt;br/&gt;
I also noticed the problem some time ago and made a PR on GitHub for the SparkOnHBase project (before merge with HBase). Here is my PR, I hope it can help without overriding Spark classes. &lt;a href=&quot;https://github.com/cloudera-labs/SparkOnHBase/pull/9&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://github.com/cloudera-labs/SparkOnHBase/pull/9&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="15141300" author="woj_in" created="Wed, 10 Feb 2016 17:51:56 +0000"  >&lt;p&gt;Some more information about the problem also in this thread: &lt;a href=&quot;https://github.com/cloudera-labs/SparkOnHBase/pull/7&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://github.com/cloudera-labs/SparkOnHBase/pull/7&lt;/a&gt;&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=ted.m&quot; class=&quot;user-hover&quot; rel=&quot;ted.m&quot;&gt;Theodore michael Malaska&lt;/a&gt; please let me know your thoughts.&lt;/p&gt;</comment>
                            <comment id="15147419" author="ted.m" created="Mon, 15 Feb 2016 14:39:43 +0000"  >&lt;p&gt;I&apos;m also here on this Jira.  I&apos;m on a clint application now and I want to make sure everything is solid before I submit the batch.  I&apos;m sorry this is taking longer then initially planned.  But I want to finish my testing on the kerberos cluster first.&lt;/p&gt;</comment>
                            <comment id="15156351" author="ted.m" created="Mon, 22 Feb 2016 01:28:40 +0000"  >&lt;p&gt;OK finally back ported the code and ran it on my Kerberos Cluster and yup it breaks.  Going to make the changes tonight and hopefully tomorrow we will have something.&lt;/p&gt;</comment>
                            <comment id="15158050" author="ted.m" created="Tue, 23 Feb 2016 00:54:26 +0000"  >&lt;p&gt;This was tested both in unit tests and in a 10 node kerberos cluster&lt;/p&gt;</comment>
                            <comment id="15158661" author="asrabkin" created="Tue, 23 Feb 2016 10:13:40 +0000"  >&lt;p&gt;Thanks so much for tackling this, &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=ted.m&quot; class=&quot;user-hover&quot; rel=&quot;ted.m&quot;&gt;Theodore michael Malaska&lt;/a&gt;.  Is there some way I could put in a no-op spark Map early in the job to work around this?&lt;br/&gt;
The core bit of code in my app looks like this:&lt;/p&gt;

&lt;p&gt;    val rawTable = sc.newAPIHadoopRDD(hbconf, classOf&lt;span class=&quot;error&quot;&gt;&amp;#91;TableInputFormat&amp;#93;&lt;/span&gt;,&lt;br/&gt;
      classOf&lt;span class=&quot;error&quot;&gt;&amp;#91;org.apache.hadoop.hbase.io.ImmutableBytesWritable&amp;#93;&lt;/span&gt;,&lt;br/&gt;
      classOf&lt;span class=&quot;error&quot;&gt;&amp;#91;org.apache.hadoop.hbase.client.Result&amp;#93;&lt;/span&gt;)&lt;br/&gt;
    val resultsDataset = rawTable.map( resultToRecord)&lt;/p&gt;


&lt;p&gt;Note that there&apos;s no explicit scan happening here; it&apos;s all inside the TableInputFormat. So I&apos;m a bit unclear what I would do to cause a &apos;map&apos; operation to happen early enough. &lt;/p&gt;</comment>
                            <comment id="15159949" author="hadoopqa" created="Wed, 24 Feb 2016 00:30:03 +0000"  >&lt;table class=&apos;confluenceTable&apos;&gt;&lt;tbody&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/error.gif&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt; &lt;b&gt;&lt;font color=&quot;red&quot;&gt;-1 overall&lt;/font&gt;&lt;/b&gt; &lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;&lt;/table&gt;

&lt;p&gt;&lt;br class=&quot;atl-forced-newline&quot; /&gt;
&lt;br class=&quot;atl-forced-newline&quot; /&gt;&lt;/p&gt;
&lt;table class=&apos;confluenceTable&apos;&gt;&lt;tbody&gt;
&lt;tr&gt;
&lt;th class=&apos;confluenceTh&apos;&gt; Vote &lt;/th&gt;
&lt;th class=&apos;confluenceTh&apos;&gt; Subsystem &lt;/th&gt;
&lt;th class=&apos;confluenceTh&apos;&gt; Runtime &lt;/th&gt;
&lt;th class=&apos;confluenceTh&apos;&gt; Comment &lt;/th&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; &lt;font color=&quot;blue&quot;&gt;0&lt;/font&gt; &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; &lt;font color=&quot;blue&quot;&gt; reexec &lt;/font&gt; &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; &lt;font color=&quot;blue&quot;&gt; 0m 0s &lt;/font&gt; &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; &lt;font color=&quot;blue&quot;&gt; Docker mode activated. &lt;/font&gt; &lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; &lt;font color=&quot;green&quot;&gt; @author &lt;/font&gt; &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; &lt;font color=&quot;green&quot;&gt; 0m 0s &lt;/font&gt; &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; &lt;font color=&quot;green&quot;&gt; The patch does not contain any @author tags. &lt;/font&gt; &lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; &lt;font color=&quot;red&quot;&gt;-1&lt;/font&gt; &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; &lt;font color=&quot;red&quot;&gt; test4tests &lt;/font&gt; &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; &lt;font color=&quot;red&quot;&gt; 0m 0s &lt;/font&gt; &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; &lt;font color=&quot;red&quot;&gt; The patch doesn&apos;t appear to include any new or modified tests. Please justify why no new tests are needed for this patch. Also please list what manual steps were performed to verify this patch. &lt;/font&gt; &lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; &lt;font color=&quot;green&quot;&gt; compile &lt;/font&gt; &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; &lt;font color=&quot;green&quot;&gt; 0m 46s &lt;/font&gt; &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; &lt;font color=&quot;green&quot;&gt; master passed with JDK v1.8.0_72 &lt;/font&gt; &lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; &lt;font color=&quot;green&quot;&gt; compile &lt;/font&gt; &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; &lt;font color=&quot;green&quot;&gt; 1m 0s &lt;/font&gt; &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; &lt;font color=&quot;green&quot;&gt; master passed with JDK v1.7.0_95 &lt;/font&gt; &lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; &lt;font color=&quot;green&quot;&gt; scaladoc &lt;/font&gt; &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; &lt;font color=&quot;green&quot;&gt; 0m 28s &lt;/font&gt; &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; &lt;font color=&quot;green&quot;&gt; master passed &lt;/font&gt; &lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; &lt;font color=&quot;green&quot;&gt; scaladoc &lt;/font&gt; &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; &lt;font color=&quot;green&quot;&gt; 0m 28s &lt;/font&gt; &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; &lt;font color=&quot;green&quot;&gt; master passed &lt;/font&gt; &lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; &lt;font color=&quot;green&quot;&gt; compile &lt;/font&gt; &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; &lt;font color=&quot;green&quot;&gt; 0m 43s &lt;/font&gt; &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; &lt;font color=&quot;green&quot;&gt; the patch passed with JDK v1.8.0_72 &lt;/font&gt; &lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; &lt;font color=&quot;green&quot;&gt; scalac &lt;/font&gt; &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; &lt;font color=&quot;green&quot;&gt; 0m 43s &lt;/font&gt; &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; &lt;font color=&quot;green&quot;&gt; the patch passed &lt;/font&gt; &lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; &lt;font color=&quot;green&quot;&gt; compile &lt;/font&gt; &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; &lt;font color=&quot;green&quot;&gt; 1m 0s &lt;/font&gt; &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; &lt;font color=&quot;green&quot;&gt; the patch passed with JDK v1.7.0_95 &lt;/font&gt; &lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; &lt;font color=&quot;green&quot;&gt; scalac &lt;/font&gt; &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; &lt;font color=&quot;green&quot;&gt; 1m 0s &lt;/font&gt; &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; &lt;font color=&quot;green&quot;&gt; the patch passed &lt;/font&gt; &lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; &lt;font color=&quot;green&quot;&gt; whitespace &lt;/font&gt; &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; &lt;font color=&quot;green&quot;&gt; 0m 0s &lt;/font&gt; &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; &lt;font color=&quot;green&quot;&gt; Patch has no whitespace issues. &lt;/font&gt; &lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; &lt;font color=&quot;green&quot;&gt; hadoopcheck &lt;/font&gt; &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; &lt;font color=&quot;green&quot;&gt; 24m 14s &lt;/font&gt; &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; &lt;font color=&quot;green&quot;&gt; Patch does not cause any errors with Hadoop 2.4.0 2.4.1 2.5.0 2.5.1 2.5.2 2.6.1 2.6.2 2.6.3 2.7.1. &lt;/font&gt; &lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; &lt;font color=&quot;green&quot;&gt; scaladoc &lt;/font&gt; &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; &lt;font color=&quot;green&quot;&gt; 0m 28s &lt;/font&gt; &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; &lt;font color=&quot;green&quot;&gt; the patch passed &lt;/font&gt; &lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; &lt;font color=&quot;green&quot;&gt; scaladoc &lt;/font&gt; &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; &lt;font color=&quot;green&quot;&gt; 0m 29s &lt;/font&gt; &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; &lt;font color=&quot;green&quot;&gt; the patch passed &lt;/font&gt; &lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; &lt;font color=&quot;green&quot;&gt; unit &lt;/font&gt; &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; &lt;font color=&quot;green&quot;&gt; 0m 52s &lt;/font&gt; &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; &lt;font color=&quot;green&quot;&gt; hbase-spark in the patch passed with JDK v1.8.0_72. &lt;/font&gt; &lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; &lt;font color=&quot;green&quot;&gt; unit &lt;/font&gt; &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; &lt;font color=&quot;green&quot;&gt; 1m 1s &lt;/font&gt; &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; &lt;font color=&quot;green&quot;&gt; hbase-spark in the patch passed with JDK v1.7.0_95. &lt;/font&gt; &lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; &lt;font color=&quot;green&quot;&gt; asflicense &lt;/font&gt; &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; &lt;font color=&quot;green&quot;&gt; 0m 9s &lt;/font&gt; &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; &lt;font color=&quot;green&quot;&gt; Patch does not generate ASF License warnings. &lt;/font&gt; &lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; &lt;font color=&quot;black&quot;&gt;&lt;/font&gt; &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; &lt;font color=&quot;black&quot;&gt; &lt;/font&gt; &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; &lt;font color=&quot;black&quot;&gt; 31m 54s &lt;/font&gt; &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; &lt;font color=&quot;black&quot;&gt; &lt;/font&gt; &lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;&lt;/table&gt;

&lt;p&gt;&lt;br class=&quot;atl-forced-newline&quot; /&gt;
&lt;br class=&quot;atl-forced-newline&quot; /&gt;&lt;/p&gt;
&lt;table class=&apos;confluenceTable&apos;&gt;&lt;tbody&gt;
&lt;tr&gt;
&lt;th class=&apos;confluenceTh&apos;&gt; Subsystem &lt;/th&gt;
&lt;th class=&apos;confluenceTh&apos;&gt; Report/Notes &lt;/th&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; Docker &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; Client=1.9.1 Server=1.9.1 Image:yetus/hbase:date2016-02-23 &lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; JIRA Patch URL &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; &lt;a href=&quot;https://issues.apache.org/jira/secure/attachment/12789108/HBASE-15184.1.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/secure/attachment/12789108/HBASE-15184.1.patch&lt;/a&gt; &lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; JIRA Issue &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-15184&quot; title=&quot;SparkSQL Scan operation doesn&amp;#39;t work on kerberos cluster&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-15184&quot;&gt;&lt;del&gt;HBASE-15184&lt;/del&gt;&lt;/a&gt; &lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; Optional Tests &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;  asflicense  scalac  scaladoc  unit  compile  &lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; uname &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; Linux b39a061cd578 3.13.0-36-lowlatency #63-Ubuntu SMP PREEMPT Wed Sep 3 21:56:12 UTC 2014 x86_64 x86_64 x86_64 GNU/Linux &lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; Build tool &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; maven &lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; Personality &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; /home/jenkins/jenkins-slave/workspace/PreCommit-HBASE-Build/component/dev-support/hbase-personality.sh &lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; git revision &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; master / f47dba7 &lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; JDK v1.7.0_95  Test Results &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/657/testReport/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/657/testReport/&lt;/a&gt; &lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; modules &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; C: hbase-spark U: hbase-spark &lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; Max memory used &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; 186MB &lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; Powered by &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; Apache Yetus 0.1.0   &lt;a href=&quot;http://yetus.apache.org&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://yetus.apache.org&lt;/a&gt; &lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; Console output &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HBASE-Build/657/console&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HBASE-Build/657/console&lt;/a&gt; &lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;&lt;/table&gt;



&lt;p&gt;This message was automatically generated.&lt;/p&gt;
</comment>
                            <comment id="15159979" author="jmhsieh" created="Wed, 24 Feb 2016 00:48:59 +0000"  >&lt;p&gt;Hey &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=asrabkin&quot; class=&quot;user-hover&quot; rel=&quot;asrabkin&quot;&gt;Ari Rabkin&lt;/a&gt;, I don&apos;t quite understand the map trick you mentioned but I think the HBaseContext introduced in this module may hide the need for the code snippet you provided.&lt;/p&gt;
</comment>
                            <comment id="15159982" author="jmhsieh" created="Wed, 24 Feb 2016 00:50:47 +0000"  >&lt;p&gt;I tested the patch on a live kerborized cluster and it works for me.    Here&apos;s how I did it for folks who&apos;d like to duplicate:&lt;/p&gt;

&lt;p&gt;Prereqs:&lt;/p&gt;
&lt;ol&gt;
	&lt;li&gt;must have a kerb enabled cluster (hbase/hdfs/yarn, etc).&lt;/li&gt;
	&lt;li&gt;spark must be run in yarn continainers (kerb doesn&apos;t work with spark standalone mode).&lt;/li&gt;
&lt;/ol&gt;


&lt;p&gt;Procedure: &lt;/p&gt;
&lt;ol&gt;
	&lt;li&gt;Loaded a table with 100k rows.  &apos;hbase ltt -write 5:1000:160 -num_keys 100000 -tn ltt&apos;&lt;/li&gt;
	&lt;li&gt;Granted &apos;R&apos; access to &apos;randomuser&apos; user (yarn need to have a user with id &amp;gt;1000).  &quot;grant &apos;randomuser&apos;, &apos;R&apos;, &apos;ltt&apos;&quot; in the hbase shell.&lt;/li&gt;
	&lt;li&gt;Started spark-shell with hbase classpath: &apos;sudo -u randomuser SPARK_CLASSPATH=`hbase classpath` spark-shell&lt;/li&gt;
	&lt;li&gt;ran these lines in the spark shell
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;

&lt;span class=&quot;code-keyword&quot;&gt;import&lt;/span&gt; org.apache.hadoop.hbase.spark.HBaseContext
&lt;span class=&quot;code-keyword&quot;&gt;import&lt;/span&gt; org.apache.hadoop.hbase.{TableName, HBaseConfiguration}
&lt;span class=&quot;code-keyword&quot;&gt;import&lt;/span&gt; org.apache.hadoop.hbase.util.Bytes
&lt;span class=&quot;code-keyword&quot;&gt;import&lt;/span&gt; org.apache.hadoop.hbase.client.Scan
&lt;span class=&quot;code-keyword&quot;&gt;import&lt;/span&gt; org.apache.spark.sql.SQLContext
val tableName=&lt;span class=&quot;code-quote&quot;&gt;&quot;ltt&quot;&lt;/span&gt;
val hbaseConf = HBaseConfiguration.create()
val hbaseContext = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; HBaseContext(sc, hbaseConf)
val scan = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; Scan()
scan.setCaching(100)
val getRdd = hbaseContext.hbaseRDD(TableName.valueOf(tableName), scan)
getRdd.foreach(v =&amp;gt; println(Bytes.toString(v._1.get())))
println(&lt;span class=&quot;code-quote&quot;&gt;&quot;Length: &quot;&lt;/span&gt; + getRdd.map(r =&amp;gt; r._1.copyBytes()).collect().length);
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;&lt;/li&gt;
	&lt;li&gt;got 100k count, declare victory&lt;/li&gt;
&lt;/ol&gt;

</comment>
                            <comment id="15159987" author="ted.m" created="Wed, 24 Feb 2016 00:54:40 +0000"  >&lt;p&gt;Thank u Ted yu&lt;/p&gt;




&lt;p&gt;&amp;#8211; &lt;br/&gt;
Sent from Gmail Mobile&lt;/p&gt;</comment>
                            <comment id="15159992" author="jmhsieh" created="Wed, 24 Feb 2016 01:01:16 +0000"  >&lt;p&gt;Hey &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=tedyu&quot; class=&quot;user-hover&quot; rel=&quot;tedyu&quot;&gt;Ted Yu&lt;/a&gt;, before we committed we should have waited to make sure &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=asrabkin&quot; class=&quot;user-hover&quot; rel=&quot;asrabkin&quot;&gt;Ari Rabkin&lt;/a&gt;&apos;s concern was addressed.  &lt;/p&gt;</comment>
                            <comment id="15160042" author="yuzhihong@gmail.com" created="Wed, 24 Feb 2016 01:46:40 +0000"  >&lt;p&gt;Sure. Thought you already addressed his comment &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.gif&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;

&lt;p&gt;Anyway, if Ari&apos;s concern turns out not to be addressed, we can certainly apply addendum or revert.&lt;/p&gt;</comment>
                            <comment id="15160163" author="hudson" created="Wed, 24 Feb 2016 04:27:12 +0000"  >&lt;p&gt;FAILURE: Integrated in HBase-Trunk_matrix #732 (See &lt;a href=&quot;https://builds.apache.org/job/HBase-Trunk_matrix/732/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/HBase-Trunk_matrix/732/&lt;/a&gt;)&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-15184&quot; title=&quot;SparkSQL Scan operation doesn&amp;#39;t work on kerberos cluster&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-15184&quot;&gt;&lt;del&gt;HBASE-15184&lt;/del&gt;&lt;/a&gt; SparkSQL Scan operation doesn&apos;t work on kerberos cluster (tedyu: rev 00248656ee9c60009ff1697e90ba9d0f86264103)&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;hbase-spark/src/main/scala/org/apache/hadoop/hbase/spark/DefaultSource.scala&lt;/li&gt;
	&lt;li&gt;hbase-spark/src/main/scala/org/apache/hadoop/hbase/spark/NewHBaseRDD.scala&lt;/li&gt;
	&lt;li&gt;hbase-spark/src/main/scala/org/apache/hadoop/hbase/spark/HBaseContext.scala&lt;/li&gt;
	&lt;li&gt;hbase-spark/src/main/scala/org/apache/hadoop/hbase/spark/datasources/HBaseTableScanRDD.scala&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="15163233" author="asrabkin" created="Wed, 24 Feb 2016 15:54:09 +0000"  >&lt;p&gt;Having talked with &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=jmhsieh&quot; class=&quot;user-hover&quot; rel=&quot;jmhsieh&quot;&gt;Jonathan Hsieh&lt;/a&gt; I think my problem might not be the same as the one in this issue, since I was using TableInputFormat instead of the HBase Spark context. &lt;/p&gt;

&lt;p&gt;It would be good to update the docs to clarify if TableInputFormat + secure clusters is ever going to work.&lt;/p&gt;</comment>
                            <comment id="15163253" author="jmhsieh" created="Wed, 24 Feb 2016 16:11:55 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=asrabkin&quot; class=&quot;user-hover&quot; rel=&quot;asrabkin&quot;&gt;Ari Rabkin&lt;/a&gt; thanks.  Feel free to file a jira if you have a stack trace with problems that occur when you try to use the method your described.&lt;/p&gt;

&lt;p&gt;A belated thanks to &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=woj_in&quot; class=&quot;user-hover&quot; rel=&quot;woj_in&quot;&gt;Wojciech Indyk&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=tedyu&quot; class=&quot;user-hover&quot; rel=&quot;tedyu&quot;&gt;Ted Yu&lt;/a&gt; - looks like the issues can be addressed separately so we can let the commit stand.  &lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10032">
                    <name>Blocker</name>
                                            <outwardlinks description="blocks">
                                        <issuelink>
            <issuekey id="12849672">HBASE-14160</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12789108" name="HBASE-15184.1.patch" size="8392" author="ted.m" created="Tue, 23 Feb 2016 00:54:26 +0000"/>
                            <attachment id="12785048" name="HBaseSparkModule.zip" size="91329" author="ted.m" created="Thu, 28 Jan 2016 23:56:31 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Tue, 2 Feb 2016 21:32:34 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310191" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                        <customfieldname>Hadoop Flags</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10343"><![CDATA[Reviewed]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            40 weeks, 1 day ago
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i2s4c7:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310192" key="com.atlassian.jira.plugin.system.customfieldtypes:textarea">
                        <customfieldname>Release Note</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Before this patch, users of the spark HBaseContext would fail due to lack of  privilege exceptions.  &lt;br/&gt;
&lt;br/&gt;
Note: &lt;br/&gt;
* It is preferred to have spark in spark-on-yarn mode if Kerberos is used. &lt;br/&gt;
* This is orthogonal to issues with a kerberized spark cluster via InputFormats.  &lt;br/&gt;
&lt;br/&gt;
&amp;nbsp;</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        </customfields>
    </item>
</channel>
</rss>