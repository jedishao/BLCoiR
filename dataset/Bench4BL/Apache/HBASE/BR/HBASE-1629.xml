<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Fri Dec 02 20:43:11 UTC 2016

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/HBASE-1629/HBASE-1629.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[HBASE-1629] HRS unable to contact master</title>
                <link>https://issues.apache.org/jira/browse/HBASE-1629</link>
                <project id="12310753" key="HBASE">HBase</project>
                    <description>&lt;p&gt;HRS unable to contact master for initialization after expiration from ZK. Master thinks HRS is still up whereas HRS went down and now cannot restart. The RS logs have a flurry of the following warning messages:&lt;/p&gt;

&lt;p&gt;2009-07-08 12:53:19,547 WARN org.apache.hadoop.hbase.regionserver.HRegionServer: Unable to get master for initialization&lt;/p&gt;

&lt;p&gt;More logs from the RS and the Master attached.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12429848">HBASE-1629</key>
            <summary>HRS unable to contact master</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/bug.png">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.png">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="nitay">Nitay Joffe</assignee>
                                    <reporter username="amansk">Amandeep Khurana</reporter>
                        <labels>
                    </labels>
                <created>Wed, 8 Jul 2009 20:23:57 +0000</created>
                <updated>Sun, 13 Sep 2009 22:24:49 +0000</updated>
                            <resolved>Thu, 9 Jul 2009 23:05:08 +0000</resolved>
                                    <version>0.20.0</version>
                                    <fixVersion>0.20.0</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>1</watches>
                                                                <comments>
                            <comment id="12728887" author="amansk" created="Wed, 8 Jul 2009 20:35:12 +0000"  >&lt;p&gt;Attaching logs from the RS and the Master from the time the failure started&lt;/p&gt;</comment>
                            <comment id="12728937" author="nitay" created="Wed, 8 Jul 2009 22:24:55 +0000"  >&lt;p&gt;Small patch for a convoluted problem. Amandeep, try this out, see if it fixes it for you.&lt;/p&gt;

&lt;p&gt;Here&apos;s the problem:&lt;/p&gt;

&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;[14:32]  &amp;lt;nitay&amp;gt; reportForDuty()
[14:32]  &amp;lt;nitay&amp;gt;     while (!getMaster()) {
[14:32]  &amp;lt;nitay&amp;gt;       sleeper.sleep();
[14:32]  &amp;lt;nitay&amp;gt;       LOG.warn(&quot;Unable to get master for initialization&quot;);
[14:32]  &amp;lt;nitay&amp;gt;     }
[14:33]  &amp;lt;nitay&amp;gt; getMaster()
[14:33]  &amp;lt;nitay&amp;gt;     HServerAddress masterAddress = null;
[14:33]  &amp;lt;nitay&amp;gt;     while (masterAddress == null) {
[14:33]  &amp;lt;nitay&amp;gt;       if (stopRequested.get()) {
[14:33]  &amp;lt;nitay&amp;gt;         return false;
[14:33]  &amp;lt;nitay&amp;gt;       }
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;This is an infinite loop which causes the messages at the end of the RS Log Amandeep posted.&lt;/p&gt;

&lt;p&gt;The flow of logic that leads to this is the following:&lt;/p&gt;
&lt;ol&gt;
	&lt;li&gt;RS session with ZooKeeper expires.&lt;/li&gt;
	&lt;li&gt;Master gets znode expiration, starts cleanup/shutdown of RS.&lt;/li&gt;
	&lt;li&gt;RS gets its session expired, begins restart() logic, setting stopRequested.&lt;/li&gt;
	&lt;li&gt;Meanwhile, RS run() thread is still talking to master.&lt;/li&gt;
	&lt;li&gt;Master gets a message from RS, but doesn&apos;t know it because it&apos;s been removed. This is the &quot;received server report from unknown server...&quot; stuff. Tells the RS to reinitialize, sending MSG_CALL_SERVER_STARTUP.&lt;/li&gt;
	&lt;li&gt;RS on getting MSG_CALL_SERVER_STARTUP calls reportForDuty() and is now in a loop. The restart() thread from ZooKeeper is waiting for the RS run() to finish, but it never will.&lt;/li&gt;
&lt;/ol&gt;


&lt;p&gt;This simple patch makes reportyForDuty() fail fast when stopRequested is set.&lt;/p&gt;</comment>
                            <comment id="12729065" author="stack" created="Thu, 9 Jul 2009 06:09:15 +0000"  >&lt;p&gt;+1&lt;/p&gt;

&lt;p&gt;Would be great if AK could try it before commit but I&apos;m fine w/ commit if not &amp;#8211; easy enough see if this fixes issue.&lt;/p&gt;</comment>
                            <comment id="12729443" author="nitay" created="Thu, 9 Jul 2009 23:05:08 +0000"  >&lt;p&gt;Stack said to go ahead and commit this. Amandeep, if you see this again, feel free to reopen the issue.&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                                                <inwardlinks description="is related to">
                                        <issuelink>
            <issuekey id="12429325">HBASE-1601</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12412906" name="Master_log" size="111706" author="amansk" created="Wed, 8 Jul 2009 20:35:12 +0000"/>
                            <attachment id="12412905" name="RS_Log" size="16883" author="amansk" created="Wed, 8 Jul 2009 20:35:12 +0000"/>
                            <attachment id="12412929" name="hbase-1629.patch" size="1020" author="nitay" created="Wed, 8 Jul 2009 22:24:55 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>3.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Wed, 8 Jul 2009 22:24:55 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>25874</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            7 years, 22 weeks ago
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0hedj:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>99591</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        </customfields>
    </item>
</channel>
</rss>