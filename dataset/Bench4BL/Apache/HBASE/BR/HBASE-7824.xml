<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Sat Dec 03 19:31:17 UTC 2016

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/HBASE-7824/HBASE-7824.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[HBASE-7824] Improve master start up time when there is log splitting work</title>
                <link>https://issues.apache.org/jira/browse/HBASE-7824</link>
                <project id="12310753" key="HBASE">HBase</project>
                    <description>&lt;p&gt;When there is log split work going on, master start up waits till all log split work completes even though the log split has nothing to do with meta region servers.&lt;/p&gt;

&lt;p&gt;It&apos;s a bad behavior considering a master node can run when log split is happening while its start up is blocking by log split work. &lt;/p&gt;

&lt;p&gt;Since master is kind of single point of failure, we should start it ASAP.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12631850">HBASE-7824</key>
            <summary>Improve master start up time when there is log splitting work</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/bug.png">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.png">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="jeffreyz">Jeffrey Zhong</assignee>
                                    <reporter username="jeffreyz">Jeffrey Zhong</reporter>
                        <labels>
                    </labels>
                <created>Tue, 12 Feb 2013 00:02:43 +0000</created>
                <updated>Sat, 27 Apr 2013 15:55:23 +0000</updated>
                            <resolved>Wed, 10 Apr 2013 23:07:21 +0000</resolved>
                                                    <fixVersion>0.94.7</fixVersion>
                                    <component>master</component>
                        <due></due>
                            <votes>1</votes>
                                    <watches>14</watches>
                                                                <comments>
                            <comment id="13583869" author="jeffreyz" created="Fri, 22 Feb 2013 03:16:01 +0000"  >&lt;p&gt;Hey Lars,&lt;/p&gt;

&lt;p&gt;Do you want me to put the fix into 0.94.6? After the fix, master starts up will only blocked on meta region servers(including root &amp;amp; meta) recovery. Assuming, a 100 nodes cluster, the meta region servers is only about 2% of all region servers. Therefore, master virtually doesn&apos;t wait log splitting work for starting up.&lt;/p&gt;

&lt;p&gt;Thanks,&lt;br/&gt;
-Jeffrey&lt;/p&gt;
</comment>
                            <comment id="13584755" author="jeffreyz" created="Fri, 22 Feb 2013 22:11:26 +0000"  >&lt;p&gt;Unblock master starts up when there are non-meta region servers&apos; split work. After the fix, master will only block by meta region server log spliting work. More details as following:&lt;/p&gt;

&lt;p&gt;    1) Adding support to fast master up&lt;br/&gt;
    2) Adding a test case for new code&lt;br/&gt;
    3) Fix test function makehlog to creat rows with keys within assigned region&apos;s key space&lt;/p&gt;</comment>
                            <comment id="13584762" author="jmspaggi" created="Fri, 22 Feb 2013 22:18:14 +0000"  >&lt;p&gt;Hi Jeffrey,&lt;/p&gt;

&lt;p&gt;Is this for 0.94.x? Or for trunk? If it&apos;s for trunk, I think the patch not done on the right directory level. Seems to be missing hbaser-server/ &lt;/p&gt;</comment>
                            <comment id="13584765" author="jeffreyz" created="Fri, 22 Feb 2013 22:21:35 +0000"  >
&lt;p&gt;This patch is for 0.94.6.&lt;/p&gt;</comment>
                            <comment id="13584788" author="jmspaggi" created="Fri, 22 Feb 2013 22:50:57 +0000"  >&lt;p&gt;Thanks. I will apply it and test it since it will be very usefull for my needs.&lt;/p&gt;

&lt;p&gt;Few small comments.&lt;br/&gt;
In HMaster, you are testing if failedServers is null to handle other dead servers in SSH. So it can be null there, should it be tested also for META and ROOT? (failedServers.contains())&lt;br/&gt;
In MasterFileSystem, there is some extra spaces in getFailedServersFromLogFolders() (After retrySplitting declaration).&lt;br/&gt;
In ServerManager, does processDeadServer need to be synchronized? Many other methods calling deadservers and services are not synchronized. So I&apos;m just asking. FindBug seems to be fine with that.&lt;/p&gt;
</comment>
                            <comment id="13584798" author="yuzhihong@gmail.com" created="Fri, 22 Feb 2013 23:07:27 +0000"  >&lt;p&gt;Looks good overall.&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
+    &lt;span class=&quot;code-comment&quot;&gt;// Make sure root assigned before proceeding.
&lt;/span&gt;+    &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (!assignRoot(status)) &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt;;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;I think exception should be thrown in the above case.&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
+    &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (failedServers != &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;) {
+      &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; (ServerName curServer : failedServers) {
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;The null check didn&apos;t appear ahead of the above if block. I guess the check is not needed.&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
+   * Check &amp;lt;code&amp;gt;.META.&amp;lt;/code&amp;gt; is assigned. If not, assign it.
+   * @&lt;span class=&quot;code-keyword&quot;&gt;throws&lt;/span&gt; InterruptedException
+   * @&lt;span class=&quot;code-keyword&quot;&gt;throws&lt;/span&gt; IOException
+   * @&lt;span class=&quot;code-keyword&quot;&gt;throws&lt;/span&gt; KeeperException
+   * @&lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; Count of regions we assigned.
+   */
+  &lt;span class=&quot;code-object&quot;&gt;boolean&lt;/span&gt; assignMeta(MonitoredTask status, ServerName previousRootServer)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;Please add javadoc for parameters. @return doesn&apos;t match actual return.&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
+  &lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;synchronized&lt;/span&gt; void processDeadServer(&lt;span class=&quot;code-keyword&quot;&gt;final&lt;/span&gt; ServerName serverName) {
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;This method can be package private.&lt;/p&gt;
</comment>
                            <comment id="13584804" author="jeffreyz" created="Fri, 22 Feb 2013 23:16:16 +0000"  >&lt;p&gt;@Jean-Marc,&lt;/p&gt;

&lt;p&gt;Thanks for reviewing. &lt;/p&gt;

&lt;p&gt;1)&lt;br/&gt;
&quot;In HMaster, you are testing if failedServers is null to handle other dead servers in SSH. So it can be null there, should it be tested also for META and ROOT? (failedServers.contains())&quot;&lt;/p&gt;

&lt;p&gt;failedServers can&apos;t be null. I can remove the null check to be consistant.&lt;br/&gt;
2)&lt;br/&gt;
&quot;In ServerManager, does processDeadServer need to be synchronized? Many other methods calling deadservers and services are not synchronized.&quot;&lt;/p&gt;

&lt;p&gt;A good point. it&apos;s not needed for the fix at least.&lt;/p&gt;
</comment>
                            <comment id="13584820" author="jeffreyz" created="Fri, 22 Feb 2013 23:28:17 +0000"  >&lt;p&gt;@Ted,&lt;/p&gt;

&lt;p&gt;Thanks for the reviewing. assignRoot will throw exact same exceptions as before so we should be fine there. I&apos;ll make the other changes per your comments.&lt;/p&gt;
</comment>
                            <comment id="13584928" author="jeffreyz" created="Sat, 23 Feb 2013 01:26:24 +0000"  >&lt;p&gt;Incorporate review comments. &lt;/p&gt;

&lt;p&gt;Thanks,&lt;br/&gt;
-Jeffrey&lt;/p&gt;</comment>
                            <comment id="13584987" author="jmspaggi" created="Sat, 23 Feb 2013 03:19:24 +0000"  >&lt;p&gt;All tests passed. with the previous version. They are running now, I will post the results tomorrow.&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
  Set&amp;lt;ServerName&amp;gt; getFailedServersFromLogFolders() {
    &lt;span class=&quot;code-object&quot;&gt;boolean&lt;/span&gt; retrySplitting = !conf.getBoolean(&lt;span class=&quot;code-quote&quot;&gt;&quot;hbase.hlog.split.skip.errors&quot;&lt;/span&gt;,
      HLog.SPLIT_SKIP_ERRORS_DEFAULT);
....
    Set&amp;lt;ServerName&amp;gt; serverNames = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; HashSet&amp;lt;ServerName&amp;gt;();
    Path logsDirPath = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; Path(&lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt;.rootdir, HConstants.HREGION_LOGDIR_NAME);
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;Still have some extra spaces here (replaced by dots to highlight them).&lt;/p&gt;

&lt;p&gt;+1 for me.&lt;/p&gt;</comment>
                            <comment id="13585013" author="stack" created="Sat, 23 Feb 2013 05:28:55 +0000"  >&lt;p&gt;Patch looks great.&lt;/p&gt;

&lt;p&gt;Why we doing the below?  Doesn&apos;t recoverablezookeeper do this for us?&lt;/p&gt;

&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;LOG.error(&quot;ZooKeeper exception trying to set cluster as down in ZK&quot;, e);&lt;br/&gt;
+      if (e instanceof KeeperException.SessionExpiredException) {&lt;br/&gt;
+        LOG.warn(&quot;ZK session expired. Retry a new connection...&quot;);&lt;br/&gt;
+        try {&lt;br/&gt;
+          this.zooKeeper.reconnectAfterExpiration();&lt;br/&gt;
+          this.clusterStatusTracker.setClusterDown();&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;+1 on commit.&lt;/p&gt;</comment>
                            <comment id="13585428" author="jmspaggi" created="Sun, 24 Feb 2013 17:22:03 +0000"  >&lt;p&gt;Need to &quot;Submit Patch&quot; to have Hadoop QA looking at it...&lt;/p&gt;</comment>
                            <comment id="13585431" author="yuzhihong@gmail.com" created="Sun, 24 Feb 2013 17:26:13 +0000"  >&lt;p&gt;The patch is for 0.94 branch.&lt;/p&gt;</comment>
                            <comment id="13585432" author="nkeywal" created="Sun, 24 Feb 2013 17:26:18 +0000"  >&lt;p&gt;hadoop-qa is for trunk only...&lt;/p&gt;</comment>
                            <comment id="13585442" author="lhofhansl" created="Sun, 24 Feb 2013 17:53:10 +0000"  >&lt;p&gt;I skimmed the patch. Looks good as far as I can tell. Definitely a worthy addition ton0.94.&lt;/p&gt;</comment>
                            <comment id="13585576" author="jmspaggi" created="Mon, 25 Feb 2013 02:47:35 +0000"  >&lt;p&gt;Has anyone been able to run all the tests successfuly? I tried 3 times today and always TestReplicationQueueFailoverCompressed was part of the failed tests.&lt;/p&gt;

&lt;p&gt;However, I&apos;m not sure it&apos;s realy related to this fix. I will try again tomorrow.&lt;/p&gt;

&lt;p&gt;Tests in error: &lt;br/&gt;
  queueFailover(org.apache.hadoop.hbase.replication.TestReplicationQueueFailoverCompressed): test timed out after 300000 milliseconds&lt;/p&gt;

&lt;p&gt;Tests in error: &lt;br/&gt;
  queueFailover(org.apache.hadoop.hbase.replication.TestReplicationQueueFailoverCompressed): test timed out after 300000 milliseconds&lt;br/&gt;
  queueFailover(org.apache.hadoop.hbase.replication.TestReplicationQueueFailover): test timed out after 300000 milliseconds&lt;/p&gt;

&lt;p&gt;Tests in error: &lt;br/&gt;
  queueFailover(org.apache.hadoop.hbase.replication.TestReplicationQueueFailoverCompressed): test timed out after 300000 milliseconds&lt;/p&gt;</comment>
                            <comment id="13585634" author="yuzhihong@gmail.com" created="Mon, 25 Feb 2013 05:30:53 +0000"  >&lt;p&gt;@Jean-Marc:&lt;br/&gt;
Thanks for your verification.&lt;/p&gt;

&lt;p&gt;I don&apos;t think the above test failures were caused by the patch.&lt;/p&gt;</comment>
                            <comment id="13585643" author="jeffreyz" created="Mon, 25 Feb 2013 05:42:30 +0000"  >&lt;p&gt;@Stack&lt;/p&gt;

&lt;p&gt;Thanks for reviewing. Though recoverablezookeeper does retry after errors, SessionExpiredException is special and normal retry won&apos;recover the error no matter how many retries. It has to reconnect to ZK and retry.&lt;/p&gt;

&lt;p&gt;@Jean-Marc,&lt;/p&gt;

&lt;p&gt;I was able to run &quot;mvn test -PlocalTests -Dtest=TestReplicationQueueFailoverCompressed&quot; successfully on my dev box.&lt;/p&gt;</comment>
                            <comment id="13585851" author="jmspaggi" created="Mon, 25 Feb 2013 13:27:04 +0000"  >&lt;p&gt;Working for me too with mvn test -PlocalTests -Dtest=TestReplicationQueueFailoverCompressed&lt;/p&gt;

&lt;p&gt;Running org.apache.hadoop.hbase.replication.TestReplicationQueueFailoverCompressed&lt;br/&gt;
Tests run: 1, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 126.846 sec&lt;/p&gt;</comment>
                            <comment id="13586053" author="yuzhihong@gmail.com" created="Mon, 25 Feb 2013 17:58:46 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=lhofhansl&quot; class=&quot;user-hover&quot; rel=&quot;lhofhansl&quot;&gt;Lars Hofhansl&lt;/a&gt;:&lt;br/&gt;
Do you want to take another look ?&lt;/p&gt;

&lt;p&gt;Thanks&lt;/p&gt;</comment>
                            <comment id="13586184" author="stack" created="Mon, 25 Feb 2013 19:30:57 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=jeffreyz&quot; class=&quot;user-hover&quot; rel=&quot;jeffreyz&quot;&gt;Jeffrey Zhong&lt;/a&gt; This is for 0.94.  We don&apos;t need a trunk patch (or it is dealt w/ already in another issue?)&lt;/p&gt;</comment>
                            <comment id="13586191" author="jeffreyz" created="Mon, 25 Feb 2013 19:35:46 +0000"  >
&lt;p&gt;@Stack, the similar work is captured in &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-7835&quot; title=&quot;Implementation of the log splitting without creating intermediate files &quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-7835&quot;&gt;&lt;del&gt;HBASE-7835&lt;/del&gt;&lt;/a&gt; for trunk. &lt;/p&gt;</comment>
                            <comment id="13586209" author="stack" created="Mon, 25 Feb 2013 19:50:19 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=jeffreyz&quot; class=&quot;user-hover&quot; rel=&quot;jeffreyz&quot;&gt;Jeffrey Zhong&lt;/a&gt; Ok. +1 on commit to 0.94.&lt;/p&gt;</comment>
                            <comment id="13586353" author="yuzhihong@gmail.com" created="Mon, 25 Feb 2013 22:02:47 +0000"  >&lt;p&gt;Integrated to 0.94 branch.&lt;/p&gt;

&lt;p&gt;Thanks for the patch, Jeffrey.&lt;/p&gt;

&lt;p&gt;Thanks for the reviews, Stack, Lars and Jean-Marc.&lt;/p&gt;</comment>
                            <comment id="13586683" author="hudson" created="Tue, 26 Feb 2013 03:16:24 +0000"  >&lt;p&gt;Integrated in HBase-0.94 #859 (See &lt;a href=&quot;https://builds.apache.org/job/HBase-0.94/859/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/HBase-0.94/859/&lt;/a&gt;)&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-7824&quot; title=&quot;Improve master start up time when there is log splitting work&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-7824&quot;&gt;&lt;del&gt;HBASE-7824&lt;/del&gt;&lt;/a&gt; Improve master start up time when there is log splitting work (Jeffrey Zhong) (Revision 1449920)&lt;/p&gt;

&lt;p&gt;     Result = SUCCESS&lt;br/&gt;
tedyu : &lt;br/&gt;
Files : &lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/hbase/branches/0.94/src/main/java/org/apache/hadoop/hbase/catalog/CatalogTracker.java&lt;/li&gt;
	&lt;li&gt;/hbase/branches/0.94/src/main/java/org/apache/hadoop/hbase/master/HMaster.java&lt;/li&gt;
	&lt;li&gt;/hbase/branches/0.94/src/main/java/org/apache/hadoop/hbase/master/MasterFileSystem.java&lt;/li&gt;
	&lt;li&gt;/hbase/branches/0.94/src/main/java/org/apache/hadoop/hbase/master/ServerManager.java&lt;/li&gt;
	&lt;li&gt;/hbase/branches/0.94/src/main/java/org/apache/hadoop/hbase/master/handler/ServerShutdownHandler.java&lt;/li&gt;
	&lt;li&gt;/hbase/branches/0.94/src/main/java/org/apache/hadoop/hbase/regionserver/HRegionServer.java&lt;/li&gt;
	&lt;li&gt;/hbase/branches/0.94/src/main/java/org/apache/hadoop/hbase/zookeeper/ZooKeeperNodeTracker.java&lt;/li&gt;
	&lt;li&gt;/hbase/branches/0.94/src/test/java/org/apache/hadoop/hbase/master/TestDistributedLogSplitting.java&lt;/li&gt;
	&lt;li&gt;/hbase/branches/0.94/src/test/java/org/apache/hadoop/hbase/regionserver/TestRSKilledWhenMasterInitializing.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="13586891" author="hudson" created="Tue, 26 Feb 2013 07:26:58 +0000"  >&lt;p&gt;Integrated in HBase-0.94-security #112 (See &lt;a href=&quot;https://builds.apache.org/job/HBase-0.94-security/112/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/HBase-0.94-security/112/&lt;/a&gt;)&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-7824&quot; title=&quot;Improve master start up time when there is log splitting work&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-7824&quot;&gt;&lt;del&gt;HBASE-7824&lt;/del&gt;&lt;/a&gt; Improve master start up time when there is log splitting work (Jeffrey Zhong) (Revision 1449920)&lt;/p&gt;

&lt;p&gt;     Result = SUCCESS&lt;br/&gt;
tedyu : &lt;br/&gt;
Files : &lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/hbase/branches/0.94/src/main/java/org/apache/hadoop/hbase/catalog/CatalogTracker.java&lt;/li&gt;
	&lt;li&gt;/hbase/branches/0.94/src/main/java/org/apache/hadoop/hbase/master/HMaster.java&lt;/li&gt;
	&lt;li&gt;/hbase/branches/0.94/src/main/java/org/apache/hadoop/hbase/master/MasterFileSystem.java&lt;/li&gt;
	&lt;li&gt;/hbase/branches/0.94/src/main/java/org/apache/hadoop/hbase/master/ServerManager.java&lt;/li&gt;
	&lt;li&gt;/hbase/branches/0.94/src/main/java/org/apache/hadoop/hbase/master/handler/ServerShutdownHandler.java&lt;/li&gt;
	&lt;li&gt;/hbase/branches/0.94/src/main/java/org/apache/hadoop/hbase/regionserver/HRegionServer.java&lt;/li&gt;
	&lt;li&gt;/hbase/branches/0.94/src/main/java/org/apache/hadoop/hbase/zookeeper/ZooKeeperNodeTracker.java&lt;/li&gt;
	&lt;li&gt;/hbase/branches/0.94/src/test/java/org/apache/hadoop/hbase/master/TestDistributedLogSplitting.java&lt;/li&gt;
	&lt;li&gt;/hbase/branches/0.94/src/test/java/org/apache/hadoop/hbase/regionserver/TestRSKilledWhenMasterInitializing.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="13592002" author="lhofhansl" created="Mon, 4 Mar 2013 05:23:32 +0000"  >&lt;p&gt;We&apos;re seeing relatively frequent failures of TestMasterFailover.testMasterFailoverWithMockedRITOnDeadRS now. Over in &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-7985&quot; title=&quot;TestMasterFailover.testMasterFailoverWithMockedRITOnDeadRS fails frequently in 0.94&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-7985&quot;&gt;&lt;del&gt;HBASE-7985&lt;/del&gt;&lt;/a&gt; Ram determined that this always happens when the RS we abort does not carry META. It might be related to this change.&lt;/p&gt;</comment>
                            <comment id="13592009" author="ram_krish" created="Mon, 4 Mar 2013 05:55:23 +0000"  >&lt;p&gt;@Jeff&lt;br/&gt;
Any specific reason for adding the server to be processed (other than RS carrying ROOT or META) to the deadServers.&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
 void processDeadServer(&lt;span class=&quot;code-keyword&quot;&gt;final&lt;/span&gt; ServerName serverName) {
    &lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt;.deadservers.add(serverName);
    &lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt;.services.getExecutorService().submit(
      &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; ServerShutdownHandler(&lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt;.master, &lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt;.services, &lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt;.deadservers, serverName, &lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;));
  }
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;I remember we used to track the servers that got expired when master was coming up using deadServers.  See ServerManager.expireServer().  &lt;br/&gt;
May be some specific issues you got?  &lt;/p&gt;</comment>
                            <comment id="13592021" author="jeffreyz" created="Mon, 4 Mar 2013 06:31:17 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=ram_krish&quot; class=&quot;user-hover&quot; rel=&quot;ram_krish&quot;&gt;ramkrishna.s.vasudevan&lt;/a&gt;&lt;br/&gt;
The reason is that we already recovered META region servers during the initialization so we don&apos;t need to keep meta region servers there. The failedServer list is only for log splitting work.Let me see why the test TestMasterFailover.testMasterFailoverWithMockedRITOnDeadRS failed more often. &lt;/p&gt;

&lt;p&gt;Thanks,&lt;br/&gt;
-Jeffrey&lt;/p&gt;</comment>
                            <comment id="13592028" author="ram_krish" created="Mon, 4 Mar 2013 06:40:10 +0000"  >&lt;p&gt;Yes i can understand that part.  But do we need to explicitly add to deadServers?  Because the deadServers list was like used when an RS goes down just when the master started coming up.&lt;/p&gt;</comment>
                            <comment id="13592434" author="jeffreyz" created="Mon, 4 Mar 2013 18:16:35 +0000"  >&lt;p&gt;The reason to add those previous dead non-meta region servers into deadServers is to let the new master instance start as a failover such as the following code in AssignmentManager. In addition, we don&apos;t want AM assign those regions before log splitting work complete that&apos;s why let AM skip them inside function processDeadServersAndRegionsInTransition but handle them in SSH.&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
    &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (!&lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt;.serverManager.getDeadServers().isEmpty()) {
      &lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt;.failover = &lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;;
    }
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt; 

&lt;p&gt;Since those failed servers will be processed by SSH so their regions should be online and I did see test log message &quot;Finished processing of shutdown&quot;. &lt;/p&gt;

&lt;p&gt;There are couple of regions aren&apos;t assigned for some reason and I need to dig more in the test case and keep you updated.&lt;/p&gt;

&lt;p&gt;Thanks,&lt;br/&gt;
-Jeffrey&lt;/p&gt;
</comment>
                            <comment id="13592457" author="lhofhansl" created="Mon, 4 Mar 2013 18:31:23 +0000"  >&lt;p&gt;I would like to roll 0.94.6 soon.&lt;br/&gt;
Should we revert this for 0.94.6 and put it back up for 0.94.7?&lt;/p&gt;</comment>
                            <comment id="13592474" author="jeffreyz" created="Mon, 4 Mar 2013 18:41:32 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=lhofhansl&quot; class=&quot;user-hover&quot; rel=&quot;lhofhansl&quot;&gt;Lars Hofhansl&lt;/a&gt;I&apos;m fine to revert it for now and put it back up for 0.94.7 because there is no hurry for this.&lt;/p&gt;

&lt;p&gt;Thanks,&lt;br/&gt;
-Jeffrey&lt;/p&gt;</comment>
                            <comment id="13592481" author="lhofhansl" created="Mon, 4 Mar 2013 18:45:24 +0000"  >&lt;p&gt;If we can work out the failure that would be preferable of course &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.gif&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;</comment>
                            <comment id="13592492" author="jeffreyz" created="Mon, 4 Mar 2013 18:49:45 +0000"  >&lt;p&gt;Yeah, in either way I&apos;ll get the bottom of this(hopefully by end of today) so that we can be sure there is no issue. &lt;/p&gt;

</comment>
                            <comment id="13592501" author="lhofhansl" created="Mon, 4 Mar 2013 18:55:42 +0000"  >&lt;p&gt;Thanks &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=jeffreyz&quot; class=&quot;user-hover&quot; rel=&quot;jeffreyz&quot;&gt;Jeffrey Zhong&lt;/a&gt;!&lt;/p&gt;</comment>
                            <comment id="13592522" author="yuzhihong@gmail.com" created="Mon, 4 Mar 2013 19:16:41 +0000"  >&lt;p&gt;Talked with Jeffrey.&lt;/p&gt;

&lt;p&gt;I reverted the patch for now.&lt;/p&gt;

&lt;p&gt;Jeffrey would provide his suggestion on how to make TestMasterFailover more reliable, along with his changes.&lt;/p&gt;</comment>
                            <comment id="13592721" author="jeffreyz" created="Mon, 4 Mar 2013 22:15:28 +0000"  >&lt;p&gt;I think I found the root cause and I addressed in the trunk patch(&lt;a href=&quot;https://reviews.apache.org/r/9419/diff/#index_header&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/9419/diff/#index_header&lt;/a&gt;) where I have the following line:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
 &lt;span class=&quot;code-comment&quot;&gt;// wait till all dead server are processed	
&lt;/span&gt;    ServerManager serverManager = master.getServerManager();
    &lt;span class=&quot;code-keyword&quot;&gt;while&lt;/span&gt; (serverManager.areDeadServersInProgress()) {
      &lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;.sleep(100);
    }
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Because my change will make master start up quickly with some SSH handling left which changes existing test case assumption a little bit. So I added the above lines to match the exiting test case expectation which that all log splitting work is done &amp;amp; previous dead servers are handled.   &lt;/p&gt;

&lt;p&gt;I&apos;ve run the test case 20 times in a loop without any failure. &lt;/p&gt;

&lt;p&gt;The reason that the test case passed with removing &quot;this.deadservers.add(serverName);&quot;. Because it basically assigns regions before master initialization due to waitForActiveAndReadyMaster in the test code. Since it matches old behavior so that test case passed while the log splitting work might not have been done before those regions are assigned.&lt;/p&gt;



</comment>
                            <comment id="13592731" author="jeffreyz" created="Mon, 4 Mar 2013 22:19:03 +0000"  >&lt;p&gt;Amend waitForActiveAndReadyMaster so the master ready state will wait for all SSH handing are done to match the old behavior that existing test cases are expecting.&lt;/p&gt;</comment>
                            <comment id="13592943" author="hudson" created="Tue, 5 Mar 2013 02:01:52 +0000"  >&lt;p&gt;Integrated in HBase-0.94 #879 (See &lt;a href=&quot;https://builds.apache.org/job/HBase-0.94/879/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/HBase-0.94/879/&lt;/a&gt;)&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-7824&quot; title=&quot;Improve master start up time when there is log splitting work&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-7824&quot;&gt;&lt;del&gt;HBASE-7824&lt;/del&gt;&lt;/a&gt; Revert until TestMasterFailover passes reliably (Revision 1452452)&lt;/p&gt;

&lt;p&gt;     Result = FAILURE&lt;br/&gt;
tedyu : &lt;br/&gt;
Files : &lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/hbase/branches/0.94/src/main/java/org/apache/hadoop/hbase/catalog/CatalogTracker.java&lt;/li&gt;
	&lt;li&gt;/hbase/branches/0.94/src/main/java/org/apache/hadoop/hbase/master/HMaster.java&lt;/li&gt;
	&lt;li&gt;/hbase/branches/0.94/src/main/java/org/apache/hadoop/hbase/master/MasterFileSystem.java&lt;/li&gt;
	&lt;li&gt;/hbase/branches/0.94/src/main/java/org/apache/hadoop/hbase/master/ServerManager.java&lt;/li&gt;
	&lt;li&gt;/hbase/branches/0.94/src/main/java/org/apache/hadoop/hbase/master/handler/ServerShutdownHandler.java&lt;/li&gt;
	&lt;li&gt;/hbase/branches/0.94/src/main/java/org/apache/hadoop/hbase/regionserver/HRegionServer.java&lt;/li&gt;
	&lt;li&gt;/hbase/branches/0.94/src/main/java/org/apache/hadoop/hbase/zookeeper/ZooKeeperNodeTracker.java&lt;/li&gt;
	&lt;li&gt;/hbase/branches/0.94/src/test/java/org/apache/hadoop/hbase/master/TestDistributedLogSplitting.java&lt;/li&gt;
	&lt;li&gt;/hbase/branches/0.94/src/test/java/org/apache/hadoop/hbase/regionserver/TestRSKilledWhenMasterInitializing.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="13593183" author="hudson" created="Tue, 5 Mar 2013 07:52:14 +0000"  >&lt;p&gt;Integrated in HBase-0.94-security-on-Hadoop-23 #12 (See &lt;a href=&quot;https://builds.apache.org/job/HBase-0.94-security-on-Hadoop-23/12/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/HBase-0.94-security-on-Hadoop-23/12/&lt;/a&gt;)&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-7824&quot; title=&quot;Improve master start up time when there is log splitting work&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-7824&quot;&gt;&lt;del&gt;HBASE-7824&lt;/del&gt;&lt;/a&gt; Revert until TestMasterFailover passes reliably (Revision 1452452)&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-7824&quot; title=&quot;Improve master start up time when there is log splitting work&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-7824&quot;&gt;&lt;del&gt;HBASE-7824&lt;/del&gt;&lt;/a&gt; Improve master start up time when there is log splitting work (Jeffrey Zhong) (Revision 1449920)&lt;/p&gt;

&lt;p&gt;     Result = FAILURE&lt;br/&gt;
tedyu : &lt;br/&gt;
Files : &lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/hbase/branches/0.94/src/main/java/org/apache/hadoop/hbase/catalog/CatalogTracker.java&lt;/li&gt;
	&lt;li&gt;/hbase/branches/0.94/src/main/java/org/apache/hadoop/hbase/master/HMaster.java&lt;/li&gt;
	&lt;li&gt;/hbase/branches/0.94/src/main/java/org/apache/hadoop/hbase/master/MasterFileSystem.java&lt;/li&gt;
	&lt;li&gt;/hbase/branches/0.94/src/main/java/org/apache/hadoop/hbase/master/ServerManager.java&lt;/li&gt;
	&lt;li&gt;/hbase/branches/0.94/src/main/java/org/apache/hadoop/hbase/master/handler/ServerShutdownHandler.java&lt;/li&gt;
	&lt;li&gt;/hbase/branches/0.94/src/main/java/org/apache/hadoop/hbase/regionserver/HRegionServer.java&lt;/li&gt;
	&lt;li&gt;/hbase/branches/0.94/src/main/java/org/apache/hadoop/hbase/zookeeper/ZooKeeperNodeTracker.java&lt;/li&gt;
	&lt;li&gt;/hbase/branches/0.94/src/test/java/org/apache/hadoop/hbase/master/TestDistributedLogSplitting.java&lt;/li&gt;
	&lt;li&gt;/hbase/branches/0.94/src/test/java/org/apache/hadoop/hbase/regionserver/TestRSKilledWhenMasterInitializing.java&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;tedyu : &lt;br/&gt;
Files : &lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/hbase/branches/0.94/src/main/java/org/apache/hadoop/hbase/catalog/CatalogTracker.java&lt;/li&gt;
	&lt;li&gt;/hbase/branches/0.94/src/main/java/org/apache/hadoop/hbase/master/HMaster.java&lt;/li&gt;
	&lt;li&gt;/hbase/branches/0.94/src/main/java/org/apache/hadoop/hbase/master/MasterFileSystem.java&lt;/li&gt;
	&lt;li&gt;/hbase/branches/0.94/src/main/java/org/apache/hadoop/hbase/master/ServerManager.java&lt;/li&gt;
	&lt;li&gt;/hbase/branches/0.94/src/main/java/org/apache/hadoop/hbase/master/handler/ServerShutdownHandler.java&lt;/li&gt;
	&lt;li&gt;/hbase/branches/0.94/src/main/java/org/apache/hadoop/hbase/regionserver/HRegionServer.java&lt;/li&gt;
	&lt;li&gt;/hbase/branches/0.94/src/main/java/org/apache/hadoop/hbase/zookeeper/ZooKeeperNodeTracker.java&lt;/li&gt;
	&lt;li&gt;/hbase/branches/0.94/src/test/java/org/apache/hadoop/hbase/master/TestDistributedLogSplitting.java&lt;/li&gt;
	&lt;li&gt;/hbase/branches/0.94/src/test/java/org/apache/hadoop/hbase/regionserver/TestRSKilledWhenMasterInitializing.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="13593237" author="hudson" created="Tue, 5 Mar 2013 08:29:15 +0000"  >&lt;p&gt;Integrated in HBase-0.94-security #116 (See &lt;a href=&quot;https://builds.apache.org/job/HBase-0.94-security/116/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/HBase-0.94-security/116/&lt;/a&gt;)&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-7824&quot; title=&quot;Improve master start up time when there is log splitting work&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-7824&quot;&gt;&lt;del&gt;HBASE-7824&lt;/del&gt;&lt;/a&gt; Revert until TestMasterFailover passes reliably (Revision 1452452)&lt;/p&gt;

&lt;p&gt;     Result = SUCCESS&lt;br/&gt;
tedyu : &lt;br/&gt;
Files : &lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/hbase/branches/0.94/src/main/java/org/apache/hadoop/hbase/catalog/CatalogTracker.java&lt;/li&gt;
	&lt;li&gt;/hbase/branches/0.94/src/main/java/org/apache/hadoop/hbase/master/HMaster.java&lt;/li&gt;
	&lt;li&gt;/hbase/branches/0.94/src/main/java/org/apache/hadoop/hbase/master/MasterFileSystem.java&lt;/li&gt;
	&lt;li&gt;/hbase/branches/0.94/src/main/java/org/apache/hadoop/hbase/master/ServerManager.java&lt;/li&gt;
	&lt;li&gt;/hbase/branches/0.94/src/main/java/org/apache/hadoop/hbase/master/handler/ServerShutdownHandler.java&lt;/li&gt;
	&lt;li&gt;/hbase/branches/0.94/src/main/java/org/apache/hadoop/hbase/regionserver/HRegionServer.java&lt;/li&gt;
	&lt;li&gt;/hbase/branches/0.94/src/main/java/org/apache/hadoop/hbase/zookeeper/ZooKeeperNodeTracker.java&lt;/li&gt;
	&lt;li&gt;/hbase/branches/0.94/src/test/java/org/apache/hadoop/hbase/master/TestDistributedLogSplitting.java&lt;/li&gt;
	&lt;li&gt;/hbase/branches/0.94/src/test/java/org/apache/hadoop/hbase/regionserver/TestRSKilledWhenMasterInitializing.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="13594952" author="jeffreyz" created="Wed, 6 Mar 2013 18:41:06 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=ram_krish&quot; class=&quot;user-hover&quot; rel=&quot;ram_krish&quot;&gt;ramkrishna.s.vasudevan&lt;/a&gt; Are you all right with my explanation in &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-7824?focusedCommentId=13592721&amp;amp;page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-13592721?&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/HBASE-7824?focusedCommentId=13592721&amp;amp;page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-13592721?&lt;/a&gt; So far the test cases passed with a small modifications in the file src/test/java/org/apache/hadoop/hbase/MiniHBaseCluster.java.&lt;/p&gt;

&lt;p&gt;Thanks,&lt;br/&gt;
-Jeffrey&lt;/p&gt;</comment>
                            <comment id="13600442" author="jeffreyz" created="Tue, 12 Mar 2013 20:35:34 +0000"  >&lt;p&gt;Latest rebased patch. Below are test results:&lt;/p&gt;

&lt;p&gt;mvn clean -PrunAllTests -Dmaven.test.redirectTestOutputToFile=true install assembly:single -DskipITs&lt;/p&gt;

&lt;p&gt;Results :&lt;/p&gt;

&lt;p&gt;Tests run: 1327, Failures: 0, Errors: 0, Skipped: 13&lt;/p&gt;</comment>
                            <comment id="13600785" author="yuzhihong@gmail.com" created="Wed, 13 Mar 2013 03:55:23 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=lhofhansl&quot; class=&quot;user-hover&quot; rel=&quot;lhofhansl&quot;&gt;Lars Hofhansl&lt;/a&gt;:&lt;br/&gt;
What do you think of this one ?&lt;/p&gt;</comment>
                            <comment id="13600808" author="lhofhansl" created="Wed, 13 Mar 2013 04:38:26 +0000"  >&lt;p&gt;+1 let&apos;s try again for 0.94.&lt;/p&gt;</comment>
                            <comment id="13601206" author="yuzhihong@gmail.com" created="Wed, 13 Mar 2013 14:57:43 +0000"  >&lt;p&gt;Integrated to 0.94&lt;/p&gt;

&lt;p&gt;Thanks for the patch, Jeff.&lt;/p&gt;

&lt;p&gt;Let&apos;s see how it goes.&lt;/p&gt;</comment>
                            <comment id="13601234" author="hudson" created="Wed, 13 Mar 2013 15:27:44 +0000"  >&lt;p&gt;Integrated in HBase-0.94 #894 (See &lt;a href=&quot;https://builds.apache.org/job/HBase-0.94/894/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/HBase-0.94/894/&lt;/a&gt;)&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-7824&quot; title=&quot;Improve master start up time when there is log splitting work&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-7824&quot;&gt;&lt;del&gt;HBASE-7824&lt;/del&gt;&lt;/a&gt; Improve master start up time when there is log splitting work (Jeffrey Zhong) (Revision 1455976)&lt;/p&gt;

&lt;p&gt;     Result = FAILURE&lt;br/&gt;
tedyu : &lt;br/&gt;
Files : &lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/hbase/branches/0.94/src/main/java/org/apache/hadoop/hbase/catalog/CatalogTracker.java&lt;/li&gt;
	&lt;li&gt;/hbase/branches/0.94/src/main/java/org/apache/hadoop/hbase/master/HMaster.java&lt;/li&gt;
	&lt;li&gt;/hbase/branches/0.94/src/main/java/org/apache/hadoop/hbase/master/MasterFileSystem.java&lt;/li&gt;
	&lt;li&gt;/hbase/branches/0.94/src/main/java/org/apache/hadoop/hbase/master/ServerManager.java&lt;/li&gt;
	&lt;li&gt;/hbase/branches/0.94/src/main/java/org/apache/hadoop/hbase/master/handler/ServerShutdownHandler.java&lt;/li&gt;
	&lt;li&gt;/hbase/branches/0.94/src/main/java/org/apache/hadoop/hbase/regionserver/HRegionServer.java&lt;/li&gt;
	&lt;li&gt;/hbase/branches/0.94/src/main/java/org/apache/hadoop/hbase/zookeeper/ZooKeeperNodeTracker.java&lt;/li&gt;
	&lt;li&gt;/hbase/branches/0.94/src/test/java/org/apache/hadoop/hbase/MiniHBaseCluster.java&lt;/li&gt;
	&lt;li&gt;/hbase/branches/0.94/src/test/java/org/apache/hadoop/hbase/master/TestDistributedLogSplitting.java&lt;/li&gt;
	&lt;li&gt;/hbase/branches/0.94/src/test/java/org/apache/hadoop/hbase/regionserver/TestRSKilledWhenMasterInitializing.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="13602785" author="yuzhihong@gmail.com" created="Thu, 14 Mar 2013 21:31:45 +0000"  >&lt;p&gt;Backed out again due to TestMasterFailover#testMasterFailoverWithMockedRITOnDeadRS test failure.&lt;/p&gt;</comment>
                            <comment id="13602793" author="lhofhansl" created="Thu, 14 Mar 2013 21:37:35 +0000"  >&lt;p&gt;Since we backed this out twice... -1 on attempting this again.&lt;/p&gt;</comment>
                            <comment id="13602794" author="lhofhansl" created="Thu, 14 Mar 2013 21:38:03 +0000"  >&lt;p&gt;Thanks for reverting Ted.&lt;/p&gt;</comment>
                            <comment id="13603033" author="hudson" created="Fri, 15 Mar 2013 02:35:13 +0000"  >&lt;p&gt;Integrated in HBase-0.94 #903 (See &lt;a href=&quot;https://builds.apache.org/job/HBase-0.94/903/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/HBase-0.94/903/&lt;/a&gt;)&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-7824&quot; title=&quot;Improve master start up time when there is log splitting work&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-7824&quot;&gt;&lt;del&gt;HBASE-7824&lt;/del&gt;&lt;/a&gt; Improve master start up time when there is log splitting work, revert due to TestMasterFailover#testMasterFailoverWithMockedRITOnDeadRS failure (Revision 1456689)&lt;/p&gt;

&lt;p&gt;     Result = FAILURE&lt;br/&gt;
tedyu : &lt;br/&gt;
Files : &lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/hbase/branches/0.94/src/main/java/org/apache/hadoop/hbase/catalog/CatalogTracker.java&lt;/li&gt;
	&lt;li&gt;/hbase/branches/0.94/src/main/java/org/apache/hadoop/hbase/master/HMaster.java&lt;/li&gt;
	&lt;li&gt;/hbase/branches/0.94/src/main/java/org/apache/hadoop/hbase/master/MasterFileSystem.java&lt;/li&gt;
	&lt;li&gt;/hbase/branches/0.94/src/main/java/org/apache/hadoop/hbase/master/ServerManager.java&lt;/li&gt;
	&lt;li&gt;/hbase/branches/0.94/src/main/java/org/apache/hadoop/hbase/master/handler/ServerShutdownHandler.java&lt;/li&gt;
	&lt;li&gt;/hbase/branches/0.94/src/main/java/org/apache/hadoop/hbase/regionserver/HRegionServer.java&lt;/li&gt;
	&lt;li&gt;/hbase/branches/0.94/src/main/java/org/apache/hadoop/hbase/zookeeper/ZooKeeperNodeTracker.java&lt;/li&gt;
	&lt;li&gt;/hbase/branches/0.94/src/test/java/org/apache/hadoop/hbase/MiniHBaseCluster.java&lt;/li&gt;
	&lt;li&gt;/hbase/branches/0.94/src/test/java/org/apache/hadoop/hbase/master/TestDistributedLogSplitting.java&lt;/li&gt;
	&lt;li&gt;/hbase/branches/0.94/src/test/java/org/apache/hadoop/hbase/regionserver/TestRSKilledWhenMasterInitializing.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="13603095" author="hudson" created="Fri, 15 Mar 2013 03:52:03 +0000"  >&lt;p&gt;Integrated in HBase-0.94-security #124 (See &lt;a href=&quot;https://builds.apache.org/job/HBase-0.94-security/124/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/HBase-0.94-security/124/&lt;/a&gt;)&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-7824&quot; title=&quot;Improve master start up time when there is log splitting work&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-7824&quot;&gt;&lt;del&gt;HBASE-7824&lt;/del&gt;&lt;/a&gt; Improve master start up time when there is log splitting work, revert due to TestMasterFailover#testMasterFailoverWithMockedRITOnDeadRS failure (Revision 1456689)&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-7824&quot; title=&quot;Improve master start up time when there is log splitting work&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-7824&quot;&gt;&lt;del&gt;HBASE-7824&lt;/del&gt;&lt;/a&gt; Improve master start up time when there is log splitting work (Jeffrey Zhong) (Revision 1455976)&lt;/p&gt;

&lt;p&gt;     Result = FAILURE&lt;br/&gt;
tedyu : &lt;br/&gt;
Files : &lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/hbase/branches/0.94/src/main/java/org/apache/hadoop/hbase/catalog/CatalogTracker.java&lt;/li&gt;
	&lt;li&gt;/hbase/branches/0.94/src/main/java/org/apache/hadoop/hbase/master/HMaster.java&lt;/li&gt;
	&lt;li&gt;/hbase/branches/0.94/src/main/java/org/apache/hadoop/hbase/master/MasterFileSystem.java&lt;/li&gt;
	&lt;li&gt;/hbase/branches/0.94/src/main/java/org/apache/hadoop/hbase/master/ServerManager.java&lt;/li&gt;
	&lt;li&gt;/hbase/branches/0.94/src/main/java/org/apache/hadoop/hbase/master/handler/ServerShutdownHandler.java&lt;/li&gt;
	&lt;li&gt;/hbase/branches/0.94/src/main/java/org/apache/hadoop/hbase/regionserver/HRegionServer.java&lt;/li&gt;
	&lt;li&gt;/hbase/branches/0.94/src/main/java/org/apache/hadoop/hbase/zookeeper/ZooKeeperNodeTracker.java&lt;/li&gt;
	&lt;li&gt;/hbase/branches/0.94/src/test/java/org/apache/hadoop/hbase/MiniHBaseCluster.java&lt;/li&gt;
	&lt;li&gt;/hbase/branches/0.94/src/test/java/org/apache/hadoop/hbase/master/TestDistributedLogSplitting.java&lt;/li&gt;
	&lt;li&gt;/hbase/branches/0.94/src/test/java/org/apache/hadoop/hbase/regionserver/TestRSKilledWhenMasterInitializing.java&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;tedyu : &lt;br/&gt;
Files : &lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/hbase/branches/0.94/src/main/java/org/apache/hadoop/hbase/catalog/CatalogTracker.java&lt;/li&gt;
	&lt;li&gt;/hbase/branches/0.94/src/main/java/org/apache/hadoop/hbase/master/HMaster.java&lt;/li&gt;
	&lt;li&gt;/hbase/branches/0.94/src/main/java/org/apache/hadoop/hbase/master/MasterFileSystem.java&lt;/li&gt;
	&lt;li&gt;/hbase/branches/0.94/src/main/java/org/apache/hadoop/hbase/master/ServerManager.java&lt;/li&gt;
	&lt;li&gt;/hbase/branches/0.94/src/main/java/org/apache/hadoop/hbase/master/handler/ServerShutdownHandler.java&lt;/li&gt;
	&lt;li&gt;/hbase/branches/0.94/src/main/java/org/apache/hadoop/hbase/regionserver/HRegionServer.java&lt;/li&gt;
	&lt;li&gt;/hbase/branches/0.94/src/main/java/org/apache/hadoop/hbase/zookeeper/ZooKeeperNodeTracker.java&lt;/li&gt;
	&lt;li&gt;/hbase/branches/0.94/src/test/java/org/apache/hadoop/hbase/MiniHBaseCluster.java&lt;/li&gt;
	&lt;li&gt;/hbase/branches/0.94/src/test/java/org/apache/hadoop/hbase/master/TestDistributedLogSplitting.java&lt;/li&gt;
	&lt;li&gt;/hbase/branches/0.94/src/test/java/org/apache/hadoop/hbase/regionserver/TestRSKilledWhenMasterInitializing.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="13604123" author="lhofhansl" created="Sat, 16 Mar 2013 05:25:38 +0000"  >&lt;p&gt;Maybe I was a bit rash here.&lt;br/&gt;
You said you worked on figuring out what the issues was with the failed test. Any luck?&lt;/p&gt;

&lt;p&gt;The fix that Ram suggests in &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-7985&quot; title=&quot;TestMasterFailover.testMasterFailoverWithMockedRITOnDeadRS fails frequently in 0.94&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-7985&quot;&gt;&lt;del&gt;HBASE-7985&lt;/del&gt;&lt;/a&gt; does not work?&lt;br/&gt;
This is a good improvement and it would be a shame to miss out on this in 0.94.&lt;/p&gt;</comment>
                            <comment id="13604137" author="jeffreyz" created="Sat, 16 Mar 2013 06:41:35 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=lhofhansl&quot; class=&quot;user-hover&quot; rel=&quot;lhofhansl&quot;&gt;Lars Hofhansl&lt;/a&gt; Thanks for giving potential another chance&lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.gif&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;. I&apos;m still looking for a good solution. The cause of the test failure is what Ram suggested. While the cause leads me suspecting a potential situation that a region could stuck in RIT forever, I need to write a test to verify that and will keep you updated. &lt;/p&gt;</comment>
                            <comment id="13604365" author="ram_krish" created="Sat, 16 Mar 2013 18:57:22 +0000"  >&lt;p&gt;Found some reasons..will keep you updated. Let me understand Jeff&apos;s patch also and the idea behind it.&lt;/p&gt;</comment>
                            <comment id="13604457" author="jeffreyz" created="Sat, 16 Mar 2013 23:57:17 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=ram_krish&quot; class=&quot;user-hover&quot; rel=&quot;ram_krish&quot;&gt;ramkrishna.s.vasudevan&lt;/a&gt; Thanks for looking this as well! &lt;/p&gt;

</comment>
                            <comment id="13604458" author="jeffreyz" created="Sat, 16 Mar 2013 23:59:35 +0000"  >&lt;p&gt;I think the test case fails before with the patch is due to an existing issue which I filed at &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-8127&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/HBASE-8127&lt;/a&gt;. Please see details there. Basically RITs of disabling(or disabled) table could stuck in RIT state forever for master failover case. The changes in the patch triggers the existing issue so we have the test failures.&lt;/p&gt;</comment>
                            <comment id="13621757" author="lhofhansl" created="Thu, 4 Apr 2013 04:28:59 +0000"  >&lt;p&gt;Moving to 0.94.8 (along with &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-8127&quot; title=&quot;Region of a disabling or disabled table could be stuck in transition state when RS dies during Master initialization&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-8127&quot;&gt;&lt;del&gt;HBASE-8127&lt;/del&gt;&lt;/a&gt;). Feel free to pull back in.&lt;/p&gt;</comment>
                            <comment id="13623196" author="hudson" created="Fri, 5 Apr 2013 01:00:57 +0000"  >&lt;p&gt;Integrated in HBase-0.94-security-on-Hadoop-23 #13 (See &lt;a href=&quot;https://builds.apache.org/job/HBase-0.94-security-on-Hadoop-23/13/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/HBase-0.94-security-on-Hadoop-23/13/&lt;/a&gt;)&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-7824&quot; title=&quot;Improve master start up time when there is log splitting work&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-7824&quot;&gt;&lt;del&gt;HBASE-7824&lt;/del&gt;&lt;/a&gt; Improve master start up time when there is log splitting work, revert due to TestMasterFailover#testMasterFailoverWithMockedRITOnDeadRS failure (Revision 1456689)&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-7824&quot; title=&quot;Improve master start up time when there is log splitting work&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-7824&quot;&gt;&lt;del&gt;HBASE-7824&lt;/del&gt;&lt;/a&gt; Improve master start up time when there is log splitting work (Jeffrey Zhong) (Revision 1455976)&lt;/p&gt;

&lt;p&gt;     Result = FAILURE&lt;br/&gt;
tedyu : &lt;br/&gt;
Files : &lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/hbase/branches/0.94/src/main/java/org/apache/hadoop/hbase/catalog/CatalogTracker.java&lt;/li&gt;
	&lt;li&gt;/hbase/branches/0.94/src/main/java/org/apache/hadoop/hbase/master/HMaster.java&lt;/li&gt;
	&lt;li&gt;/hbase/branches/0.94/src/main/java/org/apache/hadoop/hbase/master/MasterFileSystem.java&lt;/li&gt;
	&lt;li&gt;/hbase/branches/0.94/src/main/java/org/apache/hadoop/hbase/master/ServerManager.java&lt;/li&gt;
	&lt;li&gt;/hbase/branches/0.94/src/main/java/org/apache/hadoop/hbase/master/handler/ServerShutdownHandler.java&lt;/li&gt;
	&lt;li&gt;/hbase/branches/0.94/src/main/java/org/apache/hadoop/hbase/regionserver/HRegionServer.java&lt;/li&gt;
	&lt;li&gt;/hbase/branches/0.94/src/main/java/org/apache/hadoop/hbase/zookeeper/ZooKeeperNodeTracker.java&lt;/li&gt;
	&lt;li&gt;/hbase/branches/0.94/src/test/java/org/apache/hadoop/hbase/MiniHBaseCluster.java&lt;/li&gt;
	&lt;li&gt;/hbase/branches/0.94/src/test/java/org/apache/hadoop/hbase/master/TestDistributedLogSplitting.java&lt;/li&gt;
	&lt;li&gt;/hbase/branches/0.94/src/test/java/org/apache/hadoop/hbase/regionserver/TestRSKilledWhenMasterInitializing.java&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;tedyu : &lt;br/&gt;
Files : &lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/hbase/branches/0.94/src/main/java/org/apache/hadoop/hbase/catalog/CatalogTracker.java&lt;/li&gt;
	&lt;li&gt;/hbase/branches/0.94/src/main/java/org/apache/hadoop/hbase/master/HMaster.java&lt;/li&gt;
	&lt;li&gt;/hbase/branches/0.94/src/main/java/org/apache/hadoop/hbase/master/MasterFileSystem.java&lt;/li&gt;
	&lt;li&gt;/hbase/branches/0.94/src/main/java/org/apache/hadoop/hbase/master/ServerManager.java&lt;/li&gt;
	&lt;li&gt;/hbase/branches/0.94/src/main/java/org/apache/hadoop/hbase/master/handler/ServerShutdownHandler.java&lt;/li&gt;
	&lt;li&gt;/hbase/branches/0.94/src/main/java/org/apache/hadoop/hbase/regionserver/HRegionServer.java&lt;/li&gt;
	&lt;li&gt;/hbase/branches/0.94/src/main/java/org/apache/hadoop/hbase/zookeeper/ZooKeeperNodeTracker.java&lt;/li&gt;
	&lt;li&gt;/hbase/branches/0.94/src/test/java/org/apache/hadoop/hbase/MiniHBaseCluster.java&lt;/li&gt;
	&lt;li&gt;/hbase/branches/0.94/src/test/java/org/apache/hadoop/hbase/master/TestDistributedLogSplitting.java&lt;/li&gt;
	&lt;li&gt;/hbase/branches/0.94/src/test/java/org/apache/hadoop/hbase/regionserver/TestRSKilledWhenMasterInitializing.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="13623414" author="jeffreyz" created="Fri, 5 Apr 2013 06:48:36 +0000"  >&lt;p&gt;The patch is back!&lt;/p&gt;

&lt;p&gt;There is one more hanging RIT issue found during tests and I listed below as item 4.&lt;/p&gt;

&lt;p&gt;Patch Contents&lt;br/&gt;
==============&lt;br/&gt;
Reviewed:&lt;br/&gt;
1) Adding support to fast master up&lt;br/&gt;
2) Adding a test case for new code&lt;br/&gt;
3) Fix test function makehlog to creat rows with keys within assigned region&apos;s key space&lt;/p&gt;

&lt;p&gt;New changes in the v4 Patch(unreviewed):&lt;br/&gt;
4) Fix ritsGoingToServer hang issue. You can try the new test case testRSKilledWithMockedOpeningRITGoingToDeadRS in the patch to reproduce the issue against 0.94 branch.&lt;br/&gt;
Basically ritsGoingToServer list doesn&apos;t handle disabling or disabled case. You can see the fix in SSH for details.&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=rajesh23&quot; class=&quot;user-hover&quot; rel=&quot;rajesh23&quot;&gt;rajeshbabu&lt;/a&gt;, &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=ram_krish&quot; class=&quot;user-hover&quot; rel=&quot;ram_krish&quot;&gt;ramkrishna.s.vasudevan&lt;/a&gt; Could you please review this fix? Thanks in advance.&lt;/p&gt;

&lt;p&gt;5) Since 0.94 assignment manager is a different animal than 0.96AM, in the patch I included a config flag &quot;hbase.master.wait.for.log.splitting&quot; to disable the feature in case some users may desperately need it later.&lt;/p&gt;

&lt;p&gt;I&apos;ll re-run full suite test and integration tests and post results here.&lt;/p&gt;

&lt;p&gt;Is there anyway we can remove some comments in this JIRA otherwise it&apos;s hard for others to follow?&lt;/p&gt;

&lt;p&gt;Thanks,&lt;br/&gt;
-Jeffrey&lt;/p&gt;

</comment>
                            <comment id="13623417" author="ram_krish" created="Fri, 5 Apr 2013 06:52:33 +0000"  >&lt;p&gt;Ok will check this fix.  It is related to MTTR so always it is useful.&lt;/p&gt;</comment>
                            <comment id="13623960" author="rajesh23" created="Fri, 5 Apr 2013 19:11:38 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=jeffreyz&quot; class=&quot;user-hover&quot; rel=&quot;jeffreyz&quot;&gt;Jeffrey Zhong&lt;/a&gt;&lt;br/&gt;
Going through the patch. &lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
+    &lt;span class=&quot;code-comment&quot;&gt;// SSH should enabled before META region assignment
&lt;/span&gt;+    &lt;span class=&quot;code-comment&quot;&gt;// because META region assignment is depending on ROOT server online.&lt;/span&gt;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;FYI,There is possible META data loss with this&lt;br/&gt;
see chunhui comment&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-8251?focusedCommentId=13621689&amp;amp;page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-13621689&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/HBASE-8251?focusedCommentId=13621689&amp;amp;page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-13621689&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="13624030" author="jeffreyz" created="Fri, 5 Apr 2013 20:26:28 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=rajesh23&quot; class=&quot;user-hover&quot; rel=&quot;rajesh23&quot;&gt;rajeshbabu&lt;/a&gt; I saw the similar issue &quot;if the RS who host ROOT dies before step 4, master will be blocked.&quot; during my testing since it&apos;s pre-existing issue so I guess I can live with it in the patch. Let me try to find a solution otherwise leave the issue as it is. Thanks for the reviewing.&lt;/p&gt;</comment>
                            <comment id="13624071" author="jeffreyz" created="Fri, 5 Apr 2013 21:13:28 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=rajesh23&quot; class=&quot;user-hover&quot; rel=&quot;rajesh23&quot;&gt;rajeshbabu&lt;/a&gt; I find a solution to deal with the pre-existing master hang issue. The solution is simple and basically enable SSH for ROOT only not others before META assignment.&lt;/p&gt;

&lt;p&gt;I&apos;ll rerun whole suite test against the latest path and post result here.&lt;/p&gt;

&lt;p&gt;Thanks,&lt;br/&gt;
-Jeffrey&lt;/p&gt;</comment>
                            <comment id="13624248" author="jeffreyz" created="Sat, 6 Apr 2013 00:54:21 +0000"  >&lt;p&gt;Test suite result:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;Tests run: 1336, Failures: 0, Errors: 0, Skipped: 13&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Integration Test:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
Running org.apache.hadoop.hbase.IntegrationTestDataIngestWithChaosMonkey
Tests run: 1, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 681.593 sec

Results :

Tests run: 1, Failures: 0, Errors: 0, Skipped: 0
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="13624350" author="lhofhansl" created="Sat, 6 Apr 2013 05:37:10 +0000"  >&lt;p&gt;You feel good about this one, Jeffrey?&lt;/p&gt;</comment>
                            <comment id="13624353" author="jeffreyz" created="Sat, 6 Apr 2013 05:57:52 +0000"  >&lt;p&gt;Yeah. So far all test failures(relating/unrelating to this patch) found in tests of this patch are fixed in this patch or other patches. For example, a recent flaky test case failure &lt;a href=&quot;http://54.241.6.143/job/HBase-0.94/org.apache.hbase$hbase/60/testReport/junit/org.apache.hadoop.hbase.regionserver/TestRSKilledWhenMasterInitializing/testCorrectnessWhenMasterFailOver/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://54.241.6.143/job/HBase-0.94/org.apache.hbase$hbase/60/testReport/junit/org.apache.hadoop.hbase.regionserver/TestRSKilledWhenMasterInitializing/testCorrectnessWhenMasterFailOver/&lt;/a&gt; should be also fixed.&lt;/p&gt;

&lt;p&gt;I&apos;ll run more rounds of test suite through the weekend to really make it as solid as possible.&lt;/p&gt;</comment>
                            <comment id="13624568" author="jeffreyz" created="Sun, 7 Apr 2013 01:29:53 +0000"  >&lt;p&gt;I have run the whole test suite with the patch 4 times in a row. Three are clean as following and one with single failure happened in recent builds as well.&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
Results :
Tests run: 1339, Failures: 0, Errors: 0, Skipped: 13

Integration Test: IntegrationTestDataIngestWithChaosMonkey
Tests run: 1, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 905.014 sec
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;I also provided a release note in the JIRA.&lt;/p&gt;</comment>
                            <comment id="13624572" author="zjushch" created="Sun, 7 Apr 2013 01:42:50 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=jeffreyz&quot; class=&quot;user-hover&quot; rel=&quot;jeffreyz&quot;&gt;Jeffrey Zhong&lt;/a&gt;&lt;br/&gt;
IMO, it is still able to cause META data loss as I mentioned in &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-8251&quot; title=&quot;enable SSH before assign META on Master startup&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-8251&quot;&gt;&lt;del&gt;HBASE-8251&lt;/del&gt;&lt;/a&gt;:&lt;br/&gt;
1.Assign ROOT to the RS where META on&lt;br/&gt;
2.Enable SSH for ROOT&lt;br/&gt;
3.Assign META&lt;/p&gt;

&lt;p&gt;If the META RS(it is also the ROOT RS) is dead between step2 and step3, MetaSSH start splitting its hlog.&lt;br/&gt;
However step3 will assign META directly(Because HMaster#splitLogAndExpireIfOnline will return null), it means META will loss the data from hlog.&lt;/p&gt;

&lt;p&gt;Correct me if wrong, thanks&lt;/p&gt;</comment>
                            <comment id="13624583" author="jeffreyz" created="Sun, 7 Apr 2013 01:55:19 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=zjushch&quot; class=&quot;user-hover&quot; rel=&quot;zjushch&quot;&gt;chunhui shen&lt;/a&gt; The patch already covered the case you mentioned. You can check both v7 &amp;amp; v8 patch. The reason I don&apos;t mention the scenario in the above suggestion is to make the idea easier to be accepted.&lt;/p&gt;

&lt;p&gt;Yesterday I replied you on hbase-8251 for ROOT &amp;amp; META collocating on one RS scenario. You can check details at MetaSSH in the patch. Basically we only recover ROOT portion and leave META part till master meta assignment completes. Below is related pseudo code snippet, please let me know if you have more questions. Thanks.&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
      ...
      re-assign root
      ... 
      
      &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt;(!&lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt;.services.isServerShutdownHandlerEnabled()) {
        &lt;span class=&quot;code-comment&quot;&gt;// resubmit in &lt;span class=&quot;code-keyword&quot;&gt;case&lt;/span&gt; we&apos;re in master initialization and SSH hasn&apos;t been enabled yet.
&lt;/span&gt;        &lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt;.services.getExecutorService().submit(&lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt;);
        &lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt;.deadServers.add(serverName);
        &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt;;
      }
      ...
      re-assign meta
      ...
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="13624587" author="zjushch" created="Sun, 7 Apr 2013 02:03:50 +0000"  >&lt;p&gt;I think your patch couldn&apos;t fix the problem.&lt;/p&gt;

&lt;p&gt;As the above mentioned case, I have two question.&lt;/p&gt;

&lt;p&gt;1.What will the master initialization thread do when assigning META&lt;br/&gt;
2.What is the value of isCarryingMeta in ServerManager#expireServer&#65292; I think it&apos;s false rather than true&lt;/p&gt;</comment>
                            <comment id="13624596" author="jeffreyz" created="Sun, 7 Apr 2013 02:39:52 +0000"  >&lt;p&gt;Let me add more clarifications to your first comments to see if you agree firstly:&lt;/p&gt;

&lt;blockquote&gt;
&lt;p&gt;If the META RS(it is also the ROOT RS) is dead between step2 and step3, MetaSSH start splitting its hlog.&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;The root recovery portion in Meta SSH will complete log splitting for both ROOT and META regions. Therefore, all recovered edits files are created before Meta region can be assigned because meta region can only be assigned only when ROOT is online. By then, all recovered edits files are created and they will be replayed when meta region is opened during assignment.&lt;/p&gt;

&lt;blockquote&gt;
&lt;p&gt;However step3 will assign META directly(Because HMaster#splitLogAndExpireIfOnline will return null), it means META will loss the data from hlog.&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;This is all right because the existing log splitting work has already be done and will be replayed during META region open phase.&lt;/p&gt;

&lt;p&gt;Thanks for your feedbacks.&lt;/p&gt;
</comment>
                            <comment id="13624602" author="zjushch" created="Sun, 7 Apr 2013 03:12:37 +0000"  >&lt;blockquote&gt;&lt;p&gt;Therefore, all recovered edits files are created before Meta region can be assigned because meta region can only be assigned only when ROOT is online.&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;We can open the META region on RS when ROOT is offline. &lt;br/&gt;
How about if ROOT RS is killed between getMetaLocationOrReadLocationFromRoot and assignMeta?&lt;/p&gt;</comment>
                            <comment id="13624604" author="zjushch" created="Sun, 7 Apr 2013 03:13:47 +0000"  >&lt;p&gt;It means META region is opening on the RS before SSH completed log-split&lt;/p&gt;</comment>
                            <comment id="13624612" author="jeffreyz" created="Sun, 7 Apr 2013 03:37:20 +0000"  >&lt;blockquote&gt;
&lt;p&gt;We can open the META region on RS when ROOT is offline. &lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;We need updated META location in ROOT RS when META region is opening on a newly assigned RS. Is that true? Therefore, a ROOT RS has to be online for a successful META assignment.&lt;/p&gt;

&lt;p&gt;So the open will fail even if META region can be opened but no one can access it because root is offline and the old location isn&apos;t updated to the newly assigned location. Later Meta region will be re-assigned by MetaSSH.&lt;/p&gt;</comment>
                            <comment id="13624622" author="zjushch" created="Sun, 7 Apr 2013 03:50:08 +0000"  >&lt;blockquote&gt;&lt;p&gt;So the open will fail even if META region can be opened but no one can access it because root is offline&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;We will retry if fail to update META location in ROOT RS.&lt;br/&gt;
Root will be online finally, however Meta region won&apos;t be re-assigned.&lt;/p&gt;</comment>
                            <comment id="13624730" author="jeffreyz" created="Sun, 7 Apr 2013 05:39:28 +0000"  >&lt;blockquote&gt;
&lt;p&gt;We will retry if fail to update META location in ROOT RS.&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;Are you referring to HTable.put internal retries? It seems that in high level you agreed to my pervious statements. &lt;/p&gt;

&lt;p&gt;Let&apos;s go back to the possible scenario you mentioned above that a root RS crashed after getMetaLocationOrReadLocationFromRoot. Since ZK session timeout take a while, HMaster#splitLogAndExpireIfOnline will kick in so there won&apos;t be any issue.&lt;/p&gt;

&lt;p&gt;Let&apos;s conclude this issue. I&apos;ll change the patch to the following pesudo-code snippet, are you fine with this adjustment?&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
  ...
  fileSystemManager.splitAllLogs(sn); 
  &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt;(serverManager.isServerOnline(currentMetaServer)){
    expire(currentMetaServer);
  }
  ...
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
</comment>
                            <comment id="13624740" author="zjushch" created="Sun, 7 Apr 2013 06:20:36 +0000"  >&lt;blockquote&gt;&lt;p&gt;Since ZK session timeout take a while, HMaster#splitLogAndExpireIfOnline will kick in so there won&apos;t be any issue.&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;1.ZK seession will timeout once java process exit.&lt;br/&gt;
2.I think in a complex network we shouldn&apos;t assert that ZK session timeout happen after HMaster#splitLogAndExpireIfOnline. e.g. the return of getMetaLocationOrReadLocationFromRoot is hanged for a little time.&lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;are you fine with this adjustment?&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;Sorry, why do this adjustment?&lt;/p&gt;


&lt;p&gt;In addition, is it only for 0.94, no trunk?  If trunk only, I think there is no above trouble since ROOT has dropped in trunk&lt;/p&gt;</comment>
                            <comment id="13624751" author="jeffreyz" created="Sun, 7 Apr 2013 06:38:08 +0000"  >&lt;p&gt;It&apos;s only for 0.94 and the adjustment is guaranteed that splitLog will happen right before &lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;assignmentManager.assignMeta();&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt; just like before to deal with the possible data loss issue you mentioned. &lt;/p&gt;


</comment>
                            <comment id="13624757" author="ram_krish" created="Sun, 7 Apr 2013 06:58:22 +0000"  >&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
   ServerName currentMetaServer = &lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt;.catalogTracker.getMetaLocationOrReadLocationFromRoot();
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;This is read in two places. One in finishInitialization() and the other inside assignMEta where the META RS is checked with prev ROOT server.&lt;br/&gt;
Can we check this only once and then make the pseudo code change as above  mentioned by Jeffrey?&lt;/p&gt;</comment>
                            <comment id="13624769" author="jeffreyz" created="Sun, 7 Apr 2013 07:15:22 +0000"  >&lt;p&gt;I pasted the whole related code snippet as below. Ram&apos;s suggestion is possible because no one re-assign META till assignmentManager.assignMeta(). The modified logic is same as before the patch.   &lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
      ...
      ServerName currentMetaServer = &lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt;.catalogTracker.getMetaLocationOrReadLocationFromRoot();
      &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (currentMetaServer != &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt; &amp;amp;&amp;amp; !currentMetaServer.equals(previousRootServer)) {
        fileSystemManager.splitAllLogs(currentMetaServer);
        &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (&lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt;.serverManager.isServerOnline(currentMetaServer)) {
          &lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt;.serverManager.expireServer(currentMetaServer);
        }
      }
      assignmentManager.assignMeta();
      enableSSHandWaitForMeta();
      ...
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="13624788" author="zjushch" created="Sun, 7 Apr 2013 08:28:19 +0000"  >&lt;blockquote&gt;&lt;p&gt;fileSystemManager.splitAllLogs(currentMetaServer);&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;Should we take care of log-split concurrency between master initialization thread and SSH&#65311;&lt;/p&gt;</comment>
                            <comment id="13624789" author="jeffreyz" created="Sun, 7 Apr 2013 08:35:37 +0000"  >&lt;p&gt;Yep, I&apos;ve taken care of that. Basically, synchronized log split tasks before SSH is enabled. Once you agree the approach in general, I&apos;ll submit the modified patch for review.&lt;/p&gt;

&lt;p&gt;A question through: Should we do expireServer firstly and then do log splitting after we have the log splitting synchronization mechanism before SSH is enabled.&lt;/p&gt;</comment>
                            <comment id="13624792" author="zjushch" created="Sun, 7 Apr 2013 08:52:31 +0000"  >&lt;blockquote&gt;&lt;p&gt;log splitting synchronization mechanism before SSH is enabled&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;Yes, it&apos;s a solution.  &lt;/p&gt;

&lt;p&gt;What&apos;s the difference if do expireServer firstly? None? &lt;br/&gt;
Go as your thought&lt;/p&gt;</comment>
                            <comment id="13624963" author="jeffreyz" created="Sun, 7 Apr 2013 16:47:22 +0000"  >&lt;p&gt;Make sure splitLog happen once before we assign Meta to address data loss concern from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=zjushch&quot; class=&quot;user-hover&quot; rel=&quot;zjushch&quot;&gt;chunhui shen&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Thanks &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=zjushch&quot; class=&quot;user-hover&quot; rel=&quot;zjushch&quot;&gt;chunhui shen&lt;/a&gt; for the reviewing!&lt;/p&gt;</comment>
                            <comment id="13625026" author="jeffreyz" created="Sun, 7 Apr 2013 21:43:36 +0000"  >&lt;p&gt;Test result for v9 patch:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
Test Suite Results :

Tests run: 1339, Failures: 0, Errors: 0, Skipped: 13

Integration: IntegrationTestDataIngestWithChaosMonkey

Tests run: 1, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 353.049 sec
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="13625088" author="zjushch" created="Mon, 8 Apr 2013 02:17:19 +0000"  >&lt;p&gt;Minor comments:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;+   * @param previousRootServer ServerName of previous root region server before current start up
+   * @&lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt;
+   * @&lt;span class=&quot;code-keyword&quot;&gt;throws&lt;/span&gt; InterruptedException&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;remove @return&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
+        } &lt;span class=&quot;code-keyword&quot;&gt;catch&lt;/span&gt; (Exception ex) {
+          LOG.warn(&lt;span class=&quot;code-quote&quot;&gt;&quot;Retry setClusterDown failed&quot;&lt;/span&gt;, ex);
+        }
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;LOG.error seems more reasonable since using error before&lt;/p&gt;

&lt;p&gt;Some doubt:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
+      &lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt;.fileSystemManager.splitAllLogs(preRootServer);
+      &lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt;.fileSystemManager.splitAllLogs(preMetaServer);
+        fileSystemManager.splitAllLogs(currentMetaServer);
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;Should use the flag &apos;shouldSplitMetaSeparately&apos; like other log-split?&lt;/p&gt;

&lt;p&gt;In master#finishInitialization, after handling other dead servers in SSH, we will call assignmentManager.joinCluster(), it seems have some problems, e.g.&lt;br/&gt;
1.in AssignmentManager#processDeadServersAndRegionsInTransition, how about if we mark it as a clean cluster startup?&lt;br/&gt;
2.if we mark it as a failover, is there any conflict between SSH and AssignmentManager#processDeadServersAndRecoverLostRegions&lt;/p&gt;

&lt;p&gt;An important attention:&lt;br/&gt;
From DeadServer#cleanPreviousInstance, a deadserver will be removed if the same HostnamePort servername is online.&lt;br/&gt;
It means a server will not belong to deadservers even if it is processed in SSH.&lt;/p&gt;</comment>
                            <comment id="13625509" author="jeffreyz" created="Mon, 8 Apr 2013 16:22:25 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=zjushch&quot; class=&quot;user-hover&quot; rel=&quot;zjushch&quot;&gt;chunhui shen&lt;/a&gt; Thanks for the detailed reviewing!&lt;/p&gt;

&lt;p&gt;For your first two comments, I&apos;ll make corresponding modifications.&lt;/p&gt;

&lt;blockquote&gt;
&lt;p&gt;Should use the flag &apos;shouldSplitMetaSeparately&apos; like other log-split?&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;A good question. Since splitLog is a sync call, the following two calls &lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
      fileSystemManager.splitMetaLog(sn);
      fileSystemManager.splitLog(sn);
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;are logically equivalent to one splitAllLogs call while splitAllLogs has a little bit performance advantage because it submits all log splitting logs in one go. &apos;shouldSplitMetaSeparately&apos; is significant in MetaSSH and SSH while in other places there is no difference logically. &lt;br/&gt;
Being said that, in some places I could take advantage by separating them to improve a little bit more on master start up. As you know both features are new, so I choose conservative way in the beginning and make them less dependent on each other.&lt;/p&gt;

&lt;blockquote&gt;
&lt;p&gt;in AssignmentManager#processDeadServersAndRegionsInTransition, how about if we mark it as a clean cluster startup?&lt;br/&gt;
if we mark it as a failover, is there any conflict between SSH and AssignmentManager#processDeadServersAndRecoverLostRegions&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;If we have left log splitting work, it means that the new master start up isn&apos;t a clean one. The reason to make it a failover is to let SSH(single place) to handle dead servers including the log splitting we skipped at the very beginning. If we make the start up as a clean one, we could have data loss as log splitting won&apos;t be done for some regions. &lt;br/&gt;
During the AssignmentManager#processDeadServersAndRecoverLostRegions, there are existing implementations intentionally skipping all known dead servers and leave them to SSH so there is no conflict.&lt;/p&gt;

&lt;blockquote&gt;
&lt;p&gt;From DeadServer#cleanPreviousInstance, a deadserver will be removed if the same HostnamePort servername is online. &lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;Good concern. The key point is that DeadServer#cleanPreviousInstance will be only called after master initialization. By then, we don&apos;t rely on DeadServer much as far as master start up concerns. After master is initialized, DeadServer is basically used in UI to show previously dead servers, &quot;YouAreDeadException&quot; handling and prevent duplicated expireServer calls. As you already know, once a dead server SSH is submitted, it will continue till it&apos;s done regardless if it&apos;s in the DeadServer or not. This could happen today when a RS crashed sequentially while its previous instances are still in SSH pipe no matter if DeadServer tracks them or not. In short, DeadServer#cleanPreviousInstance doesn&apos;t have much impact.&lt;/p&gt;</comment>
                            <comment id="13625592" author="ram_krish" created="Mon, 8 Apr 2013 17:49:38 +0000"  >&lt;p&gt;waitingOnLogSplitting - waitOnLogSplitting may be better.&lt;/p&gt;
&lt;blockquote&gt;&lt;p&gt;this.catalogTracker.getMetaLocationOrReadLocationFromRoot();&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;Is it ok to call this in one place as per my yesterday&apos;s comment.&lt;br/&gt;
If root went down after &lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
&lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt;.initializationBeforeMetaAssignment = &lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;we call assignRoot.  when we try to split the log we will not do that because SSH is not yet enabled.&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
    &lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt;.assignmentManager.assignRoot();
      waitForRootAssignment();
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;So we expect that though the above step waits, we do &lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
&lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt;.serverManager.enableSSHForRoot();
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;Which will do the assignment? Still sshEnabled is not true right?&lt;br/&gt;
Things look fine but still this area is really a big head ache.  Removal of ROOT in trunk is a blessing for developers now.&lt;br/&gt;
I think if you are confident on the above comments then let us go for a commit and address if future issues.  Else we are good.&lt;/p&gt;

&lt;p&gt;Good stuff Jeff, Everytime I feel that something may be missed out in this area.&lt;br/&gt;
@Chunhui&lt;br/&gt;
What do you feel?&lt;/p&gt;</comment>
                            <comment id="13625628" author="jeffreyz" created="Mon, 8 Apr 2013 18:19:07 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=ram_krish&quot; class=&quot;user-hover&quot; rel=&quot;ram_krish&quot;&gt;ramkrishna.s.vasudevan&lt;/a&gt; Thanks for the reviewing!&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;Is it ok to call this in one place as per my yesterday&apos;s comment.&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;The change was missed and I&apos;ll make sure it&apos;s in the next patch.&lt;/p&gt;

&lt;blockquote&gt;
&lt;p&gt;Which will do the assignment? Still sshEnabled is not true right?&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;A very good point. In very rare case I did see tests failed tue to this. If no objections, I can move the enableSSHForRoot right after assignRoot(); to close the loophole following the same pattern we do for metaAssignment.&lt;/p&gt;
</comment>
                            <comment id="13626062" author="jeffreyz" created="Tue, 9 Apr 2013 01:15:49 +0000"  >&lt;p&gt;Submit v10 patch to incorporate feedbacks from Chunhui and Ram.&lt;/p&gt;

&lt;p&gt;After I moved enableSSHForRoot() right after rootAssignment. I can run TestMasterFailover 10 times in a loop successfully while there may be one failure before.&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
Test Suite Result:

Tests run: 1339, Failures: 0, Errors: 0, Skipped: 13

Integration Test: IntegrationTestDataIngestWithChaosMonkey

Tests run: 1, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 662.064 sec
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="13626118" author="zjushch" created="Tue, 9 Apr 2013 02:10:14 +0000"  >&lt;p&gt;As ram saied, things are easy to be missed out in this area...&lt;/p&gt;

&lt;p&gt;Patch v10 seems good for me.&lt;/p&gt;</comment>
                            <comment id="13626131" author="zjushch" created="Tue, 9 Apr 2013 02:20:57 +0000"  >&lt;p&gt;Maybe I have realized one bug case.&lt;br/&gt;
Suppose Master,RS1,RS2&lt;br/&gt;
1.kill master and RS1&lt;br/&gt;
2.start master and RS1&lt;br/&gt;
3.master start SSH to process dead server RS1 when initialization&lt;br/&gt;
4.RS1 is not in dead server since a new RS1 is online&lt;br/&gt;
5.AssignmentManager#joinCluster rebuild user regions, return the dead server RS1 and its regions&lt;br/&gt;
6.AssignmentManager#processDeadServersAndRecoverLostRegions will assign the regions carried by RS1&lt;br/&gt;
7.However hlogs of RS1 is still being split by SSH, it means data loss since we assign region in step6 before completing log-split&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=jeffreyz&quot; class=&quot;user-hover&quot; rel=&quot;jeffreyz&quot;&gt;Jeffrey Zhong&lt;/a&gt;&lt;br/&gt;
Please take a check, correct me if wrong&lt;/p&gt;</comment>
                            <comment id="13626182" author="jeffreyz" created="Tue, 9 Apr 2013 03:31:45 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=zjushch&quot; class=&quot;user-hover&quot; rel=&quot;zjushch&quot;&gt;chunhui shen&lt;/a&gt; Could you please clarify RS1 online state from step 4 to step 6? Thanks.&lt;/p&gt;

&lt;p&gt;In step4, RS1 is recorded as online by Master while in step 5 we return RS1 as dead. AM#rebuildUserRegions only returns dead servers which are not contained in online servers. &lt;br/&gt;
Since AssignmentManager#processDeadServersAndRecoverLostRegions skips all dead servers for region assignment, it seems you&apos;re suggesting RS1 online again in step 6.&lt;/p&gt;</comment>
                            <comment id="13626185" author="zjushch" created="Tue, 9 Apr 2013 03:41:30 +0000"  >&lt;p&gt;RS1,001 is dead server &lt;br/&gt;
RS1,002 is online server&lt;/p&gt;

&lt;p&gt;where 001 and 002 represents the start code of regionserver&lt;/p&gt;

&lt;p&gt;RS1,001 is being processed by SSH and also marked as dead server in AM#rebuildUserRegions.&lt;/p&gt;

&lt;p&gt;However, RS1,001 is not included in ServerManager#getDeadServers, so AssignmentManager#processDeadServersAndRecoverLostRegions won&apos;t skip this server&lt;/p&gt;</comment>
                            <comment id="13626221" author="jeffreyz" created="Tue, 9 Apr 2013 04:46:07 +0000"  >&lt;p&gt;The following clarifications might help:&lt;/p&gt;

&lt;p&gt;During Master starts up, function getFailedServersFromLogFolders will return (rs1,001) as part of failedServers. Because start code is part of server name so does hlog file path. Before AM.joinCluser(), the following code in HMaster#finishInitialization will put (rs1,001) into deadservers. &lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
    status.setStatus(&lt;span class=&quot;code-quote&quot;&gt;&quot;Submit log splitting work of non-meta region servers&quot;&lt;/span&gt;);
    &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; (ServerName curServer : failedServers) {
      &lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt;.serverManager.expireServer(curServer);
    }
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
</comment>
                            <comment id="13626226" author="zjushch" created="Tue, 9 Apr 2013 04:53:43 +0000"  >&lt;blockquote&gt;&lt;p&gt;HMaster#finishInitialization will put (rs1,001) into deadservers. &lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;Yes, it&apos;s so.&lt;br/&gt;
But (rs1,001) will be removed from deadservers by DeadServer#cleanPreviousInstance, you could take a see about its call hierarchy.&lt;/p&gt;

&lt;p&gt;I have poined this in the above comment:&lt;br/&gt;
From DeadServer#cleanPreviousInstance, a deadserver will be removed if the same HostnamePort servername is online.&lt;br/&gt;
It means a server will not belong to deadservers even if it is being processed in SSH. &lt;/p&gt;</comment>
                            <comment id="13626232" author="jeffreyz" created="Tue, 9 Apr 2013 05:02:18 +0000"  >&lt;p&gt;I&apos;m about to send additional notes about DeadServer#cleanPreviousInstance. I think it may help to solve all the confusions:&lt;/p&gt;

&lt;p&gt;1) The above steps including AM#JoinCluster are before master.initialized becomes true.&lt;br/&gt;
2) Inside function ServerManager#checkIsDead &lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
    &lt;span class=&quot;code-comment&quot;&gt;// remove dead server with same hostname and port of newly checking in rs after master
&lt;/span&gt;    &lt;span class=&quot;code-comment&quot;&gt;// initialization.See HBASE-5916 &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; more information.
&lt;/span&gt;    &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; ((&lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt;.services == &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt; || ((HMaster) &lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt;.services).isInitialized())
        &amp;amp;&amp;amp; &lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt;.deadservers.cleanPreviousInstance(serverName)) {
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;You can see this.deadservers.cleanPreviousInstance won&apos;t do anything because master is NOT initialized yet.&lt;/p&gt;</comment>
                            <comment id="13626250" author="zjushch" created="Tue, 9 Apr 2013 05:33:50 +0000"  >&lt;p&gt;Good point, I&apos;m clear about this now, thanks.&lt;/p&gt;</comment>
                            <comment id="13626251" author="zjushch" created="Tue, 9 Apr 2013 05:35:05 +0000"  >&lt;p&gt;+1 from me&lt;/p&gt;</comment>
                            <comment id="13626261" author="stack" created="Tue, 9 Apr 2013 05:51:09 +0000"  >&lt;p&gt;Quality works lads (Jeffrey, Ram, and Chunhui).&lt;/p&gt;</comment>
                            <comment id="13626820" author="yuzhihong@gmail.com" created="Tue, 9 Apr 2013 17:02:09 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=lhofhansl&quot; class=&quot;user-hover&quot; rel=&quot;lhofhansl&quot;&gt;Lars Hofhansl&lt;/a&gt;, &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=ram_krish&quot; class=&quot;user-hover&quot; rel=&quot;ram_krish&quot;&gt;ramkrishna.s.vasudevan&lt;/a&gt;:&lt;br/&gt;
Do you have further review comments ?&lt;/p&gt;</comment>
                            <comment id="13627506" author="ram_krish" created="Wed, 10 Apr 2013 05:36:59 +0000"  >&lt;p&gt;If above Chunhui&apos;s comments are fixed and i see that latest patch V10 has the changes incorporated +1 on the patch. Thanks Jeffrey, continuous persisted efforts on this JIRA.&lt;br/&gt;
Thanks to Chunhui for good reviews.&lt;/p&gt;</comment>
                            <comment id="13628024" author="jeffreyz" created="Wed, 10 Apr 2013 17:37:36 +0000"  >&lt;p&gt;Many thanks to Ram, Chunhui and Rajesh for the latest reviews! &lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=lhofhansl&quot; class=&quot;user-hover&quot; rel=&quot;lhofhansl&quot;&gt;Lars Hofhansl&lt;/a&gt; Are you all right to check the patch v10 in? Thanks.&lt;/p&gt;</comment>
                            <comment id="13628389" author="lhofhansl" created="Wed, 10 Apr 2013 22:53:11 +0000"  >&lt;p&gt;Patch looks good (although I didn&apos;t have time for a detailed review)&lt;br/&gt;
+1&lt;/p&gt;</comment>
                            <comment id="13628401" author="yuzhihong@gmail.com" created="Wed, 10 Apr 2013 23:01:12 +0000"  >&lt;p&gt;Integrated to 0.94&lt;/p&gt;

&lt;p&gt;Thanks for the continued effort, Jeff.&lt;/p&gt;

&lt;p&gt;Thanks for the reviews, Ram, Chunhui and Rajesh.&lt;/p&gt;</comment>
                            <comment id="13628721" author="hudson" created="Thu, 11 Apr 2013 06:42:59 +0000"  >&lt;p&gt;Integrated in HBase-0.94 #955 (See &lt;a href=&quot;https://builds.apache.org/job/HBase-0.94/955/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/HBase-0.94/955/&lt;/a&gt;)&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-7824&quot; title=&quot;Improve master start up time when there is log splitting work&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-7824&quot;&gt;&lt;del&gt;HBASE-7824&lt;/del&gt;&lt;/a&gt; Improve master start up time when there is log splitting work (Jeffrey Zhong) (Revision 1466725)&lt;/p&gt;

&lt;p&gt;     Result = SUCCESS&lt;br/&gt;
tedyu : &lt;br/&gt;
Files : &lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/hbase/branches/0.94/src/main/java/org/apache/hadoop/hbase/catalog/CatalogTracker.java&lt;/li&gt;
	&lt;li&gt;/hbase/branches/0.94/src/main/java/org/apache/hadoop/hbase/master/HMaster.java&lt;/li&gt;
	&lt;li&gt;/hbase/branches/0.94/src/main/java/org/apache/hadoop/hbase/master/MasterFileSystem.java&lt;/li&gt;
	&lt;li&gt;/hbase/branches/0.94/src/main/java/org/apache/hadoop/hbase/master/ServerManager.java&lt;/li&gt;
	&lt;li&gt;/hbase/branches/0.94/src/main/java/org/apache/hadoop/hbase/master/handler/MetaServerShutdownHandler.java&lt;/li&gt;
	&lt;li&gt;/hbase/branches/0.94/src/main/java/org/apache/hadoop/hbase/master/handler/ServerShutdownHandler.java&lt;/li&gt;
	&lt;li&gt;/hbase/branches/0.94/src/main/java/org/apache/hadoop/hbase/regionserver/HRegionServer.java&lt;/li&gt;
	&lt;li&gt;/hbase/branches/0.94/src/main/java/org/apache/hadoop/hbase/zookeeper/ZooKeeperNodeTracker.java&lt;/li&gt;
	&lt;li&gt;/hbase/branches/0.94/src/test/java/org/apache/hadoop/hbase/MiniHBaseCluster.java&lt;/li&gt;
	&lt;li&gt;/hbase/branches/0.94/src/test/java/org/apache/hadoop/hbase/master/TestDistributedLogSplitting.java&lt;/li&gt;
	&lt;li&gt;/hbase/branches/0.94/src/test/java/org/apache/hadoop/hbase/master/TestMasterFailover.java&lt;/li&gt;
	&lt;li&gt;/hbase/branches/0.94/src/test/java/org/apache/hadoop/hbase/regionserver/TestRSKilledWhenMasterInitializing.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="13629770" author="hudson" created="Fri, 12 Apr 2013 04:15:22 +0000"  >&lt;p&gt;Integrated in HBase-0.94-security #134 (See &lt;a href=&quot;https://builds.apache.org/job/HBase-0.94-security/134/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/HBase-0.94-security/134/&lt;/a&gt;)&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-7824&quot; title=&quot;Improve master start up time when there is log splitting work&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-7824&quot;&gt;&lt;del&gt;HBASE-7824&lt;/del&gt;&lt;/a&gt; Improve master start up time when there is log splitting work (Jeffrey Zhong) (Revision 1466725)&lt;/p&gt;

&lt;p&gt;     Result = FAILURE&lt;br/&gt;
tedyu : &lt;br/&gt;
Files : &lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/hbase/branches/0.94/src/main/java/org/apache/hadoop/hbase/catalog/CatalogTracker.java&lt;/li&gt;
	&lt;li&gt;/hbase/branches/0.94/src/main/java/org/apache/hadoop/hbase/master/HMaster.java&lt;/li&gt;
	&lt;li&gt;/hbase/branches/0.94/src/main/java/org/apache/hadoop/hbase/master/MasterFileSystem.java&lt;/li&gt;
	&lt;li&gt;/hbase/branches/0.94/src/main/java/org/apache/hadoop/hbase/master/ServerManager.java&lt;/li&gt;
	&lt;li&gt;/hbase/branches/0.94/src/main/java/org/apache/hadoop/hbase/master/handler/MetaServerShutdownHandler.java&lt;/li&gt;
	&lt;li&gt;/hbase/branches/0.94/src/main/java/org/apache/hadoop/hbase/master/handler/ServerShutdownHandler.java&lt;/li&gt;
	&lt;li&gt;/hbase/branches/0.94/src/main/java/org/apache/hadoop/hbase/regionserver/HRegionServer.java&lt;/li&gt;
	&lt;li&gt;/hbase/branches/0.94/src/main/java/org/apache/hadoop/hbase/zookeeper/ZooKeeperNodeTracker.java&lt;/li&gt;
	&lt;li&gt;/hbase/branches/0.94/src/test/java/org/apache/hadoop/hbase/MiniHBaseCluster.java&lt;/li&gt;
	&lt;li&gt;/hbase/branches/0.94/src/test/java/org/apache/hadoop/hbase/master/TestDistributedLogSplitting.java&lt;/li&gt;
	&lt;li&gt;/hbase/branches/0.94/src/test/java/org/apache/hadoop/hbase/master/TestMasterFailover.java&lt;/li&gt;
	&lt;li&gt;/hbase/branches/0.94/src/test/java/org/apache/hadoop/hbase/regionserver/TestRSKilledWhenMasterInitializing.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10032">
                    <name>Blocker</name>
                                                                <inwardlinks description="is blocked by">
                                        <issuelink>
            <issuekey id="12637408">HBASE-8127</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                            <issuelinktype id="12310000">
                    <name>Duplicate</name>
                                            <outwardlinks description="duplicates">
                                        <issuelink>
            <issuekey id="12640445">HBASE-8251</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                                                <inwardlinks description="is related to">
                                        <issuelink>
            <issuekey id="12635043">HBASE-7985</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12577669" name="hbase-7824-v10.patch" size="51008" author="jeffreyz" created="Tue, 9 Apr 2013 01:15:49 +0000"/>
                            <attachment id="12577306" name="hbase-7824-v7.patch" size="48275" author="jeffreyz" created="Fri, 5 Apr 2013 22:29:03 +0000"/>
                            <attachment id="12577360" name="hbase-7824-v8.patch" size="48292" author="jeffreyz" created="Sat, 6 Apr 2013 05:26:04 +0000"/>
                            <attachment id="12577455" name="hbase-7824-v9.patch" size="49782" author="jeffreyz" created="Sun, 7 Apr 2013 16:47:22 +0000"/>
                            <attachment id="12570544" name="hbase-7824.patch" size="30095" author="jeffreyz" created="Fri, 22 Feb 2013 22:11:26 +0000"/>
                            <attachment id="12570581" name="hbase-7824_v2.patch" size="30112" author="jeffreyz" created="Sat, 23 Feb 2013 01:26:24 +0000"/>
                            <attachment id="12573408" name="hbase-7824_v3.patch" size="31425" author="jeffreyz" created="Tue, 12 Mar 2013 20:35:34 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>7.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Fri, 22 Feb 2013 22:18:14 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>312346</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310191" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                        <customfieldname>Hadoop Flags</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10343"><![CDATA[Reviewed]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            3 years, 34 weeks, 1 day ago
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i1hwhr:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>312692</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310192" key="com.atlassian.jira.plugin.system.customfieldtypes:textarea">
                        <customfieldname>Release Note</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Master now won&amp;#39;t wait for existing or previously left log splitting work(except for ROOT and META region servers) finish before it can start up. Sometimes log splitting work could take more than minutes. In normal case, master node starts much faster than before when there is region server recovery work going on. The feature can be disabled by setting configuration value &amp;quot;&amp;quot;hbase.master.wait.for.log.splitting&amp;quot; to true.(default value is false)</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        </customfields>
    </item>
</channel>
</rss>