<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Thu Dec 01 21:44:49 UTC 2016

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/HBASE-16655/HBASE-16655.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[HBASE-16655] hbase backup describe with incorrect backup id results in NPE</title>
                <link>https://issues.apache.org/jira/browse/HBASE-16655</link>
                <project id="12310753" key="HBASE">HBase</project>
                    <description>&lt;p&gt;If the user supplies backup Id which is non-existent, we would get NullPointerException :&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
2016-09-19 10:26:50,771 ERROR [main] backup.BackupDriver(173): Error running command-line tool
java.lang.NullPointerException
  at org.apache.hadoop.hbase.backup.impl.BackupCommands$DescribeCommand.execute(BackupCommands.java:329)
  at org.apache.hadoop.hbase.backup.BackupDriver.parseAndRun(BackupDriver.java:114)
  at org.apache.hadoop.hbase.backup.BackupDriver.doWork(BackupDriver.java:135)
  at org.apache.hadoop.hbase.backup.BackupDriver.run(BackupDriver.java:171)
  at org.apache.hadoop.util.ToolRunner.run(ToolRunner.java:70)
  at org.apache.hadoop.hbase.backup.TestBackupDescribe.testBackupDescribe(TestBackupDescribe.java:67)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</description>
                <environment></environment>
        <key id="13005977">HBASE-16655</key>
            <summary>hbase backup describe with incorrect backup id results in NPE</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/bug.png">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.png">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="yuzhihong@gmail.com">Ted Yu</assignee>
                                    <reporter username="yuzhihong@gmail.com">Ted Yu</reporter>
                        <labels>
                            <label>backup</label>
                    </labels>
                <created>Mon, 19 Sep 2016 17:32:47 +0000</created>
                <updated>Tue, 20 Sep 2016 00:58:37 +0000</updated>
                            <resolved>Mon, 19 Sep 2016 22:03:46 +0000</resolved>
                                                                        <due></due>
                            <votes>0</votes>
                                    <watches>2</watches>
                                                                <comments>
                            <comment id="15504131" author="yuzhihong@gmail.com" created="Mon, 19 Sep 2016 17:50:03 +0000"  >&lt;p&gt;Modified test in TestBackupDescribe for the case of incorrect backup Id.&lt;/p&gt;</comment>
                            <comment id="15504713" author="vrodionov" created="Mon, 19 Sep 2016 21:13:04 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=tedyu&quot; class=&quot;user-hover&quot; rel=&quot;tedyu&quot;&gt;Ted Yu&lt;/a&gt; please keep only &quot;hbase backup describe with incorrect backup id results in NPE&quot; related fix and new test in the patch. I have taken care about the rest (progress / describe with no backupId) in &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-16620&quot; title=&quot;Fix backup command-line tool usability issues&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-16620&quot;&gt;&lt;del&gt;HBASE-16620&lt;/del&gt;&lt;/a&gt; addendum6 patch.&lt;/p&gt;</comment>
                            <comment id="15504765" author="yuzhihong@gmail.com" created="Mon, 19 Sep 2016 21:40:29 +0000"  >&lt;p&gt;Addendum 6 would result in retrieving progress for null backup Id if there is no backup Id specified on the command line:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
&lt;span class=&quot;code-quote&quot;&gt;&quot;main&quot;&lt;/span&gt; #1 prio=5 os_prio=31 tid=0x00007fe493006800 nid=0x1703 waiting on condition [0x0000700000217000]
   java.lang.&lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;.State: TIMED_WAITING (sleeping)
	at java.lang.&lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;.sleep(Native Method)
	at java.lang.&lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;.sleep(&lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;.java:340)
	at java.util.concurrent.TimeUnit.sleep(TimeUnit.java:386)
	at org.apache.hadoop.hbase.util.RetryCounter.sleepUntilNextRetry(RetryCounter.java:158)
	at org.apache.hadoop.hbase.zookeeper.RecoverableZooKeeper.getData(RecoverableZooKeeper.java:373)
	at org.apache.hadoop.hbase.zookeeper.ZKUtil.getData(ZKUtil.java:620)
	at org.apache.hadoop.hbase.zookeeper.MetaTableLocator.getMetaRegionState(MetaTableLocator.java:479)
	at org.apache.hadoop.hbase.zookeeper.MetaTableLocator.getMetaRegionLocation(MetaTableLocator.java:165)
	at org.apache.hadoop.hbase.zookeeper.MetaTableLocator.blockUntilAvailable(MetaTableLocator.java:596)
	at org.apache.hadoop.hbase.zookeeper.MetaTableLocator.blockUntilAvailable(MetaTableLocator.java:577)
	at org.apache.hadoop.hbase.zookeeper.MetaTableLocator.blockUntilAvailable(MetaTableLocator.java:556)
	at org.apache.hadoop.hbase.client.ZooKeeperRegistry.getMetaRegionLocation(ZooKeeperRegistry.java:58)
	at org.apache.hadoop.hbase.client.ConnectionImplementation.locateMeta(ConnectionImplementation.java:765)
	- locked &amp;lt;0x000000078a5e7d48&amp;gt; (a java.lang.&lt;span class=&quot;code-object&quot;&gt;Object&lt;/span&gt;)
	at org.apache.hadoop.hbase.client.ConnectionImplementation.locateRegion(ConnectionImplementation.java:732)
	at org.apache.hadoop.hbase.client.RpcRetryingCallerWithReadReplicas.getRegionLocations(RpcRetryingCallerWithReadReplicas.java:298)
	at org.apache.hadoop.hbase.client.ScannerCallableWithReplicas.call(ScannerCallableWithReplicas.java:156)
	at org.apache.hadoop.hbase.client.ScannerCallableWithReplicas.call(ScannerCallableWithReplicas.java:60)
	at org.apache.hadoop.hbase.client.RpcRetryingCallerImpl.callWithoutRetries(RpcRetryingCallerImpl.java:185)
	at org.apache.hadoop.hbase.client.ClientSmallReversedScanner.loadCache(ClientSmallReversedScanner.java:212)
	at org.apache.hadoop.hbase.client.ClientSmallReversedScanner.next(ClientSmallReversedScanner.java:186)
	at org.apache.hadoop.hbase.client.ConnectionImplementation.locateRegionInMeta(ConnectionImplementation.java:829)
	at org.apache.hadoop.hbase.client.ConnectionImplementation.locateRegion(ConnectionImplementation.java:735)
	at org.apache.hadoop.hbase.client.RpcRetryingCallerWithReadReplicas.getRegionLocations(RpcRetryingCallerWithReadReplicas.java:298)
	at org.apache.hadoop.hbase.client.ScannerCallableWithReplicas.call(ScannerCallableWithReplicas.java:156)
	at org.apache.hadoop.hbase.client.ScannerCallableWithReplicas.call(ScannerCallableWithReplicas.java:60)
	at org.apache.hadoop.hbase.client.RpcRetryingCallerImpl.callWithoutRetries(RpcRetryingCallerImpl.java:185)
	at org.apache.hadoop.hbase.client.ClientScanner.call(ClientScanner.java:311)
	at org.apache.hadoop.hbase.client.ClientScanner.nextScanner(ClientScanner.java:286)
	at org.apache.hadoop.hbase.client.ClientScanner.initializeScannerInConstruction(ClientScanner.java:162)
	at org.apache.hadoop.hbase.client.ClientScanner.&amp;lt;init&amp;gt;(ClientScanner.java:155)
	at org.apache.hadoop.hbase.client.ClientSimpleScanner.&amp;lt;init&amp;gt;(ClientSimpleScanner.java:40)
	at org.apache.hadoop.hbase.client.HTable.getScanner(HTable.java:381)
	at org.apache.hadoop.hbase.backup.impl.BackupSystemTable.getBackupContexts(BackupSystemTable.java:355)
	at org.apache.hadoop.hbase.client.HBaseBackupAdmin.getProgress(HBaseBackupAdmin.java:88)
	at org.apache.hadoop.hbase.backup.impl.BackupCommands$ProgressCommand.execute(BackupCommands.java:367)
	at org.apache.hadoop.hbase.backup.BackupDriver.parseAndRun(BackupDriver.java:114)
	at org.apache.hadoop.hbase.backup.BackupDriver.doWork(BackupDriver.java:135)
	at org.apache.hadoop.hbase.backup.BackupDriver.run(BackupDriver.java:171)
	at org.apache.hadoop.util.ToolRunner.run(ToolRunner.java:70)
	at org.apache.hadoop.hbase.backup.TestBackupCommandLineTool.testBackupDriverProgressHelp(TestBackupCommandLineTool.java:176)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;Let me make a patch that combines addendum 6 and my patch.&lt;/p&gt;</comment>
                            <comment id="15504787" author="yuzhihong@gmail.com" created="Mon, 19 Sep 2016 21:48:22 +0000"  >&lt;p&gt;Patch v3 combines addendum 6 from &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-16620&quot; title=&quot;Fix backup command-line tool usability issues&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-16620&quot;&gt;&lt;del&gt;HBASE-16620&lt;/del&gt;&lt;/a&gt; .&lt;/p&gt;

&lt;p&gt;Vlad:&lt;br/&gt;
I will give you credit when committing the patch.&lt;/p&gt;</comment>
                            <comment id="15504791" author="vrodionov" created="Mon, 19 Sep 2016 21:49:56 +0000"  >&lt;p&gt;Yes, I know. That was intended behavior : if no id specified for progress - we will retrieve this backup id from system table (RUNNING state). But I think this should be changed to default behavior - if no id, then print usage. Go ahead and combine patches, &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=tedyu&quot; class=&quot;user-hover&quot; rel=&quot;tedyu&quot;&gt;Ted Yu&lt;/a&gt;.&lt;/p&gt;</comment>
                            <comment id="15504819" author="yuzhihong@gmail.com" created="Mon, 19 Sep 2016 22:01:30 +0000"  >&lt;p&gt;Both TestBackupCommandLineTool and TestBackupDescribe passed based on patch v3.&lt;/p&gt;</comment>
                            <comment id="15505096" author="vrodionov" created="Tue, 20 Sep 2016 00:06:16 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=tedyu&quot; class=&quot;user-hover&quot; rel=&quot;tedyu&quot;&gt;Ted Yu&lt;/a&gt;, the default behavior of progress command w/o attributes is to lookup current RUNNING backup session from hbase:backup table and present progress info for that session. We need to preserve it, as since, when session is in progress, there is no easy way to get backupID of this session (we return it on a backup completion). &lt;/p&gt;</comment>
                            <comment id="15505118" author="yuzhihong@gmail.com" created="Tue, 20 Sep 2016 00:16:07 +0000"  >&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
  &lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;static&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;final&lt;/span&gt; &lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt; PROGRESS_CMD_USAGE = &lt;span class=&quot;code-quote&quot;&gt;&quot;Usage: hbase backup progress &amp;lt;backupId&amp;gt;\n&quot;&lt;/span&gt;
          + &lt;span class=&quot;code-quote&quot;&gt;&quot; backupId        backup image id\n&quot;&lt;/span&gt;;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;When backup session is in progress, user can obtain backupId from Proc V2 tab of master UI.&lt;/p&gt;</comment>
                            <comment id="15505192" author="yuzhihong@gmail.com" created="Tue, 20 Sep 2016 00:58:35 +0000"  >&lt;p&gt;The addendum allows progress command to retrieve on-going backup session.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12829308" name="16655.addendum" size="4552" author="yuzhihong@gmail.com" created="Tue, 20 Sep 2016 00:58:35 +0000"/>
                            <attachment id="12829241" name="16655.v2.txt" size="5696" author="yuzhihong@gmail.com" created="Mon, 19 Sep 2016 17:56:31 +0000"/>
                            <attachment id="12829278" name="16655.v3.txt" size="7901" author="yuzhihong@gmail.com" created="Mon, 19 Sep 2016 21:48:22 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>3.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Mon, 19 Sep 2016 21:13:04 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310191" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                        <customfieldname>Hadoop Flags</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10343"><![CDATA[Reviewed]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            10 weeks, 2 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i33t1b:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        </customfields>
    </item>
</channel>
</rss>