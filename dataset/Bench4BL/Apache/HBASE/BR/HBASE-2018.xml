<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Sat Dec 03 17:09:50 UTC 2016

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/HBASE-2018/HBASE-2018.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[HBASE-2018] Updates to .META. blocked under high MemStore load</title>
                <link>https://issues.apache.org/jira/browse/HBASE-2018</link>
                <project id="12310753" key="HBASE">HBase</project>
                    <description>&lt;p&gt;I discovered this on Lars&apos; cluster. The symptom was the good old:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
09/11/30 08:10:26 INFO mapred.JobClient: Task Id : attempt_200911250121_0011_r_000010_1, Status : FAILED
org.apache.hadoop.hbase.client.RetriesExhaustedException: Trying to contact region server Some server, retryOnlyOne=&lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;, index=0, islastrow=&lt;span class=&quot;code-keyword&quot;&gt;false&lt;/span&gt;, tries=9, numtries=10, i=14, listsize=20, region=prev-docs,de68fb97795ef3d936a3f10ff8790253,1259573366564 &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; region prev-docs,ccea967e66ccb53d83c48849c3a23f21,1259542138868, row &apos;ccff8cd4ca871c41f4fa7d44cffed962&apos;, but failed after 10 attempts.
Exceptions:
        at org.apache.hadoop.hbase.client.HConnectionManager$TableServers$Batch.process(HConnectionManager.java:1120)
        at org.apache.hadoop.hbase.client.HConnectionManager$TableServers.processBatchOfRows(HConnectionManager.java:1201)
        at org.apache.hadoop.hbase.client.HTable.flushCommits(HTable.java:605)
        at org.apache.hadoop.hbase.client.HTable.put(HTable.java:470)
        at org.apache.hadoop.hbase.mapreduce.TableOutputFormat$TableRecordW
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;But the load wasn&apos;t that heavy, just lots of splitting going on. Looking at the logs, I see a split taking more than 4 minutes which is explained by this happening on the RS hosting .META. :&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
2009-11-30 08:08:39,922 INFO org.apache.hadoop.hbase.regionserver.MemStoreFlusher: Forced flushing of prev-docs,2c9d51e57b20decd5c6419d23ede822b,1259542273901 because global memstore limit of 1.6g exceeded; currently 1.6g and flushing till 1021.9m
...
2009-11-30 08:12:33,743 DEBUG org.apache.hadoop.hbase.regionserver.HRegion: Finished memstore flush of ~22.9m &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; region prev-docs,c8fea4fbbc41e746d960854ed4d41dd6,1259587143838 in 14160ms, sequence id=13677, compaction requested=&lt;span class=&quot;code-keyword&quot;&gt;false&lt;/span&gt;
2009-11-30 08:12:33,744 INFO org.apache.hadoop.hbase.regionserver.MemStoreFlusher: Forced flushing of prev-docs,39c2995d955c041d21f4dc4a0d0dbf6c,1259587061295 because global memstore limit of 1.6g exceeded; currently 1.0g and flushing till 1021.9m
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;So we should not block updates to .META. for any reason. I&apos;m pretty sure this issue explains other issues we&apos;ve seen on the mailing list.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12442002">HBASE-2018</key>
            <summary>Updates to .META. blocked under high MemStore load</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/bug.png">Bug</type>
                                            <priority id="1" iconUrl="https://issues.apache.org/jira/images/icons/priorities/blocker.png">Blocker</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="jdcryans">Jean-Daniel Cryans</assignee>
                                    <reporter username="jdcryans">Jean-Daniel Cryans</reporter>
                        <labels>
                    </labels>
                <created>Mon, 30 Nov 2009 22:32:19 +0000</created>
                <updated>Fri, 12 Oct 2012 06:14:17 +0000</updated>
                            <resolved>Fri, 4 Dec 2009 04:34:31 +0000</resolved>
                                    <version>0.20.2</version>
                                    <fixVersion>0.20.3</fixVersion>
                    <fixVersion>0.90.0</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                <comments>
                            <comment id="12783910" author="jdcryans" created="Mon, 30 Nov 2009 22:39:45 +0000"  >&lt;p&gt;This patch adds a check before calling cacheFlusher.reclaimMemStoreMemory so that we don&apos;t go waiting on the synchronized method if it&apos;s a .META. update. I&apos;m currently running the tests.&lt;/p&gt;</comment>
                            <comment id="12784004" author="apurtell" created="Tue, 1 Dec 2009 01:50:15 +0000"  >&lt;p&gt;+1&lt;/p&gt;

&lt;p&gt;Agree with the issue priority also. &lt;/p&gt;</comment>
                            <comment id="12784033" author="jdcryans" created="Tue, 1 Dec 2009 03:42:28 +0000"  >&lt;p&gt;All the tests pass. I would love if Lars could try out my patch before committing.&lt;/p&gt;</comment>
                            <comment id="12784219" author="larsgeorge" created="Tue, 1 Dec 2009 13:07:24 +0000"  >&lt;p&gt;Testing now, takes a few hours to ramp up through the map phase. Results forthcoming...&lt;/p&gt;</comment>
                            <comment id="12784866" author="larsgeorge" created="Wed, 2 Dec 2009 15:09:24 +0000"  >&lt;p&gt;So testing for me is not going too well. Overall the patch is not harming anything, I say +1. For my testing I am struggling apparently with a too small cluster &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/sad.gif&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;</comment>
                            <comment id="12785175" author="apurtell" created="Thu, 3 Dec 2009 04:25:15 +0000"  >&lt;p&gt;Should this check be for all operations on meta regions, deletes also? See patch -v2. &lt;/p&gt;</comment>
                            <comment id="12785455" author="jdcryans" created="Thu, 3 Dec 2009 19:05:34 +0000"  >&lt;p&gt;New patch makes sense. Also Lars just reported that his job finally was successful (by tweaking other stuff). At least I think this patch covers a very bad corner case.&lt;/p&gt;</comment>
                            <comment id="12785486" author="stack" created="Thu, 3 Dec 2009 20:17:49 +0000"  >&lt;p&gt;+1 on v2 of patch.&lt;/p&gt;</comment>
                            <comment id="12785743" author="apurtell" created="Fri, 4 Dec 2009 04:34:31 +0000"  >&lt;p&gt;Committed -v2 patch to trunk and 0.20 branch.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12426750" name="HBASE-2018-v2.patch" size="2762" author="apurtell" created="Thu, 3 Dec 2009 04:25:15 +0000"/>
                            <attachment id="12426463" name="HBASE-2018.patch" size="1077" author="jdcryans" created="Mon, 30 Nov 2009 22:39:45 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Tue, 1 Dec 2009 01:50:15 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>26102</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310191" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                        <customfieldname>Hadoop Flags</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10343"><![CDATA[Reviewed]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            7 years, 1 week, 1 day ago
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i08t3j:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>49314</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        </customfields>
    </item>
</channel>
</rss>