<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Sat Dec 03 02:41:43 UTC 2016

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/CAMEL-1247/CAMEL-1247.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[CAMEL-1247] SFTP : Polling - Cannot list directory Error</title>
                <link>https://issues.apache.org/jira/browse/CAMEL-1247</link>
                <project id="12311211" key="CAMEL">Camel</project>
                    <description>&lt;p&gt;&lt;a href=&quot;http://www.nabble.com/SFTP-%3A-Polling---Cannot-list-directory-to21413159s22882.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://www.nabble.com/SFTP-%3A-Polling---Cannot-list-directory-to21413159s22882.html&lt;/a&gt;&lt;/p&gt;

</description>
                <environment>&lt;p&gt;Windows Xp&lt;/p&gt;</environment>
        <key id="12486112">CAMEL-1247</key>
            <summary>SFTP : Polling - Cannot list directory Error</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/bug.png">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.png">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="davsclaus">Claus Ibsen</assignee>
                                    <reporter username="watcher">Paddy Daly</reporter>
                        <labels>
                    </labels>
                <created>Mon, 12 Jan 2009 12:18:20 +0000</created>
                <updated>Fri, 31 Jul 2009 06:33:57 +0000</updated>
                            <resolved>Wed, 14 Jan 2009 05:05:12 +0000</resolved>
                                    <version>2.0.0</version>
                                    <fixVersion>2.0-M1</fixVersion>
                                    <component>camel-ftp</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                <comments>
                            <comment id="12950349" author="watcher" created="Tue, 13 Jan 2009 09:34:35 +0000"  >&lt;p&gt;Here&apos;s the log file for the following route&lt;/p&gt;

&lt;p&gt;&amp;lt;endpoint id=&quot;printerSFTP&quot; uri=&quot;sftp://pdaly@127.0.0.1?password=password&amp;amp;binary=true&amp;amp;expression=done/$&lt;/p&gt;
{file:name}
&lt;p&gt;&amp;amp;recursive=true&amp;amp;delay=10000&amp;amp;initialDelay=2000&amp;amp;readLock=rename&amp;amp;knownHostsFile=c://known_host&amp;amp;filter=#myAntFilter&quot;/&amp;gt;&lt;/p&gt;</comment>
                            <comment id="12950343" author="davsclaus" created="Tue, 13 Jan 2009 09:40:49 +0000"  >&lt;p&gt;Thanks for the log. Are you sure its using TRACE. I cant see any TRACE log lines in the file?&lt;/p&gt;

</comment>
                            <comment id="12950356" author="davsclaus" created="Tue, 13 Jan 2009 10:15:03 +0000"  >&lt;p&gt;I think I got it now. Running full unit test with the fix&lt;/p&gt;</comment>
                            <comment id="12950301" author="watcher" created="Tue, 13 Jan 2009 10:33:44 +0000"  >&lt;p&gt;Sorry about that, here you go.&lt;/p&gt;</comment>
                            <comment id="12950355" author="davsclaus" created="Tue, 13 Jan 2009 11:03:42 +0000"  >&lt;p&gt;@Paddy&lt;/p&gt;

&lt;p&gt;I have commited a fix to camel trunk. Would be lovely if you could test it.&lt;/p&gt;

&lt;p&gt;You can wait X hours or how long it takes for Apache INFRA to build and deploy a new SNAPSHOT of Camel 2.0 or you can grab the source and build a camel-ftp jar yourself.&lt;/p&gt;

&lt;p&gt;The fix is in r734095&lt;/p&gt;</comment>
                            <comment id="12950292" author="davsclaus" created="Tue, 13 Jan 2009 11:24:07 +0000"  >&lt;p&gt;This bug does not exists in 1.x&lt;/p&gt;</comment>
                            <comment id="12950334" author="watcher" created="Tue, 13 Jan 2009 12:21:38 +0000"  >&lt;p&gt;Claus &lt;br/&gt;
The StringIndexOutOfBoundsException is fixed however I&apos;m still getting an error.&lt;/p&gt;

&lt;p&gt;Here is my directory structure.&lt;br/&gt;
    c:/folder/printer&lt;br/&gt;
                              /test1&lt;br/&gt;
                                      /incoming&lt;br/&gt;
                                      /outgoing&lt;br/&gt;
                              /test2&lt;br/&gt;
                                      /incoming&lt;br/&gt;
                                      /outgoing&lt;/p&gt;

&lt;p&gt;I&apos;ve set the user pdaly@127.0.0.1 to the root folder of c:/folder/printer&lt;/p&gt;

&lt;p&gt;Here&apos;s the log from the sftp server&lt;/p&gt;


&lt;p&gt;000000001358 2009-01-13 12:11:02.131690 UTC WinSSHD 5.04 &lt;span class=&quot;error&quot;&gt;&amp;#91;111&amp;#93;&lt;/span&gt; Info&lt;br/&gt;
  Session thread 1103 for Windows account &apos;pdaly&apos; from 127.0.0.1:3431:&lt;br/&gt;
  Session channel 1: FlowSfsWin: Closed directory &apos;C:\folder\printer\test1&apos;. Registered 1 successful&lt;br/&gt;
  operation. Listed 3 entries in 1 operation.&lt;/p&gt;

&lt;p&gt;000000001359 2009-01-13 12:11:02.132952 UTC WinSSHD 5.04 &lt;span class=&quot;error&quot;&gt;&amp;#91;118&amp;#93;&lt;/span&gt; Info&lt;br/&gt;
  Session thread 1103 for Windows account &apos;pdaly&apos; from 127.0.0.1:3431:&lt;br/&gt;
  Session channel 1: FlowSfsWin: Reading attributes for &apos;C:\folder\printer\incoming&apos; (follow symlink)&lt;br/&gt;
  failed with NoSuchFile. GetFileAttributes() failed: Windows error 2: The system cannot find the file&lt;br/&gt;
  specified.&lt;/p&gt;

&lt;p&gt;Is there something wrong with my filter&lt;/p&gt;

&lt;p&gt;	&amp;lt;bean id=&quot;myAntFilter&quot; class=&quot;org.apache.camel.component.file.remote.AntPathMatcherRemoteFileFilter&quot;&amp;gt;	   &lt;br/&gt;
	    &amp;lt;property name=&quot;includes&quot; value=&quot;*&lt;b&gt;/incoming/&lt;/b&gt;&quot;/&amp;gt;&lt;br/&gt;
	    &amp;lt;property name=&quot;excludes&quot; value=&quot;*&lt;b&gt;/outgoing/&lt;/b&gt;&quot;/&amp;gt;&lt;br/&gt;
	&amp;lt;/bean&amp;gt;&lt;/p&gt;

&lt;p&gt;above should be&lt;br/&gt;
star star/incoming/star&lt;/p&gt;
</comment>
                            <comment id="12950253" author="davsclaus" created="Tue, 13 Jan 2009 12:29:16 +0000"  >&lt;p&gt;Hi&lt;/p&gt;

&lt;p&gt;Looks like when it gets the file list it can not detect that the incoming is a directory and not a file. I will look in the code and try to get a fix for you to test again&lt;/p&gt;</comment>
                            <comment id="12950283" author="davsclaus" created="Tue, 13 Jan 2009 12:43:55 +0000"  >&lt;p&gt;@Paddy&lt;/p&gt;

&lt;p&gt;I have commited a fix for the new problem&lt;/p&gt;

&lt;p&gt;Sending        camel-ftp/src/main/java/org/apache/camel/component/file/remote/SftpConsumer.java&lt;br/&gt;
Transmitting file data .&lt;br/&gt;
Committed revision 734117.&lt;/p&gt;</comment>
                            <comment id="12950354" author="watcher" created="Tue, 13 Jan 2009 14:08:20 +0000"  >&lt;p&gt;I still get an error in SftpRemoteFileOperations&lt;/p&gt;

&lt;p&gt;  Vector files = channel.ls(path);&lt;/p&gt;

&lt;p&gt;when path equals &quot;incoming&quot;&lt;/p&gt;

&lt;p&gt; WARN  An exception occured while polling: Endpoint&lt;span class=&quot;error&quot;&gt;&amp;#91;sftp://pdaly@127.0.0.1&amp;#93;&lt;/span&gt;: Cannot list directory: incoming&lt;br/&gt;
org.apache.camel.component.file.remote.RemoteFileOperationFailedException: Cannot list directory: incoming&lt;br/&gt;
	at org.apache.camel.component.file.remote.SftpRemoteFileOperations.listFiles(SftpRemoteFileOperations.java:270)&lt;br/&gt;
	at org.apache.camel.component.file.remote.SftpConsumer.pollDirectory(SftpConsumer.java:47)&lt;br/&gt;
	at org.apache.camel.component.file.remote.SftpConsumer.pollDirectory(SftpConsumer.java:53)&lt;br/&gt;
	at org.apache.camel.component.file.remote.SftpConsumer.pollDirectory(SftpConsumer.java:53)&lt;br/&gt;
	at org.apache.camel.component.file.remote.RemoteFileConsumer.poll(RemoteFileConsumer.java:65)&lt;br/&gt;
	at org.apache.camel.impl.ScheduledPollConsumer.run(ScheduledPollConsumer.java:66)&lt;br/&gt;
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:441)&lt;br/&gt;
	at java.util.concurrent.FutureTask$Sync.innerRunAndReset(FutureTask.java:317)&lt;br/&gt;
	at java.util.concurrent.FutureTask.runAndReset(FutureTask.java:150)&lt;br/&gt;
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.access$101(ScheduledThreadPoolExecutor.java:98)&lt;br/&gt;
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.runPeriodic(ScheduledThreadPoolExecutor.java:181)&lt;br/&gt;
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:205)&lt;br/&gt;
	at java.util.concurrent.ThreadPoolExecutor$Worker.runTask(ThreadPoolExecutor.java:886)&lt;br/&gt;
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:908)&lt;br/&gt;
	at java.lang.Thread.run(Thread.java:619)&lt;br/&gt;
Caused by: 2: SfsStatusCode.NoSuchFile&lt;br/&gt;
	at com.jcraft.jsch.ChannelSftp.throwStatusError(Unknown Source)&lt;br/&gt;
	at com.jcraft.jsch.ChannelSftp.stat(Unknown Source)&lt;br/&gt;
	at com.jcraft.jsch.ChannelSftp.ls(Unknown Source)&lt;br/&gt;
	at org.apache.camel.component.file.remote.SftpRemoteFileOperations.listFiles(SftpRemoteFileOperations.java:264)&lt;br/&gt;
	... 14 more&lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;te.RemoteFileComponent@100d6ea&amp;#93;&lt;/span&gt; ScheduledPollConsumer    &lt;/p&gt;</comment>
                            <comment id="12950325" author="davsclaus" created="Tue, 13 Jan 2009 14:19:00 +0000"  >&lt;p&gt;Sorry I have found the bug.&lt;/p&gt;

&lt;p&gt;The problem with the SFTP is that we dont have a java SFTP server we can use for automatic unit testing. So we run all the unit tests with the regular FTP component. The SFTP codebase is 98% identical to the FTP. But I found the bug with the sub folder stuff.&lt;/p&gt;

&lt;p&gt;Will commit a patch shortly. &lt;/p&gt;</comment>
                            <comment id="12950337" author="davsclaus" created="Tue, 13 Jan 2009 14:26:32 +0000"  >&lt;p&gt;@Paddy&lt;/p&gt;

&lt;p&gt;I have commited a fix to trunk. Could you please test it? Sorry for the issues. However Camel FTP has had a major refactor in Camel 2.x compared to 1.x.&lt;/p&gt;


&lt;p&gt;New Revision: 734141&lt;/p&gt;</comment>
                            <comment id="12950361" author="watcher" created="Tue, 13 Jan 2009 14:50:13 +0000"  >&lt;p&gt;Its processing the file ok now, however it fails to put the file into the done directory and throws the following exception.&lt;/p&gt;

&lt;p&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;te.RemoteFileComponent@1c1e333&amp;#93;&lt;/span&gt; SftpConsumer                   ERROR Cannot delete file: /test1/inc&lt;br/&gt;
oming/.done/New Text Document.txt&lt;br/&gt;
org.apache.camel.component.file.remote.RemoteFileOperationFailedException: Cannot delete file: /test&lt;br/&gt;
1/incoming/.done/New Text Document.txt&lt;br/&gt;
        at org.apache.camel.component.file.remote.SftpRemoteFileOperations.deleteFile(SftpRemoteFile&lt;br/&gt;
Operations.java:138)&lt;br/&gt;
        at org.apache.camel.component.file.remote.strategy.RenameRemoteFileProcessStrategy.renameFil&lt;br/&gt;
e(RenameRemoteFileProcessStrategy.java:71)&lt;br/&gt;
        at org.apache.camel.component.file.remote.strategy.RenameRemoteFileProcessStrategy.commit(Re&lt;br/&gt;
nameRemoteFileProcessStrategy.java:65)&lt;br/&gt;
        at org.apache.camel.component.file.remote.RemoteFileConsumer.processStrategyCommit(RemoteFil&lt;br/&gt;
eConsumer.java:215)&lt;br/&gt;
        at org.apache.camel.component.file.remote.RemoteFileConsumer$1.done(RemoteFileConsumer.java:&lt;br/&gt;
170)&lt;br/&gt;
        at org.apache.camel.processor.UnitOfWorkProcessor$1.done(UnitOfWorkProcessor.java:57)&lt;br/&gt;
        at org.apache.camel.management.InstrumentationProcessor$1.done(InstrumentationProcessor.java&lt;br/&gt;
:74)&lt;/p&gt;</comment>
                            <comment id="12950369" author="davsclaus" created="Tue, 13 Jan 2009 15:45:39 +0000"  >&lt;p&gt;Hi&lt;/p&gt;

&lt;p&gt;Could you try a file without spaces in the file name?&lt;/p&gt;</comment>
                            <comment id="12950320" author="watcher" created="Tue, 13 Jan 2009 15:48:03 +0000"  >&lt;p&gt;same issue&lt;/p&gt;</comment>
                            <comment id="12950352" author="davsclaus" created="Tue, 13 Jan 2009 15:57:35 +0000"  >&lt;p&gt;@Paddy&lt;/p&gt;

&lt;p&gt;I have commited a new fix to trunk about the move bug. Could you try it?&lt;/p&gt;

&lt;p&gt;Committed revision 734164.&lt;/p&gt;</comment>
                            <comment id="12950341" author="watcher" created="Tue, 13 Jan 2009 16:32:34 +0000"  >&lt;p&gt;That works. &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.gif&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt; &lt;/p&gt;

&lt;p&gt;I tested folder names with spaces and file names with spaces too.&lt;/p&gt;

&lt;p&gt;Thanks so much for your effort today.&lt;/p&gt;
</comment>
                            <comment id="12950351" author="davsclaus" created="Wed, 14 Jan 2009 05:05:12 +0000"  >&lt;p&gt;Thanks with good help from Paddy we have fixed the issues with SFTP/FTP consumers in Camel 2.0. &lt;/p&gt;

&lt;p&gt;Paddy thanks for being patient and reporting and testing this issue. Much appreciated by the community.&lt;/p&gt;</comment>
                            <comment id="12948864" author="davsclaus" created="Fri, 31 Jul 2009 06:33:57 +0000"  >&lt;p&gt;Closing 2.0m1 tickets&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12462720" name="example.log" size="106218" author="watcher" created="Tue, 13 Jan 2009 10:33:44 +0000"/>
                            <attachment id="12462695" name="example.log" size="11415" author="watcher" created="Tue, 13 Jan 2009 09:34:35 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Tue, 13 Jan 2009 09:40:49 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>76905</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            7 years, 19 weeks ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i01h8n:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>6562</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        </customfields>
    </item>
</channel>
</rss>