<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Sat Dec 03 02:50:18 UTC 2016

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/CAMEL-8742/CAMEL-8742.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[CAMEL-8742] RabbitMqConsumer did not retry if connection failed</title>
                <link>https://issues.apache.org/jira/browse/CAMEL-8742</link>
                <project id="12311211" key="CAMEL">Camel</project>
                    <description>&lt;p&gt;Camel Rabbitmq is used to consume a queue in RabbitMQ. &lt;br/&gt;
Sometimes, the Administrator would delete the queue and create a fresh queue. Or, the Camel container was started while all or some queue was not declared.&lt;/p&gt;

&lt;p&gt;During these period, Camel will fail with the following error:&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;[localhost-startStop-1] 14:03:31,824 INFO  org.apache.camel.component.rabbitmq.RabbitMQConsumer - Connection failed, will start background thread to retry!
java.io.IOException
	at com.rabbitmq.client.impl.AMQChannel.wrap(AMQChannel.java:106)
	at com.rabbitmq.client.impl.AMQChannel.wrap(AMQChannel.java:102)
	at com.rabbitmq.client.impl.ChannelN.basicConsume(ChannelN.java:976)
	at com.rabbitmq.client.impl.ChannelN.basicConsume(ChannelN.java:943)
	at com.rabbitmq.client.impl.ChannelN.basicConsume(ChannelN.java:935)
	at org.apache.camel.component.rabbitmq.RabbitMQConsumer$RabbitConsumer.start(RabbitMQConsumer.java:285)
	at org.apache.camel.component.rabbitmq.RabbitMQConsumer.startConsumer(RabbitMQConsumer.java:109)
	at org.apache.camel.component.rabbitmq.RabbitMQConsumer.startConsumers(RabbitMQConsumer.java:96)
	at org.apache.camel.component.rabbitmq.RabbitMQConsumer.doStart(RabbitMQConsumer.java:119)
	at org.apache.camel.support.ServiceSupport.start(ServiceSupport.java:61)
	at org.apache.camel.impl.DefaultCamelContext.startService(DefaultCamelContext.java:2869)
	at org.apache.camel.impl.DefaultCamelContext.doStartOrResumeRouteConsumers(DefaultCamelContext.java:3163)
	at org.apache.camel.impl.DefaultCamelContext.doStartRouteConsumers(DefaultCamelContext.java:3099)
	at org.apache.camel.impl.DefaultCamelContext.safelyStartRouteServices(DefaultCamelContext.java:3029)
	at org.apache.camel.impl.DefaultCamelContext.doStartOrResumeRoutes(DefaultCamelContext.java:2797)
	at org.apache.camel.impl.DefaultCamelContext.doStartCamel(DefaultCamelContext.java:2653)
	at org.apache.camel.impl.DefaultCamelContext.access$000(DefaultCamelContext.java:167)
	at org.apache.camel.impl.DefaultCamelContext$2.call(DefaultCamelContext.java:2467)
	at org.apache.camel.impl.DefaultCamelContext$2.call(DefaultCamelContext.java:2463)
	at org.apache.camel.impl.DefaultCamelContext.doWithDefinedClassLoader(DefaultCamelContext.java:2486)
	at org.apache.camel.impl.DefaultCamelContext.doStart(DefaultCamelContext.java:2463)
	at org.apache.camel.support.ServiceSupport.start(ServiceSupport.java:61)
	at org.apache.camel.impl.DefaultCamelContext.start(DefaultCamelContext.java:2432)
	at org.apache.camel.spring.SpringCamelContext.maybeStart(SpringCamelContext.java:255)
	at org.apache.camel.spring.SpringCamelContext.onApplicationEvent(SpringCamelContext.java:121)
	at org.apache.camel.spring.CamelContextFactoryBean.onApplicationEvent(CamelContextFactoryBean.java:332)
	at org.springframework.context.event.SimpleApplicationEventMulticaster.multicastEvent(SimpleApplicationEventMulticaster.java:96)
	at org.springframework.context.support.AbstractApplicationContext.publishEvent(AbstractApplicationContext.java:334)
	at org.springframework.context.support.AbstractApplicationContext.finishRefresh(AbstractApplicationContext.java:948)
	at org.springframework.context.support.AbstractApplicationContext.refresh(AbstractApplicationContext.java:482)
	at org.springframework.web.context.ContextLoader.configureAndRefreshWebApplicationContext(ContextLoader.java:389)
	at org.springframework.web.context.ContextLoader.initWebApplicationContext(ContextLoader.java:294)
	at org.springframework.web.context.ContextLoaderListener.contextInitialized(ContextLoaderListener.java:112)
	at org.apache.catalina.core.StandardContext.listenerStart(StandardContext.java:4973)
	at org.apache.catalina.core.StandardContext.startInternal(StandardContext.java:5467)
	at org.apache.catalina.util.LifecycleBase.start(LifecycleBase.java:150)
	at org.apache.catalina.core.ContainerBase.addChildInternal(ContainerBase.java:901)
	at org.apache.catalina.core.ContainerBase.addChild(ContainerBase.java:877)
	at org.apache.catalina.core.StandardHost.addChild(StandardHost.java:632)
	at org.apache.catalina.startup.HostConfig.deployDescriptor(HostConfig.java:670)
	at org.apache.catalina.startup.HostConfig$DeployDescriptor.run(HostConfig.java:1839)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:471)
	at java.util.concurrent.FutureTask.run(FutureTask.java:262)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1145)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:615)
	at java.lang.Thread.run(Thread.java:745)
Caused by: com.rabbitmq.client.ShutdownSignalException: channel error; reason: {#method&amp;lt;channel.close&amp;gt;(reply-code=404, reply-text=NOT_FOUND - no queue &apos;ad_google_dfa_reporting_queue&apos; in vhost &apos;/&apos;, class-id=60, method-id=20), null, &quot;&quot;}
	at com.rabbitmq.utility.ValueOrException.getValue(ValueOrException.java:67)
	at com.rabbitmq.utility.BlockingValueOrException.uninterruptibleGetValue(BlockingValueOrException.java:33)
	at com.rabbitmq.client.impl.AMQChannel$BlockingRpcContinuation.getReply(AMQChannel.java:343)
	at com.rabbitmq.client.impl.ChannelN.basicConsume(ChannelN.java:974)
	... 43 more
Caused by: com.rabbitmq.client.ShutdownSignalException: channel error; reason: {#method&amp;lt;channel.close&amp;gt;(reply-code=404, reply-text=NOT_FOUND - no queue &apos;ad_google_dfa_reporting_queue&apos; in vhost &apos;/&apos;, class-id=60, method-id=20), null, &quot;&quot;}
	at com.rabbitmq.client.impl.ChannelN.asyncShutdown(ChannelN.java:474)
	at com.rabbitmq.client.impl.ChannelN.processAsync(ChannelN.java:315)
	at com.rabbitmq.client.impl.AMQChannel.handleCompleteInboundCommand(AMQChannel.java:144)
	at com.rabbitmq.client.impl.AMQChannel.handleFrame(AMQChannel.java:91)
	at com.rabbitmq.client.impl.AMQConnection$MainLoop.run(AMQConnection.java:533)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;From the log, it shows retrying. But after 45 minutes, nothing happen. &lt;/p&gt;

&lt;p&gt;While waiting for &lt;a href=&quot;https://issues.apache.org/jira/browse/CAMEL-8487&quot; title=&quot;Custom arguments to RabbitMQ queues&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CAMEL-8487&quot;&gt;&lt;del&gt;CAMEL-8487&lt;/del&gt;&lt;/a&gt; (which i have no idea how to configure &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/sad.gif&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt; ), is there anything i can do for retry to work/happen sooner?&lt;/p&gt;</description>
                <environment></environment>
        <key id="12827158">CAMEL-8742</key>
            <summary>RabbitMqConsumer did not retry if connection failed</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/bug.png">Bug</type>
                                            <priority id="4" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.png">Minor</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="davsclaus">Claus Ibsen</assignee>
                                    <reporter username="reusable">Yap Poh Soon</reporter>
                        <labels>
                    </labels>
                <created>Tue, 5 May 2015 06:45:06 +0000</created>
                <updated>Thu, 28 Jan 2016 16:43:18 +0000</updated>
                            <resolved>Thu, 28 Jan 2016 08:26:38 +0000</resolved>
                                    <version>2.15.1</version>
                                    <fixVersion>2.17.0</fixVersion>
                                    <component>camel-rabbitmq</component>
                        <due></due>
                            <votes>1</votes>
                                    <watches>5</watches>
                                                                <comments>
                            <comment id="14532091" author="davsclaus" created="Thu, 7 May 2015 06:24:36 +0000"  >&lt;p&gt;Do you have a chance to dive into the Rabbit MQ client api to find what it offers for failover - re-connection etc, so we can see if there is an option or what code it takes to add to camel-rabbitmq to make it support this?&lt;/p&gt;

&lt;p&gt;Other brokers like ActiveMQ has that out of the box in its JMS client.&lt;/p&gt;</comment>
                            <comment id="14537001" author="reusable" created="Sun, 10 May 2015 02:41:59 +0000"  >&lt;p&gt;Im on it. &lt;/p&gt;</comment>
                            <comment id="14733483" author="davsclaus" created="Mon, 7 Sep 2015 09:46:20 +0000"  >&lt;p&gt;Anyone working on this?&lt;/p&gt;</comment>
                            <comment id="14953228" author="unleashed85" created="Mon, 12 Oct 2015 15:45:13 +0000"  >&lt;p&gt;I&apos;ve have also seen this happen. I glanced at the code a few months ago but I think this is going to require a redesign of how consumers are created. If I remember correctly, when the consumer is created we pass in a rabbit channel instead of passing in the pool or connection details. So when that channel is closed there is no way for the consumer to recover.&lt;/p&gt;</comment>
                            <comment id="14954430" author="davsclaus" created="Tue, 13 Oct 2015 05:42:37 +0000"  >&lt;p&gt;Brad, yeah that sounds like what would be needed.&lt;/p&gt;</comment>
                            <comment id="15099042" author="unleashed85" created="Thu, 14 Jan 2016 22:34:24 +0000"  >&lt;p&gt;I keep hitting this so I&apos;ll work on it.&lt;/p&gt;</comment>
                            <comment id="15119852" author="githubbot" created="Wed, 27 Jan 2016 17:35:59 +0000"  >&lt;p&gt;GitHub user brreitme opened a pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/camel/pull/812&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://github.com/apache/camel/pull/812&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://issues.apache.org/jira/browse/CAMEL-8742&quot; title=&quot;RabbitMqConsumer did not retry if connection failed&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CAMEL-8742&quot;&gt;&lt;del&gt;CAMEL-8742&lt;/del&gt;&lt;/a&gt; - Reconnect when connections are closed.&lt;/p&gt;

&lt;ul&gt;
	&lt;li&gt;Publishers and subscribers will reconnect if the connection / channel is closed&lt;/li&gt;
	&lt;li&gt;Cancel reply manager when sending a message in the producer fails so the reply thread doesn&apos;t time out.&lt;/li&gt;
	&lt;li&gt;Change the SuspendResume test to use a different queue since it conflicts with other queue settings&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;You can merge this pull request into a Git repository by running:&lt;/p&gt;

&lt;p&gt;    $ git pull &lt;a href=&quot;https://github.com/brreitme/camel&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://github.com/brreitme/camel&lt;/a&gt; master&lt;/p&gt;

&lt;p&gt;Alternatively you can review and apply these changes as the patch at:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/camel/pull/812.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://github.com/apache/camel/pull/812.patch&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;To close this pull request, make a commit to your master/trunk branch&lt;br/&gt;
with (at least) the following in the commit message:&lt;/p&gt;

&lt;p&gt;    This closes #812&lt;/p&gt;

&lt;hr /&gt;
&lt;p&gt;commit a389806e2884ba16aa8793a8944971c4d50b0dc9&lt;br/&gt;
Author: Brad Reitmeyer &amp;lt;brreitme@cisco.com&amp;gt;&lt;br/&gt;
Date:   2016-01-26T22:39:12Z&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://issues.apache.org/jira/browse/CAMEL-8742&quot; title=&quot;RabbitMqConsumer did not retry if connection failed&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CAMEL-8742&quot;&gt;&lt;del&gt;CAMEL-8742&lt;/del&gt;&lt;/a&gt; - Reconect when connections are closed.&lt;/p&gt;

&lt;ul&gt;
	&lt;li&gt;Cancel reply manager when sending a message in the producer fails&lt;/li&gt;
	&lt;li&gt;Change the SuspendResume test to use a different queue since it conflicts with other queue settings&lt;/li&gt;
&lt;/ul&gt;


&lt;hr /&gt;</comment>
                            <comment id="15121011" author="davsclaus" created="Thu, 28 Jan 2016 08:26:38 +0000"  >&lt;p&gt;Thanks Brad for the PR&lt;/p&gt;</comment>
                            <comment id="15121854" author="githubbot" created="Thu, 28 Jan 2016 16:43:18 +0000"  >&lt;p&gt;Github user brreitme closed the pull request at:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/camel/pull/812&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://github.com/apache/camel/pull/812&lt;/a&gt;&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Thu, 7 May 2015 06:24:36 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12310060" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Estimated Complexity</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10060"><![CDATA[Unknown]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            44 weeks, 1 day ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i2ea9z:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        </customfields>
    </item>
</channel>
</rss>