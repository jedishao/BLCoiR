<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Sat Dec 03 02:34:43 UTC 2016

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/CAMEL-1583/CAMEL-1583.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[CAMEL-1583] ldap component is not thread safe</title>
                <link>https://issues.apache.org/jira/browse/CAMEL-1583</link>
                <project id="12311211" key="CAMEL">Camel</project>
                    <description>&lt;p&gt;JNDI context objects are not thread-safe. The LDAP component shares a directory context across all threads that use the component. This is not safe.&lt;/p&gt;

&lt;p&gt;In addition the LDAP component will attempt to establish a connection on instantiation of the component, and not when the component is required to process requests. If the LDAP server is not ready e.g. temporarily unavailable then the entire Camel application will stop.&lt;/p&gt;

&lt;p&gt;JNDI directory contexts should be established when a consuming thread needs it and should be released when the thread is finished with the component i.e.:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;ctx = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; InitialDirContext(env);
&lt;span class=&quot;code-keyword&quot;&gt;try&lt;/span&gt; {
  ...
} &lt;span class=&quot;code-keyword&quot;&gt;finally&lt;/span&gt; {
  ctx.close();
}
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;The above will release the connection with the LDAP server as soon as possible. The existing component relies on JNDI to release the socket in its own time (several seconds later).&lt;/p&gt;</description>
                <environment>&lt;p&gt;N/A&lt;/p&gt;</environment>
        <key id="12486246">CAMEL-1583</key>
            <summary>ldap component is not thread safe</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/bug.png">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.png">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="davsclaus">Claus Ibsen</assignee>
                                    <reporter username="huntc@internode.on.net">Christopher Hunt</reporter>
                        <labels>
                    </labels>
                <created>Sat, 2 May 2009 10:20:11 +0000</created>
                <updated>Sat, 21 Nov 2009 11:58:00 +0000</updated>
                            <resolved>Mon, 4 May 2009 14:05:00 +0000</resolved>
                                    <version>1.6.0</version>
                    <version>2.0-M1</version>
                                    <fixVersion>1.6.1</fixVersion>
                    <fixVersion>2.0-M2</fixVersion>
                                    <component>camel-ldap</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                <comments>
                            <comment id="12951970" author="huntc@internode.on.net" created="Mon, 4 May 2009 05:25:11 +0000"  >&lt;p&gt;Changes to the 1.6.1 branch.&lt;/p&gt;

&lt;p&gt;In essence a context is retrieved from the registry each time that an exchange is to be produced.&lt;/p&gt;

&lt;p&gt;Given that the contract for an InitialContext states:&lt;/p&gt;

&lt;p&gt;&lt;em&gt;An InitialContext instance is not synchronized against concurrent access by multiple threads. Multiple threads each manipulating a different InitialContext instance need not synchronize. Threads that need to access a single InitialContext instance concurrently should synchronize amongst themselves and provide the necessary locking.&lt;/em&gt;&lt;/p&gt;

&lt;p&gt;...the registry entry should either: (a) provide an InitialContext that is known to be thread safe; or (b) ensure that the registry instantiates a new bean each time that the bean is looked up. The latter will be the general situation and so, for example with Spring IOC, use a bean declaration similar to:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
	&amp;lt;!-- Directory Context --&amp;gt;
	&amp;lt;bean id=&lt;span class=&quot;code-quote&quot;&gt;&quot;ldapserver&quot;&lt;/span&gt; class=&lt;span class=&quot;code-quote&quot;&gt;&quot;javax.naming.directory.InitialDirContext&quot;&lt;/span&gt; scope=&lt;span class=&quot;code-quote&quot;&gt;&quot;prototype&quot;&lt;/span&gt;&amp;gt;
		&amp;lt;constructor-arg&amp;gt;
			&amp;lt;props&amp;gt;
				&amp;lt;prop key=&lt;span class=&quot;code-quote&quot;&gt;&quot;java.naming.factory.initial&quot;&lt;/span&gt;&amp;gt;com.sun.jndi.ldap.LdapCtxFactory&amp;lt;/prop&amp;gt;
				&amp;lt;prop key=&lt;span class=&quot;code-quote&quot;&gt;&quot;java.naming.provider.url&quot;&lt;/span&gt;&amp;gt;ldap:&lt;span class=&quot;code-comment&quot;&gt;//localhost:10389&amp;lt;/prop&amp;gt;
&lt;/span&gt;				&amp;lt;prop key=&lt;span class=&quot;code-quote&quot;&gt;&quot;java.naming.security.authentication&quot;&lt;/span&gt;&amp;gt;none&amp;lt;/prop&amp;gt;
			&amp;lt;/props&amp;gt;
		&amp;lt;/constructor-arg&amp;gt;
	&amp;lt;/bean&amp;gt;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;It is important to use a prototype scope to ensure that a new directory context is obtained for each exchange produced.&lt;/p&gt;</comment>
                            <comment id="12951961" author="huntc@internode.on.net" created="Mon, 4 May 2009 07:01:10 +0000"  >&lt;p&gt;I forgot to mention that I ran the ldap unit tests and all was well. In addition I used the modified class within my application and confiirmed (using the debugger) that a new context instance was being used each time.&lt;/p&gt;</comment>
                            <comment id="12951974" author="davsclaus" created="Mon, 4 May 2009 14:05:00 +0000"  >&lt;p&gt;trunk: 771303, 771307.&lt;br/&gt;
1.x: 771309.&lt;/p&gt;

&lt;p&gt;Yeah I needed two commits on trunk as the patch was for 1.x and it used generics in the LdapProducer. So I had to remove it again on trunk &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.gif&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;</comment>
                            <comment id="12951973" author="davsclaus" created="Mon, 4 May 2009 14:05:30 +0000"  >&lt;p&gt;Christopher.&lt;/p&gt;

&lt;p&gt;Thanks again for doing the patch and the investigations. And provided yet another patch.&lt;/p&gt;</comment>
                            <comment id="12953685" author="davsclaus" created="Sat, 21 Nov 2009 11:58:00 +0000"  >&lt;p&gt;Closing all 2.0M2 tickets&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12462945" name="LdapProducer.java.diff" size="2871" author="huntc@internode.on.net" created="Mon, 4 May 2009 05:25:11 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Mon, 4 May 2009 14:05:00 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>76811</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            7 years, 2 weeks, 6 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i01jb3:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>6897</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        </customfields>
    </item>
</channel>
</rss>