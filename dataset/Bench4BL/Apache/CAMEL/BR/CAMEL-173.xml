<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Sat Dec 03 04:39:41 UTC 2016

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/CAMEL-173/CAMEL-173.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[CAMEL-173] BAM example failure</title>
                <link>https://issues.apache.org/jira/browse/CAMEL-173</link>
                <project id="12311211" key="CAMEL">Camel</project>
                    <description>&lt;p&gt;the example throws following error:&lt;/p&gt;

&lt;p&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;pache.camel.spring.Main.main()&amp;#93;&lt;/span&gt; Main                           INFO  Apache Camel 1.2.0 starting&lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;pache.camel.spring.Main.main()&amp;#93;&lt;/span&gt; Main                           INFO  Generating DOT file for routes: /opt/dev/apache-camel-1.2.0/examples/camel-example-bam/target/site/cameldoc for: org.apache.camel.spring.SpringCamelContext@352d87&lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;nent.file.FileComponent@db248c&amp;#93;&lt;/span&gt; JDBCExceptionReporter          WARN  SQL Error: 0, SQLState: null&lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;nent.file.FileComponent@db248c&amp;#93;&lt;/span&gt; JDBCExceptionReporter          ERROR failed batch&lt;br/&gt;
Failed to load preferences.  Proceeding with defaults:&lt;/p&gt;

&lt;p&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;nent.file.FileComponent@db248c&amp;#93;&lt;/span&gt; AbstractFlushingEventListener  ERROR Could not synchronize database state with session&lt;br/&gt;
org.hibernate.exception.GenericJDBCException: Could not execute JDBC batch update&lt;br/&gt;
        at org.hibernate.exception.SQLStateConverter.handledNonSpecificException(SQLStateConverter.java:103)&lt;br/&gt;
        at org.hibernate.exception.SQLStateConverter.convert(SQLStateConverter.java:91)&lt;br/&gt;
        at org.hibernate.exception.JDBCExceptionHelper.convert(JDBCExceptionHelper.java:43)&lt;br/&gt;
        at org.hibernate.jdbc.AbstractBatcher.executeBatch(AbstractBatcher.java:249)&lt;br/&gt;
        at org.hibernate.engine.ActionQueue.executeActions(ActionQueue.java:235)&lt;br/&gt;
        at org.hibernate.engine.ActionQueue.executeActions(ActionQueue.java:139)&lt;br/&gt;
        at org.hibernate.event.def.AbstractFlushingEventListener.performExecutions(AbstractFlushingEventListener.java:298)&lt;br/&gt;
        at org.hibernate.event.def.DefaultFlushEventListener.onFlush(DefaultFlushEventListener.java:27)&lt;br/&gt;
        at org.hibernate.impl.SessionImpl.flush(SessionImpl.java:1000)&lt;br/&gt;
        at org.hibernate.ejb.AbstractEntityManagerImpl.flush(AbstractEntityManagerImpl.java:296)&lt;br/&gt;
        at org.springframework.orm.jpa.JpaTemplate$8.doInJpa(JpaTemplate.java:289)&lt;br/&gt;
        at org.springframework.orm.jpa.JpaTemplate.execute(JpaTemplate.java:191)&lt;br/&gt;
        at org.springframework.orm.jpa.JpaTemplate.flush(JpaTemplate.java:287)&lt;br/&gt;
        at org.apache.camel.bam.processor.JpaBamProcessorSupport.loadEntity(JpaBamProcessorSupport.java:118)&lt;br/&gt;
        at org.apache.camel.bam.processor.BamProcessorSupport$1.doInTransaction(BamProcessorSupport.java:96)&lt;br/&gt;
        at org.springframework.transaction.support.TransactionTemplate.execute(TransactionTemplate.java:127)&lt;br/&gt;
        at org.apache.camel.bam.processor.BamProcessorSupport.process(BamProcessorSupport.java:91)&lt;br/&gt;
        at org.apache.camel.impl.converter.AsyncProcessorTypeConverter$ProcessorToAsynProcessorBridge.process(AsyncProcessorTypeConverter.java:44)&lt;br/&gt;
        at org.apache.camel.component.file.FileConsumer.pollFile(FileConsumer.java:131)&lt;br/&gt;
        at org.apache.camel.component.file.FileConsumer.pollFileOrDirectory(FileConsumer.java:68)&lt;br/&gt;
        at org.apache.camel.component.file.FileConsumer.pollFileOrDirectory(FileConsumer.java:76)&lt;br/&gt;
        at org.apache.camel.component.file.FileConsumer.poll(FileConsumer.java:49)&lt;br/&gt;
        at org.apache.camel.impl.ScheduledPollConsumer.run(ScheduledPollConsumer.java:63)&lt;br/&gt;
        at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:417)&lt;br/&gt;
        at java.util.concurrent.FutureTask$Sync.innerRunAndReset(FutureTask.java:280)&lt;br/&gt;
        at java.util.concurrent.FutureTask.runAndReset(FutureTask.java:135)&lt;br/&gt;
        at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.access$101(ScheduledThreadPoolExecutor.java:65)&lt;br/&gt;
        at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.runPeriodic(ScheduledThreadPoolExecutor.java:142)&lt;br/&gt;
        at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:166)&lt;br/&gt;
        at java.util.concurrent.ThreadPoolExecutor$Worker.runTask(ThreadPoolExecutor.java:650)&lt;br/&gt;
        at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:675)&lt;br/&gt;
        at java.lang.Thread.run(Thread.java:595)&lt;br/&gt;
Caused by: java.sql.BatchUpdateException: failed batch&lt;br/&gt;
        at org.hsqldb.jdbc.jdbcStatement.executeBatch(Unknown Source)&lt;br/&gt;
        at org.hsqldb.jdbc.jdbcPreparedStatement.executeBatch(Unknown Source)&lt;br/&gt;
        at org.hibernate.jdbc.BatchingBatcher.doExecuteBatch(BatchingBatcher.java:48)&lt;br/&gt;
        at org.hibernate.jdbc.AbstractBatcher.executeBatch(AbstractBatcher.java:242)&lt;br/&gt;
        ... 28 more&lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;nent.file.FileComponent@db248c&amp;#93;&lt;/span&gt; BamProcessorSupport            INFO  Attempt to insert duplicate row due to concurrency issue, so retrying: org.springframework.orm.jpa.JpaSystemException: org.hibernate.exception.GenericJDBCException: Could not execute JDBC batch update; nested exception is javax.persistence.PersistenceException: org.hibernate.exception.GenericJDBCException: Could not execute JDBC batch update&lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;nent.file.FileComponent@db248c&amp;#93;&lt;/span&gt; BamProcessorSupport            INFO  Retry attempt due to duplicate row: 1&lt;br/&gt;
[         ActivityMonitorEngine] BamFailures                    ERROR Exchange[Message: ActivityState[2 on ProcessInstance&lt;span class=&quot;error&quot;&gt;&amp;#91;p3&amp;#93;&lt;/span&gt; Activity&lt;span class=&quot;error&quot;&gt;&amp;#91;2 name: file:src/data/invoices?noop=true&amp;#93;&lt;/span&gt;]]&lt;br/&gt;
[         ActivityMonitorEngine] BamFailures                    ERROR Exchange[Message: ActivityState[7 on ProcessInstance&lt;span class=&quot;error&quot;&gt;&amp;#91;p2&amp;#93;&lt;/span&gt; Activity&lt;span class=&quot;error&quot;&gt;&amp;#91;2 name: file:src/data/invoices?noop=true&amp;#93;&lt;/span&gt;]]&lt;/p&gt;</description>
                <environment>&lt;p&gt;testing the camel-1.2.0 RC2 on SUSE Linux&lt;/p&gt;</environment>
        <key id="12485407">CAMEL-173</key>
            <summary>BAM example failure</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/bug.png">Bug</type>
                                            <priority id="4" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.png">Minor</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="davsclaus">Claus Ibsen</assignee>
                                    <reporter username="blin">Bozhong Lin</reporter>
                        <labels>
                    </labels>
                <created>Thu, 11 Oct 2007 08:13:31 +0000</created>
                <updated>Mon, 12 May 2008 12:45:27 +0000</updated>
                            <resolved>Fri, 28 Mar 2008 11:27:06 +0000</resolved>
                                    <version>1.2.0</version>
                                    <fixVersion>1.3.0</fixVersion>
                                    <component>examples</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                <comments>
                            <comment id="12946570" author="davsclaus" created="Fri, 28 Mar 2008 09:44:39 +0000"  >&lt;p&gt;The exception is happening on startup, it does not affect the application later on. &lt;br/&gt;
However it would be nicer to remove this noise.&lt;/p&gt;</comment>
                            <comment id="12946600" author="jstrachan" created="Fri, 28 Mar 2008 10:02:12 +0000"  >&lt;p&gt;Agreed. I&quot;m thinking this could be caused by concurrent threads trying to insert the same row? Am wondering if a different JDBC provider does locking better or something?&lt;/p&gt;</comment>
                            <comment id="12946504" author="davsclaus" created="Fri, 28 Mar 2008 11:27:06 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/CAMEL-173&quot; title=&quot;BAM example failure&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CAMEL-173&quot;&gt;&lt;del&gt;CAMEL-173&lt;/del&gt;&lt;/a&gt;&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;fixed concurrency issue with creating a new entity. Now using a ReentrantLock from Java.&lt;/li&gt;
	&lt;li&gt;no more exceptions in the camel-bam-example demo app as well.&lt;/li&gt;
	&lt;li&gt;added some assertions to the unit test&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="12946588" author="davsclaus" created="Fri, 28 Mar 2008 11:28:31 +0000"  >&lt;p&gt;James please by all means review my patch committed. &lt;/p&gt;

&lt;p&gt;Running the demo app now only displays:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
[INFO] [camel:run]
[pache.camel.spring.Main.main()] Main                           INFO  Apache Camel 1.3-SNAPSHOT starting
[pache.camel.spring.Main.main()] Main                           INFO  Generating DOT file &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; routes: D:\project\camel\examples\camel-example-bam\target/site/cameldoc &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt;: org.apache.camel.spring.SpringCamelContext@ae4f8b
Failed to load preferences.  Proceeding with defaults:

[         ActivityMonitorEngine] BamFailures                    ERROR Exchange[Message: ActivityState[3 on ProcessInstance[p1] Activity[2 name: file:src/data/invoices?noop=&lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;]]]
[         ActivityMonitorEngine] BamFailures                    ERROR Exchange[Message: ActivityState[4 on ProcessInstance[p3] Activity[2 name: file:src/data/invoices?noop=&lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;]]]
[         ActivityMonitorEngine] BamFailures                    ERROR Exchange[Message: ActivityState[6 on ProcessInstance[p2] Activity[2 name: file:src/data/invoices?noop=&lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;]]]
Stopping
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="12946533" author="jstrachan" created="Fri, 28 Mar 2008 11:32:28 +0000"  >&lt;p&gt;Awesome stuff! &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.gif&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;

&lt;p&gt;I guess the problem could still happen if folks were running multiple JVMs against the same database; though in that case a real database would be used that properly implements locks etc &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.gif&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;</comment>
                            <comment id="12947011" author="davsclaus" created="Mon, 12 May 2008 12:45:27 +0000"  >&lt;p&gt;Closed all 1.3 tickets&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Fri, 28 Mar 2008 09:44:39 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>83159</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            8 years, 30 weeks, 4 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i01alj:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>5486</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        </customfields>
    </item>
</channel>
</rss>