<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Sat Dec 03 01:26:48 UTC 2016

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/CAMEL-1199/CAMEL-1199.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[CAMEL-1199] Throttler appears to &quot;throttle&quot; per thread instead of throttling across multiple threads</title>
                <link>https://issues.apache.org/jira/browse/CAMEL-1199</link>
                <project id="12311211" key="CAMEL">Camel</project>
                    <description></description>
                <environment></environment>
        <key id="12485721">CAMEL-1199</key>
            <summary>Throttler appears to &quot;throttle&quot; per thread instead of throttling across multiple threads</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/bug.png">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.png">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="gertvanthienen">Gert Vanthienen</assignee>
                                    <reporter username="rgavlin">Ron Gavlin</reporter>
                        <labels>
                    </labels>
                <created>Fri, 19 Dec 2008 12:20:41 +0000</created>
                <updated>Fri, 31 Jul 2009 06:33:53 +0000</updated>
                            <resolved>Mon, 5 Jan 2009 08:53:57 +0000</resolved>
                                    <version>1.5.0</version>
                                    <fixVersion>1.6.0</fixVersion>
                    <fixVersion>2.0-M1</fixVersion>
                                    <component>camel-core</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                <comments>
                            <comment id="12950204" author="hadrian" created="Mon, 22 Dec 2008 15:34:20 +0000"  >&lt;p&gt;Ron, I tried to reproduce your issue and the throttler seems to work with the following route.  The Throttler code keeps everything per object, so as long as there is one object everything seems ok.  One odd thing I noticed is that at 3 messages per second I expected the whole thing to take a bit over 7 seconds, but it takes (consistently) over 6 seconds (and a bit over 60 sec for 240 messages).  &lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
&lt;span class=&quot;code-comment&quot;&gt;// START SNIPPET: ex
&lt;/span&gt;from(&lt;span class=&quot;code-quote&quot;&gt;&quot;direct:a&quot;&lt;/span&gt;).thread(5).
    throttler(3).timePeriodMillis(1000).to(&lt;span class=&quot;code-quote&quot;&gt;&quot;mock:result&quot;&lt;/span&gt;);
&lt;span class=&quot;code-comment&quot;&gt;// END SNIPPET: ex&lt;/span&gt;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;and the client code makes invocations from multiple threads, as smx does.  The core pool size didn&apos;t infulence the results.&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
        ThreadPoolTaskExecutor executor = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; ThreadPoolTaskExecutor();
        executor.setCorePoolSize(5);
        executor.afterPropertiesSet();
        &lt;span class=&quot;code-object&quot;&gt;long&lt;/span&gt; start = &lt;span class=&quot;code-object&quot;&gt;System&lt;/span&gt;.currentTimeMillis();
        executor.execute(&lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;code-object&quot;&gt;Runnable&lt;/span&gt;() {
            &lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; void run() {
                &lt;span class=&quot;code-object&quot;&gt;long&lt;/span&gt; start = &lt;span class=&quot;code-object&quot;&gt;System&lt;/span&gt;.currentTimeMillis();
                &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; (&lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt; i = 0; i &amp;lt; messageCount; i++) {
                    template.sendBody(&lt;span class=&quot;code-quote&quot;&gt;&quot;direct:a&quot;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&quot;&amp;lt;message&amp;gt;&quot;&lt;/span&gt; + i + &lt;span class=&quot;code-quote&quot;&gt;&quot;&amp;lt;/message&amp;gt;&quot;&lt;/span&gt;);
                }
                duration = &lt;span class=&quot;code-object&quot;&gt;System&lt;/span&gt;.currentTimeMillis() - start;
            };
        });
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Can you please make it fail or give more details about what you experience?  How does your route look like?&lt;/p&gt;</comment>
                            <comment id="12950177" author="rgavlin" created="Mon, 22 Dec 2008 16:36:47 +0000"  >&lt;p&gt;Hi Adrian,&lt;/p&gt;

&lt;p&gt;I am attempting to use the throttler within smx-camel. I suspect this represents a different use case than using the throttler natively from multiple threads within camel. My route is:&lt;/p&gt;

&lt;p&gt;&amp;lt;from uri=&quot;jbi:...jms_consumer&quot;/&amp;gt;&lt;br/&gt;
&amp;lt;throttler/&amp;gt;&lt;br/&gt;
&amp;lt;to uri=&quot;jbi:...jms_provider&quot;/&amp;gt;&lt;/p&gt;

&lt;p&gt;So, I am not sure if this is a camel problem or a smx-camel problem. I thought I would post the issue here first.&lt;/p&gt;

&lt;p&gt;/Ron&lt;/p&gt;
</comment>
                            <comment id="12950215" author="hadrian" created="Mon, 29 Dec 2008 15:32:47 +0000"  >&lt;p&gt;Gert is taking a look at this in the context of smx.  Thanks Gert.&lt;/p&gt;</comment>
                            <comment id="12950153" author="gertvanthienen" created="Tue, 30 Dec 2008 14:03:07 +0000"  >&lt;p&gt;There is only one Throttler object when running in ServiceMix too, but on my machine submitting multiple messages to a direct-endpoint from an Executor does lead to problems.&lt;br/&gt;
&lt;a href=&quot;http://svn.eu.apache.org/viewvc?view=rev&amp;amp;revision=730132&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://svn.eu.apache.org/viewvc?view=rev&amp;amp;revision=730132&lt;/a&gt; makes the implementation of the throttler a bit more thread-safe&lt;/p&gt;</comment>
                            <comment id="12950155" author="gertvanthienen" created="Mon, 5 Jan 2009 08:53:57 +0000"  >&lt;p&gt;The throttler always delayed until the next time period, regardless of the number of exchanges already waiting for being handled in that period.  The new algorithm allows the the throttler to delay exchanges for more than one time period if necessary.&lt;/p&gt;

&lt;p&gt;Fixed in &lt;a href=&quot;http://svn.eu.apache.org/viewvc?view=rev&amp;amp;revision=731488&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://svn.eu.apache.org/viewvc?view=rev&amp;amp;revision=731488&lt;/a&gt;&lt;br/&gt;
and backported to 1.5.x in &lt;a href=&quot;http://svn.eu.apache.org/viewvc?view=rev&amp;amp;revision=731493&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://svn.eu.apache.org/viewvc?view=rev&amp;amp;revision=731493&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="12948521" author="davsclaus" created="Fri, 31 Jul 2009 06:33:53 +0000"  >&lt;p&gt;Closing 2.0m1 tickets&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Mon, 22 Dec 2008 15:34:20 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>76918</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            7 years, 19 weeks ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i01gxz:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>6514</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        </customfields>
    </item>
</channel>
</rss>