<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Sat Dec 03 05:21:27 UTC 2016

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/CAMEL-2978/CAMEL-2978.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[CAMEL-2978] java.net.SocketException: Too many open files with Apache Camel(Netty TCP) 2.4.0.</title>
                <link>https://issues.apache.org/jira/browse/CAMEL-2978</link>
                <project id="12311211" key="CAMEL">Camel</project>
                    <description>&lt;p&gt;I&apos;ve got a unit test that works fine with Apache Camel 2.3.0, but as soon as I upgraded to 2.4.0 it consistently started to fail.&lt;/p&gt;

&lt;p&gt;It performs a number of concurrent requests using this url:&lt;br/&gt;
netty:tcp://localhost:2048?sync=true&lt;br/&gt;
In both the client and server side of the unit test.&lt;/p&gt;

&lt;p&gt;There&apos;s also a sister test which does the same thing with Netty directly and that works in isolation, so it would appear something has been broken in the transition to 2.4.0.  Previously this code was also using a beta version of Netty, but even updating that specific dependency has made no difference.&lt;/p&gt;</description>
                <environment>&lt;p&gt;Linux laptop 2.6.32-24-generic #38-Ubuntu SMP Mon Jul 5 09:20:59 UTC 2010 x86_64 GNU/Linux&lt;br/&gt;
java version &quot;1.6.0_20&quot;&lt;br/&gt;
Java(TM) SE Runtime Environment (build 1.6.0_20-b02)&lt;br/&gt;
Java HotSpot(TM) 64-Bit Server VM (build 16.3-b01, mixed mode)&lt;/p&gt;</environment>
        <key id="12485603">CAMEL-2978</key>
            <summary>java.net.SocketException: Too many open files with Apache Camel(Netty TCP) 2.4.0.</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/bug.png">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.png">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="davsclaus">Claus Ibsen</assignee>
                                    <reporter username="seanparsons">Sean Parsons</reporter>
                        <labels>
                    </labels>
                <created>Tue, 20 Jul 2010 22:46:40 +0000</created>
                <updated>Sun, 24 Apr 2011 09:57:29 +0000</updated>
                            <resolved>Mon, 26 Jul 2010 13:33:44 +0000</resolved>
                                    <version>2.4.0</version>
                                    <fixVersion>2.5.0</fixVersion>
                                    <component>camel-netty</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                <comments>
                            <comment id="12949794" author="hadrian" created="Tue, 20 Jul 2010 23:07:21 +0000"  >&lt;p&gt;Sean, could you attach the unit test so that we take a look?&lt;/p&gt;</comment>
                            <comment id="12949743" author="davsclaus" created="Wed, 21 Jul 2010 07:33:46 +0000"  >&lt;p&gt;Camel 2.4 uses the latest release of Netty which is 3.2.1. Camel 2.3 used an older release.&lt;/p&gt;</comment>
                            <comment id="12950235" author="seanparsons" created="Wed, 21 Jul 2010 20:27:07 +0000"  >&lt;p&gt;This Groovy file manifests the issue, the @Grab annotation for camel-netty can be changed between 2.3.0 and 2.4.0 with the latter throwing the exceptions.  This also uses the latest version of Netty in both cases.&lt;/p&gt;</comment>
                            <comment id="12950017" author="davsclaus" created="Sun, 25 Jul 2010 12:14:09 +0000"  >&lt;p&gt;You should &lt;b&gt;not&lt;/b&gt; create a new instance of producer template when sending&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
 def producerTemplate = context.createProducerTemplate();
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;See this FAQ&lt;br/&gt;
&lt;a href=&quot;http://camel.apache.org/why-does-camel-use-too-many-threads-with-producertemplate.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://camel.apache.org/why-does-camel-use-too-many-threads-with-producertemplate.html&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="12948931" author="seanparsons" created="Sun, 25 Jul 2010 13:21:17 +0000"  >&lt;p&gt;Updated script to not create the ProducerTemplate on each send.&lt;/p&gt;</comment>
                            <comment id="12955506" author="seanparsons" created="Sun, 25 Jul 2010 13:22:23 +0000"  >&lt;p&gt;The issue still occurs even if the ProducerTemplate isn&apos;t being created on each send.&lt;/p&gt;</comment>
                            <comment id="12949272" author="davsclaus" created="Sun, 25 Jul 2010 18:14:12 +0000"  >&lt;p&gt;Can you create an example in pure java. For example as a JUnit test. Then we can use that as a test in camel-netty and much easier to use to lookup into the issue.&lt;/p&gt;</comment>
                            <comment id="12949271" author="seanparsons" created="Sun, 25 Jul 2010 19:11:49 +0000"  >&lt;p&gt;One Java based unit test that causes the same issue.&lt;/p&gt;</comment>
                            <comment id="12949028" author="davsclaus" created="Mon, 26 Jul 2010 13:14:16 +0000"  >&lt;p&gt;Sean&lt;/p&gt;

&lt;p&gt;Thanks for the test. I am looking into it right now and appears to have a fix.&lt;/p&gt;

&lt;p&gt;Can you try with Camel 2.4.0 to disable timeout. You do this to set &lt;tt&gt;timeout=0&lt;/tt&gt; in the endpoint uri.&lt;br/&gt;
The bug seems to be a timeout timer from Jetty which should have been shared and not prototype scoped &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.gif&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;</comment>
                            <comment id="12948768" author="davsclaus" created="Mon, 26 Jul 2010 13:33:44 +0000"  >&lt;p&gt;trunk: 979276.&lt;/p&gt;

&lt;p&gt;Sean fell free to also test with latest code from trunk.&lt;/p&gt;</comment>
                            <comment id="13023818" author="davsclaus" created="Sun, 24 Apr 2011 09:57:29 +0000"  >&lt;p&gt;Closing all resolved tickets from 2010 or older&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12463299" name="Camel2978Test.java" size="3565" author="seanparsons" created="Sun, 25 Jul 2010 19:11:49 +0000"/>
                            <attachment id="12463271" name="CamelBreakingTest.groovy" size="2268" author="seanparsons" created="Wed, 21 Jul 2010 20:27:07 +0000"/>
                            <attachment id="12463298" name="CamelBreakingTest2.groovy" size="2282" author="seanparsons" created="Sun, 25 Jul 2010 13:21:17 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>3.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Tue, 20 Jul 2010 23:07:21 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>76383</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            5 years, 32 weeks, 5 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i01rwn:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>8290</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        </customfields>
    </item>
</channel>
</rss>