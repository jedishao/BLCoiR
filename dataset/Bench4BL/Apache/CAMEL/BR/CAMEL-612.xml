<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Sat Dec 03 02:02:21 UTC 2016

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/CAMEL-612/CAMEL-612.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[CAMEL-612] Exchange should end in error when no choice in a ChoiceType matches</title>
                <link>https://issues.apache.org/jira/browse/CAMEL-612</link>
                <project id="12311211" key="CAMEL">Camel</project>
                    <description>&lt;p&gt;When you define a route with a choice() and no matching when() clause is found, the Exchange just ends successfully without doing anything.  In my mind, it should fail by default in this case (or we should at least have an easy way to get this behavior).&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;from(DIRECT_ROUTER).choice()
  .when(xpath(&lt;span class=&quot;code-quote&quot;&gt;&quot;/oc:order_confirmation/oc:order/oc:customer/@category = &apos;140&apos;&quot;&lt;/span&gt;))
    .to(DIRECT_CUSTOMER1)
  .when(xpath(&lt;span class=&quot;code-quote&quot;&gt;&quot;/oc:order_confirmation/oc:order/oc:customer/@category = &apos;116&apos;&quot;&lt;/span&gt;))
    .to(DIRECT_CUSTOMER2);
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</description>
                <environment></environment>
        <key id="12485277">CAMEL-612</key>
            <summary>Exchange should end in error when no choice in a ChoiceType matches</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/bug.png">Bug</type>
                                            <priority id="5" iconUrl="https://issues.apache.org/jira/images/icons/priorities/trivial.png">Trivial</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="gertvanthienen">Gert Vanthienen</assignee>
                                    <reporter username="gertvanthienen">Gert Vanthienen</reporter>
                        <labels>
                    </labels>
                <created>Mon, 16 Jun 2008 06:38:46 +0000</created>
                <updated>Fri, 11 Jul 2008 04:21:45 +0000</updated>
                            <resolved>Mon, 23 Jun 2008 12:41:58 +0000</resolved>
                                    <version>1.3.0</version>
                    <version>1.4.0</version>
                                    <fixVersion>1.4.0</fixVersion>
                                    <component>camel-core</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                <comments>
                            <comment id="12947461" author="davsclaus" created="Mon, 16 Jun 2008 08:55:20 +0000"  >&lt;p&gt;Gert I do think that the choice() should &lt;b&gt;always&lt;/b&gt; have an otherwise() so there always is a match.&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
from(DIRECT_ROUTER).choice()
  .when(xpath(&lt;span class=&quot;code-quote&quot;&gt;&quot;/oc:order_confirmation/oc:order/oc:customer/@category = &apos;140&apos;&quot;&lt;/span&gt;))
    .to(DIRECT_CUSTOMER1)
  .when(xpath(&lt;span class=&quot;code-quote&quot;&gt;&quot;/oc:order_confirmation/oc:order/oc:customer/@category = &apos;116&apos;&quot;&lt;/span&gt;))
    .to(DIRECT_CUSTOMER2);
  .otherwise().to(DIRECT_CUSTOMER3);
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;If the otherwise() is missing on the choice() then Camel should thrown an exception. Maybe checked during the route creation stuff.&lt;/p&gt;</comment>
                            <comment id="12947574" author="gertvanthienen" created="Tue, 17 Jun 2008 06:49:38 +0000"  >&lt;p&gt;Claus,&lt;/p&gt;

&lt;p&gt;I actually do think this use case for a choice() block does make sense.  I definitely do not want all my unmatched exchanges to go to any third customer, so I usually code something like:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
...otherwise().process(&lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; Processor() { &lt;span class=&quot;code-comment&quot;&gt;//make the exchange fail here });&lt;/span&gt;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;... to get my RouteBuilder&apos;s error handler to pick it up.&lt;/p&gt;

&lt;p&gt;We should at least make this behavior easier to implement or maybe even make it the default when no explicit otherwise() was given.  &lt;/p&gt;

&lt;p&gt;Gert&lt;/p&gt;</comment>
                            <comment id="12947506" author="hadrian" created="Tue, 17 Jun 2008 13:29:42 +0000"  >&lt;p&gt;-1 &lt;span class=&quot;error&quot;&gt;&amp;#91;edit: retracting my +1&amp;#93;&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;In other words if there is no explicit otherwise() to go the errorHandler (no redelivery of course).&lt;/p&gt;

&lt;p&gt;Thinking more about this I think the behavior of choice should be the way it already is.  If no clause matches and there is no otherwise it should silently succeed with a noop.  Users are familiar with this from switch() statements and is i think a reasonable expectation.&lt;/p&gt;

&lt;p&gt;I think it&apos;s perfectly reasonable to add the otherwise (as one would add a default: ) to make it explicit that the exchange should fail if there is no match:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
    [...].otherwise().exception(MyException.class);
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;What I would do though is adding a log (below INFO) in the ChoiceProcessor.process() if otherwise == null that would say that exchange is not processed.&lt;/p&gt;</comment>
                            <comment id="12947646" author="davsclaus" created="Wed, 18 Jun 2008 04:09:21 +0000"  >&lt;p&gt;Hadrian good comments.&lt;/p&gt;

&lt;p&gt;&amp;gt;In other words if there is no explicit otherwise() to go the errorHandler (no redelivery of course).&lt;br/&gt;
How can we archive this, the DeadLetterChannel is probably already &quot;chaining&quot; the routing?&lt;/p&gt;

&lt;p&gt;Would be good to have it documented somehow. I do think the wiki needs a section where each DSL types is documented one-by-one. That is a however a extensive work to do.&lt;/p&gt;</comment>
                            <comment id="12947530" author="gertvanthienen" created="Wed, 18 Jun 2008 14:29:47 +0000"  >&lt;p&gt;OK, I wasn&apos;t aware of the &lt;tt&gt;throwFault()&lt;/tt&gt; method that allows a user to easily make the message exchange fail instead of having to use the &lt;tt&gt;Processor&lt;/tt&gt; trick.  Reducing the priority of the issue, because I guess I only need to document the default, messsage filtering behavior of the choice() on the site to make people more aware of it.  &lt;/p&gt;</comment>
                            <comment id="12947673" author="gertvanthienen" created="Mon, 23 Jun 2008 12:41:58 +0000"  >&lt;p&gt;I added a warning to the logging in &lt;a href=&quot;http://svn.apache.org/viewvc?view=rev&amp;amp;revision=670544&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://svn.apache.org/viewvc?view=rev&amp;amp;revision=670544&lt;/a&gt; and I changed the documentation at &lt;a href=&quot;http://cwiki.apache.org/confluence/x/IcE&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://cwiki.apache.org/confluence/x/IcE&lt;/a&gt;&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Mon, 16 Jun 2008 08:55:20 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>83186</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            8 years, 24 weeks, 4 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i01dbb:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>5926</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        </customfields>
    </item>
</channel>
</rss>