<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Sun Dec 04 01:09:40 UTC 2016

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/CAMEL-3774/CAMEL-3774.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[CAMEL-3774] camel-manual generation fails during release process</title>
                <link>https://issues.apache.org/jira/browse/CAMEL-3774</link>
                <project id="12311211" key="CAMEL">Camel</project>
                    <description>&lt;p&gt;It works during a regular mvn install, but it fails during release:prepare. The bug is somewhere in the maven-html-to-pdf plugin. I hope a mock release using mvn -X will reveal the problem, but would take a frustrating amount of time. For now the available info is the output:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
[INFO] [INFO] [html-to-pdf:compile {execution: &lt;span class=&quot;code-keyword&quot;&gt;default&lt;/span&gt;}]
[INFO] [INFO] Downloading: http:&lt;span class=&quot;code-comment&quot;&gt;//camel.apache.org/book-in-one-page.html
&lt;/span&gt;[INFO] ERROR:  &apos;NOT_FOUND_ERR: An attempt is made to reference a node in a context where it does not exist.&apos;
[INFO] [ERROR] Download or validation of &apos;http:&lt;span class=&quot;code-comment&quot;&gt;//camel.apache.org/book-in-one-page.html&apos; failed: org.apache.camel.CamelException: Failed to convert the HTML to tidy Markup
&lt;/span&gt;[INFO] [INFO] Stored dummy file: /w1/apache/release/camel270/tooling/camel-manual/target/site/manual/camel-manual-2.7.0.html since download of http:&lt;span class=&quot;code-comment&quot;&gt;//camel.apache.org/book-in-one-page.html failed.&lt;/span&gt;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;The error points to a DOM related issue, but since the downloaded manual gets overwritten with the dummy file, I have no idea if the download got interrupted, or in what way the source gets corrupted.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12500970">CAMEL-3774</key>
            <summary>camel-manual generation fails during release process</summary>
                <type id="3" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/task.png">Task</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.png">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="hadrian">Hadrian Zbarcea</assignee>
                                    <reporter username="hadrian">Hadrian Zbarcea</reporter>
                        <labels>
                    </labels>
                <created>Thu, 10 Mar 2011 00:42:49 +0000</created>
                <updated>Thu, 5 Jan 2012 13:11:44 +0000</updated>
                            <resolved>Thu, 5 Jan 2012 13:11:44 +0000</resolved>
                                    <version>2.6.0</version>
                                    <fixVersion>2.7.5</fixVersion>
                    <fixVersion>2.8.4</fixVersion>
                    <fixVersion>2.9.1</fixVersion>
                    <fixVersion>2.10.0</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>1</watches>
                                                                <comments>
                            <comment id="13013893" author="davsclaus" created="Thu, 31 Mar 2011 09:19:56 +0000"  >&lt;p&gt;This issue doesnt affect Camel end users so changing to task type&lt;/p&gt;</comment>
                            <comment id="13155825" author="bvahdat" created="Wed, 23 Nov 2011 11:51:01 +0000"  >&lt;p&gt;Had a quick chance to look at this after the 2.8.3 release today. Be warned, I&apos;m not a Apache Maven expert, so maybe I&apos;m completely &lt;b&gt;wrong&lt;/b&gt; &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/wink.gif&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;

&lt;p&gt;Looking at &lt;span class=&quot;error&quot;&gt;&amp;#91;1&amp;#93;&lt;/span&gt; it says:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
 &lt;span class=&quot;code-keyword&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt; downloadContent() &lt;span class=&quot;code-keyword&quot;&gt;throws&lt;/span&gt; MalformedURLException, MojoExecutionException {
        &lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt; contentTag = &lt;span class=&quot;code-quote&quot;&gt;&quot;&amp;lt;div class=\&quot;&lt;/span&gt;&lt;span class=&quot;code-quote&quot;&gt;&quot; + contentDivClass + &quot;&lt;/span&gt;\&quot;&quot;;

        getLog().info(&lt;span class=&quot;code-quote&quot;&gt;&quot;Downloading: &quot;&lt;/span&gt; + page);
        URL url = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; URL(page);        
        
        &lt;span class=&quot;code-keyword&quot;&gt;try&lt;/span&gt; {
            TidyMarkupDataFormat dataFormat = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; TidyMarkupDataFormat();
            dataFormat.setMethod(&lt;span class=&quot;code-quote&quot;&gt;&quot;html&quot;&lt;/span&gt;);
            Node doc = dataFormat.asNodeTidyMarkup(&lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; BufferedInputStream(url.openStream()));
            XPath xpath = XPathFactory.newInstance().newXPath();
            Node nd = (Node)xpath.evaluate(&lt;span class=&quot;code-quote&quot;&gt;&quot;&lt;span class=&quot;code-comment&quot;&gt;//div[@class=&apos;&quot;&lt;/span&gt; + contentDivClass + &lt;span class=&quot;code-quote&quot;&gt;&quot;&apos;]&quot;&lt;/span&gt;, doc, XPathConstants.NODE);
&lt;/span&gt;            &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (nd != &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;) {
                &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt;  &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; XmlConverter().toString(nd, &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;);
            }
        } &lt;span class=&quot;code-keyword&quot;&gt;catch&lt;/span&gt; (Throwable e) {
            &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (errorOnDownloadFailure) {
                &lt;span class=&quot;code-keyword&quot;&gt;throw&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; MojoExecutionException(&lt;span class=&quot;code-quote&quot;&gt;&quot;Download or validation of &apos;&quot;&lt;/span&gt; + page + &lt;span class=&quot;code-quote&quot;&gt;&quot;&apos; failed: &quot;&lt;/span&gt; + e);
            } &lt;span class=&quot;code-keyword&quot;&gt;else&lt;/span&gt; {
                getLog().error(&lt;span class=&quot;code-quote&quot;&gt;&quot;Download or validation of &apos;&quot;&lt;/span&gt; + page + &lt;span class=&quot;code-quote&quot;&gt;&quot;&apos; failed: &quot;&lt;/span&gt; + e);
                &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;;
            }
        }        
        &lt;span class=&quot;code-keyword&quot;&gt;throw&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; MojoExecutionException(&lt;span class=&quot;code-quote&quot;&gt;&quot;The &apos;&quot;&lt;/span&gt; + page + &lt;span class=&quot;code-quote&quot;&gt;&quot;&apos; page did not have a &quot;&lt;/span&gt; + contentTag + &lt;span class=&quot;code-quote&quot;&gt;&quot; element.&quot;&lt;/span&gt;);
    }
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;On the other hand the default value of contentDivClass by this Mojo is:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
/**
  * The first div with who&apos;s class matches the contentDivClass will be
  * assumed to be the content section of the HTML and is what will be used as
  * the content in the PDF.
  *
  * @parameter &lt;span class=&quot;code-keyword&quot;&gt;default&lt;/span&gt;-value=&lt;span class=&quot;code-quote&quot;&gt;&quot;wiki-content&quot;&lt;/span&gt;
  */
  &lt;span class=&quot;code-keyword&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt; contentDivClass = &lt;span class=&quot;code-quote&quot;&gt;&quot;wiki-content&quot;&lt;/span&gt;;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;But looking at &lt;span class=&quot;error&quot;&gt;&amp;#91;2&amp;#93;&lt;/span&gt; the real value of the div-class element is:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
&amp;lt;DIV class=&lt;span class=&quot;code-quote&quot;&gt;&quot;wiki-content maincontent&quot;&lt;/span&gt;&amp;gt;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;So that the exception message of the TidyMarkupDataFormat doesn&apos;t surprise me too much:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
[INFO] ERROR:  &apos;NOT_FOUND_ERR: An attempt is made to reference a node in a context where it does not exist.&apos;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Other than that the method storeDummyFile() of &lt;span class=&quot;error&quot;&gt;&amp;#91;1&amp;#93;&lt;/span&gt; is:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
&lt;span class=&quot;code-keyword&quot;&gt;private&lt;/span&gt; void storeDummyFile() &lt;span class=&quot;code-keyword&quot;&gt;throws&lt;/span&gt; FileNotFoundException {
        PrintWriter out = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; PrintWriter(&lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; BufferedOutputStream(&lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; FileOutputStream(getHTMLFileName())));
        out.println(&lt;span class=&quot;code-quote&quot;&gt;&quot;&amp;lt;html&amp;gt;&quot;&lt;/span&gt;);
        out.println(&lt;span class=&quot;code-quote&quot;&gt;&quot;&amp;lt;body&amp;gt;Download of &quot;&lt;/span&gt; + page + &lt;span class=&quot;code-quote&quot;&gt;&quot; failed&amp;lt;/body&amp;gt;&quot;&lt;/span&gt;);
        out.close();
        getLog().info(&lt;span class=&quot;code-quote&quot;&gt;&quot;Stored dummy file: &quot;&lt;/span&gt; + getHTMLFileName() + &lt;span class=&quot;code-quote&quot;&gt;&quot; since download of &quot;&lt;/span&gt; + page + &lt;span class=&quot;code-quote&quot;&gt;&quot; failed.&quot;&lt;/span&gt;);
    }
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;which doesn&apos;t generate a valid HTML (the closing html tag is missing). IMHO we should generate something like:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
&amp;lt;html&amp;gt;
 &amp;lt;body&amp;gt;
  &amp;lt;a href=&lt;span class=&quot;code-quote&quot;&gt;&quot;http:&lt;span class=&quot;code-comment&quot;&gt;//camel.apache.org/book-in-one-page.html&quot;&lt;/span&gt;&amp;gt;Generation of the offline PDF version of the manual failed, however you could &lt;span class=&quot;code-keyword&quot;&gt;try&lt;/span&gt; the online HTML version here.&amp;lt;/a&amp;gt;
&lt;/span&gt; &amp;lt;/body&amp;gt;
&amp;lt;/html&amp;gt;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;So that in the case something goes wrong whatsoever we would still have a proper HTML pointing to the online version of the manual.&lt;/p&gt;

&lt;p&gt;I would love to provide a patch for this issue (I know, you love contributions &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.gif&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;), however I&apos;m afraid I will not be able to verify that as I&apos;m not a committer so that release:prepare would fail before ahead (I assume). So maybe some Rider (Hadrian?) could locally check/verify the patch before applying it into the trunk...&lt;/p&gt;

&lt;p&gt;Any thoughts?&lt;/p&gt;

&lt;p&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;1&amp;#93;&lt;/span&gt; &lt;a href=&quot;https://svn.apache.org/repos/asf/camel/trunk/tooling/maven/maven-html-to-pdf/src/main/java/org/apache/camel/maven/HtmlToPdfMojo.java&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://svn.apache.org/repos/asf/camel/trunk/tooling/maven/maven-html-to-pdf/src/main/java/org/apache/camel/maven/HtmlToPdfMojo.java&lt;/a&gt;&lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;2&amp;#93;&lt;/span&gt; &lt;a href=&quot;http://camel.apache.org/book-in-one-page.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://camel.apache.org/book-in-one-page.html&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="13155860" author="hadrian" created="Wed, 23 Nov 2011 13:26:58 +0000"  >&lt;p&gt;Your findings are consistent with mine. The part I didn&apos;t figure out is why the manual is generated properly via mvn install but not during release:prepare. I stopped looking at it a while back, but I owe it to your efforts to look into it again.&lt;/p&gt;

&lt;p&gt;I&apos;ll be back with details. Thanks.&lt;/p&gt;</comment>
                            <comment id="13155872" author="bvahdat" created="Wed, 23 Nov 2011 13:48:24 +0000"  >&lt;p&gt;@Hadrian,&lt;/p&gt;

&lt;p&gt;I&apos;m afraid I was wrong with my assumption as I didn&apos;t check &lt;span class=&quot;error&quot;&gt;&amp;#91;1&amp;#93;&lt;/span&gt; before commenting on this ticket where the default value of contentDivClass member variable of the Mojo HtmlToPdfMojo gets overriden with the one injected through the plugin configuration, that&apos;s &apos;wiki-content maincontent&apos;:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
         &amp;lt;plugin&amp;gt;
            &amp;lt;groupId&amp;gt;org.apache.camel&amp;lt;/groupId&amp;gt;
            &amp;lt;artifactId&amp;gt;maven-html-to-pdf&amp;lt;/artifactId&amp;gt;
            &amp;lt;version&amp;gt;${project.version}&amp;lt;/version&amp;gt;
            &amp;lt;executions&amp;gt;
              &amp;lt;execution&amp;gt;
                &amp;lt;goals&amp;gt;
                  &amp;lt;goal&amp;gt;compile&amp;lt;/goal&amp;gt;
                &amp;lt;/goals&amp;gt;
                &amp;lt;phase&amp;gt;compile&amp;lt;/phase&amp;gt;
              &amp;lt;/execution&amp;gt;
            &amp;lt;/executions&amp;gt;    
            &amp;lt;configuration&amp;gt;
              &amp;lt;page&amp;gt;http:&lt;span class=&quot;code-comment&quot;&gt;//camel.apache.org/book-in-one-page.html&amp;lt;/page&amp;gt;
&lt;/span&gt;              &amp;lt;contentDivClass&amp;gt;wiki-content maincontent&amp;lt;/contentDivClass&amp;gt;
              &amp;lt;head&amp;gt;&amp;lt;![CDATA[ 
                  &amp;lt;link href=&lt;span class=&quot;code-quote&quot;&gt;&quot;file:${basedir}/src/styles/print.css&quot;&lt;/span&gt; rel=&lt;span class=&quot;code-quote&quot;&gt;&quot;stylesheet&quot;&lt;/span&gt; type=&lt;span class=&quot;code-quote&quot;&gt;&quot;text/css&quot;&lt;/span&gt; /&amp;gt;
                  &amp;lt;style type=&lt;span class=&quot;code-quote&quot;&gt;&quot;text/css&quot;&lt;/span&gt;&amp;gt;
                    @page :left {
                      @top-left {
                        content: &lt;span class=&quot;code-quote&quot;&gt;&quot;Apache Camel ${project.version} Developer&apos;s Manual&quot;&lt;/span&gt;;
                      }
                    }
                  &amp;lt;/style&amp;gt;
              ]]&amp;gt;&amp;lt;/head&amp;gt;
              &amp;lt;replaceToken&amp;gt;&amp;lt;![CDATA[
                  &amp;lt;h3 id=&lt;span class=&quot;code-quote&quot;&gt;&quot;replaceme&quot;&lt;/span&gt;&amp;gt;.*&amp;lt;/h3&amp;gt;
              ]]&amp;gt;&amp;lt;/replaceToken&amp;gt;
              &amp;lt;replaceValue&amp;gt;&amp;lt;![CDATA[
                  &amp;lt;h3&amp;gt;Version ${project.version}&amp;lt;/h3&amp;gt;
              ]]&amp;gt;&amp;lt;/replaceValue&amp;gt;
            &amp;lt;/configuration&amp;gt;
          &amp;lt;/plugin&amp;gt;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;If what I claimed was right it should have always systematically failed which is apparently not the case. Still looking into it in the hope of some findings.&lt;/p&gt;

&lt;p&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;1&amp;#93;&lt;/span&gt; &lt;a href=&quot;https://svn.apache.org/repos/asf/camel/trunk/tooling/camel-manual/pom.xml&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://svn.apache.org/repos/asf/camel/trunk/tooling/camel-manual/pom.xml&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="13155878" author="hadrian" created="Wed, 23 Nov 2011 14:00:36 +0000"  >&lt;p&gt;Yeah, it&apos;s even a bit worse than that. If you try to validate the pages using a validator (like the &lt;a href=&quot;http://validator.w3.org/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;w3c&lt;/a&gt; one) there are a bunch of errors in the generated html pages that need fixing. They didn&apos;t get high on my priority list because at some point we were discussing other/better ways of providing docs.&lt;/p&gt;</comment>
                            <comment id="13155899" author="bvahdat" created="Wed, 23 Nov 2011 14:44:42 +0000"  >&lt;p&gt;My post seems not to get accepted so that I simply paste the Nabble link into here:&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;http://camel.465427.n5.nabble.com/svn-commit-r1205412-camel-trunk-tooling-maven-maven-html-to-pdf-src-main-java-org-apache-camel-mavena-td5016786.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://camel.465427.n5.nabble.com/svn-commit-r1205412-camel-trunk-tooling-maven-maven-html-to-pdf-src-main-java-org-apache-camel-mavena-td5016786.html&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="13157029" author="bvahdat" created="Fri, 25 Nov 2011 08:40:15 +0000"  >&lt;p&gt;As I&apos;ve already claimed by this ticket, trying:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
mvn release:prepare -DdryRun=&lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt; 
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;failes beforehand by me @ maven-gpg-plugin because of the missing public key of mine in &lt;span class=&quot;error&quot;&gt;&amp;#91;1&amp;#93;&lt;/span&gt;. So that I can&apos;t even reproduce the issue on my box. I think even better than &quot;mvn -X ...&quot; one could attach (remotely through IDE) to the maven process with something like:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
MAVEN_OPTS = ... -Xdebug -Xrunjdwp:transport=dt_socket,server=y,suspend=n,address=1044
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;And then one could follow the exception chain completely down to the root cause where it&apos;s thrown. However &quot;mvn -X ...&quot; on the other hand would dump something like:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
...
 Caused by: ...
         ... 27 more
...
.....
 Caused by: ...
         ... 9 more
...
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;into the console which wouldn&apos;t really give a clue where/why it has been thrown. Having the exact point where it&apos;s thrown would then give us a good clue for further investigation. Regarding the puzzle why &quot;mvn install&quot; works but not &quot;mvn release&quot; I suspect that the classpath setup through maven are different in those cases, one with Xerces and/or Xalan and one without, which seem to have some issues see &lt;span class=&quot;error&quot;&gt;&amp;#91;2&amp;#93;&lt;/span&gt; &amp;amp; &lt;span class=&quot;error&quot;&gt;&amp;#91;3&amp;#93;&lt;/span&gt; and also the comments in &lt;span class=&quot;error&quot;&gt;&amp;#91;4&amp;#93;&lt;/span&gt;.&lt;/p&gt;

&lt;p&gt;In worst case I think we should move towards something else other than Tagsoup. The ones I&apos;m aware of are:&lt;/p&gt;

&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;NekoHTML&lt;/li&gt;
	&lt;li&gt;HtmlCleaner&lt;/li&gt;
	&lt;li&gt;jTidy&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;I&apos;ll try to reproduce the behaviour using some of my own Apps but without much hope &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/sad.gif&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;

&lt;p&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;1&amp;#93;&lt;/span&gt; &lt;a href=&quot;https://svn.apache.org/repos/asf/camel/trunk/KEYS&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://svn.apache.org/repos/asf/camel/trunk/KEYS&lt;/a&gt;&lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;2&amp;#93;&lt;/span&gt; &lt;a href=&quot;http://osdir.com/ml/text.xml.xforms.chiba.devel/2005-03/msg00068.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://osdir.com/ml/text.xml.xforms.chiba.devel/2005-03/msg00068.html&lt;/a&gt;&lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;3&amp;#93;&lt;/span&gt; &lt;a href=&quot;http://apache-tika-users.1629097.n2.nabble.com/Xerces-Xalan-x-marks-the-spot-td3791968.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://apache-tika-users.1629097.n2.nabble.com/Xerces-Xalan-x-marks-the-spot-td3791968.html&lt;/a&gt;&lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;4&amp;#93;&lt;/span&gt; &lt;a href=&quot;https://svn.apache.org/repos/asf/camel/trunk/components/camel-tagsoup/pom.xml&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://svn.apache.org/repos/asf/camel/trunk/components/camel-tagsoup/pom.xml&lt;/a&gt;&lt;br/&gt;
Babak&lt;/p&gt;</comment>
                            <comment id="13157031" author="njiang" created="Fri, 25 Nov 2011 08:48:53 +0000"  >&lt;p&gt;Hi Babak&lt;/p&gt;

&lt;p&gt;I can reproduce the error without try to release the camel in the trunk now.&lt;br/&gt;
Did you try to reproduce the error by just using mvn clean install ?&lt;/p&gt;</comment>
                            <comment id="13157035" author="bvahdat" created="Fri, 25 Nov 2011 08:57:37 +0000"  >&lt;p&gt;Hi Willem,&lt;/p&gt;

&lt;p&gt;doing&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
mvn clean install
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;worked fine on my box yesterday night which created a proper PDF &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/sad.gif&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt; I&apos;ll try to do install again tonight @ home and will attach the generated PDF into this ticket.&lt;/p&gt;

&lt;p&gt;Have you installed prince &lt;span class=&quot;error&quot;&gt;&amp;#91;1&amp;#93;&lt;/span&gt; on your box (I&apos;ve got version 8 of it) and do you have it properly on PATH? This is imporant for a proper PDF generation through maven-html-to-pdf plugin, however this has not been mentioned in &lt;span class=&quot;error&quot;&gt;&amp;#91;2&amp;#93;&lt;/span&gt;.&lt;/p&gt;

&lt;p&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;1&amp;#93;&lt;/span&gt; &lt;a href=&quot;http://www.princexml.com&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://www.princexml.com&lt;/a&gt;&lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;2&amp;#93;&lt;/span&gt; &lt;a href=&quot;http://camel.apache.org/release-guide.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://camel.apache.org/release-guide.html&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Babak&lt;/p&gt;</comment>
                            <comment id="13157147" author="njiang" created="Fri, 25 Nov 2011 13:30:13 +0000"  >&lt;p&gt;Hi Babak&lt;/p&gt;

&lt;p&gt;I tried run mvn clean install on the tooling/camel-manual/, I got the same failure when I used mvn 2.2.1 and 3.0.2.&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
Using Java version: 1.6.0
Apache Maven 2.2.1 (r801777; 2009-08-07 03:16:01+0800)
Java version: 1.6.0_26
Java home: /Library/Java/JavaVirtualMachines/1.6.0_26-b03-383.jdk/Contents/Home
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="13157162" author="bvahdat" created="Fri, 25 Nov 2011 14:10:59 +0000"  >&lt;p&gt;Hi Willem,&lt;/p&gt;

&lt;p&gt;My maven setup is:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
D:\Data\eclipse-workspace\camel-trunk\tooling\camel-manual&amp;gt;mvn --version
Apache Maven 3.0.3 (r1075438; 2011-02-28 18:31:09+0100)
Maven home: P:\My Documents\dev\env\apache-maven-3.0.3\bin\..
Java version: 1.6.0_29, vendor: Sun Microsystems Inc.
Java home: C:\Program Files\Java\jdk1.6.0_29\jre
Default locale: de_CH, platform encoding: Cp1252
OS name: &lt;span class=&quot;code-quote&quot;&gt;&quot;windows xp&quot;&lt;/span&gt;, version: &lt;span class=&quot;code-quote&quot;&gt;&quot;5.1&quot;&lt;/span&gt;, arch: &lt;span class=&quot;code-quote&quot;&gt;&quot;x86&quot;&lt;/span&gt;, family: &lt;span class=&quot;code-quote&quot;&gt;&quot;windows&quot;&lt;/span&gt;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;And when I do mvn clean install on tooling/camel-manual, I get the following output:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
[INFO] Downloading: http:&lt;span class=&quot;code-comment&quot;&gt;//camel.apache.org/book-in-one-page.html
&lt;/span&gt;[INFO] Stored: D:\Data\eclipse-workspace\camel-trunk\tooling\camel-manual\target/site/manual/camel-manual-2.9-SNAPSHOT.html
[INFO] Converting to PDF with prince...
[INFO] About to execute PrinceXml (see www.princexml.com)
[INFO]  prince D:\Data\eclipse-workspace\camel-trunk\tooling\camel-manual\target/site/manual/camel-manual-2.9-SNAPSHOT.html D:\Data\eclipse-workspace\camel-trunk\tooling\camel-manual\target/site/manual/camel-manual-2.9-SNAPSHOT.pdf
[INFO]
[INFO] --- build-helper-maven-plugin:1.5:attach-artifact (attach-artifacts) @ camel-manual ---
[INFO]
[INFO] --- ianal-maven-plugin:1.0-alpha-1:verify-legal-files (&lt;span class=&quot;code-keyword&quot;&gt;default&lt;/span&gt;) @ camel-manual ---
[INFO]
[INFO] --- maven-install-plugin:2.3.1:install (&lt;span class=&quot;code-keyword&quot;&gt;default&lt;/span&gt;-install) @ camel-manual ---
[INFO] Installing D:\Data\eclipse-workspace\camel-trunk\tooling\camel-manual\pom.xml to D:\Data\Maven\repo\org\apache\camel\camel-manual\2.9-SNAPSHOT\camel-manual-2.9-SNAPSHOT.pom
[INFO] Installing D:\Data\eclipse-workspace\camel-trunk\tooling\camel-manual\target\site\manual\camel-manual-2.9-SNAPSHOT.pdf to D:\Data\Maven\repo\org\apache\camel\camel-manual\2.9-SNAPSHOT\camel-manual-2.9-SNAPSHOT.pdf
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Which produces a proper readable PDF &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/sad.gif&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt; &lt;/p&gt;

&lt;p&gt;Please note that I edited my previous post on this ticket with some more informations about princexml. Could you check it please?&lt;/p&gt;

&lt;p&gt;On windows before I do mvn clean install inside terminal I put prince.exe into the Windows PATH variable, that&apos;s:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
PATH=%PATH%;P:\My Documents\dev\env\prince\Engine\bin
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;On Unix / Mac (I assume) it would be something like &lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
export PATH=$PATH:&amp;lt;path_to_your_princexml_installation&amp;gt;/Engine/bin
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;After setting the PATH properly then I do mvn clean install, which as said before creates the PDF properly. You can download princexml @ &lt;span class=&quot;error&quot;&gt;&amp;#91;1&amp;#93;&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;1&amp;#93;&lt;/span&gt; &lt;a href=&quot;http://www.princexml.com/download/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://www.princexml.com/download/&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Babak&lt;/p&gt;</comment>
                            <comment id="13157174" author="bvahdat" created="Fri, 25 Nov 2011 14:37:26 +0000"  >&lt;p&gt;@Willem&lt;/p&gt;

&lt;p&gt;Just checked the MacOS distribution for princexml @ &lt;span class=&quot;error&quot;&gt;&amp;#91;1&amp;#93;&lt;/span&gt;. The installation steps there seem to be different.&lt;br/&gt;
So please check &apos;install.sh&apos; &amp;amp; &apos;README.TXT&apos; inside it.&lt;/p&gt;

&lt;p&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;1&amp;#93;&lt;/span&gt; &lt;a href=&quot;http://www.princexml.com/download/prince-8.0-macosx.tar.gz&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://www.princexml.com/download/prince-8.0-macosx.tar.gz&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Babak&lt;/p&gt;</comment>
                            <comment id="13157281" author="bvahdat" created="Fri, 25 Nov 2011 18:52:47 +0000"  >&lt;p&gt;@Willem,&lt;/p&gt;

&lt;p&gt;as already promised I attached the generated PDF on my box (camel-manual-2.9-SNAPSHOT.pdf) into this ticket. The odd thing I realized is that all chapters by the second page (Table Of Contents) point to &quot;Chapter 1&quot;. Nevertheless it&apos;s still a proper and readable PDF.&lt;/p&gt;

&lt;p&gt;Maybe you should check your setup regarding princexml installation, see my previous posts regarding this by this ticket. Could you maybe paste the maven output when you do mvn clean install on tooling/camel-manual?&lt;/p&gt;

&lt;p&gt;Babak &lt;/p&gt;</comment>
                            <comment id="13157306" author="hadrian" created="Fri, 25 Nov 2011 21:12:23 +0000"  >&lt;p&gt;@Babak, out of curiosity, why did you attach the manual pdf? It can be generated just fine. It&apos;s just during the release phase that there is a problem with the download. For all minor releases I generated it manually and uploaded to the staging site.&lt;/p&gt;</comment>
                            <comment id="13157402" author="bvahdat" created="Sat, 26 Nov 2011 07:20:14 +0000"  >&lt;p&gt;@Hadrain, just to make Willem believe that the pdf generation works on my box during the install! Apparently even that seems not to work on his box.&lt;/p&gt;</comment>
                            <comment id="13157708" author="bvahdat" created="Sun, 27 Nov 2011 09:26:25 +0000"  >&lt;p&gt;@Hadrian&lt;/p&gt;

&lt;p&gt;As I can&apos;t reproduce the issue on my box (see my previous comments because of the maven-gpg-plugin) would it be possible for you to do:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
mvn -X -DdryRun=&lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt; release:prepare &amp;gt; camel-3774.log
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;and attach the output on this ticket, so that I can get some clue about the problem cause?&lt;/p&gt;</comment>
                            <comment id="13178748" author="bvahdat" created="Tue, 3 Jan 2012 14:22:17 +0000"  >&lt;p&gt;O.K. now I was also able to &lt;b&gt;reproduce&lt;/b&gt; the issue on my box and therefore could find a workaround for solving the problem.&lt;/p&gt;

&lt;p&gt;If you go to &lt;span class=&quot;error&quot;&gt;&amp;#91;1&amp;#93;&lt;/span&gt; on your workspace and do a &lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
mvn clean install -Dtest=foo
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;The PDF generation fails as described by this ticket description of Hadrian, but if you change to &lt;span class=&quot;error&quot;&gt;&amp;#91;2&amp;#93;&lt;/span&gt; and do the same, then PDF will get generated successfully (as I also attached once to this ticket while ago). Please note that the PDF generation will be done only if the fastinstall profile is not active so that I did above -Dtest=foo as there&apos;e no test called &quot;foo&quot; I could verify the behaviour much faster.&lt;/p&gt;

&lt;p&gt;But what this exactly means? We do &lt;b&gt;exactly the same&lt;/b&gt; at &lt;b&gt;two different&lt;/b&gt; project directory levels but the behaviour is different! One possible explanation is &lt;span class=&quot;error&quot;&gt;&amp;#91;3&amp;#93;&lt;/span&gt;, that&apos;s the DOM implemenataion used by the JDK-XSLT seems to be &lt;b&gt;not thread-safe&lt;/b&gt;. When you run maven at the level of &lt;span class=&quot;error&quot;&gt;&amp;#91;2&amp;#93;&lt;/span&gt; you have so to say a &lt;b&gt;virgin&lt;/b&gt; JDK launching up, but running maven under &lt;span class=&quot;error&quot;&gt;&amp;#91;1&amp;#93;&lt;/span&gt; folder it will &lt;b&gt;take a really long way&lt;/b&gt; until the build of camel-manual maven module is reached and &lt;b&gt;exactly at this point&lt;/b&gt; the inconsistency (under sun-jdk) by the class&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
com.sun.org.apache.xerces.internal.dom.AttrImpl   
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;has already happened!&lt;/p&gt;

&lt;p&gt;I&apos;ve already attached the patch &lt;a href=&quot;https://issues.apache.org/jira/browse/CAMEL-3774&quot; title=&quot;camel-manual generation fails during release process&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CAMEL-3774&quot;&gt;&lt;del&gt;CAMEL-3774&lt;/del&gt;&lt;/a&gt;.patch to this ticket which resolved the issue on my box even if I run maven at the level of the folder &lt;span class=&quot;error&quot;&gt;&amp;#91;1&amp;#93;&lt;/span&gt;. The solution is pretty simply the HtmlToPdfMojo now supports &lt;b&gt;an optional&lt;/b&gt; transformerFactoryClassName field which we set to org.apache.xalan.xsltc.trax.TransformerFactoryImpl not having this thread-safety issue.&lt;/p&gt;

&lt;p&gt;Please note that the prerequisite for a proper PDF generation is an available installation of &lt;b&gt;princexml&lt;/b&gt; on the PATH. On my iMac I installed it under the PATH&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
/Users/bvahdat/dev/prince   
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;And before calling maven I did&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
PATH=$PATH:/Users/bvahdat/dev/prince/bin
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;So that princexml can be successfully kicked off by HtmlToPdfMojo (plexus-utils API is used there).&lt;/p&gt;

&lt;p&gt;How further:&lt;/p&gt;

&lt;p&gt;As Christian intends to provide the last 2.7.5 release (see &lt;span class=&quot;error&quot;&gt;&amp;#91;5&amp;#93;&lt;/span&gt;) I propose to first apply this patch to the 2.7.x branch and if it indeed did the trick we can still apply it afterwards to the 2.8.x and the trunk.&lt;/p&gt;

&lt;p&gt;@Christian&lt;br/&gt;
Please let me know what you think about this and if you&apos;ve got any questions. Thanks!&lt;/p&gt;

&lt;p&gt;BTW yesterday I did a full &lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
mvn clean install
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;with &lt;b&gt;all&lt;/b&gt; tests passing on the trunk with a proper PDF &amp;amp; HTML inside the generated zip &amp;amp; tarball under the /doc/manual folder &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.gif&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;

&lt;p&gt;And just noticed that the steps regarding the princexml installation &amp;amp; setup is not mentioned in &lt;span class=&quot;error&quot;&gt;&amp;#91;6&amp;#93;&lt;/span&gt; at all which we may also want to add as well.&lt;/p&gt;

&lt;p&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;1&amp;#93;&lt;/span&gt; &lt;a href=&quot;https://svn.apache.org/repos/asf/camel/trunk/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://svn.apache.org/repos/asf/camel/trunk/&lt;/a&gt;&lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;2&amp;#93;&lt;/span&gt; &lt;a href=&quot;https://svn.apache.org/repos/asf/camel/trunk/tooling/camel-manual/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://svn.apache.org/repos/asf/camel/trunk/tooling/camel-manual/&lt;/a&gt;&lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;3&amp;#93;&lt;/span&gt; &lt;a href=&quot;http://osdir.com/ml/text.xml.xforms.chiba.devel/2005-03/msg00068.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://osdir.com/ml/text.xml.xforms.chiba.devel/2005-03/msg00068.html&lt;/a&gt;&lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;4&amp;#93;&lt;/span&gt; &lt;a href=&quot;http://www.princexml.com/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://www.princexml.com/&lt;/a&gt;&lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;5&amp;#93;&lt;/span&gt; &lt;a href=&quot;http://camel.465427.n5.nabble.com/DISCUSS-Dropping-support-for-Camel-2-7-x-tp5112509p5113252.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://camel.465427.n5.nabble.com/DISCUSS-Dropping-support-for-Camel-2-7-x-tp5112509p5113252.html&lt;/a&gt;&lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;6&amp;#93;&lt;/span&gt; &lt;a href=&quot;http://camel.apache.org/release-guide.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://camel.apache.org/release-guide.html&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="13178824" author="hadrian" created="Tue, 3 Jan 2012 17:08:43 +0000"  >&lt;p&gt;@Babak, my findings are different than yours. For me, the PDF manual gets generated properly from both &lt;span class=&quot;error&quot;&gt;&amp;#91;1&amp;#93;&lt;/span&gt; and &lt;span class=&quot;error&quot;&gt;&amp;#91;2&amp;#93;&lt;/span&gt; (your links). It&apos;s just during release:* when the generation fails, and the configuration seems to be the same (although something is clearly different as the generation fails only during release). I will test your findings on both osx and linux though. Thanks!&lt;/p&gt;</comment>
                            <comment id="13178996" author="bvahdat" created="Tue, 3 Jan 2012 20:24:51 +0000"  >&lt;p&gt;@Hadrian, just right before I gave it a test on my Windows box as well with a &lt;b&gt;consistent&lt;/b&gt; result compared to my Mac box, that&apos;s without the provided patch while doing&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
mvn clean install -Dtest=foo
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;on &lt;span class=&quot;error&quot;&gt;&amp;#91;1&amp;#93;&lt;/span&gt; I get:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
[INFO] --- maven-html-to-pdf:2.10-SNAPSHOT:compile (&lt;span class=&quot;code-keyword&quot;&gt;default&lt;/span&gt;) @ camel-manual ---
[INFO] Downloading: http:&lt;span class=&quot;code-comment&quot;&gt;//camel.apache.org/book-in-one-page.html
&lt;/span&gt;FEHLER:  &apos;NOT_FOUND_ERR: An attempt is made to reference a node in a context where it does not exist.&apos;
[ERROR] Download or validation of &apos;http:&lt;span class=&quot;code-comment&quot;&gt;//camel.apache.org/book-in-one-page.html&apos; failed: org.apache.camel.CamelException: Failed to convert the HTML to tidy Markup
&lt;/span&gt;[INFO] Stored dummy file: C:\dev\workspace\camel\tooling\camel-manual\target/site/manual/camel-manual-2.10-SNAPSHOT.html since download of http:&lt;span class=&quot;code-comment&quot;&gt;//camel.apache.org/book-in-one-page.html failed.&lt;/span&gt;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;And with the patch applied on my workspace I get:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
[INFO] --- maven-html-to-pdf:2.10-SNAPSHOT:compile (&lt;span class=&quot;code-keyword&quot;&gt;default&lt;/span&gt;) @ camel-manual ---
[INFO] Set the XSL transformer factory class name to be &apos;org.apache.xalan.xsltc.trax.TransformerFactoryImpl&apos;
[INFO] Downloading: http:&lt;span class=&quot;code-comment&quot;&gt;//camel.apache.org/book-in-one-page.html
&lt;/span&gt;[INFO] Removed the set XSL transformer factory class name &apos;org.apache.xalan.xsltc.trax.TransformerFactoryImpl&apos; from the system properties
[INFO] Stored: c:\dev\workspace\camel\tooling\camel-manual\target/site/manual/camel-manual-2.10-SNAPSHOT.html
[INFO] Converting to PDF with prince...
[INFO] About to execute PrinceXml (see www.princexml.com)
[INFO]  prince c:\dev\workspace\camel\tooling\camel-manual\target/site/manual/camel-manual-2.10-SNAPSHOT.html c:\dev\workspace\camel\tooling\camel-manual\target/site/manual/camel-manual-2.10-SNAPSHOT.pdf
[INFO] Stored: c:\dev\workspace\camel\tooling\camel-manual\target/site/manual/camel-manual-2.10-SNAPSHOT.pdf
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Where the generated zip &amp;amp; tar artifacts both contain a proper HTML &amp;amp; PDF copy of the manual. For any case I put my workspace setup just in the case you may want to compare with yours:&lt;/p&gt;

&lt;p&gt;Windows:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
c:\dev\workspace\camel&amp;gt;mvn -verrsion
Apache Maven 3.0.3 (r1075438; 2011-02-28 18:31:09+0100)
Maven home: c:\dev\apache-maven-3.0.3\bin\..
Java version: 1.6.0_29, vendor: Sun Microsystems Inc.
Java home: c:\dev\jdk1.6\jre
Default locale: de_CH, platform encoding: Cp1252
OS name: &lt;span class=&quot;code-quote&quot;&gt;&quot;windows vista&quot;&lt;/span&gt;, version: &lt;span class=&quot;code-quote&quot;&gt;&quot;6.0&quot;&lt;/span&gt;, arch: &lt;span class=&quot;code-quote&quot;&gt;&quot;x86&quot;&lt;/span&gt;, family: &lt;span class=&quot;code-quote&quot;&gt;&quot;windows&quot;&lt;/span&gt;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;MacOS:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
~/dev/workspace/camel&amp;gt;mvn -version
Apache Maven 3.0.3 (r1075438; 2011-02-28 18:31:09+0100)
Maven home: /usr/share/maven
Java version: 1.6.0_29, vendor: Apple Inc.
Java home: /&lt;span class=&quot;code-object&quot;&gt;System&lt;/span&gt;/Library/Java/JavaVirtualMachines/1.6.0.jdk/Contents/Home
Default locale: de_DE, platform encoding: MacRoman
OS name: &lt;span class=&quot;code-quote&quot;&gt;&quot;mac os x&quot;&lt;/span&gt;, version: &lt;span class=&quot;code-quote&quot;&gt;&quot;10.7.2&quot;&lt;/span&gt;, arch: &lt;span class=&quot;code-quote&quot;&gt;&quot;x86_64&quot;&lt;/span&gt;, family: &lt;span class=&quot;code-quote&quot;&gt;&quot;mac&quot;&lt;/span&gt;

&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;1&amp;#93;&lt;/span&gt; &lt;a href=&quot;https://svn.apache.org/repos/asf/camel/trunk/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://svn.apache.org/repos/asf/camel/trunk/&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="13179878" author="bvahdat" created="Wed, 4 Jan 2012 21:16:55 +0000"  >&lt;p&gt;@Hadrian, as Christian intends to cut the last 2.7.x branch release by &lt;b&gt;this&lt;/b&gt; freiday 01/06/2011 that&apos;s not much time left.&lt;br/&gt;
I believe the provided patch does the trick, but the last proof would be using it while doing a dry run of the release.&lt;/p&gt;

&lt;p&gt;I think we all would love to see a proper HTML &amp;amp; PDF by the next 2.7.5 release tar ball. See also my previous post of the last night after yours.&lt;/p&gt;</comment>
                            <comment id="13180004" author="bvahdat" created="Thu, 5 Jan 2012 00:06:44 +0000"  >&lt;p&gt;Right before I had a chat with Hadrian on IRC-Room which partially was:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
[22:22]
&quot;
&#8220;Hadrian just something came to my mind, may I ask you something?,&#8221;
&quot;
asked bvahdat.
[22:22]
&quot;
&#8220;shoot,&#8221;
&quot;
said hadrian.
[22:24]
&quot;
&#8220;On the ticket CAMEL-3774 you claimed always that &lt;span class=&quot;code-quote&quot;&gt;&quot;the generation fails only during release&quot;&lt;/span&gt;. Now I don&apos;t get it at all!!!,&#8221;
&quot;
exclaimed bvahdat.
[22:25]
&quot;
&#8220;bvahdat: you said it yourself: when you go to tooling/camel-manual and run `mvn install` the generation passes,&#8221;
&quot;
said hadrian.
[22:26]
&quot;
&#8220;that&apos;s how i generated: http:&lt;span class=&quot;code-comment&quot;&gt;//camel.apache.org/manual/camel-manual-2.9.0.pdf,&#8221;
&lt;/span&gt;&quot;
said hadrian.
[22:26]
&quot;
&#8220;O.K. I see,&#8221;
&quot;
said bvahdat.
[22:27]
&quot;
&#8220;Was the output again &lt;span class=&quot;code-quote&quot;&gt;&quot;&apos;NOT_FOUND_ERR: An attempt is made to reference a node in a context where it does not exist.&apos;&quot;&lt;/span&gt; Or something &lt;span class=&quot;code-keyword&quot;&gt;else&lt;/span&gt;?,&#8221;
&quot;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;@Hadrian, but when I read your comment on this ticket again at 03/Jan/12 17:08 you said that:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
my findings are different than yours. For me, the PDF manual gets generated properly from both [1] and [2] (your links). It&apos;s just during release:* when the generation fails
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Now I don&apos;t really get it now if / when it works / doesn&apos;t work on your box! Please help me understand it. Thanks!&lt;/p&gt;</comment>
                            <comment id="13180170" author="hadrian" created="Thu, 5 Jan 2012 04:14:11 +0000"  >&lt;p&gt;Babak, after wiping out my local maven repo your patch seems to be working on Linux. I tested and committed on branches 2.7.x up to trunk. I am currently running a release dryRun on osx, which I had to restart due to a checkstyle error. We will know more in the morning, and hopefully be able to close this issue. Thanks again for taking the time.&lt;/p&gt;</comment>
                            <comment id="13180359" author="hadrian" created="Thu, 5 Jan 2012 13:11:10 +0000"  >&lt;p&gt;The release dryRun went fine on osx. I have no reason to believe it won&apos;t work on other platforms. I will mark this issue as resolved. Thanks again Babak for the patch.&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="12310000">
                    <name>Duplicate</name>
                                                                <inwardlinks description="is duplicated by">
                                        <issuelink>
            <issuekey id="12515807">CAMEL-4284</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12509180" name="CAMEL-3774.patch" size="4814" author="bvahdat" created="Tue, 3 Jan 2012 08:23:15 +0000"/>
                            <attachment id="12505149" name="camel-manual-2.9-SNAPSHOT.pdf" size="4286697" author="bvahdat" created="Fri, 25 Nov 2011 18:44:23 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Thu, 31 Mar 2011 09:19:56 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>66609</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            4 years, 48 weeks, 2 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i01wtb:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9085</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        </customfields>
    </item>
</channel>
</rss>