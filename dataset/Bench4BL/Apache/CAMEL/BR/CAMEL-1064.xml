<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Sat Dec 03 01:30:52 UTC 2016

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/CAMEL-1064/CAMEL-1064.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[CAMEL-1064] Camel ActiveMQ service not recovering from lost broker</title>
                <link>https://issues.apache.org/jira/browse/CAMEL-1064</link>
                <project id="12311211" key="CAMEL">Camel</project>
                    <description>&lt;p&gt;If the ActiveMQ broker is shut down and then started again while a Camel ActiveMQ endpoint based program is listening on its queue, the program does not pick the queue back up for consuming when ActiveMQ is back up. Anything subsequently posted to the new broker becomes available only when the Camel program is restarted.&lt;/p&gt;

&lt;p&gt;This is a problem in production style scenarios where the broker has to be restarted for some reason e.g. so that modifications to its configuration can be made.&lt;/p&gt;

&lt;p&gt;I have been able to observe the above behaviour with the camel-example-jms-file project and attach a modified version of the CamelJmsToFileExample.java file. My modifications bind to the broker at tcp://localhost:61616 and cause the example to pause for 20s before sending out any messages. In this time, if the broker (which has to be started externally prior to executing the example) is shutdown and then started again, no messages are received.&lt;/p&gt;

&lt;p&gt;Here are the actual recommended steps to reproduce the problem:&lt;br/&gt;
1. Start the ActiveMQ broker in one terminal window&lt;br/&gt;
2. Run the example via mvn compile exec:java&lt;br/&gt;
3. When the message displays stating that you have 20s, Ctrl-C the broker in the broker terminal window&lt;br/&gt;
4. When the broker stops, start it again&lt;/p&gt;

&lt;p&gt;At this point no messages are displayed - you would expect them to be - they have actually been sent out. This can be verified also:&lt;/p&gt;

&lt;p&gt;5. Type mvn compile exec:java again&lt;br/&gt;
6. Let the example continue without interfering with the broker.&lt;/p&gt;

&lt;p&gt;You will now see the messages posted previously prior while the program waits for 20 seconds (remember no messages have been posted at this point). Letting the example continue demonstrates that after the 20 seconds, the messages are sent out and then received quickly given that we have not touched the broker.&lt;/p&gt;

&lt;p&gt;The original thread posting can be found at:&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;http://www.nabble.com/Camel-ActiveMQ-service-not-recovering-from-lost-broker-to20379163s22882.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://www.nabble.com/Camel-ActiveMQ-service-not-recovering-from-lost-broker-to20379163s22882.html&lt;/a&gt;&lt;/p&gt;</description>
                <environment>&lt;p&gt;Mac OS X (10.5), Java 1.5, ActiveMQ 5.1.0&lt;/p&gt;</environment>
        <key id="12487102">CAMEL-1064</key>
            <summary>Camel ActiveMQ service not recovering from lost broker</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/bug.png">Bug</type>
                                            <priority id="2" iconUrl="https://issues.apache.org/jira/images/icons/priorities/critical.png">Critical</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="hadrian">Hadrian Zbarcea</assignee>
                                    <reporter username="huntc@internode.on.net">Christopher Hunt</reporter>
                        <labels>
                    </labels>
                <created>Sat, 8 Nov 2008 11:30:40 +0000</created>
                <updated>Sun, 7 Feb 2010 09:54:17 +0000</updated>
                            <resolved>Mon, 23 Feb 2009 16:30:52 +0000</resolved>
                                    <version>1.4.0</version>
                    <version>1.5.0</version>
                                                    <component>camel-activemq</component>
                        <due></due>
                            <votes>1</votes>
                                    <watches>0</watches>
                                                                <comments>
                            <comment id="12949530" author="huntc@internode.on.net" created="Sat, 8 Nov 2008 11:33:40 +0000"  >&lt;p&gt;Modified camel-example-jms-file project file from the Camel 1.4.0 distribution. The modifications allow time for a broker to be shutdown subsequently to the consumer environment being set up, but before any messages are sent out.&lt;/p&gt;</comment>
                            <comment id="12949545" author="hadrian" created="Sat, 8 Nov 2008 12:04:26 +0000"  >&lt;p&gt;@Christopher thanks for spotting it and for the detailed steps and example.  This is indeed a serious problem.  I will upgrade this to critical and we&apos;ll look into it as soon as possible.&lt;/p&gt;</comment>
                            <comment id="12949668" author="davsclaus" created="Sun, 16 Nov 2008 06:56:39 +0000"  >&lt;p&gt;Hadrian did you have a look at it?&lt;/p&gt;</comment>
                            <comment id="12949637" author="hadrian" created="Tue, 18 Nov 2008 06:26:17 +0000"  >&lt;p&gt;Not yet &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/sad.gif&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;.  Let me look into this this week.&lt;/p&gt;</comment>
                            <comment id="12949798" author="huntc@internode.on.net" created="Thu, 27 Nov 2008 07:48:12 +0000"  >&lt;p&gt;I appreciate that life is full and busy, but has anybody been able to identify a potential work-around for this issue? I&apos;m looking to move my Camel based service into production next week so it&apos;d be great to have a resolution one way or another. Thank you for your help.&lt;/p&gt;</comment>
                            <comment id="12949814" author="akuhtz" created="Sat, 29 Nov 2008 10:26:02 +0000"  >&lt;p&gt;Hi Christopher,&lt;/p&gt;

&lt;p&gt;Not sure if I got all of your problem but if you change the url for the connection factory from &lt;b&gt;tcp://localhost:61616&lt;/b&gt; to &lt;b&gt;failover:tcp://localhost:61616&lt;/b&gt; it uses failover transport that does reconnect and you will receive messages after the broker is back again (at least it did when I started your test).&lt;/p&gt;</comment>
                            <comment id="12949740" author="huntc@internode.on.net" created="Sun, 30 Nov 2008 08:48:51 +0000"  >&lt;p&gt;Thanks for this - this sounds like a viable work around and I shall test it shortly. I presume that this is indeed regarded as a work-around though and that the issue remains to be fixed?&lt;/p&gt;

&lt;p&gt;Thanks again.&lt;/p&gt;</comment>
                            <comment id="12949954" author="huntc@internode.on.net" created="Thu, 4 Dec 2008 04:38:06 +0000"  >&lt;p&gt;Hi Hadrian,&lt;/p&gt;

&lt;p&gt;Any further advice on the investigation of this issue?&lt;/p&gt;

&lt;p&gt;Kind regards,&lt;br/&gt;
Christopher&lt;/p&gt;</comment>
                            <comment id="12950927" author="jstrachan" created="Mon, 23 Feb 2009 16:30:52 +0000"  >&lt;p&gt;using &lt;b&gt;failover:tcp://localhost:61616&lt;/b&gt; as the connection URL is the correct approach for dealing with reconnection to the broker in case of broker failure or network issues causing temporary socket loss.&lt;/p&gt;

&lt;p&gt;in 5.2.0 or later of ActiveMQ the connection factory and ActiveMQ camel component use failover in the default URL by default to avoid folks having to know about the failover configuration. i.e. if you don&apos;t configure anything you will get failover and so auto-reconnection&lt;/p&gt;</comment>
                            <comment id="12950903" author="huntc@internode.on.net" created="Mon, 23 Feb 2009 21:09:20 +0000"  >&lt;p&gt;Thanks for this. Was this a 1.6.0 fix for Camel? You implied that the ActiveMQ Camel component was changed also; or is it because of 5.2.0&apos;s connection factory change that Camel&apos;s component inherits the fix?&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12462670" name="CamelJmsToFileExample.java" size="3940" author="huntc@internode.on.net" created="Sat, 8 Nov 2008 11:33:40 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Sat, 8 Nov 2008 12:04:26 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>76957</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            7 years, 41 weeks, 4 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i01g3z:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>6379</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        </customfields>
    </item>
</channel>
</rss>