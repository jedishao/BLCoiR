<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Sat Dec 03 01:54:26 UTC 2016

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/CAMEL-3425/CAMEL-3425.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[CAMEL-3425] CamelContext is started twice when using camel-blueprint</title>
                <link>https://issues.apache.org/jira/browse/CAMEL-3425</link>
                <project id="12311211" key="CAMEL">Camel</project>
                    <description>&lt;p&gt;For example if you run the &lt;tt&gt;testRouteWithAllComponents&lt;/tt&gt; test in &lt;tt&gt;CamelBlueprintTest&lt;/tt&gt; in tests/camel-itest-osgi you will see &lt;em&gt;a lot&lt;/em&gt; of logging. But notice&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
[RMI TCP Connection(1)-10.0.1.2] INFO org.apache.camel.core.osgi.OsgiDefaultCamelContext - Apache Camel 2.6-SNAPSHOT (CamelContext: 67-camel-2) is starting
[RMI TCP Connection(1)-10.0.1.2] INFO org.apache.camel.core.osgi.OsgiDefaultCamelContext - Apache Camel 2.6-SNAPSHOT (CamelContext: 67-camel-2) started in 0.147 seconds
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Then blueprint does something&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
[Blueprint Extender: 3] INFO org.apache.camel.blueprint.BlueprintCamelContext - Apache Camel 2.6-SNAPSHOT (CamelContext: 4-camel-5) is starting
[Blueprint Extender: 3] INFO org.apache.camel.blueprint.BlueprintCamelContext - Apache Camel 2.6-SNAPSHOT (CamelContext: 4-camel-5) started in 0.071 seconds
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;And likewise both CamelContext&apos;s is shutdown when the test completes. There are logging events for that as well.&lt;/p&gt;

&lt;p&gt;Pay attention to the name of the 1st CamelContext &lt;tt&gt;67-camel-2&lt;/tt&gt;. This is the &lt;b&gt;correct&lt;/b&gt; name as its based on the bundle id, our end user Camel application is given. This ensures that the CamelContext from his application has a name which is unique and refers to the bundle id as well.&lt;/p&gt;

&lt;p&gt;Now if you look at the 2nd CamelContext being started its given another name &lt;tt&gt;4-camel-5&lt;/tt&gt;. That id is most likely using a shared bundle id with a low number. For example camel-blueprint or camel-core bundle, or something like that. &lt;/p&gt;

&lt;p&gt;In essence camel-blueprint should only create &lt;b&gt;one&lt;/b&gt; CamelContext and it should use the &lt;tt&gt;67-camel-2&lt;/tt&gt; as the name of the CamelContext (eg. include the bundle id of the end user application).&lt;/p&gt;</description>
                <environment></environment>
        <key id="12493164">CAMEL-3425</key>
            <summary>CamelContext is started twice when using camel-blueprint</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/bug.png">Bug</type>
                                            <priority id="2" iconUrl="https://issues.apache.org/jira/images/icons/priorities/critical.png">Critical</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="gnt">Guillaume Nodet</assignee>
                                    <reporter username="davsclaus">Claus Ibsen</reporter>
                        <labels>
                    </labels>
                <created>Tue, 14 Dec 2010 10:36:25 +0000</created>
                <updated>Sun, 24 Apr 2011 09:57:25 +0000</updated>
                            <resolved>Fri, 17 Dec 2010 15:27:04 +0000</resolved>
                                    <version>2.6.0</version>
                                    <fixVersion>2.6.0</fixVersion>
                                    <component>camel-blueprint</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                <comments>
                            <comment id="12971221" author="davsclaus" created="Tue, 14 Dec 2010 10:40:48 +0000"  >&lt;p&gt;If you compare this to a spring-dm test from tests/camel-itest-osgi. For example org.apache.camel.itest.osgi.core.direct.DirectTest &lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
[RMI TCP Connection(1)-10.0.1.2] INFO org.apache.camel.itest.osgi.core.direct.DirectTest - ********************************************************************************
[RMI TCP Connection(1)-10.0.1.2] INFO org.apache.camel.itest.osgi.core.direct.DirectTest - Testing: (org.apache.camel.itest.osgi.core.direct.DirectTest)
[RMI TCP Connection(1)-10.0.1.2] INFO org.apache.camel.itest.osgi.core.direct.DirectTest - ********************************************************************************
[RMI TCP Connection(1)-10.0.1.2] INFO org.apache.camel.itest.osgi.OSGiIntegrationTestSupport - Get the bundleContext is org.eclipse.osgi.framework.internal.core.BundleContextImpl@53dafbaf
[RMI TCP Connection(1)-10.0.1.2] INFO org.apache.camel.itest.osgi.OSGiIntegrationTestSupport - Application installed as bundle id: 49
[RMI TCP Connection(1)-10.0.1.2] INFO org.apache.camel.core.osgi.OsgiDefaultCamelContext - Apache Camel 2.6-SNAPSHOT (CamelContext: 49-camel-2) is starting
[RMI TCP Connection(1)-10.0.1.2] INFO org.apache.camel.core.osgi.OsgiDefaultCamelContext - Debugger: DefaultDebugger is enabled on CamelContext: 49-camel-2
[RMI TCP Connection(1)-10.0.1.2] INFO org.apache.camel.core.osgi.OsgiDefaultCamelContext - JMX is disabled. Using DefaultManagementStrategy.
[RMI TCP Connection(1)-10.0.1.2] INFO org.apache.camel.impl.osgi.Activator - Found 13 @Converter classes to load
[RMI TCP Connection(1)-10.0.1.2] INFO org.apache.camel.core.osgi.OsgiDefaultCamelContext - Route: route1 started and consuming from: Endpoint[direct:&lt;span class=&quot;code-comment&quot;&gt;//start]
&lt;/span&gt;[RMI TCP Connection(1)-10.0.1.2] INFO org.apache.camel.core.osgi.OsgiDefaultCamelContext - Total 1 routes, of which 1 is started.
[RMI TCP Connection(1)-10.0.1.2] INFO org.apache.camel.core.osgi.OsgiDefaultCamelContext - Apache Camel 2.6-SNAPSHOT (CamelContext: 49-camel-2) started in 0.188 seconds
[RMI TCP Connection(1)-10.0.1.2] INFO org.apache.camel.component.mock.MockEndpoint - Asserting: Endpoint[mock:&lt;span class=&quot;code-comment&quot;&gt;//result] is satisfied
&lt;/span&gt;[RMI TCP Connection(1)-10.0.1.2] INFO org.apache.camel.itest.osgi.core.direct.DirectTest - Testing done: org.apache.camel.itest.osgi.core.direct.DirectTest@109ce4a3
[RMI TCP Connection(1)-10.0.1.2] INFO org.apache.camel.core.osgi.OsgiDefaultCamelContext - Apache Camel 2.6-SNAPSHOT (CamelContext:49-camel-2) is shutting down
[RMI TCP Connection(1)-10.0.1.2] INFO org.apache.camel.impl.DefaultShutdownStrategy - Starting to graceful shutdown 1 routes (timeout 10 seconds)
[Camel (49-camel-2) thread #0 - ShutdownTask] INFO org.apache.camel.impl.DefaultShutdownStrategy - Route: route1 suspension deferred.
[Camel (49-camel-2) thread #0 - ShutdownTask] INFO org.apache.camel.impl.DefaultShutdownStrategy - Route: route1 preparing to shutdown complete.
[Camel (49-camel-2) thread #0 - ShutdownTask] INFO org.apache.camel.impl.DefaultShutdownStrategy - Route: route1 shutdown complete.
[RMI TCP Connection(1)-10.0.1.2] INFO org.apache.camel.impl.DefaultShutdownStrategy - Graceful shutdown of 1 routes completed in 0 seconds
[RMI TCP Connection(1)-10.0.1.2] INFO org.apache.camel.impl.DefaultInflightRepository - Shutting down with no inflight exchanges.
[RMI TCP Connection(1)-10.0.1.2] INFO org.apache.camel.core.osgi.OsgiDefaultCamelContext - Uptime: 0.222 seconds
[RMI TCP Connection(1)-10.0.1.2] INFO org.apache.camel.core.osgi.OsgiDefaultCamelContext - Apache Camel 2.6-SNAPSHOT (CamelContext: 49-camel-2) is shutdown in 0.007 seconds
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;As you can see from the log above, CamelContext is only started &lt;b&gt;once&lt;/b&gt;, and it has been given a name using its bundle id. The end user Camel application was given bundle id 49, which is included in the CamelContext name.&lt;/p&gt;

&lt;p&gt;edit: I fixed the logger in DefaultCamelContext so its not static anymore, which means you can see the actual classname. So now it shows &lt;tt&gt;OsgiDefaultCamelContext&lt;/tt&gt; instead of &lt;tt&gt;DefaultCamelContext&lt;/tt&gt;. &lt;/p&gt;</comment>
                            <comment id="12972519" author="gnt" created="Fri, 17 Dec 2010 15:27:04 +0000"  >&lt;p&gt;Committing to &lt;a href=&quot;https://svn.apache.org/repos/asf/camel/trunk&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://svn.apache.org/repos/asf/camel/trunk&lt;/a&gt; ...&lt;br/&gt;
	M	tests/camel-itest-osgi/src/test/java/org/apache/camel/itest/osgi/blueprint/AbstractIntegrationTest.java&lt;br/&gt;
Committed r1050422&lt;/p&gt;</comment>
                            <comment id="13023789" author="davsclaus" created="Sun, 24 Apr 2011 09:57:25 +0000"  >&lt;p&gt;Closing all resolved tickets from 2010 or older&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Fri, 17 Dec 2010 15:27:04 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>76256</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            5 years, 32 weeks, 5 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i01unz:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>8737</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        </customfields>
    </item>
</channel>
</rss>