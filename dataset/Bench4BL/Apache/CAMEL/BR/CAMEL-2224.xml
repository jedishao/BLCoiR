<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Sat Dec 03 03:31:30 UTC 2016

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/CAMEL-2224/CAMEL-2224.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[CAMEL-2224] Response received is of type java.lang.String instead of javax.ws.rs.core.Response</title>
                <link>https://issues.apache.org/jira/browse/CAMEL-2224</link>
                <project id="12311211" key="CAMEL">Camel</project>
                    <description>&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;D:\Soft\opensource\curl-7.19.5-win32-nossl&amp;gt;curl -i -H &lt;span class=&quot;code-quote&quot;&gt;&quot;Accept: application/xml&quot;&lt;/span&gt; http:&lt;span class=&quot;code-comment&quot;&gt;//localhost:8080/cxf/camel-&lt;span class=&quot;code-keyword&quot;&gt;rest&lt;/span&gt;-example/reportservice/incidents/1
&lt;/span&gt;11/
HTTP/1.1 500 Internal Server Error
Content-Type: text/xml; charset=iso-8859-1
Content-Length: 256
Server: Jetty(6.1.x)

&amp;lt;ns1:XMLFault xmlns:ns1=&lt;span class=&quot;code-quote&quot;&gt;&quot;http:&lt;span class=&quot;code-comment&quot;&gt;//cxf.apache.org/bindings/xformat&quot;&lt;/span&gt;&amp;gt;&amp;lt;ns1:faultstring xmlns:ns1=&lt;span class=&quot;code-quote&quot;&gt;&quot;http://cxf.apache.org/bindings/xformat&quot;&lt;/span&gt;&amp;gt;java.lang.ClassCa
&lt;/span&gt;stException: java.lang.&lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt; cannot be &lt;span class=&quot;code-keyword&quot;&gt;cast&lt;/span&gt; to javax.ws.rs.core.Response&amp;lt;/ns1:faultstring&amp;gt;&amp;lt;/ns1:XMLFault&amp;gt;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;See the code in attachment&lt;/p&gt;

&lt;p&gt;Here is the config of apache karaf feature &lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;#
# Comma separated list of features repositories to register by &lt;span class=&quot;code-keyword&quot;&gt;default&lt;/span&gt;
#
featuresRepositories=mvn:org.apache.felix.karaf/apache-felix-karaf/1.0.0/xml/features,mvn:org.apache.camel.karaf/features/2.1-SNAPSHOT/xml/features,jar:mvn:org.apache.camel.example/reportincident.restful.features/1.0-SNAPSHOT!/reportincident.features-1.0-SNAPSHOT-features.xml


#
# Comma separated list of features to install at startup
# 

featuresBoot=spring,spring-dm,camel,http-reportingincident,spring-web,camel-cxf,reportincident
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;camel + code is present in the zip. They are three bundles &lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;one generating the feature file of the project&lt;/li&gt;
	&lt;li&gt;another containing the REST service&lt;/li&gt;
	&lt;li&gt;and the last camel route&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;here is the log on camel&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;17:34:22,155 | INFO  | xtenderThread-37 | ContextLoaderListener            | BundleApplicationContextListener   45 | Application context successfully refreshed (OsgiBundleXmlApplicationContext(bundle=org.apache.camel.example.reportincident.restful.routing, config=osgibundle:/META-INF/spring/*.xml))
17:34:27,701 | INFO  | 14218728@qtp1-1  | Tracer                           | rg.apache.camel.processor.Logger   88 | 970d2b95-93d9-4319-a5fd-4906ec9a9a9a &amp;gt;&amp;gt;&amp;gt; from(/camel-&lt;span class=&quot;code-keyword&quot;&gt;rest&lt;/span&gt;-example/) --&amp;gt; setHeader[CamelCxfRsUsingHttpAPI], Pattern:InOut, Headers:{CamelCxfRsOperationResourceInfoStack=[org.apache.cxf.jaxrs.model.MethodInvocationInfo@82fd0f], 
CamelHttpMethod=GET, CamelHttpPath=/camel-&lt;span class=&quot;code-keyword&quot;&gt;rest&lt;/span&gt;-example/reportservice/incidents/111/, CamelCxfRsResponseClass=class org.apache.camel.example.reportincident.restful.Incident, operationName=getIncident, 
CamelHttpUri=/cxf/camel-&lt;span class=&quot;code-keyword&quot;&gt;rest&lt;/span&gt;-example/reportservice/incidents/111/, CamelAcceptContentType=application/xml, CamelHttpCharacterEncoding=ISO-8859-1}, BodyType:&lt;span class=&quot;code-object&quot;&gt;Object&lt;/span&gt;[], Body:[Ljava.lang.&lt;span class=&quot;code-object&quot;&gt;Object&lt;/span&gt;;@16237fd
17:34:27,701 | INFO  | 14218728@qtp1-1  | Tracer                           | rg.apache.camel.processor.Logger   88 | 970d2b95-93d9-4319-a5fd-4906ec9a9a9a &amp;gt;&amp;gt;&amp;gt; setHeader[CamelCxfRsUsingHttpAPI] --&amp;gt; log:&lt;span class=&quot;code-comment&quot;&gt;//org.apache.camel.example.reportIncident?level=INFO, Pattern:InOut, Headers:{CamelHttpPath=/camel-&lt;span class=&quot;code-keyword&quot;&gt;rest&lt;/span&gt;-example/reportservice/incidents/111/, CamelHttpUri=/cxf/camel-&lt;span class=&quot;code-keyword&quot;&gt;rest&lt;/span&gt;-example/reportservice/incidents/111/, 
&lt;/span&gt;CamelCxfRsOperationResourceInfoStack=[org.apache.cxf.jaxrs.model.MethodInvocationInfo@82fd0f], CamelCxfRsUsingHttpAPI=True, CamelCxfRsResponseClass=class org.apache.camel.example.reportincident.restful.Incident, 
CamelHttpCharacterEncoding=ISO-8859-1, CamelHttpMethod=GET, operationName=getIncident, CamelAcceptContentType=application/xml}, BodyType:&lt;span class=&quot;code-object&quot;&gt;Object&lt;/span&gt;[], Body:[Ljava.lang.&lt;span class=&quot;code-object&quot;&gt;Object&lt;/span&gt;;@16237fd
17:34:27,717 | INFO  | 14218728@qtp1-1  | reportIncident                   | rg.apache.camel.processor.Logger   88 | Exchange[BodyType:&lt;span class=&quot;code-object&quot;&gt;Object&lt;/span&gt;[], Body:[Ljava.lang.&lt;span class=&quot;code-object&quot;&gt;Object&lt;/span&gt;;@16237fd]
17:34:27,717 | WARN  | 14218728@qtp1-1  | PhaseInterceptorChain            | ache.cxf.common.logging.LogUtils  361 | Interceptor has thrown exception, unwinding now
java.lang.ClassCastException: java.lang.&lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt; cannot be &lt;span class=&quot;code-keyword&quot;&gt;cast&lt;/span&gt; to javax.ws.rs.core.Response
	at org.apache.camel.example.reportincident.restful.OverrideResponseHandler.handleResponse(OverrideResponseHandler.java:22)
	at org.apache.cxf.jaxrs.interceptor.JAXRSOutInterceptor.processResponse(JAXRSOutInterceptor.java:131)
	at org.apache.cxf.jaxrs.interceptor.JAXRSOutInterceptor.handleMessage(JAXRSOutInterceptor.java:77)
	at org.apache.cxf.phase.PhaseInterceptorChain.doIntercept(PhaseInterceptorChain.java:236)
	at org.apache.cxf.interceptor.OutgoingChainInterceptor.handleMessage(OutgoingChainInterceptor.java:76)
	at org.apache.cxf.phase.PhaseInterceptorChain.doIntercept(PhaseInterceptorChain.java:236)
	at org.apache.cxf.transport.ChainInitiationObserver.onMessage(ChainInitiationObserver.java:109)
	at org.apache.cxf.transport.http_osgi.OsgiDestination.doMessage(OsgiDestination.java:79)
	at org.apache.cxf.transport.http_osgi.OsgiServletController.invokeDestination(OsgiServletController.java:324)
	at org.apache.cxf.transport.http_osgi.OsgiServletController.invoke(OsgiServletController.java:112)
	at org.apache.cxf.transport.http_osgi.OsgiServlet.invoke(OsgiServlet.java:53)
	at org.apache.cxf.transport.http_osgi.SpringOsgiServlet.invoke(SpringOsgiServlet.java:48)
	at org.apache.cxf.transport.servlet.AbstractHTTPServlet.handleRequest(AbstractHTTPServlet.java:179)
	at org.apache.cxf.transport.servlet.AbstractHTTPServlet.doGet(AbstractHTTPServlet.java:108)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:693)
	at org.apache.cxf.transport.servlet.AbstractHTTPServlet.service(AbstractHTTPServlet.java:159)
	at org.mortbay.jetty.servlet.ServletHolder.handle(ServletHolder.java:502)
	at org.mortbay.jetty.servlet.ServletHandler.handle(ServletHandler.java:363)
	at org.ops4j.pax.web.service.jetty.internal.HttpServiceServletHandler.handle(HttpServiceServletHandler.java:64)
	at org.mortbay.jetty.servlet.SessionHandler.handle(SessionHandler.java:181)
	at org.mortbay.jetty.handler.ContextHandler.handle(ContextHandler.java:766)
	at org.ops4j.pax.web.service.jetty.internal.HttpServiceContext.handle(HttpServiceContext.java:111)
	at org.ops4j.pax.web.service.jetty.internal.JettyServerHandlerCollection.handle(JettyServerHandlerCollection.java:64)
	at org.mortbay.jetty.handler.HandlerWrapper.handle(HandlerWrapper.java:152)
	at org.mortbay.jetty.Server.handle(Server.java:324)
	at org.mortbay.jetty.HttpConnection.handleRequest(HttpConnection.java:534)
	at org.mortbay.jetty.HttpConnection$RequestHandler.headerComplete(HttpConnection.java:864)
	at org.mortbay.jetty.HttpParser.parseNext(HttpParser.java:533)
	at org.mortbay.jetty.HttpParser.parseAvailable(HttpParser.java:207)
	at org.mortbay.jetty.HttpConnection.handle(HttpConnection.java:403)
	at org.mortbay.io.nio.SelectChannelEndPoint.run(SelectChannelEndPoint.java:409)
	at org.mortbay.thread.QueuedThreadPool$PoolThread.run(QueuedThreadPool.java:522)

&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</description>
                <environment></environment>
        <key id="12486015">CAMEL-2224</key>
            <summary>Response received is of type java.lang.String instead of javax.ws.rs.core.Response</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/bug.png">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.png">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="njiang">Willem Jiang</assignee>
                                    <reporter username="cmoulliard">Charles Moulliard</reporter>
                        <labels>
                    </labels>
                <created>Tue, 24 Nov 2009 16:43:53 +0000</created>
                <updated>Wed, 25 Nov 2009 16:47:51 +0000</updated>
                            <resolved>Wed, 25 Nov 2009 16:47:51 +0000</resolved>
                                    <version>2.1.0</version>
                                                    <component>camel-cxf</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                <comments>
                            <comment id="12953897" author="sergey_beryozkin" created="Tue, 24 Nov 2009 16:52:17 +0000"  >&lt;p&gt;Hi Willem, we&apos;ve identified that an object which is returned from a jaxrs service endpoint is somehow lost twice, first it is misrepresented as&lt;br/&gt;
Object[] and next it ends up being of  String class...&lt;/p&gt;

&lt;p&gt;If you&apos;re overwhelmed with some other priority work then please free to reassign this issue to me&lt;/p&gt;

&lt;p&gt;thanks, Sergey&lt;/p&gt;</comment>
                            <comment id="12953926" author="njiang" created="Wed, 25 Nov 2009 08:38:49 +0000"  >&lt;p&gt;@Sergey,&lt;/p&gt;

&lt;p&gt;I just have a chance to talk with Charles,  the error is caused by no response sending back the camel-cxfrs endpoint.&lt;/p&gt;</comment>
                            <comment id="12953924" author="sergey_beryozkin" created="Wed, 25 Nov 2009 09:48:15 +0000"  >&lt;p&gt;So it should be an easy fix ?&lt;/p&gt;

&lt;p&gt;The exception which is reported above is originated from the custom cxf jaxrs ResponseHandler...&lt;br/&gt;
As was discussed in the other JIRA which you closed yesterday, the CXF JAXRSOutInterceptor was getting &lt;br/&gt;
a response object being misrepresented as Object[]. So yesterday, &lt;br/&gt;
Charles tried to to check what was inside that Object[] using a custom ResponseHandler. &lt;/p&gt;

&lt;p&gt;We thought that the object the IncidentService was returning (JAXRs Response in that specific case) was wrapped &lt;br/&gt;
as the first element of Object[], so the custom ResponseHandler tried to cast the first element to Response...&lt;/p&gt;
</comment>
                            <comment id="12953925" author="cmoulliard" created="Wed, 25 Nov 2009 10:02:25 +0000"  >&lt;p&gt;@Sergey,&lt;/p&gt;

&lt;p&gt;The call of a GET service works fine.&lt;/p&gt;

&lt;p&gt;Concerning the call to a POST, here is the error displayed in the console now :&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
10:59:44,132 | DEBUG | ervice/incidents | jetty                            | service.jetty.internal.JCLLogger   85 | REQUEST /cxf/camel-&lt;span class=&quot;code-keyword&quot;&gt;rest&lt;/span&gt;-example/reportservice/incidents on org.mortbay.jetty.HttpConnection@136f665
10:59:44,132 | DEBUG | ervice/incidents | ServerModel                      | eb.service.spi.model.ServerModel  268 | Matching [/cxf/camel-&lt;span class=&quot;code-keyword&quot;&gt;rest&lt;/span&gt;-example/reportservice/incidents]...
10:59:44,132 | DEBUG | ervice/incidents | ServerModel                      | eb.service.spi.model.ServerModel  286 | Path [/cxf/camel-&lt;span class=&quot;code-keyword&quot;&gt;rest&lt;/span&gt;-example/reportservice/incidents] matched to {pattern=/cxf/.*,model=ServletModel{id=org.ops4j.pax.web.service.spi.model.ServletModel-6,name=cxf-osgi-transport-servlet,urlPatterns=[/cxf/*],alias=/cxf,servlet=org.apache.cxf.transport.http_osgi.SpringOsgiServlet@23a559,initParams={org.springframework.osgi.bean.name=osgiServlet, alias=/cxf, service.id=78, objectClass=[Ljava.lang.&lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt;;@113de03, Bundle-SymbolicName=org.apache.cxf.bundle, servlet-name=cxf-osgi-transport-servlet, Bundle-Version=2.2.5},context=ContextModel{id=org.ops4j.pax.web.service.spi.model.ContextModel-4,name=,httpContext=DefaultHttpContext{bundle=org.apache.cxf.bundle [96]},contextParams={}}}}
10:59:44,132 | DEBUG | ervice/incidents | HttpServiceContext               | etty.internal.HttpServiceContext  110 | Handling request &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; [/cxf/camel-&lt;span class=&quot;code-keyword&quot;&gt;rest&lt;/span&gt;-example/reportservice/incidents] using http context [DefaultHttpContext{bundle=org.apache.cxf.bundle [96]}]
10:59:44,132 | DEBUG | ervice/incidents | jetty                            | service.jetty.internal.JCLLogger   85 | sessionManager=org.mortbay.jetty.servlet.HashSessionManager@16a72f2
10:59:44,132 | DEBUG | ervice/incidents | jetty                            | service.jetty.internal.JCLLogger   85 | session=&lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;
10:59:44,132 | DEBUG | ervice/incidents | jetty                            | service.jetty.internal.JCLLogger   85 | servlet=cxf-osgi-transport-servlet
10:59:44,132 | DEBUG | ervice/incidents | jetty                            | service.jetty.internal.JCLLogger   85 | chain=&lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;
10:59:44,148 | DEBUG | ervice/incidents | jetty                            | service.jetty.internal.JCLLogger   85 | servlet holder=cxf-osgi-transport-servlet
10:59:44,148 | DEBUG | ervice/incidents | OsgiServlet                      | .http_osgi.OsgiServletController  276 | Service http request on thread: &lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;[31816416@qtp2-6 - /cxf/camel-&lt;span class=&quot;code-keyword&quot;&gt;rest&lt;/span&gt;-example/reportservice/incidents,5,main]
10:59:44,148 | DEBUG | ervice/incidents | AbstractHTTPDestination          | ort.http.AbstractHTTPDestination  166 | Request Headers: {Host=[localhost:8080], User-Agent=[curl/7.19.5 (i586-pc-mingw32msvc) libcurl/7.19.5 zlib/1.2.3], Content-Type=[&lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;], Accept=[application/xml]}
10:59:44,148 | DEBUG | ervice/incidents | PhaseInterceptorChain            | .cxf.phase.PhaseInterceptorChain  587 | Chain org.apache.cxf.phase.PhaseInterceptorChain@1a0a5fc was created. Current flow:
  unmarshal [JAXRSInInterceptor]
  pre-logical [OneWayProcessorInterceptor]
  invoke [ServiceInvokerInterceptor]
  post-invoke [OutgoingChainInterceptor]

10:59:44,148 | DEBUG | ervice/incidents | PhaseInterceptorChain            | .cxf.phase.PhaseInterceptorChain  233 | Invoking handleMessage on interceptor org.apache.cxf.jaxrs.interceptor.JAXRSInInterceptor@1f1788a
10:59:44,148 | DEBUG | ervice/incidents | JAXRSUtils                       | pache.cxf.jaxrs.utils.JAXRSUtils  223 | Trying to select a resource class /reportservice/incidents, request path : {1}
10:59:44,148 | DEBUG | ervice/incidents | JAXRSUtils                       | pache.cxf.jaxrs.utils.JAXRSUtils  279 | Trying to select a resource operation on the resource class org.apache.camel.example.reportincident.restful.ReportIncidentService
10:59:44,148 | DEBUG | ervice/incidents | JAXRSUtils                       | pache.cxf.jaxrs.utils.JAXRSUtils  396 | No method match, method name : getIncident, request path : /incidents, method @Path : /incidents/{id}/, HTTP Method : POST, method HTTP Method : GET, ContentType : */*, method @Consumes : */*,, Accept : application/xml,, method @Produces : application/xml,.
10:59:44,163 | DEBUG | ervice/incidents | JAXRSUtils                       | pache.cxf.jaxrs.utils.JAXRSUtils  396 | No method match, method name : updateIncident, request path : /incidents, method @Path : /incidents/, HTTP Method : POST, method HTTP Method : PUT, ContentType : */*, method @Consumes : */*,, Accept : application/xml,, method @Produces : */*,.
10:59:44,163 | DEBUG | ervice/incidents | JAXRSUtils                       | pache.cxf.jaxrs.utils.JAXRSUtils  332 | Resource operation addIncident may get selected
10:59:44,163 | DEBUG | ervice/incidents | JAXRSUtils                       | pache.cxf.jaxrs.utils.JAXRSUtils  396 | No method match, method name : addIncidentUniqueResponseCode, request path : /incidents, method @Path : /incidentsUniqueResponseCode/, HTTP Method : POST, method HTTP Method : POST, ContentType : */*, method @Consumes : */*,, Accept : application/xml,, method @Produces : */*,.
10:59:44,163 | DEBUG | ervice/incidents | JAXRSUtils                       | pache.cxf.jaxrs.utils.JAXRSUtils  396 | No method match, method name : deleteIncident, request path : /incidents, method @Path : /incidents/{id}/, HTTP Method : POST, method HTTP Method : DELETE, ContentType : */*, method @Consumes : */*,, Accept : application/xml,, method @Produces : */*,.
10:59:44,163 | DEBUG | ervice/incidents | JAXRSUtils                       | pache.cxf.jaxrs.utils.JAXRSUtils  355 | Resource operation addIncident on the resource class org.apache.camel.example.reportincident.restful.ReportIncidentService has been selected
10:59:44,163 | DEBUG | ervice/incidents | JAXRSInInterceptor               | s.interceptor.JAXRSInInterceptor  195 | Request path is: /reportservice/incidents
10:59:44,163 | DEBUG | ervice/incidents | JAXRSInInterceptor               | s.interceptor.JAXRSInInterceptor  196 | Request HTTP method is: POST
10:59:44,163 | DEBUG | ervice/incidents | JAXRSInInterceptor               | s.interceptor.JAXRSInInterceptor  197 | Request contentType is: */*
10:59:44,163 | DEBUG | ervice/incidents | JAXRSInInterceptor               | s.interceptor.JAXRSInInterceptor  198 | Accept contentType is: application/xml
10:59:44,163 | DEBUG | ervice/incidents | JAXRSInInterceptor               | s.interceptor.JAXRSInInterceptor  200 | Found operation: addIncident
10:59:44,163 | DEBUG | ervice/incidents | JAXRSUtils                       | pache.cxf.jaxrs.utils.JAXRSUtils  556 | No Content-Type specified &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; HTTP POST
10:59:44,163 | WARN  | ervice/incidents | WebApplicationExceptionMapper    | pl.WebApplicationExceptionMapper   52 | WebApplicationException has been caught : cause is javax.xml.stream.XMLStreamException
10:59:44,163 | DEBUG | ervice/incidents | PhaseInterceptorChain            | .cxf.phase.PhaseInterceptorChain  233 | Invoking handleMessage on interceptor org.apache.cxf.interceptor.OneWayProcessorInterceptor@2332b6
10:59:44,179 | DEBUG | ervice/incidents | PhaseInterceptorChain            | .cxf.phase.PhaseInterceptorChain  233 | Invoking handleMessage on interceptor org.apache.cxf.interceptor.ServiceInvokerInterceptor@d66992
10:59:44,179 | DEBUG | ervice/incidents | PhaseInterceptorChain            | .cxf.phase.PhaseInterceptorChain  233 | Invoking handleMessage on interceptor org.apache.cxf.interceptor.OutgoingChainInterceptor@ad0636
10:59:44,179 | DEBUG | ervice/incidents | OutgoingChainInterceptor         | rceptor.OutgoingChainInterceptor  163 | Interceptors contributed by bus: []
10:59:44,179 | DEBUG | ervice/incidents | OutgoingChainInterceptor         | rceptor.OutgoingChainInterceptor  167 | Interceptors contributed by service: []
10:59:44,179 | DEBUG | ervice/incidents | OutgoingChainInterceptor         | rceptor.OutgoingChainInterceptor  171 | Interceptors contributed by endpoint: [org.apache.cxf.interceptor.MessageSenderInterceptor@172f5d6]
10:59:44,179 | DEBUG | ervice/incidents | OutgoingChainInterceptor         | rceptor.OutgoingChainInterceptor  177 | Interceptors contributed by binding: [org.apache.cxf.jaxrs.interceptor.JAXRSOutInterceptor@69dc53]
10:59:44,179 | DEBUG | ervice/incidents | PhaseInterceptorChain            | .cxf.phase.PhaseInterceptorChain  587 | Chain org.apache.cxf.phase.PhaseInterceptorChain@1ffe90d was created. Current flow:
  prepare-send [MessageSenderInterceptor]
  marshal [JAXRSOutInterceptor]
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="12953931" author="sergey_beryozkin" created="Wed, 25 Nov 2009 10:37:49 +0000"  >&lt;p&gt;Hi Charles, so given this log&lt;/p&gt;

&lt;p&gt;10:59:44,163 | DEBUG | ervice/incidents | JAXRSUtils                       | pache.cxf.jaxrs.utils.JAXRSUtils  355 | Resource operation addIncident on the resource class org.apache.camel.example.reportincident.restful.ReportIncidentService has been selected&lt;br/&gt;
10:59:44,163 | DEBUG | ervice/incidents | JAXRSInInterceptor               | s.interceptor.JAXRSInInterceptor  195 | Request path is: /reportservice/incidents&lt;br/&gt;
10:59:44,163 | DEBUG | ervice/incidents | JAXRSInInterceptor               | s.interceptor.JAXRSInInterceptor  196 | Request HTTP method is: POST&lt;br/&gt;
10:59:44,163 | DEBUG | ervice/incidents | JAXRSInInterceptor               | s.interceptor.JAXRSInInterceptor  197 | Request contentType is: &lt;b&gt;/&lt;/b&gt;&lt;br/&gt;
10:59:44,163 | DEBUG | ervice/incidents | JAXRSInInterceptor               | s.interceptor.JAXRSInInterceptor  198 | Accept contentType is: application/xml&lt;br/&gt;
10:59:44,163 | DEBUG | ervice/incidents | JAXRSInInterceptor               | s.interceptor.JAXRSInInterceptor  200 | Found operation: addIncident&lt;br/&gt;
10:59:44,163 | DEBUG | ervice/incidents | JAXRSUtils                       | pache.cxf.jaxrs.utils.JAXRSUtils  556 | No Content-Type specified for HTTP POST&lt;/p&gt;

&lt;p&gt;it appears that &lt;/p&gt;

&lt;p&gt;10:59:44,163 | WARN  | ervice/incidents | WebApplicationExceptionMapper    | pl.WebApplicationExceptionMapper   52 | WebApplicationException has been caught : cause is javax.xml.stream.XMLStreamException&lt;/p&gt;


&lt;p&gt;JAXBElementProvider tried to read from XMLStreamReader (more logging would help).&lt;br/&gt;
CXF JAXRS itself does read directly from the request InputsStream but will try to read from &lt;br/&gt;
 XMLStreamReader if it is available on the message. At the moment I can not tell where this (custom) &lt;br/&gt;
XMLStreamReader is coming from.&lt;/p&gt;

&lt;p&gt;I&apos;m on my gmail now and #cxf in codehouze. Lets chat there. Alternatively please create a CXF JIRA with the copy of your latest project&lt;/p&gt;

&lt;p&gt;thanks&lt;/p&gt;
</comment>
                            <comment id="12953903" author="cmoulliard" created="Wed, 25 Nov 2009 10:52:12 +0000"  >&lt;p&gt;Only the camel-context file has been changed. I put it in attachment&lt;/p&gt;

&lt;p&gt;I have been able to generate more error in the log by adding Context-Type in the POST request :&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
11:45:50,382 | WARN  | 31816416@qtp2-6  | WebApplicationExceptionMapper    | pl.WebApplicationExceptionMapper   52 | WebApplicationException has been caught : cause is javax.xml.stream.XMLStreamException
11:49:11,054 | WARN  | 31816416@qtp2-6  | AbstractJAXBProvider             | rs.provider.AbstractJAXBProvider  544 | javax.xml.bind.UnmarshalException
 - with linked exception:
[org.xml.sax.SAXParseException: Premature end of file.]
	at javax.xml.bind.helpers.AbstractUnmarshallerImpl.createUnmarshalException(AbstractUnmarshallerImpl.java:65)
	at com.sun.xml.bind.v2.runtime.unmarshaller.UnmarshallerImpl.createUnmarshalException(UnmarshallerImpl.java:514)
	at com.sun.xml.bind.v2.runtime.unmarshaller.UnmarshallerImpl.unmarshal0(UnmarshallerImpl.java:215)
	at com.sun.xml.bind.v2.runtime.unmarshaller.UnmarshallerImpl.unmarshal(UnmarshallerImpl.java:184)
	at javax.xml.bind.helpers.AbstractUnmarshallerImpl.unmarshal(AbstractUnmarshallerImpl.java:184)
	at javax.xml.bind.helpers.AbstractUnmarshallerImpl.unmarshal(AbstractUnmarshallerImpl.java:191)
	at org.apache.cxf.jaxrs.provider.JAXBElementProvider.unmarshalFromInputStream(JAXBElementProvider.java:200)
	at org.apache.cxf.jaxrs.provider.JAXBElementProvider.doUnmarshal(JAXBElementProvider.java:183)
	at org.apache.cxf.jaxrs.provider.JAXBElementProvider.readFrom(JAXBElementProvider.java:154)
	at org.apache.cxf.jaxrs.utils.JAXRSUtils.readFromMessageBody(JAXRSUtils.java:954)
	at org.apache.cxf.jaxrs.utils.JAXRSUtils.processParameter(JAXRSUtils.java:560)
	at org.apache.cxf.jaxrs.utils.JAXRSUtils.processParameters(JAXRSUtils.java:525)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="12953948" author="cmoulliard" created="Wed, 25 Nov 2009 13:56:12 +0000"  >&lt;p&gt;@Willem&lt;/p&gt;

&lt;p&gt;Why the body is empty (question coming from Sergey) ?&lt;/p&gt;

&lt;p&gt;Here is a trace :&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
ID: 1
Address: /cxf/camel-&lt;span class=&quot;code-keyword&quot;&gt;rest&lt;/span&gt;-example/reportservice/incidents
Encoding: ISO-8859-1
Content-Type: application/xml
Headers: {content-type=[application/xml], Host=[localhost:8080], User-Agent=[curl/7.19.5 (i586-pc-mingw32msvc) libcurl/7.19.5 zlib/1.2.3], Content-Type=[application/xml], Accept=[application/xml]}
Payload:
--------------------------------------
12:56:49,960 | INFO | 31816416@qtp2-6 | LoggingOutInterceptor | ngOutInterceptor$LoggingCallback 160 | Outbound Message
---------------------------
ID: 1
Encoding:
Content-Type: text/plain
Headers: {Content-Type=[text/plain], Date=[Wed, 25 Nov 2009 11:56:49 GMT]}
Payload: JAXBException occurred : Premature end of file.. Premature end of file..
I come back in 1 hour (lunch + stuff to &lt;span class=&quot;code-keyword&quot;&gt;do&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; my family)

&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;using tcpTrace&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
&amp;lt;connection&amp;gt;
&amp;lt;loggedAt xsi:type=&apos;xsd:timeInstant&apos;&amp;gt;2009-11-25T14:41:19+-1:00&amp;lt;/loggedAt&amp;gt;
&amp;lt;connectionOpened xsi:type=&apos;xsd:timeInstant&apos;&amp;gt;2009-11-25T14:41:19+-1:00&amp;lt;/connectionOpened&amp;gt;
&amp;lt;connectionClosed xsi:type=&apos;xsd:timeInstant&apos;&amp;gt;2009-11-25T14:41:19+-1:00&amp;lt;/connectionClosed&amp;gt;
&amp;lt;source&amp;gt;127.0.0.1&amp;lt;/source&amp;gt;
&amp;lt;destination&amp;gt;localhost:8080&amp;lt;/destination&amp;gt;
&amp;lt;bytesClientToServer&amp;gt;216&amp;lt;/bytesClientToServer&amp;gt;
&amp;lt;bytesServerToClient&amp;gt;216&amp;lt;/bytesServerToClient&amp;gt;
&amp;lt;clientData&amp;gt;POST /cxf/camel-&lt;span class=&quot;code-keyword&quot;&gt;rest&lt;/span&gt;-example/reportservice/incidents HTTP/1.1
User-Agent: curl/7.19.5 (i586-pc-mingw32msvc) libcurl/7.19.5 zlib/1.2.3
Host: localhost:9999
Accept: application/xml
Content-Type: application/xml

&amp;lt;/clientData&amp;gt;
&amp;lt;serverData&amp;gt;HTTP/1.1 500 Internal Server Error
Content-Type: text/plain
Date: Wed, 25 Nov 2009 13:41:19 GMT
Content-Length: 73
Server: Jetty(6.1.x)

JAXBException occurred : Premature end of file.. Premature end of file.. &amp;lt;/serverData&amp;gt;
&amp;lt;/connection&amp;gt;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="12953942" author="sergey_beryozkin" created="Wed, 25 Nov 2009 16:03:30 +0000"  >&lt;p&gt;Actually, it does look like it is &lt;/p&gt;

&lt;p&gt;User-Agent: curl/7.19.5 (i586-pc-mingw32msvc) libcurl/7.19.5 zlib/1.2.3&lt;/p&gt;


&lt;p&gt;which sends an empty body&lt;/p&gt;</comment>
                            <comment id="12953952" author="cmoulliard" created="Wed, 25 Nov 2009 16:32:30 +0000"  >&lt;p&gt;THE REQUEST SEND WAS NOT CORRECT :&lt;/p&gt;

&lt;p&gt;If I use the following, everything works fine (-d has been added) &lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
curl -i  -H &lt;span class=&quot;code-quote&quot;&gt;&quot;Accept: application/xml&quot;&lt;/span&gt; -H &lt;span class=&quot;code-quote&quot;&gt;&quot;Content-Type: application/xml&quot;&lt;/span&gt; -d &lt;span class=&quot;code-quote&quot;&gt;&quot;&amp;lt;Incident&amp;gt;&amp;lt;incidentId&amp;gt;555&amp;lt;/incidentId&amp;gt;&amp;lt;givenName&amp;gt;chm&amp;lt;/givenName&amp;gt;&amp;lt;/Incident&amp;gt;&quot;&lt;/span&gt; -X POST http:&lt;span class=&quot;code-comment&quot;&gt;//localhost:8181/cxf/camel-&lt;span class=&quot;code-keyword&quot;&gt;rest&lt;/span&gt;-example/reportservice/incidents
&lt;/span&gt;
HTTP/1.1 200 OK
Content-Type: application/xml
Date: Wed, 25 Nov 2009 16:27:02 GMT
Content-Length: 130
Server: Jetty(6.1.x)

&amp;lt;?xml version=&lt;span class=&quot;code-quote&quot;&gt;&quot;1.0&quot;&lt;/span&gt; encoding=&lt;span class=&quot;code-quote&quot;&gt;&quot;UTF-8&quot;&lt;/span&gt; standalone=&lt;span class=&quot;code-quote&quot;&gt;&quot;yes&quot;&lt;/span&gt;?&amp;gt;&amp;lt;Incident&amp;gt;&amp;lt;incidentId&amp;gt;126&amp;lt;/incidentId&amp;gt;&amp;lt;givenName&amp;gt;chm&amp;lt;/givenName&amp;gt;&amp;lt;/Incident&amp;gt;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Here is the trace from camel / cxfrs / apache karaf&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
ID: 46
Address: /cxf/camel-&lt;span class=&quot;code-keyword&quot;&gt;rest&lt;/span&gt;-example/reportservice/incidents
Encoding: UTF-8
Content-Type: application/xml; charset=UTF-8
Headers: {content-type=[application/xml; charset=UTF-8], connection=[keep-alive], Host=[localhost:8181], Content-Length=[78], User-Agent=[Mozilla/5.0 (Windows; U; Windows NT 5.1; en-US; rv:1.9.1.3) Gecko/20090824 Firefox/3.5.3], Pragma=[no-cache], Cache-Control=[no-cache], Accept-Language=[en-us,en;q=0.5], Accept-Charset=[ISO-8859-1,utf-8;q=0.7,*;q=0.7], Keep-Alive=[300], accept-encoding=[gzip,deflate], Accept=[text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8], Content-Type=[application/xml; charset=UTF-8]}
Payload: &amp;lt;Incident&amp;gt;
&amp;lt;incidentId&amp;gt;555&amp;lt;/incidentId&amp;gt;
&amp;lt;givenName&amp;gt;chm&amp;lt;/givenName&amp;gt;
&amp;lt;/Incident&amp;gt;
--------------------------------------
17:23:37,882 | INFO  | 1979395@qtp0-3   | LoggingOutInterceptor            | ngOutInterceptor$LoggingCallback  160 | Outbound Message
---------------------------
ID: 46
Encoding: 
Content-Type: application/xhtml+xml
Headers: {Date=[Wed, 25 Nov 2009 16:23:37 GMT]}
Payload: &amp;lt;?xml version=&lt;span class=&quot;code-quote&quot;&gt;&quot;1.0&quot;&lt;/span&gt; encoding=&lt;span class=&quot;code-quote&quot;&gt;&quot;UTF-8&quot;&lt;/span&gt; standalone=&lt;span class=&quot;code-quote&quot;&gt;&quot;yes&quot;&lt;/span&gt;?&amp;gt;&amp;lt;Incident&amp;gt;&amp;lt;incidentId&amp;gt;125&amp;lt;/incidentId&amp;gt;&amp;lt;givenName&amp;gt;chm&amp;lt;/givenName&amp;gt;&amp;lt;/Incident&amp;gt;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;QUESTION : WHY DO WE HAVE TO SEND PARAMETER (&amp;lt;Incident&amp;gt;&amp;lt;incidentId&amp;gt;555&amp;lt;/incidentId&amp;gt;&amp;lt;givenName&amp;gt;chm&amp;lt;/givenName&amp;gt;&amp;lt;/Incident&amp;gt;) AS NORMALY A NEW OBJECT WILL BE CREATED BY THE SERVICE HEREAFTER ?&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
    @POST
    @Path(&lt;span class=&quot;code-quote&quot;&gt;&quot;/incidents/&quot;&lt;/span&gt;)
    @Consumes(&lt;span class=&quot;code-quote&quot;&gt;&quot;application/xml&quot;&lt;/span&gt;)
    &lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; Response addIncident(Incident incident) {
        incident.setIncidentId(++currentId);

        incidents.put(incident.getIncidentId(), incident);
        
        &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; Response.ok(incident).build();
    }
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;If I compare with the test example, no parameters are send : &lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
    @Test
    &lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; void testPostConsumer() &lt;span class=&quot;code-keyword&quot;&gt;throws&lt;/span&gt; Exception {
        PostMethod post = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; PostMethod(&lt;span class=&quot;code-quote&quot;&gt;&quot;http:&lt;span class=&quot;code-comment&quot;&gt;//localhost:9000/customerservice/customers&quot;&lt;/span&gt;);
&lt;/span&gt;        post.addRequestHeader(&lt;span class=&quot;code-quote&quot;&gt;&quot;Accept&quot;&lt;/span&gt; , &lt;span class=&quot;code-quote&quot;&gt;&quot;text/xml&quot;&lt;/span&gt;);
        RequestEntity entity = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; StringRequestEntity(POST_REQUEST, &lt;span class=&quot;code-quote&quot;&gt;&quot;text/xml&quot;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&quot;ISO-8859-1&quot;&lt;/span&gt;);
        post.setRequestEntity(entity);
        HttpClient httpclient = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; HttpClient();

        &lt;span class=&quot;code-keyword&quot;&gt;try&lt;/span&gt; {
            assertEquals(200, httpclient.executeMethod(post));
            assertEquals(&lt;span class=&quot;code-quote&quot;&gt;&quot;&amp;lt;?xml version=\&quot;&lt;/span&gt;1.0\&lt;span class=&quot;code-quote&quot;&gt;&quot; encoding=\&quot;&lt;/span&gt;UTF-8\&lt;span class=&quot;code-quote&quot;&gt;&quot; standalone=\&quot;&lt;/span&gt;yes\&lt;span class=&quot;code-quote&quot;&gt;&quot;?&amp;gt;&amp;lt;Customer&amp;gt;&amp;lt;id&amp;gt;124&amp;lt;/id&amp;gt;&amp;lt;name&amp;gt;Jack&amp;lt;/name&amp;gt;&amp;lt;/Customer&amp;gt;&quot;&lt;/span&gt;,
                    post.getResponseBodyAsString());
        } &lt;span class=&quot;code-keyword&quot;&gt;finally&lt;/span&gt; {
            post.releaseConnection();
        }

    } 
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12462841" name="camel-context.xml" size="3352" author="cmoulliard" created="Wed, 25 Nov 2009 10:52:45 +0000"/>
                            <attachment id="12462881" name="camel-cxf-rest-issue.zip" size="345484" author="cmoulliard" created="Tue, 24 Nov 2009 16:44:18 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Tue, 24 Nov 2009 16:52:17 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>76590</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            7 years, 2 weeks, 2 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i01n9z:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>7540</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                    <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        </customfields>
    </item>
</channel>
</rss>