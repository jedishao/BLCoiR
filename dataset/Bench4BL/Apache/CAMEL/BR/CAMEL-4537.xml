<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Sun Dec 04 01:06:39 UTC 2016

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/CAMEL-4537/CAMEL-4537.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[CAMEL-4537] Support for Spring DM 2.0</title>
                <link>https://issues.apache.org/jira/browse/CAMEL-4537</link>
                <project id="12311211" key="CAMEL">Camel</project>
                    <description>&lt;p&gt;The camel-spring-2.9-SNAPSHOT.jar bundle imports &lt;/p&gt;

&lt;p&gt;org.springframework.osgi.context;version=&quot;[1.2,2)&quot;;resolution:=optional,&lt;/p&gt;

&lt;p&gt;Which obviously excludes Spring DM 2.0.0M1&lt;/p&gt;

&lt;p&gt;I am not sure if Spring DM 2.0 breaks anything Camel is trying to use, but the class org.springframework.osgi.context.BundleContextAware it is searching for on startup does exist in spring-osgi-core-2.0.0.M1.jar.&lt;/p&gt;


&lt;p&gt;Currently when I deploy Camel 2.9-SNAPSHOT in JBoss 7.0.2 with Spring DM 2.0.0M1 I get the following error, and I am unable to resolve any Components from the OSGi Service registry - obviously because Camel is not trying to use it.&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
18:04:32,347 WARN  [org.jboss.modules] (SpringOsgiExtenderThread-1) Failed to define class org.apache.camel.osgi.CamelContextFactoryBean in Module &lt;span class=&quot;code-quote&quot;&gt;&quot;deployment.org.apache.camel.camel-spring:2.9.0.SNAPSHOT&quot;&lt;/span&gt; from Service Module Loader: java.lang.LinkageError: Failed to link org/apache/camel/osgi/CamelContextFactoryBean (Module &lt;span class=&quot;code-quote&quot;&gt;&quot;deployment.org.apache.camel.camel-spring:2.9.0.SNAPSHOT&quot;&lt;/span&gt; from Service Module Loader)
	at org.jboss.modules.ModuleClassLoader.defineClass(ModuleClassLoader.java:401) [jboss-modules.jar:1.0.2.GA]
	at org.jboss.modules.ModuleClassLoader.loadClassLocal(ModuleClassLoader.java:261) [jboss-modules.jar:1.0.2.GA]
	at org.jboss.modules.ModuleClassLoader$1.loadClassLocal(ModuleClassLoader.java:76) [jboss-modules.jar:1.0.2.GA]
	at org.jboss.modules.FilteredLocalLoader.loadClassLocal(FilteredLocalLoader.java:46) [jboss-modules.jar:1.0.2.GA]
	at org.jboss.modules.Module.loadModuleClass(Module.java:590) [jboss-modules.jar:1.0.2.GA]
	at org.jboss.modules.ModuleClassLoader.findClass(ModuleClassLoader.java:183) [jboss-modules.jar:1.0.2.GA]
	at org.jboss.modules.ConcurrentClassLoader.performLoadClassChecked(ConcurrentClassLoader.java:361) [jboss-modules.jar:1.0.2.GA]
	at org.jboss.modules.ConcurrentClassLoader.performLoadClassChecked(ConcurrentClassLoader.java:333) [jboss-modules.jar:1.0.2.GA]
	at org.jboss.modules.ConcurrentClassLoader.performLoadClass(ConcurrentClassLoader.java:310) [jboss-modules.jar:1.0.2.GA]
	at org.jboss.modules.ConcurrentClassLoader.loadClass(ConcurrentClassLoader.java:103) [jboss-modules.jar:1.0.2.GA]
	at java.lang.&lt;span class=&quot;code-object&quot;&gt;Class&lt;/span&gt;.forName0(Native Method) [:1.7.0]
	at java.lang.&lt;span class=&quot;code-object&quot;&gt;Class&lt;/span&gt;.forName(&lt;span class=&quot;code-object&quot;&gt;Class&lt;/span&gt;.java:186) [:1.7.0]
	at org.apache.camel.spring.handler.CamelNamespaceHandler.init(CamelNamespaceHandler.java:133)
	at org.springframework.beans.factory.xml.DefaultNamespaceHandlerResolver.resolve(DefaultNamespaceHandlerResolver.java:130)
	at org.springframework.osgi.extender.internal.support.NamespacePlugins$Plugin.resolve(NamespacePlugins.java:78)
	at org.springframework.osgi.extender.internal.support.NamespacePlugins$5.operate(NamespacePlugins.java:210)
	at org.springframework.osgi.extender.internal.support.NamespacePlugins$5.operate(NamespacePlugins.java:206)
	at org.springframework.osgi.extender.internal.support.LazyBundleRegistry.apply(LazyBundleRegistry.java:161)
	at org.springframework.osgi.extender.internal.support.NamespacePlugins.doResolve(NamespacePlugins.java:206)
	at org.springframework.osgi.extender.internal.support.NamespacePlugins.resolve(NamespacePlugins.java:170)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) [:1.7.0]
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:57) [:1.7.0]
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) [:1.7.0]
	at java.lang.reflect.Method.invoke(Method.java:601) [:1.7.0]
	at org.springframework.osgi.context.support.TrackingUtil$OsgiServiceHandler.invoke(TrackingUtil.java:108)
	at $Proxy12.resolve(Unknown Source)	at org.springframework.osgi.context.support.DelegatedNamespaceHandlerResolver.resolve(DelegatedNamespaceHandlerResolver.java:57)
	at org.springframework.beans.factory.xml.BeanDefinitionParserDelegate.parseCustomElement(BeanDefinitionParserDelegate.java:1333)
	at org.springframework.beans.factory.xml.BeanDefinitionParserDelegate.parseCustomElement(BeanDefinitionParserDelegate.java:1328)
	at org.springframework.beans.factory.xml.DefaultBeanDefinitionDocumentReader.parseBeanDefinitions(DefaultBeanDefinitionDocumentReader.java:135)
	at org.springframework.beans.factory.xml.DefaultBeanDefinitionDocumentReader.registerBeanDefinitions(DefaultBeanDefinitionDocumentReader.java:93)
	at org.springframework.beans.factory.xml.XmlBeanDefinitionReader.registerBeanDefinitions(XmlBeanDefinitionReader.java:493)
	at org.springframework.beans.factory.xml.XmlBeanDefinitionReader.doLoadBeanDefinitions(XmlBeanDefinitionReader.java:390)
	at org.springframework.beans.factory.xml.XmlBeanDefinitionReader.loadBeanDefinitions(XmlBeanDefinitionReader.java:334)
	at org.springframework.beans.factory.xml.XmlBeanDefinitionReader.loadBeanDefinitions(XmlBeanDefinitionReader.java:302)
	at org.springframework.beans.factory.support.AbstractBeanDefinitionReader.loadBeanDefinitions(AbstractBeanDefinitionReader.java:143)
	at org.springframework.beans.factory.support.AbstractBeanDefinitionReader.loadBeanDefinitions(AbstractBeanDefinitionReader.java:178)
	at org.springframework.beans.factory.support.AbstractBeanDefinitionReader.loadBeanDefinitions(AbstractBeanDefinitionReader.java:149)
	at org.springframework.osgi.context.support.OsgiBundleXmlApplicationContext.loadBeanDefinitions(OsgiBundleXmlApplicationContext.java:172)
	at org.springframework.osgi.context.support.OsgiBundleXmlApplicationContext.loadBeanDefinitions(OsgiBundleXmlApplicationContext.java:142)
	at org.springframework.context.support.AbstractRefreshableApplicationContext.refreshBeanFactory(AbstractRefreshableApplicationContext.java:130)
	at org.springframework.context.support.AbstractApplicationContext.obtainFreshBeanFactory(AbstractApplicationContext.java:467)
	at org.springframework.osgi.context.support.AbstractDelegatedExecutionApplicationContext.access$800(AbstractDelegatedExecutionApplicationContext.java:62)
	at org.springframework.osgi.context.support.AbstractDelegatedExecutionApplicationContext$3.run(AbstractDelegatedExecutionApplicationContext.java:244)
	at org.springframework.osgi.util.internal.PrivilegedUtils.executeWithCustomTCCL(PrivilegedUtils.java:87)
	at org.springframework.osgi.context.support.AbstractDelegatedExecutionApplicationContext.startRefresh(AbstractDelegatedExecutionApplicationContext.java:222)
	at org.springframework.osgi.extender.internal.dependencies.startup.DependencyWaiterApplicationContextExecutor.stageOne(DependencyWaiterApplicationContextExecutor.java:225)
	at org.springframework.osgi.extender.internal.dependencies.startup.DependencyWaiterApplicationContextExecutor.refresh(DependencyWaiterApplicationContextExecutor.java:178)
	at org.springframework.osgi.context.support.AbstractDelegatedExecutionApplicationContext.refresh(AbstractDelegatedExecutionApplicationContext.java:159)
	at org.springframework.osgi.extender.internal.activator.LifecycleManager$1.run(LifecycleManager.java:223)
	at java.lang.&lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;.run(&lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;.java:722) [:1.7.0]
Caused by: java.lang.NoClassDefFoundError: org/springframework/osgi/context/BundleContextAware
	at java.lang.&lt;span class=&quot;code-object&quot;&gt;ClassLoader&lt;/span&gt;.defineClass1(Native Method) [:1.7.0]
	at java.lang.&lt;span class=&quot;code-object&quot;&gt;ClassLoader&lt;/span&gt;.defineClass(&lt;span class=&quot;code-object&quot;&gt;ClassLoader&lt;/span&gt;.java:791) [:1.7.0]
	at java.security.SecureClassLoader.defineClass(SecureClassLoader.java:142) [:1.7.0]
	at org.jboss.modules.ModuleClassLoader.defineClass(ModuleClassLoader.java:397) [jboss-modules.jar:1.0.2.GA]
	... 50 more
Caused by: java.lang.ClassNotFoundException: org.springframework.osgi.context.BundleContextAware from [Module &lt;span class=&quot;code-quote&quot;&gt;&quot;deployment.org.apache.camel.camel-spring:2.9.0.SNAPSHOT&quot;&lt;/span&gt; from Service Module Loader]
	at org.jboss.modules.ModuleClassLoader.findClass(ModuleClassLoader.java:191) [jboss-modules.jar:1.0.2.GA]
	at org.jboss.modules.ConcurrentClassLoader.performLoadClassChecked(ConcurrentClassLoader.java:361) [jboss-modules.jar:1.0.2.GA]
	at org.jboss.modules.ConcurrentClassLoader.performLoadClassChecked(ConcurrentClassLoader.java:333) [jboss-modules.jar:1.0.2.GA]
	at org.jboss.modules.ConcurrentClassLoader.performLoadClassChecked(ConcurrentClassLoader.java:333) [jboss-modules.jar:1.0.2.GA]
	at org.jboss.modules.ConcurrentClassLoader.performLoadClass(ConcurrentClassLoader.java:310) [jboss-modules.jar:1.0.2.GA]
	at org.jboss.modules.ConcurrentClassLoader.loadClass(ConcurrentClassLoader.java:103) [jboss-modules.jar:1.0.2.GA]
	... 54 more

18:04:32,368 INFO  [org.apache.camel.spring.handler.CamelNamespaceHandler] (SpringOsgiExtenderThread-1) OSGi environment not detected.
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
</description>
                <environment>&lt;p&gt;JBoss 7.0.2 - OSGi&lt;/p&gt;</environment>
        <key id="12526771">CAMEL-4537</key>
            <summary>Support for Spring DM 2.0</summary>
                <type id="2" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/newfeature.png">New Feature</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.png">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="2">Won&apos;t Fix</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="aaronjwhiteside">Aaron Whiteside</reporter>
                        <labels>
                            <label>OSGi</label>
                            <label>Spring</label>
                    </labels>
                <created>Tue, 11 Oct 2011 22:54:20 +0000</created>
                <updated>Wed, 23 Mar 2016 09:19:20 +0000</updated>
                            <resolved>Wed, 23 Mar 2016 09:19:20 +0000</resolved>
                                    <version>2.9.0</version>
                                                    <component>osgi</component>
                        <due></due>
                            <votes>1</votes>
                                    <watches>3</watches>
                                                                <comments>
                            <comment id="13125467" author="aaronjwhiteside" created="Tue, 11 Oct 2011 23:03:32 +0000"  >&lt;p&gt;Spring DM 2.0 support is essential, because of the classloading issues with Spring DM 1.x.&lt;/p&gt;

&lt;p&gt;I understand Spring DM 2.0 is not yet final, but it&apos;s a hell of a lot better than Spring DM 1.x. and no we cannot currently use Blueprint.&lt;/p&gt;</comment>
                            <comment id="13125636" author="jbonofre" created="Wed, 12 Oct 2011 06:58:51 +0000"  >&lt;p&gt;Spring DM version is provided by Karaf. The first step is to update to Spring DM 2.0 in Karaf.&lt;/p&gt;</comment>
                            <comment id="13125653" author="jbonofre" created="Wed, 12 Oct 2011 07:50:33 +0000"  >&lt;p&gt;Spring DM is not more active. It&apos;s now replaced with Gemini. Currently in Karaf, we use Aries Blueprint by default. Having two Blueprint extenders (Aries and Gemini) is really tricky and will be source of problems.&lt;/p&gt;

&lt;p&gt;I think it&apos;s better to ask to the users to use Blueprint (generic).&lt;/p&gt;</comment>
                            <comment id="13126614" author="aaronjwhiteside" created="Thu, 13 Oct 2011 14:26:25 +0000"  >&lt;p&gt;It seems Camel has a hard dependency on the Aries&apos; blueprint implementation.&lt;/p&gt;

&lt;p&gt;It won&apos;t work under Gemini or JBoss 7&apos;s blueprint implementation - I suspect this is because of the NamespaceHandler, I think it would be better to separate the Aries specific namespace handler into its own module/bundle, so that if someone wants to run Camel on a non Aries blueprint implementation they can do so, and if they want the custom blueprint namespace they can include the specific bundle for their blueprint implementation.&lt;/p&gt;


&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;

10:18:58,656 ERROR [org.jboss.osgi.framework.internal.FrameworkEventsPlugin] (MSC service thread 1-3) Framework ERROR: org.osgi.framework.BundleException: Cannot resolve bundle resModule: [com.mm.routing.engine:1.0.0.SNAPSHOT]
	at org.jboss.osgi.framework.internal.ResolverPlugin.resolve(ResolverPlugin.java:157) [jbosgi-framework-core-1.0.0.CR8.jar:1.0.0.CR8]
	at org.jboss.osgi.framework.internal.AbstractBundleState.ensureResolved(AbstractBundleState.java:551) [jbosgi-framework-core-1.0.0.CR8.jar:1.0.0.CR8]
	at org.jboss.osgi.framework.internal.HostBundleState.startInternal(HostBundleState.java:210) [jbosgi-framework-core-1.0.0.CR8.jar:1.0.0.CR8]
	at org.jboss.osgi.framework.internal.AbstractBundleState.start(AbstractBundleState.java:494) [jbosgi-framework-core-1.0.0.CR8.jar:1.0.0.CR8]
	at org.jboss.as.osgi.deployment.BundleStartTracker$1.processService(BundleStartTracker.java:144) [jboss-as-osgi-service-7.0.2.Final.jar:7.0.2.Final]
	at org.jboss.as.osgi.deployment.BundleStartTracker$1.transition(BundleStartTracker.java:119) [jboss-as-osgi-service-7.0.2.Final.jar:7.0.2.Final]
	at org.jboss.msc.service.ServiceControllerImpl.invokeListener(ServiceControllerImpl.java:1429) [jboss-msc-1.0.1.GA.jar:1.0.1.GA]
	at org.jboss.msc.service.ServiceControllerImpl.access$2600(ServiceControllerImpl.java:49) [jboss-msc-1.0.1.GA.jar:1.0.1.GA]
	at org.jboss.msc.service.ServiceControllerImpl$ListenerTask.run(ServiceControllerImpl.java:1952) [jboss-msc-1.0.1.GA.jar:1.0.1.GA]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1110) [:1.7.0]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:603) [:1.7.0]
	at java.lang.&lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;.run(&lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;.java:722) [:1.7.0]
Caused by: org.jboss.osgi.resolver.XResolverException: Unable to resolve Module[com.mm.routing.engine:1.0.0.SNAPSHOT]: missing requirement [Module[com.mm.routing.engine:1.0.0.SNAPSHOT]] &lt;span class=&quot;code-keyword&quot;&gt;package&lt;/span&gt;; (&lt;span class=&quot;code-keyword&quot;&gt;package&lt;/span&gt;=org.apache.camel.blueprint) [caused by: Unable to resolve Module[org.apache.camel.camel-blueprint:2.9.0.SNAPSHOT]: missing requirement [Module[org.apache.camel.camel-blueprint:2.9.0.SNAPSHOT]] &lt;span class=&quot;code-keyword&quot;&gt;package&lt;/span&gt;; (&amp;amp;(&lt;span class=&quot;code-keyword&quot;&gt;package&lt;/span&gt;=org.apache.aries.blueprint)(version&amp;gt;=0.3.0)(!(version&amp;gt;=1.0.0)))]
	at org.jboss.osgi.resolver.felix.FelixResolver.resolveInternal(FelixResolver.java:117) [jbosgi-resolver-felix-1.0.9.jar:1.0.9]
	at org.jboss.osgi.resolver.spi.AbstractResolver.resolve(AbstractResolver.java:148) [jbosgi-resolver-spi-1.0.9.jar:1.0.9]
	at org.jboss.osgi.framework.internal.ResolverPlugin.resolve(ResolverPlugin.java:155) [jbosgi-framework-core-1.0.0.CR8.jar:1.0.0.CR8]
	... 11 more
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="13126937" author="aaronjwhiteside" created="Thu, 13 Oct 2011 21:17:33 +0000"  >&lt;p&gt;OK,&lt;/p&gt;

&lt;p&gt;So here is my real problems with Camel, maybe you have a solution...&lt;/p&gt;

&lt;ul&gt;
	&lt;li&gt;Camel JMS Component depends on Spring.&lt;/li&gt;
	&lt;li&gt;Camel Blueprint support depends on the Aries implementation.&lt;/li&gt;
	&lt;li&gt;Camel Spring+OSGi support only works with Spring DM 1.2 not Spring DM 2.0.&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;So while I can manually create an OSGiCamelContext instance in a non-Aries-Blueprint-implementation, I have no way of configuring the JMS Component&apos;s ConnectionFactory or TransactionManager. As the JMS Component uses the spring&apos;s ApplicationContext to look them up.&lt;/p&gt;

&lt;p&gt;If I manually can create the JMSComponent in the Blueprint context and register it as a service but the CamelContext cannot see that instance.&lt;/p&gt;

&lt;p&gt;This is my blueprint context and keep in mind this is running on JBoss 7.0.2 using it&apos;s own Blueprint implementation.&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
&amp;lt;?xml version=&lt;span class=&quot;code-quote&quot;&gt;&quot;1.0&quot;&lt;/span&gt; encoding=&lt;span class=&quot;code-quote&quot;&gt;&quot;UTF-8&quot;&lt;/span&gt;?&amp;gt;
&amp;lt;blueprint xmlns=&lt;span class=&quot;code-quote&quot;&gt;&quot;http:&lt;span class=&quot;code-comment&quot;&gt;//www.osgi.org/xmlns/blueprint/v1.0.0&quot;&lt;/span&gt;
&lt;/span&gt;           xmlns:xsi=&lt;span class=&quot;code-quote&quot;&gt;&quot;http:&lt;span class=&quot;code-comment&quot;&gt;//www.w3.org/2001/XMLSchema-instance&quot;&lt;/span&gt;&amp;gt;
&lt;/span&gt;
    &amp;lt;!-- Setup Spring&apos;s JTA Transaction Manager --&amp;gt;
    &amp;lt;bean id=&lt;span class=&quot;code-quote&quot;&gt;&quot;transactionManager&quot;&lt;/span&gt; class=&lt;span class=&quot;code-quote&quot;&gt;&quot;org.springframework.transaction.jta.JtaTransactionManager&quot;&lt;/span&gt;&amp;gt;
        &amp;lt;property name=&lt;span class=&quot;code-quote&quot;&gt;&quot;transactionManagerName&quot;&lt;/span&gt; value=&lt;span class=&quot;code-quote&quot;&gt;&quot;java:jboss/TransactionManager&quot;&lt;/span&gt;/&amp;gt;
    &amp;lt;/bean&amp;gt;

    &amp;lt;!-- Use JNDI --&amp;gt;
    &amp;lt;bean id=&lt;span class=&quot;code-quote&quot;&gt;&quot;initialContext&quot;&lt;/span&gt; class=&lt;span class=&quot;code-quote&quot;&gt;&quot;javax.naming.InitialContext&quot;&lt;/span&gt;/&amp;gt;

    &amp;lt;!-- Lookup the JMS connection factory from the container --&amp;gt;
    &amp;lt;bean id=&lt;span class=&quot;code-quote&quot;&gt;&quot;connectionFactory&quot;&lt;/span&gt; factory-ref=&lt;span class=&quot;code-quote&quot;&gt;&quot;initialContext&quot;&lt;/span&gt; factory-method=&lt;span class=&quot;code-quote&quot;&gt;&quot;lookup&quot;&lt;/span&gt;&amp;gt;
        &amp;lt;argument value=&lt;span class=&quot;code-quote&quot;&gt;&quot;java:/JmsXA&quot;&lt;/span&gt;/&amp;gt;
    &amp;lt;/bean&amp;gt;

    &amp;lt;!-- Create and Register JmsComponent --&amp;gt;
    &amp;lt;bean id=&lt;span class=&quot;code-quote&quot;&gt;&quot;jmsComponent&quot;&lt;/span&gt; class=&lt;span class=&quot;code-quote&quot;&gt;&quot;org.apache.camel.component.jms.JmsComponent&quot;&lt;/span&gt;&amp;gt;
        &amp;lt;property name=&lt;span class=&quot;code-quote&quot;&gt;&quot;connectionFactory&quot;&lt;/span&gt; ref=&lt;span class=&quot;code-quote&quot;&gt;&quot;connectionFactory&quot;&lt;/span&gt;/&amp;gt;
        &amp;lt;property name=&lt;span class=&quot;code-quote&quot;&gt;&quot;transactionManager&quot;&lt;/span&gt; ref=&lt;span class=&quot;code-quote&quot;&gt;&quot;transactionManager&quot;&lt;/span&gt;/&amp;gt;
    &amp;lt;/bean&amp;gt;
    &amp;lt;service ref=&lt;span class=&quot;code-quote&quot;&gt;&quot;jmsComponent&quot;&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;interface&lt;/span&gt;=&lt;span class=&quot;code-quote&quot;&gt;&quot;org.apache.camel.Component&quot;&lt;/span&gt;/&amp;gt;

    &amp;lt;!-- Setup a Camel Context instance --&amp;gt;
    &amp;lt;bean id=&lt;span class=&quot;code-quote&quot;&gt;&quot;camelContext&quot;&lt;/span&gt; class=&lt;span class=&quot;code-quote&quot;&gt;&quot;org.apache.camel.core.osgi.OsgiDefaultCamelContext&quot;&lt;/span&gt; init-method=&lt;span class=&quot;code-quote&quot;&gt;&quot;start&quot;&lt;/span&gt; destroy-method=&lt;span class=&quot;code-quote&quot;&gt;&quot;stop&quot;&lt;/span&gt; scope=&lt;span class=&quot;code-quote&quot;&gt;&quot;singleton&quot;&lt;/span&gt;&amp;gt;
        &amp;lt;argument ref=&lt;span class=&quot;code-quote&quot;&gt;&quot;blueprintBundleContext&quot;&lt;/span&gt;/&amp;gt;
    &amp;lt;/bean&amp;gt;

&amp;lt;/blueprint&amp;gt;

&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;


&lt;p&gt;With Spring DM 2.0 or Gemini this is much easier to do, the only problem being that Camel will not detect it&apos;s in an OSGi environment and will not find the various component bundles. So it cannot even find the JMSComponent.&lt;/p&gt;

&lt;p&gt;This is a copy of the Spring DM 2.0 context I was using:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
&amp;lt;?xml version=&lt;span class=&quot;code-quote&quot;&gt;&quot;1.0&quot;&lt;/span&gt; encoding=&lt;span class=&quot;code-quote&quot;&gt;&quot;UTF-8&quot;&lt;/span&gt;?&amp;gt;
&amp;lt;beans xmlns=&lt;span class=&quot;code-quote&quot;&gt;&quot;http:&lt;span class=&quot;code-comment&quot;&gt;//www.springframework.org/schema/beans&quot;&lt;/span&gt;
&lt;/span&gt;       xmlns:xsi=&lt;span class=&quot;code-quote&quot;&gt;&quot;http:&lt;span class=&quot;code-comment&quot;&gt;//www.w3.org/2001/XMLSchema-instance&quot;&lt;/span&gt;
&lt;/span&gt;       xmlns:camel=&lt;span class=&quot;code-quote&quot;&gt;&quot;http:&lt;span class=&quot;code-comment&quot;&gt;//camel.apache.org/schema/spring&quot;&lt;/span&gt;
&lt;/span&gt;       xmlns:osgi=&lt;span class=&quot;code-quote&quot;&gt;&quot;http:&lt;span class=&quot;code-comment&quot;&gt;//www.springframework.org/schema/osgi&quot;&lt;/span&gt;
&lt;/span&gt;       xmlns:jee=&lt;span class=&quot;code-quote&quot;&gt;&quot;http:&lt;span class=&quot;code-comment&quot;&gt;//www.springframework.org/schema/jee&quot;&lt;/span&gt;
&lt;/span&gt;       xmlns:context=&lt;span class=&quot;code-quote&quot;&gt;&quot;http:&lt;span class=&quot;code-comment&quot;&gt;//www.springframework.org/schema/context&quot;&lt;/span&gt;
&lt;/span&gt;       xsi:schemaLocation=&quot;http:&lt;span class=&quot;code-comment&quot;&gt;//www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-3.0.xsd
&lt;/span&gt;                           http:&lt;span class=&quot;code-comment&quot;&gt;//www.springframework.org/schema/osgi http://www.springframework.org/schema/osgi/spring-osgi.xsd
&lt;/span&gt;                           http:&lt;span class=&quot;code-comment&quot;&gt;//camel.apache.org/schema/spring http://camel.apache.org/schema/spring/camel-spring.xsd
&lt;/span&gt;                           http:&lt;span class=&quot;code-comment&quot;&gt;//www.springframework.org/schema/jee http://www.springframework.org/schema/jee/spring-jee-3.0.xsd
&lt;/span&gt;                           http:&lt;span class=&quot;code-comment&quot;&gt;//www.springframework.org/schema/context http://www.springframework.org/schema/context/spring-context-3.0.xsd&quot;&amp;gt;
&lt;/span&gt;
    &amp;lt;!-- Setup Spring&apos;s JTA Transaction Manager --&amp;gt;
    &amp;lt;bean id=&lt;span class=&quot;code-quote&quot;&gt;&quot;transactionManager&quot;&lt;/span&gt; class=&lt;span class=&quot;code-quote&quot;&gt;&quot;org.springframework.transaction.jta.JtaTransactionManager&quot;&lt;/span&gt;&amp;gt;
        &amp;lt;property name=&lt;span class=&quot;code-quote&quot;&gt;&quot;transactionManagerName&quot;&lt;/span&gt; value=&lt;span class=&quot;code-quote&quot;&gt;&quot;java:jboss/TransactionManager&quot;&lt;/span&gt;/&amp;gt;
    &amp;lt;/bean&amp;gt;

    &amp;lt;!-- Lookup the JMS connection factory from the container --&amp;gt;
    &amp;lt;jee:jndi-lookup id=&lt;span class=&quot;code-quote&quot;&gt;&quot;connectionFactory&quot;&lt;/span&gt; jndi-name=&lt;span class=&quot;code-quote&quot;&gt;&quot;java:/JmsXA&quot;&lt;/span&gt; lookup-on-startup=&lt;span class=&quot;code-quote&quot;&gt;&quot;&lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;&quot;&lt;/span&gt; expected-type=&lt;span class=&quot;code-quote&quot;&gt;&quot;javax.jms.ConnectionFactory&quot;&lt;/span&gt;/&amp;gt;

    &amp;lt;!-- Create and Register JmsComponent --&amp;gt;
    &amp;lt;!--&amp;lt;bean id=&lt;span class=&quot;code-quote&quot;&gt;&quot;jmsComponent&quot;&lt;/span&gt; class=&lt;span class=&quot;code-quote&quot;&gt;&quot;org.apache.camel.component.jms.JmsComponent&quot;&lt;/span&gt;&amp;gt;--&amp;gt;
        &amp;lt;!--&amp;lt;property name=&lt;span class=&quot;code-quote&quot;&gt;&quot;connectionFactory&quot;&lt;/span&gt; ref=&lt;span class=&quot;code-quote&quot;&gt;&quot;connectionFactory&quot;&lt;/span&gt;/&amp;gt;--&amp;gt;
        &amp;lt;!--&amp;lt;property name=&lt;span class=&quot;code-quote&quot;&gt;&quot;transactionManager&quot;&lt;/span&gt; ref=&lt;span class=&quot;code-quote&quot;&gt;&quot;transactionManager&quot;&lt;/span&gt;/&amp;gt;--&amp;gt;
    &amp;lt;!--&amp;lt;/bean&amp;gt;--&amp;gt;
    &amp;lt;!--&amp;lt;osgi:service ref=&lt;span class=&quot;code-quote&quot;&gt;&quot;jmsComponent&quot;&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;interface&lt;/span&gt;=&lt;span class=&quot;code-quote&quot;&gt;&quot;org.apache.camel.Component&quot;&lt;/span&gt;/&amp;gt;--&amp;gt;

    &amp;lt;!-- Setup a Camel Context instance --&amp;gt;
    &amp;lt;camel:camelContext id=&lt;span class=&quot;code-quote&quot;&gt;&quot;camelContext&quot;&lt;/span&gt; autoStartup=&lt;span class=&quot;code-quote&quot;&gt;&quot;&lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;&quot;&lt;/span&gt; shutdownRunningTask=&lt;span class=&quot;code-quote&quot;&gt;&quot;CompleteAllTasks&quot;&lt;/span&gt;&amp;gt;
        &amp;lt;camel:jmxAgent id=&lt;span class=&quot;code-quote&quot;&gt;&quot;jmxAgent&quot;&lt;/span&gt; disabled=&lt;span class=&quot;code-quote&quot;&gt;&quot;&lt;span class=&quot;code-keyword&quot;&gt;false&lt;/span&gt;&quot;&lt;/span&gt; usePlatformMBeanServer=&lt;span class=&quot;code-quote&quot;&gt;&quot;&lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;&quot;&lt;/span&gt; createConnector=&lt;span class=&quot;code-quote&quot;&gt;&quot;&lt;span class=&quot;code-keyword&quot;&gt;false&lt;/span&gt;&quot;&lt;/span&gt;/&amp;gt;
    &amp;lt;/camel:camelContext&amp;gt;

&amp;lt;/beans&amp;gt;

&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;


&lt;p&gt;So how to use JMS in OSGi without using Spring or Aries for Blueprint?&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10032">
                    <name>Blocker</name>
                                                                <inwardlinks description="is blocked by">
                                        <issuelink>
            <issuekey id="12526805">KARAF-928</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                            <issuelinktype id="12310000">
                    <name>Duplicate</name>
                                            <outwardlinks description="duplicates">
                                        <issuelink>
            <issuekey id="12487645">CAMEL-3294</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                    </issuelinks>
                <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Wed, 12 Oct 2011 06:58:51 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12310060" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Estimated Complexity</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10064"><![CDATA[Guru]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>72532</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            5 years, 8 weeks, 2 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i021jz:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9853</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        </customfields>
    </item>
</channel>
</rss>