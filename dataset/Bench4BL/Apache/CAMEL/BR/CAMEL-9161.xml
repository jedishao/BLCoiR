<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Sat Dec 03 05:06:26 UTC 2016

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/CAMEL-9161/CAMEL-9161.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[CAMEL-9161] Camel spring-boot not finding routes when using spring-cloud</title>
                <link>https://issues.apache.org/jira/browse/CAMEL-9161</link>
                <project id="12311211" key="CAMEL">Camel</project>
                    <description>&lt;p&gt;On startup Camel is not registering any routes annotated with @Component. Route is found and registered in Spring just fine. Switch to version 2.15.2 and it works fine. &lt;/p&gt;

&lt;p&gt;No errors are thrown, and everything says it&apos;s started, but no routes are active or reported as being found during startup. &lt;/p&gt;

&lt;p&gt;Application is being run through `mvn spring-boot:run` if that makes a difference.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12896117">CAMEL-9161</key>
            <summary>Camel spring-boot not finding routes when using spring-cloud</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/bug.png">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.png">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="hekonsek">Henryk Konsek</assignee>
                                    <reporter username="nstuart">Nicholas Stuart</reporter>
                        <labels>
                    </labels>
                <created>Thu, 24 Sep 2015 13:51:22 +0000</created>
                <updated>Fri, 13 Nov 2015 10:09:57 +0000</updated>
                            <resolved>Wed, 11 Nov 2015 07:17:07 +0000</resolved>
                                    <version>2.15.3</version>
                    <version>2.16.0</version>
                                    <fixVersion>2.16.1</fixVersion>
                    <fixVersion>2.15.5</fixVersion>
                    <fixVersion>2.17.0</fixVersion>
                                    <component>camel-spring-boot</component>
                        <due></due>
                            <votes>1</votes>
                                    <watches>6</watches>
                                                                <comments>
                            <comment id="14906388" author="davsclaus" created="Thu, 24 Sep 2015 14:11:09 +0000"  >&lt;p&gt;Can you try 2.16-SNAPSHOT&lt;/p&gt;</comment>
                            <comment id="14906746" author="hekonsek" created="Thu, 24 Sep 2015 18:02:27 +0000"  >&lt;p&gt;So it works for 2.15.2 and doesn&apos;t for 2.15.3?&lt;/p&gt;</comment>
                            <comment id="14907124" author="nstuart" created="Thu, 24 Sep 2015 22:14:08 +0000"  >&lt;p&gt;Correct, it works fine on 2.15.2 with no changes.&lt;/p&gt;

&lt;p&gt;I will try 2.16 when I get a chance to see if that works as well.&lt;/p&gt;</comment>
                            <comment id="14907858" author="hekonsek" created="Fri, 25 Sep 2015 09:29:58 +0000"  >&lt;p&gt;OK. Thanks! Please let us know what is result. Cheers!&lt;/p&gt;</comment>
                            <comment id="14985499" author="nstuart" created="Mon, 2 Nov 2015 16:39:00 +0000"  >&lt;p&gt;Ok, so it looks like I found the root cause, as it is also happening in 2.15.3. The culprit is in the changes in RoutesCollectors:&lt;/p&gt;

&lt;p&gt;if (applicationContext.getParent() == null) &lt;/p&gt;
{
...
}

&lt;p&gt;&lt;a href=&quot;https://github.com/apache/camel/commit/21107ffe44ff88828a4f8bcc777ec7797e885c5f#diff-dc33e1af06d90575702e3c156abde0c4&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://github.com/apache/camel/commit/21107ffe44ff88828a4f8bcc777ec7797e885c5f#diff-dc33e1af06d90575702e3c156abde0c4&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;In my app, the application parent is indeed, not null. I&apos;m not sure what the reasoning behind this parent check is (besides aforementioned double refresh). Will investigate further to see if I can come up with a solution for us, but just thought I would share my findings so far.&lt;/p&gt;

&lt;p&gt;My parrent context, btw, is a AnnotationConfigApplicationContext which doesn&apos;t seem to out of the ordinary.&lt;/p&gt;</comment>
                            <comment id="14985543" author="nstuart" created="Mon, 2 Nov 2015 17:05:32 +0000"  >&lt;p&gt;Would a viable solution be to check the status of the CamelContext instead? Not sure what the caveats of this approach would be (race conditions, etc), but something like:&lt;/p&gt;

&lt;p&gt;if(camelContext.getStatus() != ServiceStatus.Starting &amp;amp;&amp;amp; camelContext.getStatus() != ServiceStatus.Started)&lt;/p&gt;

&lt;p&gt;seems like it might work.&lt;/p&gt;</comment>
                            <comment id="14998524" author="nstuart" created="Tue, 10 Nov 2015 13:06:54 +0000"  >&lt;p&gt;Found out the difference and why it&apos;s not working correctly in our apps. If you include/use spring-cloud the ApplicationContext you create is no longer the root conext, and this causes issues with the patch mentioned above.&lt;/p&gt;

&lt;p&gt;I&apos;ll attach a sample app that will show the issue. It also includes the use of FeignClients because we had to work around the double refresh issues with how the act so I wanted to make sure that use case was still supported as well. The app also includes a RoutesCollector that works with this setup.&lt;/p&gt;

&lt;p&gt;Will produce a separate patch for this as well.&lt;/p&gt;</comment>
                            <comment id="14998668" author="githubbot" created="Tue, 10 Nov 2015 14:37:35 +0000"  >&lt;p&gt;GitHub user nstuart opened a pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/camel/pull/674&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://github.com/apache/camel/pull/674&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://issues.apache.org/jira/browse/CAMEL-9161&quot; title=&quot;Camel spring-boot not finding routes when using spring-cloud&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CAMEL-9161&quot;&gt;&lt;del&gt;CAMEL-9161&lt;/del&gt;&lt;/a&gt; Change for dealing with parent contexts&lt;/p&gt;

&lt;p&gt;    Changes to look at current status instead of just checking for parent context. Using spring cloud automatically adds a parent context which completely disables camel-spring-boot stuff from 2.15.3 onwards.&lt;/p&gt;

&lt;p&gt;You can merge this pull request into a Git repository by running:&lt;/p&gt;

&lt;p&gt;    $ git pull &lt;a href=&quot;https://github.com/nstuart/camel&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://github.com/nstuart/camel&lt;/a&gt; master&lt;/p&gt;

&lt;p&gt;Alternatively you can review and apply these changes as the patch at:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/camel/pull/674.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://github.com/apache/camel/pull/674.patch&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;To close this pull request, make a commit to your master/trunk branch&lt;br/&gt;
with (at least) the following in the commit message:&lt;/p&gt;

&lt;p&gt;    This closes #674&lt;/p&gt;

&lt;hr /&gt;
&lt;p&gt;commit 4257aaba6dece76f0649bb5c263bbb6b6558e5cd&lt;br/&gt;
Author: Nick Stuart &amp;lt;nick@portlandwebworks.com&amp;gt;&lt;br/&gt;
Date:   2015-11-10T14:19:07Z&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://issues.apache.org/jira/browse/CAMEL-9161&quot; title=&quot;Camel spring-boot not finding routes when using spring-cloud&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CAMEL-9161&quot;&gt;&lt;del&gt;CAMEL-9161&lt;/del&gt;&lt;/a&gt; Change for dealing with parent contexts&lt;/p&gt;

&lt;hr /&gt;</comment>
                            <comment id="15000048" author="githubbot" created="Wed, 11 Nov 2015 07:16:46 +0000"  >&lt;p&gt;Github user asfgit closed the pull request at:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/camel/pull/674&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://github.com/apache/camel/pull/674&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="15000049" author="davsclaus" created="Wed, 11 Nov 2015 07:17:07 +0000"  >&lt;p&gt;Thanks for the PR&lt;/p&gt;</comment>
                            <comment id="15003806" author="etienne.dethoor@gmail.com" created="Fri, 13 Nov 2015 10:09:57 +0000"  >&lt;p&gt;Hello &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=davsclaus&quot; class=&quot;user-hover&quot; rel=&quot;davsclaus&quot;&gt;Claus Ibsen&lt;/a&gt;,&lt;/p&gt;

&lt;p&gt;Can you say when this fix will be available in the 2.16.1-SNAPSHOT version ?&lt;/p&gt;

&lt;p&gt;Thanks.&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="12310000">
                    <name>Duplicate</name>
                                                                <inwardlinks description="is duplicated by">
                                        <issuelink>
            <issuekey id="12910830">CAMEL-9294</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12771543" name="camel-boot-test.tar.gz" size="3520" author="nstuart" created="Tue, 10 Nov 2015 13:07:17 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Thu, 24 Sep 2015 14:11:09 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12310060" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Estimated Complexity</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10060"><![CDATA[Unknown]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            1 year, 3 weeks ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i2lilj:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310080" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                        <customfieldname>Regression</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10091"><![CDATA[Regression]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        </customfields>
    </item>
</channel>
</rss>