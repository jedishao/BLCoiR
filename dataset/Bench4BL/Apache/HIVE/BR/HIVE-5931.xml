<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Sat Dec 03 23:51:36 UTC 2016

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/HIVE-5931/HIVE-5931.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[HIVE-5931] SQL std auth - add metastore get_principals_in_role api, support SHOW PRINCIPALS role_name</title>
                <link>https://issues.apache.org/jira/browse/HIVE-5931</link>
                <project id="12310843" key="HIVE">Hive</project>
                    <description>&lt;p&gt;Support command for listing all members of a role.&lt;br/&gt;
A new metastore api call also needs to be added for this.&lt;/p&gt;
</description>
                <environment></environment>
        <key id="12682523">HIVE-5931</key>
            <summary>SQL std auth - add metastore get_principals_in_role api, support SHOW PRINCIPALS role_name</summary>
                <type id="7" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/subtask_alternate.png">Sub-task</type>
                            <parent id="12679546">HIVE-5837</parent>
                                    <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.png">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="thejas">Thejas M Nair</assignee>
                                    <reporter username="thejas">Thejas M Nair</reporter>
                        <labels>
                    </labels>
                <created>Tue, 3 Dec 2013 21:45:41 +0000</created>
                <updated>Thu, 13 Mar 2014 07:52:44 +0000</updated>
                            <resolved>Wed, 12 Mar 2014 10:23:12 +0000</resolved>
                                                    <fixVersion>0.13.0</fixVersion>
                                    <component>Authorization</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>5</watches>
                                    <timeoriginalestimate seconds="86400">24h</timeoriginalestimate>
                            <timeestimate seconds="86400">24h</timeestimate>
                                        <comments>
                            <comment id="13841874" author="thejas" created="Fri, 6 Dec 2013 23:21:07 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=navis&quot; class=&quot;user-hover&quot; rel=&quot;navis&quot;&gt;Navis&lt;/a&gt; I believe your internal patch &quot;NHIVE-31 Add API for retrieving principals endowed with the specific role&quot; must be doing the same as what is described in this jira. Will you able able to contribute that ?&lt;/p&gt;</comment>
                            <comment id="13872901" author="thejas" created="Thu, 16 Jan 2014 01:08:40 +0000"  >&lt;p&gt;Navis, can you please contribute NHIVE-31 patch ? Do let me know if that patch is blocked on some other patch already submitted.&lt;/p&gt;</comment>
                            <comment id="13872931" author="navis" created="Thu, 16 Jan 2014 01:39:22 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=thejas&quot; class=&quot;user-hover&quot; rel=&quot;thejas&quot;&gt;Thejas M Nair&lt;/a&gt; I&apos;ve tried rebase NHIVE-31 on trunk but it&apos;s heavily dependent to &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-6204&quot; title=&quot;The result of show grant / show role should be tabular format&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-6204&quot;&gt;&lt;del&gt;HIVE-6204&lt;/del&gt;&lt;/a&gt; and it is again dependent to &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-6122&quot; title=&quot;Implement show grant on &amp;lt;resource&amp;gt;&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-6122&quot;&gt;&lt;del&gt;HIVE-6122&lt;/del&gt;&lt;/a&gt;. I don&apos;t like the way &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-6122&quot; title=&quot;Implement show grant on &amp;lt;resource&amp;gt;&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-6122&quot;&gt;&lt;del&gt;HIVE-6122&lt;/del&gt;&lt;/a&gt; is implemented but should hurry on it.&lt;/p&gt;</comment>
                            <comment id="13894305" author="thejas" created="Fri, 7 Feb 2014 08:32:12 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=navis&quot; class=&quot;user-hover&quot; rel=&quot;navis&quot;&gt;Navis&lt;/a&gt; Can you please see if you can contribute the patch for this jira ?&lt;/p&gt;</comment>
                            <comment id="13918805" author="thejas" created="Tue, 4 Mar 2014 00:23:24 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-5931&quot; title=&quot;SQL std auth - add metastore get_principals_in_role api, support SHOW PRINCIPALS role_name&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-5931&quot;&gt;&lt;del&gt;HIVE-5931&lt;/del&gt;&lt;/a&gt;.thriftapi.patch - thrift api that I plan to introduce.&lt;br/&gt;
I also think it will be cleaner to use an api that returns RoleGrant for the show-role-grant instead of adding the RoleGrant information to Role (which becomes confusing in the context of create-role). I am thinking of making that change in a separate follow up patch for 0.13 . I am hoping we can include that during the stabilization phase of 0.13 (ie, post branching).&lt;/p&gt;

&lt;p&gt;cc &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=navis&quot; class=&quot;user-hover&quot; rel=&quot;navis&quot;&gt;Navis&lt;/a&gt; &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=ashutoshc&quot; class=&quot;user-hover&quot; rel=&quot;ashutoshc&quot;&gt;Ashutosh Chauhan&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="13918827" author="thejas" created="Tue, 4 Mar 2014 00:36:23 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-5931&quot; title=&quot;SQL std auth - add metastore get_principals_in_role api, support SHOW PRINCIPALS role_name&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-5931&quot;&gt;&lt;del&gt;HIVE-5931&lt;/del&gt;&lt;/a&gt;.thriftapi.followup.patch - The follow up change that I am planning to introduce. Along with this change, the show-role-grants would use get_role_grants_for_principal instead of list_roles. That way we won&apos;t be storing role-to-principal mapping in the Role thrift object. This is a better normalized representation IMO.&lt;/p&gt;</comment>
                            <comment id="13918830" author="thejas" created="Tue, 4 Mar 2014 00:40:25 +0000"  >&lt;p&gt;fyi, the addition of user-to-role mapping into Role &apos;class&apos; was added in &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-6204&quot; title=&quot;The result of show grant / show role should be tabular format&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-6204&quot;&gt;&lt;del&gt;HIVE-6204&lt;/del&gt;&lt;/a&gt; (hive 0.13, so this will not be a backward incompatible change). But while working on this I feel, mixing the role-to-user mapping and Role object is not very intuitive/clean, and we might be taking on some technical debt there. &lt;/p&gt;</comment>
                            <comment id="13920423" author="ashutoshc" created="Wed, 5 Mar 2014 03:02:47 +0000"  >&lt;p&gt;Few comments on proposed api:&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;Better name for 1st method : get_principals_in_role() ?&lt;/li&gt;
	&lt;li&gt;Better name for 2nd method : get_roles_granted_to_principal() ?&lt;/li&gt;
	&lt;li&gt;Also struct needs better name. Also, put explanation for struct, since it carries redundant info, depending on method it is used in.&lt;/li&gt;
	&lt;li&gt;principalType in struct should be enum&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="13921242" author="ashutoshc" created="Wed, 5 Mar 2014 19:14:06 +0000"  >&lt;p&gt;Don&apos;t see {{ list&amp;lt;RoleGrant&amp;gt; get_role_grants_for_principal}} in latest patch. You want to do that in separate patch?&lt;/p&gt;</comment>
                            <comment id="13921280" author="thejas" created="Wed, 5 Mar 2014 19:34:09 +0000"  >&lt;p&gt;Yes, I was planning to do that as part of &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-6547&quot; title=&quot;normalize struct Role in metastore thrift interface&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-6547&quot;&gt;&lt;del&gt;HIVE-6547&lt;/del&gt;&lt;/a&gt; .&lt;/p&gt;</comment>
                            <comment id="13921287" author="ashutoshc" created="Wed, 5 Mar 2014 19:37:36 +0000"  >&lt;p&gt;OK. Current proposal looks good.&lt;/p&gt;</comment>
                            <comment id="13924779" author="thejas" created="Sat, 8 Mar 2014 09:46:22 +0000"  >&lt;p&gt;I am working on adding support for the describe role syntax as well, as part of this jira.&lt;/p&gt;

&lt;p&gt;But there is a problem, the current describe table syntax allows the following -&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
DESCRIBE t1 key1;
DESCRIBE EXTENDED t1 key1;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;In hive, almost all keywords are also identifiers . So &quot;describe role &amp;lt;rolename&amp;gt;&quot; also gets translated to a describe table command with &quot;role&quot; as table name and &quot;&amp;lt;rolename&amp;gt;&quot; as a column.&lt;/p&gt;

&lt;p&gt;This is not a documented syntax AFAIK,  but we do have .q tests for it and it would break backward compatibility.The documented syntax requires a  dot &lt;a href=&quot;https://cwiki.apache.org/confluence/display/Hive/LanguageManual+DDL#LanguageManualDDL-Describe&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://cwiki.apache.org/confluence/display/Hive/LanguageManual+DDL#LanguageManualDDL-Describe&lt;/a&gt; . Dot became optional with &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-1977&quot; title=&quot;DESCRIBE TABLE syntax doesn&amp;#39;t support specifying a database qualified table name&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-1977&quot;&gt;&lt;del&gt;HIVE-1977&lt;/del&gt;&lt;/a&gt; . Since there are tests added as part of the patch that use this format, it looks like the change was intentional.&lt;/p&gt;

&lt;p&gt;I will look at syntax alternatives to &apos;describe role&apos;. &lt;/p&gt;

</comment>
                            <comment id="13924810" author="thejas" created="Sat, 8 Mar 2014 12:02:39 +0000"  >&lt;p&gt;The reason why &apos;describe function &amp;lt;funcname&amp;gt;&apos; works is that for some historic reason the keyword function was not marked as a non reserved keyword in IdentifiersParser.g. This is not the case with ROLE keyword.&lt;/p&gt;</comment>
                            <comment id="13925702" author="thejas" created="Mon, 10 Mar 2014 12:34:11 +0000"  >&lt;p&gt;Instead of describe-role,  I have added support for the command: SHOW ROLE PRINCIPALS role_name;&lt;/p&gt;

&lt;p&gt;Attaching a patch file without the thrift generated files as well, for ease of review ( &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-5931&quot; title=&quot;SQL std auth - add metastore get_principals_in_role api, support SHOW PRINCIPALS role_name&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-5931&quot;&gt;&lt;del&gt;HIVE-5931&lt;/del&gt;&lt;/a&gt;.nothrifgen.1.patch  is no thrift-gen version of &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-5931&quot; title=&quot;SQL std auth - add metastore get_principals_in_role api, support SHOW PRINCIPALS role_name&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-5931&quot;&gt;&lt;del&gt;HIVE-5931&lt;/del&gt;&lt;/a&gt;.1.patch )&lt;/p&gt;
</comment>
                            <comment id="13925710" author="thejas" created="Mon, 10 Mar 2014 12:50:35 +0000"  >&lt;p&gt;Adding review board link&lt;/p&gt;</comment>
                            <comment id="13929892" author="ashutoshc" created="Tue, 11 Mar 2014 02:29:49 +0000"  >&lt;p&gt;Patch looks good. I have a minor comment on RB. &lt;br/&gt;
Although, I think following syntax  is better :&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
SHOW PRINCIPALS role_name;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;having role there is redundant. &lt;/p&gt;</comment>
                            <comment id="13930215" author="thejas" created="Tue, 11 Mar 2014 11:06:21 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-5931&quot; title=&quot;SQL std auth - add metastore get_principals_in_role api, support SHOW PRINCIPALS role_name&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-5931&quot;&gt;&lt;del&gt;HIVE-5931&lt;/del&gt;&lt;/a&gt;.*.2.patch  - addressing review comments. Update syntax to &apos;show principals role_name&apos;&lt;/p&gt;</comment>
                            <comment id="13930471" author="hiveqa" created="Tue, 11 Mar 2014 15:39:03 +0000"  >

&lt;p&gt;&lt;font color=&quot;green&quot;&gt;Overall&lt;/font&gt;: +1 all checks pass&lt;/p&gt;

&lt;p&gt;Here are the results of testing the latest attachment:&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/secure/attachment/12633684/HIVE-5931.1.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/secure/attachment/12633684/HIVE-5931.1.patch&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;font color=&quot;green&quot;&gt;SUCCESS:&lt;/font&gt; +1 5379 tests passed&lt;/p&gt;

&lt;p&gt;Test results: &lt;a href=&quot;http://bigtop01.cloudera.org:8080/job/PreCommit-HIVE-Build/1701/testReport&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://bigtop01.cloudera.org:8080/job/PreCommit-HIVE-Build/1701/testReport&lt;/a&gt;&lt;br/&gt;
Console output: &lt;a href=&quot;http://bigtop01.cloudera.org:8080/job/PreCommit-HIVE-Build/1701/console&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://bigtop01.cloudera.org:8080/job/PreCommit-HIVE-Build/1701/console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Messages:&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;Executing org.apache.hive.ptest.execution.PrepPhase
Executing org.apache.hive.ptest.execution.ExecutionPhase
Executing org.apache.hive.ptest.execution.ReportingPhase
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;

&lt;p&gt;ATTACHMENT ID: 12633684&lt;/p&gt;</comment>
                            <comment id="13930474" author="ashutoshc" created="Tue, 11 Mar 2014 15:42:42 +0000"  >&lt;p&gt;+1&lt;/p&gt;</comment>
                            <comment id="13931611" author="thejas" created="Wed, 12 Mar 2014 10:23:12 +0000"  >&lt;p&gt;Patch committed to trunk and 0.13 branch. &lt;br/&gt;
I didn&apos;t realize that I had not checked with Harish on including this in 0.13. Sorry, about that. I have now included it the wiki page. cc &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=rhbutani&quot; class=&quot;user-hover&quot; rel=&quot;rhbutani&quot;&gt;Harish Butani&lt;/a&gt;&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10032">
                    <name>Blocker</name>
                                            <outwardlinks description="blocks">
                                        <issuelink>
            <issuekey id="12682603">HIVE-5942</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                            <issuelinktype id="12310000">
                    <name>Duplicate</name>
                                                                <inwardlinks description="is duplicated by">
                                        <issuelink>
            <issuekey id="12682603">HIVE-5942</issuekey>
        </issuelink>
            <issuelink>
            <issuekey id="12682604">HIVE-5943</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                            <outwardlinks description="relates to">
                                        <issuelink>
            <issuekey id="12698716">HIVE-6547</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12633684" name="HIVE-5931.1.patch" size="1110462" author="thejas" created="Mon, 10 Mar 2014 12:31:28 +0000"/>
                            <attachment id="12633889" name="HIVE-5931.2.patch" size="1110507" author="thejas" created="Tue, 11 Mar 2014 11:06:21 +0000"/>
                            <attachment id="12633683" name="HIVE-5931.nothrifgen.1.patch" size="84493" author="thejas" created="Mon, 10 Mar 2014 12:30:35 +0000"/>
                            <attachment id="12633888" name="HIVE-5931.nothrifgen.2.patch" size="84578" author="thejas" created="Tue, 11 Mar 2014 11:04:09 +0000"/>
                            <attachment id="12632888" name="HIVE-5931.thriftapi.2.patch" size="1830" author="thejas" created="Wed, 5 Mar 2014 19:10:17 +0000"/>
                            <attachment id="12633409" name="HIVE-5931.thriftapi.3.patch" size="2209" author="thejas" created="Fri, 7 Mar 2014 18:12:38 +0000"/>
                            <attachment id="12632408" name="HIVE-5931.thriftapi.followup.patch" size="1596" author="thejas" created="Tue, 4 Mar 2014 01:01:53 +0000"/>
                            <attachment id="12632396" name="HIVE-5931.thriftapi.patch" size="1452" author="thejas" created="Tue, 4 Mar 2014 00:23:24 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>8.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Thu, 16 Jan 2014 01:39:22 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>361780</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            2 years, 38 weeks, 3 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i1qd2v:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>362077</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        </customfields>
    </item>
</channel>
</rss>