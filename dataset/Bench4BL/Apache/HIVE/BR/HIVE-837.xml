<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Sat Dec 03 22:31:23 UTC 2016

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/HIVE-837/HIVE-837.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[HIVE-837] virtual column support (filename) in hive</title>
                <link>https://issues.apache.org/jira/browse/HIVE-837</link>
                <project id="12310843" key="HIVE">Hive</project>
                    <description>&lt;p&gt;Copying from some mails:&lt;/p&gt;


&lt;p&gt;I am dumping files into a hive partion on five minute intervals. I am using LOAD DATA into a partition.&lt;/p&gt;

&lt;p&gt;weblogs&lt;br/&gt;
web1.00&lt;br/&gt;
web1.05&lt;br/&gt;
web1.10&lt;br/&gt;
...&lt;br/&gt;
web2.00&lt;br/&gt;
web2.05&lt;br/&gt;
web1.10&lt;br/&gt;
....&lt;/p&gt;

&lt;p&gt;Things that would be useful..&lt;/p&gt;

&lt;p&gt;Select files from the folder with a regex or exact name&lt;/p&gt;

&lt;p&gt;select * FROM logs where FILENAME LIKE(WEB1*)&lt;/p&gt;

&lt;p&gt;select * FROM LOGS WHERE FILENAME=web2.00&lt;/p&gt;

&lt;p&gt;Also it would be nice to be able to select offsets in a file, this would make sense with appends&lt;/p&gt;

&lt;p&gt;select * from logs WHERE FILENAME=web2.00 FROMOFFSET=454644 &lt;span class=&quot;error&quot;&gt;&amp;#91;TOOFFSET=&amp;#93;&lt;/span&gt;&lt;/p&gt;




&lt;p&gt;select  &lt;br/&gt;
substr(filename, 4, 7) as  class_A, &lt;br/&gt;
substr(filename,  8, 10) as class_B&lt;br/&gt;
count( x ) as cnt&lt;br/&gt;
from FOO&lt;br/&gt;
group by&lt;br/&gt;
substr(filename, 4, 7), &lt;br/&gt;
substr(filename,  8, 10) ;&lt;/p&gt;



&lt;p&gt;Hive should support virtual columns&lt;/p&gt;</description>
                <environment></environment>
        <key id="12435865">HIVE-837</key>
            <summary>virtual column support (filename) in hive</summary>
                <type id="2" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/newfeature.png">New Feature</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.png">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="3">Duplicate</resolution>
                                        <assignee username="he yongqiang">He Yongqiang</assignee>
                                    <reporter username="namit">Namit Jain</reporter>
                        <labels>
                    </labels>
                <created>Wed, 16 Sep 2009 19:04:18 +0000</created>
                <updated>Thu, 23 Dec 2010 22:14:07 +0000</updated>
                            <resolved>Thu, 23 Dec 2010 21:01:48 +0000</resolved>
                                                                    <component>Query Processor</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>9</watches>
                                                                <comments>
                            <comment id="12756185" author="appodictic" created="Wed, 16 Sep 2009 19:09:39 +0000"  >&lt;p&gt;also &quot;describe partition show files&quot; would be useful.&lt;/p&gt;</comment>
                            <comment id="12756563" author="appodictic" created="Thu, 17 Sep 2009 14:37:34 +0000"  >&lt;p&gt;It would be nice and very useful. sometimes I want to select my own &apos;partition&apos; or &apos;datafile&apos; explicitly.. something like below:&lt;/p&gt;

&lt;p&gt;SELECT *  FROM weblogs PARTITION (&apos;2009-09-17&apos;, &apos;2009-09-18&apos;) WHERE col1=&apos;..&apos; and col2= ...&lt;/p&gt;

&lt;p&gt;Or users can select data files from directory:&lt;/p&gt;

&lt;p&gt;SELECT *  FROM weblogs DATAFILE (&apos;log1.txt&apos;, &apos;log2.txt&apos;) WHERE col1=&apos;..&apos; and col2= ...&lt;/p&gt;</comment>
                            <comment id="12756630" author="namit" created="Thu, 17 Sep 2009 17:15:08 +0000"  >&lt;p&gt;yesterday, i was having a offline conversation with Raghu, and we were thinking that this is similar to the concept of buckets that exists currently.&lt;br/&gt;
So, do we enhance the tablesample clause to include filenames also, and not expose it as a virtual column at all ?&lt;/p&gt;

&lt;p&gt;I think it is more intuitive to have filenames in the where clause - maybe, we should have some virtual columns for buckets also and leave the current&lt;br/&gt;
syntax for buckets as is for backward compatibility.&lt;/p&gt;

&lt;p&gt;File pruning is must - so, having the filename as udf might be more difficult. The udf filename() will return the same value at compile time.&lt;br/&gt;
So, I would prefer virtual columns instead of filenames. &lt;/p&gt;

&lt;p&gt;SELECT * FROM weblogs DATAFILE (&apos;log1.txt&apos;, &apos;log2.txt&apos;) WHERE col1=&apos;..&apos; and col2= ...&lt;br/&gt;
would solve the pruning problem since the file names are part of the syntax, but how do you propose to select the filename in that case ?&lt;/p&gt;

&lt;p&gt;So, I think the original syntax:&lt;br/&gt;
select * FROM logs where FILENAME LIKE(WEB1*)&lt;br/&gt;
might be easier&lt;/p&gt;</comment>
                            <comment id="12756658" author="prasadc" created="Thu, 17 Sep 2009 17:53:13 +0000"  >&lt;p&gt;buckets have other semantic meaning which is not the case for files so we should not lump buckets with meta/virtual columns. we could possibly add a virtual column/udf called bucket() for that.&lt;/p&gt;

&lt;p&gt;mysql gives lot of virtual data as udfs (curtime(), database(), current_user(), default(column)) etc instead of virtual columns. i think it makes sense to make them udfs just incase some virtual columns need arguments.&lt;/p&gt;</comment>
                            <comment id="12765394" author="he yongqiang" created="Wed, 14 Oct 2009 05:04:16 +0000"  >&lt;p&gt;Support filename as a virtual column is more easier for file pruning, and a udf called filename() will allow capturing file name in query.&lt;br/&gt;
i think both are very useful and we should support both.&lt;/p&gt;</comment>
                            <comment id="12765413" author="he yongqiang" created="Wed, 14 Oct 2009 05:55:24 +0000"  >&lt;p&gt;It seems supporting filename as a virtual column will also allow capturing file name in query.&lt;/p&gt;</comment>
                            <comment id="12790263" author="cwsteinbach" created="Mon, 14 Dec 2009 17:53:23 +0000"  >&lt;p&gt;I think this can be implemented as either a UDF or virtual column as long as we choose to define FILE() as the directory path that contains the table&apos;s/partition&apos;s data files, but I think things get significantly more complicated if we want FILE() to evaluate to the actual &lt;b&gt;file&lt;/b&gt; that the current row is drawn from. At compile-time we have access to the table/partition directory and can retrieve a list of data files, but I don&apos;t think it is possible to make the row&amp;lt;-&amp;gt;File association until runtime. Does this make sense or am I missing something?&lt;/p&gt;</comment>
                            <comment id="12790277" author="namit" created="Mon, 14 Dec 2009 18:33:55 +0000"  >&lt;p&gt;You are right, but we need the association between the row and the actual file.&lt;br/&gt;
Directory is not good enough. &lt;/p&gt;</comment>
                            <comment id="12790287" author="cwsteinbach" created="Mon, 14 Dec 2009 18:52:18 +0000"  >&lt;p&gt;I agree. I think most people will want to use this in conjunction with external tables, and in that&lt;br/&gt;
case they are really interested in the actual filename as opposed to the directory name.&lt;/p&gt;</comment>
                            <comment id="12795904" author="tlipcon" created="Sat, 2 Jan 2010 19:33:11 +0000"  >&lt;blockquote&gt;&lt;p&gt;in that case they are really interested in the actual filename as opposed to the directory name. &lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;+1. I&apos;m currently working with a 200G dataset that has lots of rows that Hive is interpreting as NULL. As far as I knew, there are no NULLs in the dataset to begin with, so I&apos;d love to do: SELECT FILENAME(), FILEOFFSET() FROM t WHERE some_col IS NULL;&lt;/p&gt;</comment>
                            <comment id="12894714" author="jvs" created="Mon, 2 Aug 2010 21:16:55 +0000"  >&lt;p&gt;Yongqiang added the following virtual columns as part of &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-417&quot; title=&quot;Implement Indexing in Hive&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-417&quot;&gt;&lt;del&gt;HIVE-417&lt;/del&gt;&lt;/a&gt;:&lt;/p&gt;

&lt;p&gt;INPUT_&lt;em&gt;FILE&lt;/em&gt;_NAME&lt;br/&gt;
BLOCK_&lt;em&gt;OFFSET&lt;/em&gt;&lt;em&gt;INSIDE&lt;/em&gt;_FILE&lt;/p&gt;

&lt;p&gt;Those need to be documented, and we may still need a fine-grained row offset.&lt;/p&gt;</comment>
                            <comment id="12974735" author="appodictic" created="Thu, 23 Dec 2010 21:01:48 +0000"  >&lt;p&gt;Duplicate of &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-417&quot; title=&quot;Implement Indexing in Hive&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-417&quot;&gt;&lt;del&gt;HIVE-417&lt;/del&gt;&lt;/a&gt;.  We are working on adding another virtual column (logical row number within block) as part of bitmap indexing.&lt;/p&gt;</comment>
                            <comment id="12974739" author="aaa" created="Thu, 23 Dec 2010 21:06:03 +0000"  >&lt;p&gt;I am out of office on vacation and will be slower than usual in&lt;br/&gt;
responding to emails. If this is urgent then please call my cell phone&lt;br/&gt;
(or send an sms), otherwise I will reply to your email when I get&lt;br/&gt;
back.&lt;/p&gt;

&lt;p&gt;Thanks for your patience,&lt;/p&gt;

&lt;p&gt;&amp;#8211; amr&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="12310000">
                    <name>Duplicate</name>
                                            <outwardlinks description="duplicates">
                                        <issuelink>
            <issuekey id="12422895">HIVE-417</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                    </issuelinks>
                <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Wed, 16 Sep 2009 19:09:39 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>73274</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            5 years, 50 weeks, 2 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0lbzz:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>122594</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        </customfields>
    </item>
</channel>
</rss>