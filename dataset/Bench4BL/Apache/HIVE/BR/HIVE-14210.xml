<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Fri Dec 02 06:13:44 UTC 2016

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/HIVE-14210/HIVE-14210.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[HIVE-14210] ExecDriver should call jobclient.close() to trigger cleanup</title>
                <link>https://issues.apache.org/jira/browse/HIVE-14210</link>
                <project id="12310843" key="HIVE">Hive</project>
                    <description>&lt;p&gt;We found an issue in a customer environment where the HS2 crashed after a few days and the Java core dump contained several thousands of truststore reloader threads:&lt;/p&gt;

&lt;p&gt;&quot;Truststore reloader thread&quot; #126 daemon prio=5 os_prio=0 tid=0x00007f680d2e3000 nid=0x98fd waiting on &lt;br/&gt;
condition &lt;span class=&quot;error&quot;&gt;&amp;#91;0x00007f67e482c000&amp;#93;&lt;/span&gt;&lt;br/&gt;
   java.lang.Thread.State: TIMED_WAITING (sleeping)&lt;br/&gt;
        at java.lang.Thread.sleep(Native Method)&lt;br/&gt;
        at org.apache.hadoop.security.ssl.ReloadingX509TrustManager.run&lt;br/&gt;
(ReloadingX509TrustManager.java:225)&lt;br/&gt;
        at java.lang.Thread.run(Thread.java:745)&lt;/p&gt;

&lt;p&gt;We found the issue to be caused by a bug in Hadoop where the TimelineClientImpl is not destroying the SSLFactory if SSL is enabled in Hadoop and the timeline server is running. I opened &lt;a href=&quot;https://issues.apache.org/jira/browse/YARN-5309&quot; title=&quot;Fix SSLFactory truststore reloader thread leak in TimelineClientImpl&quot; class=&quot;issue-link&quot; data-issue-key=&quot;YARN-5309&quot;&gt;&lt;del&gt;YARN-5309&lt;/del&gt;&lt;/a&gt; which has more details on the problem, and a patch was submitted a few days back.&lt;/p&gt;

&lt;p&gt;In addition to the changes in Hadoop, there are a couple of Hive changes required:&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;ExecDriver needs to call jobclient.close() to trigger the clean-up of the resources after the submitted job is done/failed&lt;/li&gt;
	&lt;li&gt;Hive needs to pick up a newer release of Hadoop to pick up &lt;a href=&quot;https://issues.apache.org/jira/browse/MAPREDUCE-6618&quot; title=&quot;YarnClientProtocolProvider leaking the YarnClient thread. &quot; class=&quot;issue-link&quot; data-issue-key=&quot;MAPREDUCE-6618&quot;&gt;&lt;del&gt;MAPREDUCE-6618&lt;/del&gt;&lt;/a&gt; and &lt;a href=&quot;https://issues.apache.org/jira/browse/MAPREDUCE-6621&quot; title=&quot;Memory Leak in JobClient#submitJobInternal()&quot; class=&quot;issue-link&quot; data-issue-key=&quot;MAPREDUCE-6621&quot;&gt;&lt;del&gt;MAPREDUCE-6621&lt;/del&gt;&lt;/a&gt; that fixed issues with calling jobclient.close(). Both fixes are included in Hadoop 2.6.4.&lt;br/&gt;
However, since we also need to pick up &lt;a href=&quot;https://issues.apache.org/jira/browse/YARN-5309&quot; title=&quot;Fix SSLFactory truststore reloader thread leak in TimelineClientImpl&quot; class=&quot;issue-link&quot; data-issue-key=&quot;YARN-5309&quot;&gt;&lt;del&gt;YARN-5309&lt;/del&gt;&lt;/a&gt;, we need to wait for a new release of Hadoop.&lt;/li&gt;
&lt;/ul&gt;
</description>
                <environment></environment>
        <key id="12988484">HIVE-14210</key>
            <summary>ExecDriver should call jobclient.close() to trigger cleanup</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/bug.png">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.png">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="tfriedr">Thomas Friedrich</assignee>
                                    <reporter username="tfriedr">Thomas Friedrich</reporter>
                        <labels>
                    </labels>
                <created>Mon, 11 Jul 2016 23:58:12 +0000</created>
                <updated>Wed, 13 Jul 2016 04:37:59 +0000</updated>
                            <resolved>Wed, 13 Jul 2016 04:37:59 +0000</resolved>
                                    <version>1.2.1</version>
                    <version>2.0.0</version>
                    <version>2.1.0</version>
                                    <fixVersion>1.3.0</fixVersion>
                    <fixVersion>1.2.2</fixVersion>
                    <fixVersion>2.2.0</fixVersion>
                    <fixVersion>2.1.1</fixVersion>
                                    <component>Hive</component>
                    <component>HiveServer2</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>3</watches>
                                                                <comments>
                            <comment id="15371944" author="tfriedr" created="Tue, 12 Jul 2016 00:10:26 +0000"  >&lt;p&gt;Provided patch for ExecDriver.java to call jobclient.close()&lt;/p&gt;</comment>
                            <comment id="15371977" author="sershe" created="Tue, 12 Jul 2016 00:36:28 +0000"  >&lt;p&gt;nit: can you add braces to the if? Otherwise +1&lt;/p&gt;

&lt;p&gt;cc &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=thejas&quot; class=&quot;user-hover&quot; rel=&quot;thejas&quot;&gt;Thejas M Nair&lt;/a&gt; &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=vgumashta&quot; class=&quot;user-hover&quot; rel=&quot;vgumashta&quot;&gt;Vaibhav Gumashta&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="15371992" author="tfriedr" created="Tue, 12 Jul 2016 00:48:24 +0000"  >&lt;p&gt;Thanks for the quick review, Sergey. Updated patch with braces.&lt;/p&gt;</comment>
                            <comment id="15373534" author="vgumashta" created="Tue, 12 Jul 2016 19:28:32 +0000"  >&lt;p&gt;+1 from my side. Should we modify the jira title to reflect the change in the patch? &lt;/p&gt;</comment>
                            <comment id="15374331" author="sershe" created="Wed, 13 Jul 2016 04:37:59 +0000"  >&lt;p&gt;Committed everywhere. Thanks for the contribution!&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10032">
                    <name>Blocker</name>
                                                                <inwardlinks description="is blocked by">
                                        <issuelink>
            <issuekey id="12986370">YARN-5309</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                                                <inwardlinks description="is related to">
                                        <issuelink>
            <issuekey id="12924968">HIVE-12766</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12817304" name="HIVE-14210.1.patch" size="1153" author="tfriedr" created="Tue, 12 Jul 2016 00:46:48 +0000"/>
                            <attachment id="12817300" name="HIVE-14210.patch" size="1140" author="tfriedr" created="Tue, 12 Jul 2016 00:10:26 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Tue, 12 Jul 2016 00:36:28 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            20 weeks, 2 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i30tmn:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        </customfields>
    </item>
</channel>
</rss>