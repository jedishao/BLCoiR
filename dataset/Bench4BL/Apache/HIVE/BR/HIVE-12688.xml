<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Fri Dec 02 11:47:17 UTC 2016

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/HIVE-12688/HIVE-12688.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[HIVE-12688] HIVE-11826 makes hive unusable in properly secured cluster</title>
                <link>https://issues.apache.org/jira/browse/HIVE-12688</link>
                <project id="12310843" key="HIVE">Hive</project>
                    <description>&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-11826&quot; title=&quot;&amp;#39;hadoop.proxyuser.hive.groups&amp;#39; configuration doesn&amp;#39;t prevent unauthorized user to access metastore&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-11826&quot;&gt;&lt;del&gt;HIVE-11826&lt;/del&gt;&lt;/a&gt; makes a change to restrict connections to metastore to users who belong to groups under &apos;hadoop.proxyuser.hive.groups&apos;.&lt;br/&gt;
That property was only a meant to be a hadoop property, which controls what users the hive user can impersonate. What this change is doing is to enable use of that to also restrict who can connect to metastore server. This is new functionality, not a bug fix. There is value to this functionality.&lt;/p&gt;

&lt;p&gt;However, this change makes hive unusable in a properly secured cluster. If &apos;hadoop.proxyuser.hive.hosts&apos; is set to the proper set of hosts that run Metastore and Hiveserver2 (instead of a very open &quot;*&quot;), then users will be able to connect to metastore only from those hosts.&lt;/p&gt;

</description>
                <environment></environment>
        <key id="12922253">HIVE-12688</key>
            <summary>HIVE-11826 makes hive unusable in properly secured cluster</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/bug.png">Bug</type>
                                            <priority id="1" iconUrl="https://issues.apache.org/jira/images/icons/priorities/blocker.png">Blocker</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="thejas">Thejas M Nair</assignee>
                                    <reporter username="thejas">Thejas M Nair</reporter>
                        <labels>
                    </labels>
                <created>Wed, 16 Dec 2015 05:34:29 +0000</created>
                <updated>Thu, 2 Jun 2016 10:17:24 +0000</updated>
                            <resolved>Fri, 18 Dec 2015 00:00:15 +0000</resolved>
                                    <version>1.3.0</version>
                    <version>2.0.0</version>
                                    <fixVersion>2.0.0</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>6</watches>
                                                                <comments>
                            <comment id="15059527" author="thejas" created="Wed, 16 Dec 2015 05:38:46 +0000"  >&lt;p&gt;I think this is a blocker for 2.0.0 release . &lt;/p&gt;

&lt;p&gt;I am attaching a patch to roll back that change to unblock the 2.0.0 release. &lt;br/&gt;
An fixed version of  &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-11826&quot; title=&quot;&amp;#39;hadoop.proxyuser.hive.groups&amp;#39; configuration doesn&amp;#39;t prevent unauthorized user to access metastore&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-11826&quot;&gt;&lt;del&gt;HIVE-11826&lt;/del&gt;&lt;/a&gt; can be added in a follow up jira.&lt;/p&gt;

&lt;p&gt;cc &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=sershe&quot; class=&quot;user-hover&quot; rel=&quot;sershe&quot;&gt;Sergey Shelukhin&lt;/a&gt; &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=aihuaxu&quot; class=&quot;user-hover&quot; rel=&quot;aihuaxu&quot;&gt;Aihua Xu&lt;/a&gt; &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=csun&quot; class=&quot;user-hover&quot; rel=&quot;csun&quot;&gt;Chao Sun&lt;/a&gt; &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=ashutoshc&quot; class=&quot;user-hover&quot; rel=&quot;ashutoshc&quot;&gt;Ashutosh Chauhan&lt;/a&gt;&lt;/p&gt;

</comment>
                            <comment id="15059945" author="aihuaxu" created="Wed, 16 Dec 2015 12:55:58 +0000"  >&lt;p&gt;You are right. This is hadoop property. Seems that property should not limit the access to metastore server and we were historically using that to limit access to hive.&lt;/p&gt;

&lt;p&gt;In our own version, somehow we documented as such. Is this the old behavior? Instead of changing it back since it will introduce the issue that it will not block unauthorized access to Hive, can we keep this behavior and try to rework with a correct way that we block the Hive access somewhere else in a later version? &lt;/p&gt;</comment>
                            <comment id="15060409" author="thejas" created="Wed, 16 Dec 2015 17:56:57 +0000"  >&lt;p&gt;Yeah, looks like CDH version of Hive has been using this property to restrict access. This is not old behavior of Apache Hive. This is a new feature is not a pattern commonly seen in hadoop ecosystem. In case of HDFS, for example access is restricted on file permissions and not on a user group setting. To secure metastore access, you can already use storage based authorization.&lt;/p&gt;


&lt;p&gt;I am fine with this feature being added. However, the way it is implemented right now breaks hive not work if hadoop.proxyuser.hive.hosts is properly set.  I am not sure why CDH users didn&apos;t face this issue, I assume cloudera manager might not be securing this for the clusters.&lt;br/&gt;
I don&apos;t think we can ship Hive 2.0.0 in this form as it is a major regression. If you can change the implementation to fix this issue, please create a follow up jira with patch. I created this patch to rollback the change so that we don&apos;t block 2.0.0 release.&lt;/p&gt;


</comment>
                            <comment id="15060551" author="sershe" created="Wed, 16 Dec 2015 19:05:03 +0000"  >&lt;p&gt;I think it makes sense to keep this as blocker. If it in a while the proper fix is not in sight we can roll back the regression and postpone a better fix to a future version. &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=aihuaxu&quot; class=&quot;user-hover&quot; rel=&quot;aihuaxu&quot;&gt;Aihua Xu&lt;/a&gt; how hard would it be to make the better fix? &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=thejas&quot; class=&quot;user-hover&quot; rel=&quot;thejas&quot;&gt;Thejas M Nair&lt;/a&gt; do you think we should rather roll back now?&lt;/p&gt;</comment>
                            <comment id="15060580" author="thejas" created="Wed, 16 Dec 2015 19:14:17 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=sershe&quot; class=&quot;user-hover&quot; rel=&quot;sershe&quot;&gt;Sergey Shelukhin&lt;/a&gt; I was thinking it is better to keep the release clear of blockers to avoid issues. But we can give couple of days for a better fix if you are OK with that (as the release manager for 2.0.0).&lt;br/&gt;
It depends on cycles someone has to provide to fix the feature to prevent this regression. If we make the change to roll back this feature, there is not too much pressure on anyone working on this. &lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=aihuaxu&quot; class=&quot;user-hover&quot; rel=&quot;aihuaxu&quot;&gt;Aihua Xu&lt;/a&gt; What do you prefer ? Would you have cycles to fix the regression soon ? Or would you prefer adding this feature back again after this patch to roll it out (it gives you more time that way)?&lt;/p&gt;

</comment>
                            <comment id="15060683" author="thejas" created="Wed, 16 Dec 2015 19:52:39 +0000"  >&lt;p&gt;I think its better to roll it out and put in a proper fix when its ready. As it affects only a small number of lines adding it back with proper fix should be straightforward.  Do you agree &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=aihuaxu&quot; class=&quot;user-hover&quot; rel=&quot;aihuaxu&quot;&gt;Aihua Xu&lt;/a&gt; ?&lt;/p&gt;</comment>
                            <comment id="15060896" author="hiveqa" created="Wed, 16 Dec 2015 21:21:14 +0000"  >

&lt;p&gt;Here are the results of testing the latest attachment:&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/secure/attachment/12777933/HIVE-12688.1.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/secure/attachment/12777933/HIVE-12688.1.patch&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;font color=&quot;green&quot;&gt;SUCCESS:&lt;/font&gt; +1 due to 1 test(s) being added or modified.&lt;/p&gt;

&lt;p&gt;&lt;font color=&quot;red&quot;&gt;ERROR:&lt;/font&gt; -1 due to 18 failed/errored test(s), 9947 tests executed&lt;br/&gt;
&lt;b&gt;Failed tests:&lt;/b&gt;&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;TestHWISessionManager - did not produce a TEST-*.xml file
TestSparkCliDriver-timestamp_lazy.q-bucketsortoptimize_insert_4.q-date_udf.q-and-12-more - did not produce a TEST-*.xml file
org.apache.hadoop.hive.cli.TestCliDriver.testCliDriver_order2
org.apache.hadoop.hive.cli.TestCliDriver.testCliDriver_union9
org.apache.hadoop.hive.cli.TestEncryptedHDFSCliDriver.testCliDriver_encryption_insert_partition_dynamic
org.apache.hadoop.hive.cli.TestNegativeCliDriver.testNegativeCliDriver_authorization_uri_import
org.apache.hadoop.hive.ql.exec.spark.session.TestSparkSessionManagerImpl.testMultiSessionMultipleUse
org.apache.hadoop.hive.ql.exec.spark.session.TestSparkSessionManagerImpl.testSingleSessionMultipleUse
org.apache.hive.hcatalog.hbase.TestPigHBaseStorageHandler.org.apache.hive.hcatalog.hbase.TestPigHBaseStorageHandler
org.apache.hive.jdbc.TestSSL.testSSLVersion
org.apache.hive.spark.client.TestSparkClient.testAddJarsAndFiles
org.apache.hive.spark.client.TestSparkClient.testCounters
org.apache.hive.spark.client.TestSparkClient.testErrorJob
org.apache.hive.spark.client.TestSparkClient.testJobSubmission
org.apache.hive.spark.client.TestSparkClient.testMetricsCollection
org.apache.hive.spark.client.TestSparkClient.testRemoteClient
org.apache.hive.spark.client.TestSparkClient.testSimpleSparkJob
org.apache.hive.spark.client.TestSparkClient.testSyncRpc
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Test results: &lt;a href=&quot;http://ec2-174-129-184-35.compute-1.amazonaws.com/jenkins/job/PreCommit-HIVE-TRUNK-Build/6371/testReport&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://ec2-174-129-184-35.compute-1.amazonaws.com/jenkins/job/PreCommit-HIVE-TRUNK-Build/6371/testReport&lt;/a&gt;&lt;br/&gt;
Console output: &lt;a href=&quot;http://ec2-174-129-184-35.compute-1.amazonaws.com/jenkins/job/PreCommit-HIVE-TRUNK-Build/6371/console&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://ec2-174-129-184-35.compute-1.amazonaws.com/jenkins/job/PreCommit-HIVE-TRUNK-Build/6371/console&lt;/a&gt;&lt;br/&gt;
Test logs: &lt;a href=&quot;http://ec2-174-129-184-35.compute-1.amazonaws.com/logs/PreCommit-HIVE-TRUNK-Build-6371/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://ec2-174-129-184-35.compute-1.amazonaws.com/logs/PreCommit-HIVE-TRUNK-Build-6371/&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Messages:&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;Executing org.apache.hive.ptest.execution.TestCheckPhase
Executing org.apache.hive.ptest.execution.PrepPhase
Executing org.apache.hive.ptest.execution.ExecutionPhase
Executing org.apache.hive.ptest.execution.ReportingPhase
Tests exited with: TestsFailedException: 18 tests failed
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;

&lt;p&gt;ATTACHMENT ID: 12777933 - PreCommit-HIVE-TRUNK-Build&lt;/p&gt;</comment>
                            <comment id="15060922" author="thejas" created="Wed, 16 Dec 2015 21:36:42 +0000"  >&lt;p&gt;None of the failures are related, these are failing in previous test runs as well. Looks like we really need some cleanup!&lt;br/&gt;
Can someone please review it ?&lt;/p&gt;

&lt;p&gt;I think its simpler to commit this small patch and follow up in another jira to implement this feature without the regression.&lt;/p&gt;</comment>
                            <comment id="15060939" author="aihuaxu" created="Wed, 16 Dec 2015 21:44:40 +0000"  >&lt;p&gt;I&apos;m not able to work on that until next week. So please revert it and I will try to provide better approach for that.&lt;/p&gt;

&lt;p&gt;So agree with your approach. &lt;/p&gt;


&lt;p&gt;Sent from my iPhone&lt;/p&gt;
</comment>
                            <comment id="15060973" author="ashutoshc" created="Wed, 16 Dec 2015 22:00:05 +0000"  >&lt;p&gt;makes sense +1 for revert. Lets explore alternatives in follow-up.&lt;/p&gt;</comment>
                            <comment id="15063128" author="thejas" created="Fri, 18 Dec 2015 00:00:15 +0000"  >&lt;p&gt;Patch committed to branch-1 , branch-2.0, and master.&lt;/p&gt;

&lt;p&gt;Thanks for the review &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=ashutoshc&quot; class=&quot;user-hover&quot; rel=&quot;ashutoshc&quot;&gt;Ashutosh Chauhan&lt;/a&gt;!&lt;/p&gt;

&lt;p&gt;Thanks for your discussion &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=aihuaxu&quot; class=&quot;user-hover&quot; rel=&quot;aihuaxu&quot;&gt;Aihua Xu&lt;/a&gt;!&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="12310050">
                    <name>Regression</name>
                                                                <inwardlinks description="is broken by">
                                        <issuelink>
            <issuekey id="12864279">HIVE-11826</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12777933" name="HIVE-12688.1.patch" size="1902" author="thejas" created="Wed, 16 Dec 2015 06:05:57 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Wed, 16 Dec 2015 12:55:58 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            50 weeks ago
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i2pyi7:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                    <customfield id="customfield_12310320" key="com.atlassian.jira.plugin.system.customfieldtypes:multiversion">
                        <customfieldname>Target Version/s</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue>12332154</customfieldvalue>
    <customfieldvalue>12332641</customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        </customfields>
    </item>
</channel>
</rss>