<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Sat Dec 03 22:59:06 UTC 2016

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/HIVE-5659/HIVE-5659.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[HIVE-5659] HBaseStorageHandler overwrites Hive-set HBase properties with hbase-defaults</title>
                <link>https://issues.apache.org/jira/browse/HIVE-5659</link>
                <project id="12310843" key="HIVE">Hive</project>
                    <description>&lt;p&gt;As part of the changes to &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-5260&quot; title=&quot;Introduce HivePassThroughOutputFormat that allows Hive to use general purpose OutputFormats instead of HiveOutputFormats in StorageHandlers&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-5260&quot;&gt;&lt;del&gt;HIVE-5260&lt;/del&gt;&lt;/a&gt;, it appears that HBase properties set in hive-conf.xml are being clobbered by defaults from hbase-default.xml.&lt;/p&gt;

&lt;p&gt;Specifically, we noticed it when attempting to set hbase.zookeeper.quorum. That value defaults to &apos;localhost&apos; and results in queries of HBase tables hanging attempting to acquire a lock from a Zookeeper instance which isn&apos;t running.&lt;/p&gt;

&lt;p&gt;Any properties set in hive-site.xml will be overwritten by those in hbase-default.xml, which doesn&apos;t seem good.&lt;/p&gt;

&lt;p&gt;The call to HBaseConfiguration.addHbaseResources(jobConf) seems to be the culprit, around line 337.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12675926">HIVE-5659</key>
            <summary>HBaseStorageHandler overwrites Hive-set HBase properties with hbase-defaults</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/bug.png">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.png">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="3">Duplicate</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="ccondit">Craig Condit</reporter>
                        <labels>
                    </labels>
                <created>Sat, 26 Oct 2013 02:14:53 +0000</created>
                <updated>Thu, 9 Jan 2014 16:10:10 +0000</updated>
                            <resolved>Thu, 9 Jan 2014 16:10:10 +0000</resolved>
                                    <version>0.12.0</version>
                                                    <component>HBase Handler</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>4</watches>
                                                                <comments>
                            <comment id="13805972" author="ccondit" created="Sat, 26 Oct 2013 02:38:10 +0000"  >&lt;p&gt;Patch which seems to resolve the issue.&lt;/p&gt;</comment>
                            <comment id="13806894" author="ashutoshc" created="Mon, 28 Oct 2013 16:26:32 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=ccondit&quot; class=&quot;user-hover&quot; rel=&quot;ccondit&quot;&gt;Craig Condit&lt;/a&gt; I think current behavior is correct. To achieve what you want (ie configure hbase for hive) you should put &lt;tt&gt;hbase-site.xml&lt;/tt&gt; in hive&apos;s classpath so that hbase configs are picked up from there, instead of putting hbase configs in hive-site.xml&lt;/p&gt;</comment>
                            <comment id="13806975" author="ccondit" created="Mon, 28 Oct 2013 17:38:51 +0000"  >&lt;p&gt;In our case, I&apos;m not sure the best way to handle this. We have some options (such as HBase direct reads) that require configuration parameters that would affect all HDFS users. Those configurations would be set if we included hbase-site.xml, and wouldn&apos;t be overridable.&lt;/p&gt;

&lt;p&gt;It just seems like configuration in hive-site.xml should override hbase-site.xml, and not the other way around.&lt;/p&gt;</comment>
                            <comment id="13863752" author="ndimiduk" created="Tue, 7 Jan 2014 01:08:01 +0000"  >&lt;p&gt;FWIW, I think &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=ccondit&quot; class=&quot;user-hover&quot; rel=&quot;ccondit&quot;&gt;Craig Condit&lt;/a&gt; is correct. I would expect property resolution order to be:&lt;/p&gt;
&lt;ol&gt;
	&lt;li&gt;command-line overrides&lt;/li&gt;
	&lt;li&gt;SET statements in script&lt;/li&gt;
	&lt;li&gt;hbase-site.xml on classpath&lt;/li&gt;
	&lt;li&gt;hbase-default.xml in hbase-common.jar&lt;/li&gt;
&lt;/ol&gt;
</comment>
                            <comment id="13863804" author="sushanth" created="Tue, 7 Jan 2014 01:57:53 +0000"  >&lt;p&gt;While I agree with the order Nick is putting forth, and thus, a need for the addResources to not clobber the existing set config, I have to say I balk at the notion of putting hbase-specific config, even if associated with hbase-hive integration inside hive-site.xml. That seems to be asking for errors arising from messy config keeping. It can lead up to two-sources of truth if hive treats hive&apos;s copy of hbase config as prime, and hbase server/etc that the handler talk to treat hbase config as prime truth.&lt;/p&gt;</comment>
                            <comment id="13864315" author="brocknoland" created="Tue, 7 Jan 2014 15:03:34 +0000"  >&lt;blockquote&gt;&lt;p&gt;I balk at the notion of putting hbase-specific config, even if associated with hbase-hive integration inside hive-site.xml.&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;It has worked this way for a very long time and users have been doing this.  Breaking our users is not something we should do.&lt;/p&gt;</comment>
                            <comment id="13866028" author="sushanth" created="Wed, 8 Jan 2014 23:10:13 +0000"  >&lt;p&gt;Oh, I don&apos;t disagree that we need to fix it, it&apos;s necessary to, and at the very least because SET semantics need to be maintained. I would, however, still encourage users to avoid that pattern. &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.gif&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;</comment>
                            <comment id="13866045" author="sushanth" created="Wed, 8 Jan 2014 23:25:55 +0000"  >&lt;p&gt;Also, there is an issue with the attached patch, I&apos;m afraid what will happen with that merge is this:&lt;/p&gt;

&lt;p&gt;There&apos;ll be a newConf created, with the new properties from hbase-default.xml , etc , overriding the properties in jobConf.&lt;/p&gt;

&lt;p&gt;Then, with that merge direction, everything in newConf will override existing values in jobConf. Unless I&apos;m reading HBaseConfiguration.merge incorrectly, I believe the goal here might have been to go the other way, but that&apos;ll give us a usable newConf, whereas we wanted to make modifications to jobConf. Since this is a duplicate of &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-6115&quot; title=&quot;Remove redundant code in HiveHBaseStorageHandler&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-6115&quot;&gt;&lt;del&gt;HIVE-6115&lt;/del&gt;&lt;/a&gt;, and that patch is closer to the required solution, I think, I&apos;m going to shift over to that bug.&lt;/p&gt;</comment>
                            <comment id="13866742" author="brocknoland" created="Thu, 9 Jan 2014 16:10:10 +0000"  >&lt;p&gt;Thank you very much for looking into this! Let&apos;s take it forward over on &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-6115&quot; title=&quot;Remove redundant code in HiveHBaseStorageHandler&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-6115&quot;&gt;&lt;del&gt;HIVE-6115&lt;/del&gt;&lt;/a&gt;.&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                                                <inwardlinks description="is related to">
                                        <issuelink>
            <issuekey id="12686536">HIVE-6115</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12610435" name="HIVE-5659.patch" size="869" author="ccondit" created="Sat, 26 Oct 2013 02:38:10 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Mon, 28 Oct 2013 16:26:32 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>355423</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            2 years, 47 weeks, 2 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i1p9vj:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>355711</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        </customfields>
    </item>
</channel>
</rss>