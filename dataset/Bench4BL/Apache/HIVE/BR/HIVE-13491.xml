<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Fri Dec 02 06:02:04 UTC 2016

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/HIVE-13491/HIVE-13491.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[HIVE-13491] Testing  : log thread stacks when metastore fails to start</title>
                <link>https://issues.apache.org/jira/browse/HIVE-13491</link>
                <project id="12310843" key="HIVE">Hive</project>
                    <description>&lt;p&gt;Many tests are failing in ptest2 because metastore fails to startup in the expected time.&lt;br/&gt;
There is not enough information to figure out why the metastore startup failed/got hung in the hive.log file. Printing the thread dumps when that happens would be useful for finding the root cause.&lt;/p&gt;

&lt;p&gt;The stack in test failure looks like this -&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
java.net.ConnectException: Connection refused
	at java.net.PlainSocketImpl.socketConnect(Native Method)
	at java.net.AbstractPlainSocketImpl.doConnect(AbstractPlainSocketImpl.java:339)
	at java.net.AbstractPlainSocketImpl.connectToAddress(AbstractPlainSocketImpl.java:198)
	at java.net.AbstractPlainSocketImpl.connect(AbstractPlainSocketImpl.java:182)
	at java.net.SocksSocketImpl.connect(SocksSocketImpl.java:392)
	at java.net.Socket.connect(Socket.java:579)
	at org.apache.hadoop.hive.metastore.MetaStoreUtils.loopUntilHMSReady(MetaStoreUtils.java:1208)
	at org.apache.hadoop.hive.metastore.MetaStoreUtils.startMetaStore(MetaStoreUtils.java:1195)
	at org.apache.hadoop.hive.metastore.MetaStoreUtils.startMetaStore(MetaStoreUtils.java:1177)
	at org.apache.hadoop.hive.thrift.TestHadoopAuthBridge23.setup(TestHadoopAuthBridge23.java:153)
	at org.apache.hadoop.hive.thrift.TestHadoopAuthBridge23.testMetastoreProxyUser(TestHadoopAuthBridge23.java:241)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</description>
                <environment></environment>
        <key id="12958008">HIVE-13491</key>
            <summary>Testing  : log thread stacks when metastore fails to start</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/bug.png">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.png">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="thejas">Thejas M Nair</assignee>
                                    <reporter username="thejas">Thejas M Nair</reporter>
                        <labels>
                    </labels>
                <created>Tue, 12 Apr 2016 07:29:26 +0000</created>
                <updated>Tue, 21 Jun 2016 15:12:33 +0000</updated>
                            <resolved>Tue, 12 Apr 2016 19:10:50 +0000</resolved>
                                                    <fixVersion>1.3.0</fixVersion>
                    <fixVersion>2.1.0</fixVersion>
                                    <component>Test</component>
                    <component>Testing Infrastructure</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>3</watches>
                                                                <comments>
                            <comment id="15236757" author="githubbot" created="Tue, 12 Apr 2016 07:33:33 +0000"  >&lt;p&gt;GitHub user thejasmn opened a pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/hive/pull/71&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://github.com/apache/hive/pull/71&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-13491&quot; title=&quot;Testing  : log thread stacks when metastore fails to start&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-13491&quot;&gt;&lt;del&gt;HIVE-13491&lt;/del&gt;&lt;/a&gt; - print thread dumps&lt;/p&gt;



&lt;p&gt;You can merge this pull request into a Git repository by running:&lt;/p&gt;

&lt;p&gt;    $ git pull &lt;a href=&quot;https://github.com/thejasmn/hive&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://github.com/thejasmn/hive&lt;/a&gt; &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-13491&quot; title=&quot;Testing  : log thread stacks when metastore fails to start&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-13491&quot;&gt;&lt;del&gt;HIVE-13491&lt;/del&gt;&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Alternatively you can review and apply these changes as the patch at:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/hive/pull/71.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://github.com/apache/hive/pull/71.patch&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;To close this pull request, make a commit to your master/trunk branch&lt;br/&gt;
with (at least) the following in the commit message:&lt;/p&gt;

&lt;p&gt;    This closes #71&lt;/p&gt;

&lt;hr /&gt;
&lt;p&gt;commit 9648db8c3cdc97a9a6449a6e801c9670d796de86&lt;br/&gt;
Author: Thejas Nair &amp;lt;thejas@hortonworks.com&amp;gt;&lt;br/&gt;
Date:   2016-04-12T07:30:32Z&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-13491&quot; title=&quot;Testing  : log thread stacks when metastore fails to start&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-13491&quot;&gt;&lt;del&gt;HIVE-13491&lt;/del&gt;&lt;/a&gt; - print thread dumps&lt;/p&gt;

&lt;hr /&gt;</comment>
                            <comment id="15236763" author="thejas" created="Tue, 12 Apr 2016 07:36:57 +0000"  >&lt;p&gt;Also increased the frequency of checks for metastore startup from every 10 sec to every sec. 1 sec pause should be more than enough to not consume too much of cpu resources on the machine, and it will help shave off a few seconds from the test runtime.&lt;/p&gt;
</comment>
                            <comment id="15237509" author="thejas" created="Tue, 12 Apr 2016 16:35:52 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=sershe&quot; class=&quot;user-hover&quot; rel=&quot;sershe&quot;&gt;Sergey Shelukhin&lt;/a&gt; &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=szehon&quot; class=&quot;user-hover&quot; rel=&quot;szehon&quot;&gt;Szehon Ho&lt;/a&gt; &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=ashutoshc&quot; class=&quot;user-hover&quot; rel=&quot;ashutoshc&quot;&gt;Ashutosh Chauhan&lt;/a&gt; &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=sseth&quot; class=&quot;user-hover&quot; rel=&quot;sseth&quot;&gt;Siddharth Seth&lt;/a&gt;&lt;br/&gt;
Can someone please review this change ? It should help nail down the problem with metastore startup in large number of tests. &lt;br/&gt;
This change impacts only the tests.&lt;/p&gt;

&lt;p&gt;We have 30+ patches in the queue, and many runs are taking 3+hrs to finish. Putting this in asap could help in reducing the number of failures in those tests and might also give more clues on why the runs are taking so long.&lt;/p&gt;</comment>
                            <comment id="15237653" author="szehon" created="Tue, 12 Apr 2016 18:02:40 +0000"  >&lt;p&gt;Thanks +1&lt;/p&gt;</comment>
                            <comment id="15237667" author="szehon" created="Tue, 12 Apr 2016 18:09:05 +0000"  >&lt;p&gt;I was also thinking the other day that maybe the machines are getting loaded or somewhat slow, hence HMS cannot start up in time.  But this will tell us for certain.&lt;/p&gt;

&lt;p&gt;I will also take a look at that if I get a chance.&lt;/p&gt;</comment>
                            <comment id="15237675" author="szehon" created="Tue, 12 Apr 2016 18:16:35 +0000"  >&lt;p&gt;I thinking to restart PTest server, which should trigger auto-generation of new test slaves fresh from the image, does anyone mind me doing that?&lt;/p&gt;</comment>
                            <comment id="15237785" author="thejas" created="Tue, 12 Apr 2016 19:08:16 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=szehon&quot; class=&quot;user-hover&quot; rel=&quot;szehon&quot;&gt;Szehon Ho&lt;/a&gt; Yes, I agree, a restart is worth trying out.&lt;br/&gt;
Meanwhile, I will go ahead and commit this.&lt;/p&gt;</comment>
                            <comment id="15237792" author="thejas" created="Tue, 12 Apr 2016 19:10:50 +0000"  >&lt;p&gt;Patch committed to branch-1 and master.&lt;br/&gt;
Thanks for the review &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=szehon&quot; class=&quot;user-hover&quot; rel=&quot;szehon&quot;&gt;Szehon Ho&lt;/a&gt;!&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12798208" name="HIVE-13491.1.patch" size="2063" author="thejas" created="Tue, 12 Apr 2016 07:31:04 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Tue, 12 Apr 2016 07:33:33 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            33 weeks, 2 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i2vzaf:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                    <customfield id="customfield_12310320" key="com.atlassian.jira.plugin.system.customfieldtypes:multiversion">
                        <customfieldname>Target Version/s</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue>12334255</customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        </customfields>
    </item>
</channel>
</rss>