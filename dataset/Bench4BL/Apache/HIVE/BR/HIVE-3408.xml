<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Sat Dec 03 23:02:44 UTC 2016

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/HIVE-3408/HIVE-3408.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[HIVE-3408] A race condition is caused within QueryPlan class</title>
                <link>https://issues.apache.org/jira/browse/HIVE-3408</link>
                <project id="12310843" key="HIVE">Hive</project>
                    <description>&lt;p&gt;Hive&apos;s threads are stopped at HashMap.getEntry(..) that is used within QueryPlan#extractCounters() and QueryPlan#updateCountersInQueryPlan().  It seems that a race condition problem of a HashSet object is caused when extractCounters() and updateCountersInQueryPlan() are concurrently executed.  I hit the problem with Hive 0.7.1 but, I think that it also is caused with 0.8.1.&lt;/p&gt;

&lt;p&gt;The problem is reported by several persons on mailing list.&lt;br/&gt;
&lt;a href=&quot;http://mail-archives.apache.org/mod_mbox/hive-dev/201201.mbox/%3CCAKTRiE+3x31FDy+3F0c+jZSXQrhxBgT4DOyfZddm7sdX+cu=Zg@mail.gmail.com%3E&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://mail-archives.apache.org/mod_mbox/hive-dev/201201.mbox/%3CCAKTRiE+3x31FDy+3F0c+jZSXQrhxBgT4DOyfZddm7sdX+cu=Zg@mail.gmail.com%3E&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;http://mail-archives.apache.org/mod_mbox/hive-user/201202.mbox/%3CFC28CCD9-9C75-4F8D-B272-3D50F663A634@gmail.com%3E&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://mail-archives.apache.org/mod_mbox/hive-user/201202.mbox/%3CFC28CCD9-9C75-4F8D-B272-3D50F663A634@gmail.com%3E&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;The following is a part of my thread dump.&lt;/p&gt;

&lt;blockquote&gt;
&lt;p&gt;&quot;Thread-1091&quot; prio=10 tid=0x00007fd17112b000 nid=0x1100 runnable &lt;span class=&quot;error&quot;&gt;&amp;#91;0x00007fd175f60000&amp;#93;&lt;/span&gt;&lt;br/&gt;
   java.lang.Thread.State: RUNNABLE&lt;br/&gt;
   at java.util.HashMap.getEntry(HashMap.java:347)&lt;br/&gt;
   at java.util.HashMap.containsKey(HashMap.java:335)&lt;br/&gt;
   at java.util.HashSet.contains(HashSet.java:184)&lt;br/&gt;
   at org.apache.hadoop.hive.ql.QueryPlan.extractCounters(QueryPlan.java:342)&lt;br/&gt;
   at org.apache.hadoop.hive.ql.QueryPlan.getQueryPlan(QueryPlan.java:419)&lt;br/&gt;
   at org.apache.hadoop.hive.ql.QueryPlan.toString(QueryPlan.java:592)&lt;br/&gt;
   at org.apache.hadoop.hive.ql.history.HiveHistory.logPlanProgress(HiveHistory.java:493)&lt;br/&gt;
   at org.apache.hadoop.hive.ql.exec.ExecDriver.progress(ExecDriver.java:395)&lt;br/&gt;
   at org.apache.hadoop.hive.ql.exec.ExecDriver.execute(ExecDriver.java:686)&lt;br/&gt;
   at org.apache.hadoop.hive.ql.exec.MapRedTask.execute(MapRedTask.java:123)&lt;br/&gt;
   at org.apache.hadoop.hive.ql.exec.Task.executeTask(Task.java:130)&lt;br/&gt;
   at org.apache.hadoop.hive.ql.exec.TaskRunner.runSequential(TaskRunner.java:57)&lt;br/&gt;
   at org.apache.hadoop.hive.ql.exec.TaskRunner.run(TaskRunner.java:47)&lt;/p&gt;

&lt;p&gt;&quot;Thread-1090&quot; prio=10 tid=0x00007fd17012f000 nid=0x10ff runnable &lt;span class=&quot;error&quot;&gt;&amp;#91;0x00007fd175152000&amp;#93;&lt;/span&gt;&lt;br/&gt;
   java.lang.Thread.State: RUNNABLE&lt;br/&gt;
   at java.util.HashMap.getEntry(HashMap.java:347)&lt;br/&gt;
   at java.util.HashMap.containsKey(HashMap.java:335)&lt;br/&gt;
   at java.util.HashSet.contains(HashSet.java:184)&lt;br/&gt;
   at org.apache.hadoop.hive.ql.QueryPlan.updateCountersInQueryPlan(QueryPlan.java:297)&lt;br/&gt;
   at org.apache.hadoop.hive.ql.QueryPlan.getQueryPlan(QueryPlan.java:420)&lt;br/&gt;
   at org.apache.hadoop.hive.ql.QueryPlan.toString(QueryPlan.java:592)&lt;br/&gt;
   at org.apache.hadoop.hive.ql.history.HiveHistory.logPlanProgress(HiveHistory.java:493)&lt;br/&gt;
   at org.apache.hadoop.hive.ql.exec.ExecDriver.progress(ExecDriver.java:395)&lt;br/&gt;
   at org.apache.hadoop.hive.ql.exec.ExecDriver.execute(ExecDriver.java:686)&lt;br/&gt;
   at org.apache.hadoop.hive.ql.exec.MapRedTask.execute(MapRedTask.java:123)&lt;br/&gt;
   at org.apache.hadoop.hive.ql.exec.Task.executeTask(Task.java:130)&lt;br/&gt;
   at org.apache.hadoop.hive.ql.exec.TaskRunner.runSequential(TaskRunner.java:57)&lt;br/&gt;
   at org.apache.hadoop.hive.ql.exec.TaskRunner.run(TaskRunner.java:47)&lt;/p&gt;&lt;/blockquote&gt;</description>
                <environment>&lt;ul&gt;
	&lt;li&gt;Java 1.6.0_21, Java HotSpot(TM) 64-Bit Server VM&lt;/li&gt;
	&lt;li&gt;Ubuntu 10.04&lt;/li&gt;
&lt;/ul&gt;
</environment>
        <key id="12605046">HIVE-3408</key>
            <summary>A race condition is caused within QueryPlan class</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/bug.png">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.png">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="3">Duplicate</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="muga_nishizawa">Muga Nishizawa</reporter>
                        <labels>
                            <label>Concurrency</label>
                    </labels>
                <created>Mon, 27 Aug 2012 07:56:33 +0000</created>
                <updated>Tue, 2 Apr 2013 01:40:57 +0000</updated>
                            <resolved>Tue, 2 Apr 2013 01:40:57 +0000</resolved>
                                    <version>0.7.1</version>
                                                    <component>Query Processor</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>2</watches>
                                                                <comments>
                            <comment id="13442326" author="muga_nishizawa" created="Mon, 27 Aug 2012 07:59:03 +0000"  >&lt;p&gt;To solve the problem, I attached a patch on this ticket.  Please check it.&lt;/p&gt;</comment>
                            <comment id="13443239" author="kzk" created="Tue, 28 Aug 2012 16:11:40 +0000"  >&lt;p&gt;Found that other HashSet within a same class could cause the race condition.&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="12310000">
                    <name>Duplicate</name>
                                            <outwardlinks description="duplicates">
                                        <issuelink>
            <issuekey id="12631361">HIVE-4000</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12542586" name="race-condition-of-done-field.patch" size="902" author="muga_nishizawa" created="Mon, 27 Aug 2012 07:59:03 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Tue, 28 Aug 2012 16:11:40 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>259234</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            4 years, 14 weeks, 4 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0lno7:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>124485</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        </customfields>
    </item>
</channel>
</rss>