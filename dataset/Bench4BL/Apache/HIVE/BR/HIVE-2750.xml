<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Sat Dec 03 00:32:39 UTC 2016

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/HIVE-2750/HIVE-2750.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[HIVE-2750] Hive multi group by single reducer optimization causes invalid column reference error</title>
                <link>https://issues.apache.org/jira/browse/HIVE-2750</link>
                <project id="12310843" key="HIVE">Hive</project>
                    <description>&lt;p&gt;After the optimization, if two query blocks have the same distinct clause and the same group by keys, but the first query block does not reference all the rows the second query block does, an invalid column reference error is raised for the columns unreferenced in the first query block.&lt;/p&gt;

&lt;p&gt;E.g.&lt;br/&gt;
FROM src&lt;br/&gt;
INSERT OVERWRITE TABLE dest_g2 SELECT substr(src.key,1,1), count(DISTINCT src.key) WHERE substr(src.key,1,1) &amp;gt;= 5 GROUP BY substr(src.key,1,1)&lt;br/&gt;
INSERT OVERWRITE TABLE dest_g3 SELECT substr(src.key,1,1), count(DISTINCT src.key), count(src.value) WHERE substr(src.key,1,1) &amp;lt; 5 GROUP BY substr(src.key,1,1);&lt;/p&gt;

&lt;p&gt;This results in an invalid column reference error on src.value&lt;/p&gt;</description>
                <environment></environment>
        <key id="12539853">HIVE-2750</key>
            <summary>Hive multi group by single reducer optimization causes invalid column reference error</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/bug.png">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.png">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="kevinwilfong">Kevin Wilfong</assignee>
                                    <reporter username="kevinwilfong">Kevin Wilfong</reporter>
                        <labels>
                    </labels>
                <created>Thu, 26 Jan 2012 02:09:07 +0000</created>
                <updated>Tue, 18 Oct 2016 22:42:10 +0000</updated>
                            <resolved>Mon, 30 Jan 2012 09:53:09 +0000</resolved>
                                                    <fixVersion>0.9.0</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>4</watches>
                                                                <comments>
                            <comment id="13193529" author="phabricator@reviews.facebook.net" created="Thu, 26 Jan 2012 02:43:39 +0000"  >&lt;p&gt;kevinwilfong requested code review of &quot;&lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2750&quot; title=&quot;Hive multi group by single reducer optimization causes invalid column reference error&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-2750&quot;&gt;&lt;del&gt;HIVE-2750&lt;/del&gt;&lt;/a&gt; &lt;span class=&quot;error&quot;&gt;&amp;#91;jira&amp;#93;&lt;/span&gt; Hive multi group by single reducer optimization causes invalid column reference error&quot;.&lt;br/&gt;
Reviewers: JIRA&lt;/p&gt;

&lt;p&gt;  When generating the list of value columns for the reduce sink operator, in the case of multiple group bys occurring in the same reducer, only the columns used by the first query block was being considered, due to a typo.  This patch fixes this typo, and adds a testcase to ensure the error does not reoccur.&lt;/p&gt;

&lt;p&gt;  After the optimization, if two query blocks have the same distinct clause and the same group by keys, but the first query block does not reference all the rows the second query block does, an invalid column reference error is raised for the columns unreferenced in the first query block.&lt;/p&gt;

&lt;p&gt;  E.g.&lt;br/&gt;
  FROM src&lt;br/&gt;
  INSERT OVERWRITE TABLE dest_g2 SELECT substr(src.key,1,1), count(DISTINCT src.key) WHERE substr(src.key,1,1) &amp;gt;= 5 GROUP BY substr(src.key,1,1)&lt;br/&gt;
  INSERT OVERWRITE TABLE dest_g3 SELECT substr(src.key,1,1), count(DISTINCT src.key), count(src.value) WHERE substr(src.key,1,1) &amp;lt; 5 GROUP BY substr(src.key,1,1);&lt;/p&gt;

&lt;p&gt;  This results in an invalid column reference error on src.value&lt;/p&gt;

&lt;p&gt;TEST PLAN&lt;br/&gt;
  EMPTY&lt;/p&gt;

&lt;p&gt;REVISION DETAIL&lt;br/&gt;
  &lt;a href=&quot;https://reviews.facebook.net/D1455&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.facebook.net/D1455&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;AFFECTED FILES&lt;br/&gt;
  ql/src/test/results/clientpositive/groupby_multi_single_reducer2.q.out&lt;br/&gt;
  ql/src/test/queries/clientpositive/groupby_multi_single_reducer2.q&lt;br/&gt;
  ql/src/java/org/apache/hadoop/hive/ql/parse/SemanticAnalyzer.java&lt;/p&gt;

&lt;p&gt;MANAGE HERALD DIFFERENTIAL RULES&lt;br/&gt;
  &lt;a href=&quot;https://reviews.facebook.net/herald/view/differential/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.facebook.net/herald/view/differential/&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;WHY DID I GET THIS EMAIL?&lt;br/&gt;
  &lt;a href=&quot;https://reviews.facebook.net/herald/transcript/3015/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.facebook.net/herald/transcript/3015/&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Tip: use the X-Herald-Rules header to filter Herald messages in your client.&lt;/p&gt;</comment>
                            <comment id="13193555" author="namit" created="Thu, 26 Jan 2012 05:20:22 +0000"  >&lt;p&gt;+1&lt;/p&gt;</comment>
                            <comment id="13193949" author="hudson" created="Thu, 26 Jan 2012 16:33:43 +0000"  >&lt;p&gt;Integrated in Hive-trunk-h0.21 #1222 (See &lt;a href=&quot;https://builds.apache.org/job/Hive-trunk-h0.21/1222/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/Hive-trunk-h0.21/1222/&lt;/a&gt;)&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2750&quot; title=&quot;Hive multi group by single reducer optimization causes invalid column reference error&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-2750&quot;&gt;&lt;del&gt;HIVE-2750&lt;/del&gt;&lt;/a&gt; Hive multi group by single reducer optimization causes invalid column&lt;br/&gt;
reference error (Kevin Wilfong via namit)&lt;/p&gt;

&lt;p&gt;namit : &lt;a href=&quot;http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&amp;amp;view=rev&amp;amp;rev=1236150&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&amp;amp;view=rev&amp;amp;rev=1236150&lt;/a&gt;&lt;br/&gt;
Files : &lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/hive/trunk/ql/src/java/org/apache/hadoop/hive/ql/parse/SemanticAnalyzer.java&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/queries/clientpositive/groupby_multi_single_reducer2.q&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/results/clientpositive/groupby_multi_single_reducer2.q.out&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="13196012" author="amareshwari" created="Mon, 30 Jan 2012 09:53:09 +0000"  >&lt;p&gt;Seems the issue missed resolution. Resolving.&lt;/p&gt;</comment>
                            <comment id="13265306" author="ashutoshc" created="Mon, 30 Apr 2012 21:11:39 +0000"  >&lt;p&gt;This issue is closed now. It was released with the fix in 0.9.0. If there is a problem, please open a new jira and link this one with that.&lt;/p&gt;</comment>
                            <comment id="13548244" author="hudson" created="Wed, 9 Jan 2013 10:24:57 +0000"  >&lt;p&gt;Integrated in Hive-trunk-hadoop2 #54 (See &lt;a href=&quot;https://builds.apache.org/job/Hive-trunk-hadoop2/54/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/Hive-trunk-hadoop2/54/&lt;/a&gt;)&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2750&quot; title=&quot;Hive multi group by single reducer optimization causes invalid column reference error&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-2750&quot;&gt;&lt;del&gt;HIVE-2750&lt;/del&gt;&lt;/a&gt; Hive multi group by single reducer optimization causes invalid column&lt;br/&gt;
reference error (Kevin Wilfong via namit) (Revision 1236150)&lt;/p&gt;

&lt;p&gt;     Result = ABORTED&lt;br/&gt;
namit : &lt;a href=&quot;http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&amp;amp;view=rev&amp;amp;rev=1236150&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&amp;amp;view=rev&amp;amp;rev=1236150&lt;/a&gt;&lt;br/&gt;
Files : &lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/hive/trunk/ql/src/java/org/apache/hadoop/hive/ql/parse/SemanticAnalyzer.java&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/queries/clientpositive/groupby_multi_single_reducer2.q&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/results/clientpositive/groupby_multi_single_reducer2.q.out&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="15014110" author="jpetrakis" created="Thu, 19 Nov 2015 18:35:58 +0000"  >&lt;p&gt;Unless we turn off group-by optimization, the query as described in Jira 12412, which worked fine in Hive 1.0 fails in Hive 1.1 and later.&lt;/p&gt;</comment>
                            <comment id="15014115" author="jpetrakis" created="Thu, 19 Nov 2015 18:37:40 +0000"  >&lt;p&gt;Sorry... wrong link.&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="12310361">
                    <name>Blocked</name>
                                                                <inwardlinks description="Blocked">
                                        <issuelink>
            <issuekey id="12913005">HIVE-12412</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12511935" name="ASF.LICENSE.NOT.GRANTED--HIVE-2750.D1455.1.patch" size="13170" author="phabricator@reviews.facebook.net" created="Thu, 26 Jan 2012 02:43:40 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Thu, 26 Jan 2012 02:43:39 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>225356</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            1 year, 2 weeks, 1 day ago
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0llef:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>124117</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        </customfields>
    </item>
</channel>
</rss>