<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Sat Dec 03 23:03:57 UTC 2016

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/HIVE-2931/HIVE-2931.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[HIVE-2931] conf settings may be ignored</title>
                <link>https://issues.apache.org/jira/browse/HIVE-2931</link>
                <project id="12310843" key="HIVE">Hive</project>
                    <description>&lt;p&gt;This is a pretty serious problem.&lt;/p&gt;

&lt;p&gt;If a conf variable is changed, Hive may not pick up the variable unless the metastore variables are changed.&lt;br/&gt;
When any session variables are changed, it might be simpler to update the corresponding Hive conf.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12549916">HIVE-2931</key>
            <summary>conf settings may be ignored</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/bug.png">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.png">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="3">Duplicate</resolution>
                                        <assignee username="kevinwilfong">Kevin Wilfong</assignee>
                                    <reporter username="namit">Namit Jain</reporter>
                        <labels>
                    </labels>
                <created>Fri, 6 Apr 2012 18:48:04 +0000</created>
                <updated>Fri, 13 Apr 2012 16:41:18 +0000</updated>
                            <resolved>Fri, 13 Apr 2012 06:11:33 +0000</resolved>
                                                                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                <comments>
                            <comment id="13248643" author="namit" created="Fri, 6 Apr 2012 19:36:16 +0000"  >&lt;p&gt;&lt;a href=&quot;https://reviews.facebook.net/differential/diff/8583/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.facebook.net/differential/diff/8583/&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="13252986" author="phabricator@reviews.facebook.net" created="Fri, 13 Apr 2012 00:01:15 +0000"  >&lt;p&gt;kevinwilfong requested code review of &quot;&lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2931&quot; title=&quot;conf settings may be ignored&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-2931&quot;&gt;&lt;del&gt;HIVE-2931&lt;/del&gt;&lt;/a&gt; &lt;span class=&quot;error&quot;&gt;&amp;#91;jira&amp;#93;&lt;/span&gt; conf settings may be ignored&quot;.&lt;br/&gt;
Reviewers: JIRA&lt;/p&gt;

&lt;p&gt;  &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2931&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/HIVE-2931&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;  Unfortunately, Namit&apos;s patch did not pass the tests and he is away.  I offer this patch as a different solution.  The issue is that before &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2716&quot; title=&quot;Move retry logic in HiveMetaStore to a separe class&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-2716&quot;&gt;&lt;del&gt;HIVE-2716&lt;/del&gt;&lt;/a&gt;, Hive would alway have its needsRefresh set to true.  Now, however, this is no longer the case.  This exposed the issue that the Hive class uses config variables which are not metavariables.  This seems perfectly reasonable, except that its HiveConf instance is only updated if a metavariable changes.  It should be updated regardless.  A metavariable changing should only determine if it needs to connect to a new metastore instance.&lt;/p&gt;

&lt;p&gt;  This is a pretty serious problem.&lt;/p&gt;

&lt;p&gt;  If a conf variable is changed, Hive may not pick up the variable unless the metastore variables are changed.&lt;br/&gt;
  When any session variables are changed, it might be simpler to update the corresponding Hive conf.&lt;/p&gt;

&lt;p&gt;TEST PLAN&lt;br/&gt;
  EMPTY&lt;/p&gt;

&lt;p&gt;REVISION DETAIL&lt;br/&gt;
  &lt;a href=&quot;https://reviews.facebook.net/D2781&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.facebook.net/D2781&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;AFFECTED FILES&lt;br/&gt;
  ql/src/java/org/apache/hadoop/hive/ql/metadata/Hive.java&lt;/p&gt;

&lt;p&gt;MANAGE HERALD DIFFERENTIAL RULES&lt;br/&gt;
  &lt;a href=&quot;https://reviews.facebook.net/herald/view/differential/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.facebook.net/herald/view/differential/&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;WHY DID I GET THIS EMAIL?&lt;br/&gt;
  &lt;a href=&quot;https://reviews.facebook.net/herald/transcript/6309/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.facebook.net/herald/transcript/6309/&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Tip: use the X-Herald-Rules header to filter Herald messages in your client.&lt;/p&gt;</comment>
                            <comment id="13252995" author="phabricator@reviews.facebook.net" created="Fri, 13 Apr 2012 00:07:15 +0000"  >&lt;p&gt;stuart983 has commented on the revision &quot;&lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2931&quot; title=&quot;conf settings may be ignored&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-2931&quot;&gt;&lt;del&gt;HIVE-2931&lt;/del&gt;&lt;/a&gt; &lt;span class=&quot;error&quot;&gt;&amp;#91;jira&amp;#93;&lt;/span&gt; conf settings may be ignored&quot;.&lt;/p&gt;

&lt;p&gt;  I&apos;m not sure it is the right thing to do. This patch implies that, every time we call Hive.get(HiveConf), we replace the threadlocal Hive object&apos;s conf to the one passed in?&lt;/p&gt;

&lt;p&gt;REVISION DETAIL&lt;br/&gt;
  &lt;a href=&quot;https://reviews.facebook.net/D2781&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.facebook.net/D2781&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="13252998" author="phabricator@reviews.facebook.net" created="Fri, 13 Apr 2012 00:09:18 +0000"  >&lt;p&gt;kevinwilfong has commented on the revision &quot;&lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2931&quot; title=&quot;conf settings may be ignored&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-2931&quot;&gt;&lt;del&gt;HIVE-2931&lt;/del&gt;&lt;/a&gt; &lt;span class=&quot;error&quot;&gt;&amp;#91;jira&amp;#93;&lt;/span&gt; conf settings may be ignored&quot;.&lt;/p&gt;

&lt;p&gt;  Previously, this is what was effectively done, since every time&lt;br/&gt;
   public static Hive get(HiveConf c)&lt;br/&gt;
  was called needsRefresh was set to true in which case the thread local Hive instance was replaced with a new instance using the conf.&lt;/p&gt;



&lt;p&gt;REVISION DETAIL&lt;br/&gt;
  &lt;a href=&quot;https://reviews.facebook.net/D2781&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.facebook.net/D2781&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="13253008" author="phabricator@reviews.facebook.net" created="Fri, 13 Apr 2012 00:17:20 +0000"  >&lt;p&gt;stuart983 has commented on the revision &quot;&lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2931&quot; title=&quot;conf settings may be ignored&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-2931&quot;&gt;&lt;del&gt;HIVE-2931&lt;/del&gt;&lt;/a&gt; &lt;span class=&quot;error&quot;&gt;&amp;#91;jira&amp;#93;&lt;/span&gt; conf settings may be ignored&quot;.&lt;/p&gt;

&lt;p&gt;  One thing I just don&apos;t understand is, if always doing db.conf= c works, then why we need to comparing the meta vars and only modify when there is difference? I think we must have missed something here.&lt;/p&gt;

&lt;p&gt;REVISION DETAIL&lt;br/&gt;
  &lt;a href=&quot;https://reviews.facebook.net/D2781&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.facebook.net/D2781&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="13253012" author="phabricator@reviews.facebook.net" created="Fri, 13 Apr 2012 00:27:14 +0000"  >&lt;p&gt;kevinwilfong has commented on the revision &quot;&lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2931&quot; title=&quot;conf settings may be ignored&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-2931&quot;&gt;&lt;del&gt;HIVE-2931&lt;/del&gt;&lt;/a&gt; &lt;span class=&quot;error&quot;&gt;&amp;#91;jira&amp;#93;&lt;/span&gt; conf settings may be ignored&quot;.&lt;/p&gt;

&lt;p&gt;  The reason for comparing the metavars is to determine whether or not a new metastore client needs to be created or not, once the metastore client is created, the conf is not updated.  So if any of the conf variables used by the metastore are modified the metastore client needs to be restarted to get those new configs.  I assume this is expensive.&lt;/p&gt;

&lt;p&gt;  If a config variable is changed which may be accessed by the Hive object, but not the metastore config variable, if that is changed, there is no need to create a new metastore client, but Hive&apos;s config should still be updated to make sure it gets the new value.&lt;/p&gt;

&lt;p&gt;REVISION DETAIL&lt;br/&gt;
  &lt;a href=&quot;https://reviews.facebook.net/D2781&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.facebook.net/D2781&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="13253043" author="phabricator@reviews.facebook.net" created="Fri, 13 Apr 2012 01:39:15 +0000"  >&lt;p&gt;stuart983 has accepted the revision &quot;&lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2931&quot; title=&quot;conf settings may be ignored&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-2931&quot;&gt;&lt;del&gt;HIVE-2931&lt;/del&gt;&lt;/a&gt; &lt;span class=&quot;error&quot;&gt;&amp;#91;jira&amp;#93;&lt;/span&gt; conf settings may be ignored&quot;.&lt;/p&gt;

&lt;p&gt;  Communicated offline with Kevin. It looks fine for now. But I still think fixing setProcessor to update local Hive object is something we still need to do. Maybe we should create a follow-up task for that.&lt;/p&gt;

&lt;p&gt;REVISION DETAIL&lt;br/&gt;
  &lt;a href=&quot;https://reviews.facebook.net/D2781&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.facebook.net/D2781&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;BRANCH&lt;br/&gt;
  svn&lt;/p&gt;</comment>
                            <comment id="13253096" author="sdong" created="Fri, 13 Apr 2012 04:22:14 +0000"  >&lt;p&gt;+1, will commit after tests pass.&lt;/p&gt;</comment>
                            <comment id="13253097" author="sdong" created="Fri, 13 Apr 2012 04:22:19 +0000"  >&lt;p&gt;+1, will commit after tests pass.&lt;/p&gt;</comment>
                            <comment id="13253155" author="cwsteinbach" created="Fri, 13 Apr 2012 06:08:33 +0000"  >&lt;p&gt;This ticket is a duplicate of &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2918&quot; title=&quot;Hive Dynamic Partition Insert - move task not considering &amp;#39;hive.exec.max.dynamic.partitions&amp;#39; from CLI&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-2918&quot;&gt;&lt;del&gt;HIVE-2918&lt;/del&gt;&lt;/a&gt;. I have provided a patch for &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2918&quot; title=&quot;Hive Dynamic Partition Insert - move task not considering &amp;#39;hive.exec.max.dynamic.partitions&amp;#39; from CLI&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-2918&quot;&gt;&lt;del&gt;HIVE-2918&lt;/del&gt;&lt;/a&gt; which provides the same fix along with two new testcases that verify the behavior of hive.exec.max.dynamic.partitions. Please test and commit that patch instead.&lt;/p&gt;</comment>
                            <comment id="13253158" author="cwsteinbach" created="Fri, 13 Apr 2012 06:15:48 +0000"  >&lt;p&gt;Also, this patch doesn&apos;t add any tests to verify that it actually fixes the problem. Please either add tests or commit &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2918&quot; title=&quot;Hive Dynamic Partition Insert - move task not considering &amp;#39;hive.exec.max.dynamic.partitions&amp;#39; from CLI&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-2918&quot;&gt;&lt;del&gt;HIVE-2918&lt;/del&gt;&lt;/a&gt; instead.&lt;/p&gt;</comment>
                            <comment id="13253174" author="kevinwilfong" created="Fri, 13 Apr 2012 06:35:39 +0000"  >&lt;p&gt;I&apos;d prefer to use your patch because, as you said, it is nearly an identical fix, and it has test cases.&lt;/p&gt;</comment>
                            <comment id="13253525" author="sdong" created="Fri, 13 Apr 2012 16:41:18 +0000"  >&lt;p&gt;OK.&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="12310000">
                    <name>Duplicate</name>
                                            <outwardlinks description="duplicates">
                                        <issuelink>
            <issuekey id="12549144">HIVE-2918</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12522505" name="ASF.LICENSE.NOT.GRANTED--HIVE-2931.D2781.1.patch" size="492" author="phabricator@reviews.facebook.net" created="Fri, 13 Apr 2012 00:01:17 +0000"/>
                            <attachment id="12521716" name="hive.2931.1.patch" size="2019" author="namit" created="Fri, 6 Apr 2012 19:39:29 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Fri, 13 Apr 2012 00:01:15 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>234907</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            4 years, 34 weeks, 1 day ago
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0lm4f:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>124234</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        </customfields>
    </item>
</channel>
</rss>