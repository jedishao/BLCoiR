<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Sat Dec 03 23:54:13 UTC 2016

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/HIVE-4996/HIVE-4996.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[HIVE-4996] unbalanced calls to openTransaction/commitTransaction</title>
                <link>https://issues.apache.org/jira/browse/HIVE-4996</link>
                <project id="12310843" key="HIVE">Hive</project>
                    <description>&lt;p&gt;when we used hiveserver1 based on hive-0.10.0, we found the Exception thrown.It was:&lt;/p&gt;

&lt;p&gt;FAILED: Error in metadata: MetaException(message:java.lang.RuntimeException: commitTransaction was called but openTransactionCalls = 0. This probably indicates that the&lt;br/&gt;
re are unbalanced calls to openTransaction/commitTransaction)&lt;br/&gt;
FAILED: Execution Error, return code 1 from org.apache.hadoop.hive.ql.exec.DDLTask&lt;/p&gt;

&lt;p&gt;help&lt;/p&gt;</description>
                <environment>&lt;p&gt;hiveserver1  Java HotSpot(TM) 64-Bit Server VM (build 20.6-b01, mixed mode)&lt;/p&gt;</environment>
        <key id="12661631">HIVE-4996</key>
            <summary>unbalanced calls to openTransaction/commitTransaction</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/bug.png">Bug</type>
                                            <priority id="2" iconUrl="https://issues.apache.org/jira/images/icons/priorities/critical.png">Critical</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="szehon">Szehon Ho</assignee>
                                    <reporter username="wfeng1982">wangfeng</reporter>
                        <labels>
                            <label>hive</label>
                            <label>metastore</label>
                    </labels>
                <created>Mon, 5 Aug 2013 03:53:51 +0000</created>
                <updated>Thu, 20 Nov 2014 21:52:22 +0000</updated>
                            <resolved>Wed, 12 Feb 2014 19:20:14 +0000</resolved>
                                    <version>0.10.0</version>
                    <version>0.11.0</version>
                    <version>0.12.0</version>
                                    <fixVersion>0.13.0</fixVersion>
                                    <component>Metastore</component>
                        <due></due>
                            <votes>6</votes>
                                    <watches>18</watches>
                                    <timeoriginalestimate seconds="1814400">504h</timeoriginalestimate>
                            <timeestimate seconds="1814400">504h</timeestimate>
                                        <comments>
                            <comment id="13729097" author="wfeng1982" created="Mon, 5 Aug 2013 03:57:07 +0000"  >&lt;p&gt;this bug  occurred in the hive 0.7.0 ,see &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-1760&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/HIVE-1760&lt;/a&gt;  .but it was reproduced in  hive-0.10.0 &lt;/p&gt;</comment>
                            <comment id="13743461" author="thelogenator" created="Mon, 19 Aug 2013 00:55:32 +0000"  >&lt;p&gt;I&apos;m seeing this same issue with hive-server2-0.10.0 and hive-metastore-0.10.0&lt;/p&gt;</comment>
                            <comment id="13743686" author="teddy.choi" created="Mon, 19 Aug 2013 10:01:31 +0000"  >&lt;p&gt;Could you specify the last operation you tried? It will be helpful to find the bug.&lt;/p&gt;</comment>
                            <comment id="13744162" author="thelogenator" created="Mon, 19 Aug 2013 20:19:50 +0000"  >&lt;p&gt;Thanks for your reply Teddy. I have a hive script that drops then&lt;br/&gt;
re-creates a couple of tables. I assumed that it was the &quot;drop table if&lt;br/&gt;
exists&quot; steps but upon further investigation at least in the latest&lt;br/&gt;
instance it was the last step that failed.  &lt;b&gt;--uber_responsemapping&lt;/b&gt;&lt;/p&gt;




&lt;p&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;root@ALLEG-P-H0001 exec_etl-wf&amp;#93;&lt;/span&gt;# cat drop_uber_tables.q&lt;br/&gt;
DROP TABLE if exists $&lt;/p&gt;
{hivedbname}.uber_responsemapping;&lt;br/&gt;
DROP TABLE if exists ${hivedbname}
&lt;p&gt;.ubermap;&lt;/p&gt;

&lt;p&gt;--ubermap&lt;br/&gt;
Create table $&lt;/p&gt;
{hivedbname}.ubermap (&lt;br/&gt;
ubermapid int,&lt;br/&gt;
id int,&lt;br/&gt;
value string,&lt;br/&gt;
surveyid int,&lt;br/&gt;
uberindex int,&lt;br/&gt;
uberbit bigint,&lt;br/&gt;
modifieddate string)&lt;br/&gt;
Partitioned by (Maptype int )&lt;br/&gt;
Clustered by (id ) into 20 BUCKETS;&lt;br/&gt;
&lt;br/&gt;
&lt;b&gt;--uber_responsemapping&lt;/b&gt;&lt;br/&gt;
*Create Table ${hivedbname}
&lt;p&gt;.uber_responsemapping (*&lt;br/&gt;
*id int, *&lt;br/&gt;
*responseid int, *&lt;br/&gt;
*respondentid int, *&lt;br/&gt;
*answerid int, *&lt;br/&gt;
*scaleid int, *&lt;br/&gt;
*responserank int, *&lt;br/&gt;
*respondentstate int, *&lt;br/&gt;
*modifieddatetime string, *&lt;br/&gt;
*value string, *&lt;br/&gt;
&lt;b&gt;answerweight int,&lt;/b&gt;&lt;br/&gt;
&lt;b&gt;answerdatatype string,&lt;/b&gt;&lt;br/&gt;
&lt;b&gt;dataaction string)&lt;/b&gt;&lt;br/&gt;
&lt;b&gt;Partitioned by (surveyid int)&lt;/b&gt;&lt;br/&gt;
&lt;b&gt;Clustered by (respondentid) into 50 BUCKETS;&lt;/b&gt;&lt;/p&gt;


</comment>
                            <comment id="13744589" author="teddy.choi" created="Tue, 20 Aug 2013 01:16:38 +0000"  >&lt;p&gt;Sorry, &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=thelogenator&quot; class=&quot;user-hover&quot; rel=&quot;thelogenator&quot;&gt;Logan Hardy&lt;/a&gt;. I&apos;m confused. To make it clear, did you used asterisks for bold letters only?&lt;/p&gt;</comment>
                            <comment id="13744601" author="teddy.choi" created="Tue, 20 Aug 2013 01:33:13 +0000"  >&lt;p&gt;I removed formats and executed your queries. They worked without any error. It seems like there are more causes.&lt;/p&gt;

&lt;p&gt;Can you show me more information? Such as hivedbname, whether there were tables before executing drop queries.&lt;/p&gt;</comment>
                            <comment id="13744611" author="teddy.choi" created="Tue, 20 Aug 2013 01:51:24 +0000"  >&lt;p&gt;If it becomes reproducible, then I will try to fix it again.&lt;/p&gt;</comment>
                            <comment id="13757438" author="wfeng1982" created="Wed, 4 Sep 2013 03:48:41 +0000"  >&lt;p&gt;I found that question occurred when hiveserver were running continuously several days,and concurrently creating table &lt;/p&gt;</comment>
                            <comment id="13762495" author="sershe" created="Tue, 10 Sep 2013 00:04:31 +0000"  >&lt;p&gt;note that the error message may be misleading, see &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-5181&quot; title=&quot;RetryingRawStore should not retry on logical failures (e.g. from commit)&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-5181&quot;&gt;&lt;del&gt;HIVE-5181&lt;/del&gt;&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="13762666" author="wfeng1982" created="Tue, 10 Sep 2013 02:51:27 +0000"  >&lt;p&gt;maybe the cause of this question was  that SergeyShelukhin issued. but what&apos;s the some real issue?&lt;/p&gt;</comment>
                            <comment id="13772313" author="jsharley-fm" created="Thu, 19 Sep 2013 21:04:06 +0000"  >&lt;p&gt;We have seen similar issues in an environment with a lot of concurrent hive access from multiple machines all running version 0.11.  Our first thought was that we needed to turn on hive.support.concurrency.  However, after doing this on all of our hosts including the ones running hiveserver we still see an intermittent issue.  I&apos;ve not been able to reliably reproduce it, but it does happen at least a few times a day as part of our regularly scheduled jobs.&lt;/p&gt;</comment>
                            <comment id="13854676" author="liheyuan" created="Fri, 20 Dec 2013 23:32:38 +0000"  >&lt;p&gt;We are meeting the same issue in hive 0.11, standalone mode + MySQL as metastore.&lt;/p&gt;</comment>
                            <comment id="13862873" author="cyril.liao" created="Mon, 6 Jan 2014 09:28:45 +0000"  >&lt;p&gt;Every thing works well after i change connection pool from bonecp to dbcp . You can have a try.&lt;/p&gt;</comment>
                            <comment id="13862878" author="cyril.liao" created="Mon, 6 Jan 2014 09:41:29 +0000"  >&lt;p&gt;change connection poll from bonecp to dbcp&lt;/p&gt;</comment>
                            <comment id="13863105" author="sershe" created="Mon, 6 Jan 2014 16:53:27 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-4807&quot; title=&quot;Hive metastore hangs&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-4807&quot;&gt;&lt;del&gt;HIVE-4807&lt;/del&gt;&lt;/a&gt; changed it to bonecp due to another bug. Maybe some additional instrumentation (such as tracking db queries) can uncover the cause of this bug, instead of just changing it&lt;/p&gt;</comment>
                            <comment id="13863702" author="cyril.liao" created="Tue, 7 Jan 2014 00:28:08 +0000"  >&lt;p&gt;bonecp leads to communication with db fails,this is why there are unbalanced transcations .&lt;/p&gt;</comment>
                            <comment id="13863708" author="cyril.liao" created="Tue, 7 Jan 2014 00:34:57 +0000"  >&lt;p&gt;Maybe there are some wrong usage of bonecp in hive,but i am sure bonecp is in charge of this issue.&lt;/p&gt;</comment>
                            <comment id="13881631" author="jhsenjaliya" created="Sat, 25 Jan 2014 03:04:06 +0000"  >&lt;p&gt;just want to add my experience and testing with this bug,&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;looks like BoneCP has bug.&lt;/li&gt;
	&lt;li&gt;switching to DBCP resolved this issue for me.&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="13881806" author="lefty@hortonworks.com" created="Sat, 25 Jan 2014 10:32:49 +0000"  >&lt;p&gt;The patch is misnamed:  hive-4996.path should be hive-4996.patch.  (It downloads instead of opening when I click the link.)&lt;/p&gt;</comment>
                            <comment id="13885085" author="vgumashta" created="Wed, 29 Jan 2014 07:02:16 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=cyril.liao&quot; class=&quot;user-hover&quot; rel=&quot;cyril.liao&quot;&gt;cyril liao&lt;/a&gt; What version of bonecp are you using? Bonecp has been upgraded to a newer version in this patch: &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-6170&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;HIVE-6170&lt;/a&gt;. Can you test with the newer version?&lt;/p&gt;</comment>
                            <comment id="13885845" author="szehon" created="Wed, 29 Jan 2014 21:40:05 +0000"  >&lt;p&gt;I put some instrumentation code and saw the following in one instance of this exception:&lt;/p&gt;

&lt;p&gt;1.  HMSHandler.create_table_with_core makes a series of calls to the RawStore: &lt;/p&gt;
{open, call1, call2, call3, commmit}

&lt;p&gt;2.  Suddenly there is a strange BoneCP message saying it is closing the connection.&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
2014-01-28 22:50:34,565 WARN  bonecp.ConnectionPartition (ConnectionPartition.java:finalizeReferent(162)) - BoneCP detected an unclosed connection and will now attempt to close it &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; you. You should be closing &lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt; connection in your application - enable connectionWatch &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; additional debugging assistance or set disableConnectionTracking to &lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt; to disable &lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt; feature entirely.
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;3.  This causes a certain RawStore operation &lt;/p&gt;
{calln} to fail on commit, and rollback to occur.  In this case, failing operation is in nested-transaction (openTransactions &amp;gt; 1)&lt;br/&gt;
&lt;br/&gt;
4.  This RawStore operation {calln}
&lt;p&gt; is re-tried by virtue of the retrying metastore client, and succeeds (using perhaps another BoneCP connection).&lt;/p&gt;

&lt;p&gt;5.  But there is still the final commit() call of HMSHandler operation in step 1, and it will be unbalanced.&lt;/p&gt;

&lt;p&gt;So there are two issues, one is BoneCP randomly closing the connection, and also the design of RetryingRawStore. &lt;/p&gt;

&lt;p&gt;In my opinion, we should rely on RetryingHMSHandler and get rid of RetryingRawStore, as we should always retry the whole transaction as a unit.  It doesn&apos;t make sense too much sense to me to retry individual operations, within a nested transaction, unless I am missing something.  I could take a stab, what do people think?&lt;/p&gt;</comment>
                            <comment id="13885848" author="szehon" created="Wed, 29 Jan 2014 21:42:18 +0000"  >&lt;p&gt;Sorry there is a minor typo in 4.  It should read: &lt;/p&gt;

&lt;p&gt;This RawStore operation &lt;/p&gt;
{calln}
&lt;p&gt; is re-tried by virtue of the RetryingRawStore, and succeeds&lt;/p&gt;</comment>
                            <comment id="13885911" author="sershe" created="Wed, 29 Jan 2014 22:24:23 +0000"  >&lt;p&gt;There&apos;s attribute in retryingrawstore I think that prevents commit itself from being retries.&lt;br/&gt;
Perhaps it (or something similar?) can also be used to prevent write ops from being retried? Retrying read ops might make sense.&lt;/p&gt;</comment>
                            <comment id="13885951" author="szehon" created="Wed, 29 Jan 2014 22:55:06 +0000"  >&lt;p&gt;I think that most operations have read/write both, and the RetryingRawStore doesn&apos;t have enough context to tell whether the failing read has any writes before it, in which the rollback would affect.&lt;/p&gt;

&lt;p&gt;Also , it doesn&apos;t get around the unbalanced problem.  As the first open() is not called again, so the final commit() would be unbalanced after any retry, read or write.&lt;/p&gt;

&lt;p&gt;For example:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
HMSHandler.createTable()
   ms.open()  &lt;span class=&quot;code-comment&quot;&gt;//openTx = 1
&lt;/span&gt;   ms.getTable() &lt;span class=&quot;code-comment&quot;&gt;// fails and rollback: set openTx = 0.  Then retries, openTx = 1, then openTx = 0 on success.
&lt;/span&gt;   ms.createTable()  &lt;span class=&quot;code-comment&quot;&gt;//openTx = 1 then openTx = 0.
&lt;/span&gt;   ms.commit();  &lt;span class=&quot;code-comment&quot;&gt;//unbalanced transaction as activeTx = 0&lt;/span&gt;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;In normal scenario:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
HMSHandler.createTable()
   ms.open()  &lt;span class=&quot;code-comment&quot;&gt;//openTx = 1
&lt;/span&gt;   ms.getTable() &lt;span class=&quot;code-comment&quot;&gt;// openTx = 2, then openTx = 1
&lt;/span&gt;   ms.createTable()  &lt;span class=&quot;code-comment&quot;&gt;//openTx = 2, then openTx = 1.
&lt;/span&gt;   ms.commit();  &lt;span class=&quot;code-comment&quot;&gt;//openTx = 0&lt;/span&gt;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="13886892" author="szehon" created="Thu, 30 Jan 2014 18:41:41 +0000"  >&lt;p&gt;In some more testing, the workaround for the issue is to set the configuration hive.metastore.ds.retry.attempts=0, as this de-activates RetryingMetastore.  If there is any transient BoneCP error like this, RetryingHMSHandler will retry whole transaction from the beginning.&lt;/p&gt;</comment>
                            <comment id="13887423" author="szehon" created="Fri, 31 Jan 2014 03:23:09 +0000"  >&lt;p&gt;One more observation about the particular BoneCP error &quot;BoneCP detected an unclosed connection and will now attempt to close it for you.&quot;   It seems it is a problem of the 0.8.0 release.  There are some discussions about this, including at &lt;a href=&quot;http://jolbox.com/forum/viewtopic.php?f=3&amp;amp;t=387&amp;amp;start=10&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://jolbox.com/forum/viewtopic.php?f=3&amp;amp;t=387&amp;amp;start=10&lt;/a&gt;. We have not seen the error when we reverted back to BoneCP 0.7.1.  &lt;/p&gt;

&lt;p&gt;But I guess this is an orthogonal issue, as any transient DB/Bonecp error will be hidden by RetryingRawStore bug.  Just so happens that with BoneCP 0.8.0, it seems to be more frequent.&lt;/p&gt;</comment>
                            <comment id="13890070" author="szehon" created="Mon, 3 Feb 2014 23:04:55 +0000"  >&lt;p&gt;Attaching a fix.&lt;/p&gt;</comment>
                            <comment id="13890072" author="szehon" created="Mon, 3 Feb 2014 23:06:39 +0000"  >&lt;p&gt;Attached the link to code review.&lt;/p&gt;</comment>
                            <comment id="13890346" author="hiveqa" created="Tue, 4 Feb 2014 03:46:39 +0000"  >

&lt;p&gt;&lt;font color=&quot;red&quot;&gt;Overall&lt;/font&gt;: -1 at least one tests failed&lt;/p&gt;

&lt;p&gt;Here are the results of testing the latest attachment:&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/secure/attachment/12626772/HIVE-4996.1.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/secure/attachment/12626772/HIVE-4996.1.patch&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;font color=&quot;red&quot;&gt;ERROR:&lt;/font&gt; -1 due to 5 failed/errored test(s), 4995 tests executed&lt;br/&gt;
&lt;b&gt;Failed tests:&lt;/b&gt;&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;org.apache.hadoop.hive.cli.TestContribNegativeCliDriver.testNegativeCliDriver_url_hook
org.apache.hadoop.hive.cli.TestMinimrCliDriver.testCliDriver_bucket_num_reducers
org.apache.hadoop.hive.cli.TestMinimrCliDriver.testCliDriver_infer_bucket_sort_merge
org.apache.hadoop.hive.cli.TestMinimrCliDriver.testCliDriver_root_dir_external_table
org.apache.hadoop.hive.common.type.TestDecimal128.testHighPrecisionDecimal128Multiply
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Test results: &lt;a href=&quot;http://bigtop01.cloudera.org:8080/job/PreCommit-HIVE-Build/1170/testReport&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://bigtop01.cloudera.org:8080/job/PreCommit-HIVE-Build/1170/testReport&lt;/a&gt;&lt;br/&gt;
Console output: &lt;a href=&quot;http://bigtop01.cloudera.org:8080/job/PreCommit-HIVE-Build/1170/console&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://bigtop01.cloudera.org:8080/job/PreCommit-HIVE-Build/1170/console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Messages:&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;Executing org.apache.hive.ptest.execution.PrepPhase
Executing org.apache.hive.ptest.execution.ExecutionPhase
Executing org.apache.hive.ptest.execution.ReportingPhase
Tests exited with: TestsFailedException: 5 tests failed
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;

&lt;p&gt;ATTACHMENT ID: 12626772&lt;/p&gt;</comment>
                            <comment id="13891560" author="szehon" created="Wed, 5 Feb 2014 01:11:59 +0000"  >&lt;p&gt;Fixing url_hook failure.&lt;/p&gt;

&lt;p&gt;Other failures do not seem related to this patch.&lt;/p&gt;</comment>
                            <comment id="13892222" author="hiveqa" created="Wed, 5 Feb 2014 15:22:16 +0000"  >

&lt;p&gt;&lt;font color=&quot;red&quot;&gt;Overall&lt;/font&gt;: -1 at least one tests failed&lt;/p&gt;

&lt;p&gt;Here are the results of testing the latest attachment:&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/secure/attachment/12627045/HIVE-4996.2.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/secure/attachment/12627045/HIVE-4996.2.patch&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;font color=&quot;red&quot;&gt;ERROR:&lt;/font&gt; -1 due to 2 failed/errored test(s), 5008 tests executed&lt;br/&gt;
&lt;b&gt;Failed tests:&lt;/b&gt;&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;org.apache.hadoop.hive.metastore.TestMetaStoreListenersError.testEventListenerException
org.apache.hadoop.hive.metastore.TestMetaStoreListenersError.testInitListenerException
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Test results: &lt;a href=&quot;http://bigtop01.cloudera.org:8080/job/PreCommit-HIVE-Build/1200/testReport&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://bigtop01.cloudera.org:8080/job/PreCommit-HIVE-Build/1200/testReport&lt;/a&gt;&lt;br/&gt;
Console output: &lt;a href=&quot;http://bigtop01.cloudera.org:8080/job/PreCommit-HIVE-Build/1200/console&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://bigtop01.cloudera.org:8080/job/PreCommit-HIVE-Build/1200/console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Messages:&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;Executing org.apache.hive.ptest.execution.PrepPhase
Executing org.apache.hive.ptest.execution.ExecutionPhase
Executing org.apache.hive.ptest.execution.ReportingPhase
Tests exited with: TestsFailedException: 2 tests failed
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;

&lt;p&gt;ATTACHMENT ID: 12627045&lt;/p&gt;</comment>
                            <comment id="13892901" author="szehon" created="Thu, 6 Feb 2014 01:52:30 +0000"  >&lt;p&gt;Fixing the negative-test cases.&lt;/p&gt;</comment>
                            <comment id="13893233" author="hiveqa" created="Thu, 6 Feb 2014 10:12:31 +0000"  >

&lt;p&gt;&lt;font color=&quot;red&quot;&gt;Overall&lt;/font&gt;: -1 at least one tests failed&lt;/p&gt;

&lt;p&gt;Here are the results of testing the latest attachment:&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/secure/attachment/12627269/HIVE-4996.3.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/secure/attachment/12627269/HIVE-4996.3.patch&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;font color=&quot;red&quot;&gt;ERROR:&lt;/font&gt; -1 due to 1 failed/errored test(s), 5033 tests executed&lt;br/&gt;
&lt;b&gt;Failed tests:&lt;/b&gt;&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;org.apache.hadoop.hive.cli.TestNegativeMinimrCliDriver.testNegativeCliDriver_mapreduce_stack_trace_hadoop20
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Test results: &lt;a href=&quot;http://bigtop01.cloudera.org:8080/job/PreCommit-HIVE-Build/1213/testReport&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://bigtop01.cloudera.org:8080/job/PreCommit-HIVE-Build/1213/testReport&lt;/a&gt;&lt;br/&gt;
Console output: &lt;a href=&quot;http://bigtop01.cloudera.org:8080/job/PreCommit-HIVE-Build/1213/console&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://bigtop01.cloudera.org:8080/job/PreCommit-HIVE-Build/1213/console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Messages:&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;Executing org.apache.hive.ptest.execution.PrepPhase
Executing org.apache.hive.ptest.execution.ExecutionPhase
Executing org.apache.hive.ptest.execution.ReportingPhase
Tests exited with: TestsFailedException: 1 tests failed
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;

&lt;p&gt;ATTACHMENT ID: 12627269&lt;/p&gt;</comment>
                            <comment id="13895252" author="xuefuz" created="Fri, 7 Feb 2014 23:42:36 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=szehon&quot; class=&quot;user-hover&quot; rel=&quot;szehon&quot;&gt;Szehon Ho&lt;/a&gt; Thanks for taking care of this issue. I left a comment on RB.&lt;/p&gt;</comment>
                            <comment id="13897461" author="szehon" created="Tue, 11 Feb 2014 02:23:27 +0000"  >&lt;p&gt;Addressing review comments + rebase.&lt;/p&gt;</comment>
                            <comment id="13897500" author="xuefuz" created="Tue, 11 Feb 2014 03:28:53 +0000"  >&lt;p&gt;+1&lt;/p&gt;</comment>
                            <comment id="13899066" author="hiveqa" created="Wed, 12 Feb 2014 12:49:55 +0000"  >

&lt;p&gt;&lt;font color=&quot;red&quot;&gt;Overall&lt;/font&gt;: -1 at least one tests failed&lt;/p&gt;

&lt;p&gt;Here are the results of testing the latest attachment:&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/secure/attachment/12628142/HIVE-4996.4.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/secure/attachment/12628142/HIVE-4996.4.patch&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;font color=&quot;red&quot;&gt;ERROR:&lt;/font&gt; -1 due to 2 failed/errored test(s), 5084 tests executed&lt;br/&gt;
&lt;b&gt;Failed tests:&lt;/b&gt;&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;org.apache.hadoop.hive.cli.TestCliDriver.testCliDriver_authorization_revoke_table_priv
org.apache.hadoop.hive.cli.TestMinimrCliDriver.testCliDriver_auto_sortmerge_join_16
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Test results: &lt;a href=&quot;http://bigtop01.cloudera.org:8080/job/PreCommit-HIVE-Build/1282/testReport&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://bigtop01.cloudera.org:8080/job/PreCommit-HIVE-Build/1282/testReport&lt;/a&gt;&lt;br/&gt;
Console output: &lt;a href=&quot;http://bigtop01.cloudera.org:8080/job/PreCommit-HIVE-Build/1282/console&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://bigtop01.cloudera.org:8080/job/PreCommit-HIVE-Build/1282/console&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Messages:&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;Executing org.apache.hive.ptest.execution.PrepPhase
Executing org.apache.hive.ptest.execution.ExecutionPhase
Executing org.apache.hive.ptest.execution.ReportingPhase
Tests exited with: TestsFailedException: 2 tests failed
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;

&lt;p&gt;ATTACHMENT ID: 12628142&lt;/p&gt;</comment>
                            <comment id="13899432" author="szehon" created="Wed, 12 Feb 2014 18:57:57 +0000"  >&lt;p&gt;I saw authorization_revoke_table_priv is broken for all recent pre-commit builds.  I ran the minimr test without the issue, it seems to be flaky.&lt;/p&gt;</comment>
                            <comment id="13899456" author="xuefuz" created="Wed, 12 Feb 2014 19:20:14 +0000"  >&lt;p&gt;Patch committed to trunk. Thank Szehon for the patch.&lt;/p&gt;</comment>
                            <comment id="13899468" author="szehon" created="Wed, 12 Feb 2014 19:26:46 +0000"  >&lt;p&gt;Thanks Xuefu for the review.&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="12310000">
                    <name>Duplicate</name>
                                                                <inwardlinks description="is duplicated by">
                                        <issuelink>
            <issuekey id="12599328">HIVE-3272</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                                                <inwardlinks description="is related to">
                                        <issuelink>
            <issuekey id="12754944">HIVE-8850</issuekey>
        </issuelink>
            <issuelink>
            <issuekey id="12666222">HIVE-5181</issuekey>
        </issuelink>
            <issuelink>
            <issuekey id="12478704">HIVE-1760</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                            <issuelinktype id="12310050">
                    <name>Regression</name>
                                                                <inwardlinks description="is broken by">
                                        <issuelink>
            <issuekey id="12655818">HIVE-4807</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12626772" name="HIVE-4996.1.patch" size="23667" author="szehon" created="Mon, 3 Feb 2014 23:25:36 +0000"/>
                            <attachment id="12627045" name="HIVE-4996.2.patch" size="28161" author="szehon" created="Wed, 5 Feb 2014 01:11:59 +0000"/>
                            <attachment id="12627269" name="HIVE-4996.3.patch" size="28284" author="szehon" created="Thu, 6 Feb 2014 01:52:30 +0000"/>
                            <attachment id="12628142" name="HIVE-4996.4.patch" size="26062" author="szehon" created="Tue, 11 Feb 2014 02:23:27 +0000"/>
                            <attachment id="12626761" name="HIVE-4996.patch" size="23682" author="szehon" created="Mon, 3 Feb 2014 23:04:55 +0000"/>
                            <attachment id="12621577" name="hive-4996.path" size="2545" author="cyril.liao" created="Mon, 6 Jan 2014 09:41:29 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>6.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Mon, 19 Aug 2013 00:55:32 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>341820</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            2 years, 42 weeks, 3 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i1my8v:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>342126</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12310230" key="com.atlassian.jira.plugin.system.customfieldtypes:textfield">
                        <customfieldname>Tags</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>hive Metastore</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        </customfields>
    </item>
</channel>
</rss>