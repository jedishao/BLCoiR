<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Sat Dec 03 01:05:36 UTC 2016

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/HIVE-1129/HIVE-1129.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[HIVE-1129] Fix Assertion in ExecDriver.execute when assertions are enabled in HADOOP_OPTS</title>
                <link>https://issues.apache.org/jira/browse/HIVE-1129</link>
                <project id="12310843" key="HIVE">Hive</project>
                    <description>&lt;p&gt;I noticed that when running hive CLI, assertions are not enabled, which was causing me some confusion when debugging an issue.&lt;/p&gt;

&lt;p&gt;So, I added the following to my environment:&lt;/p&gt;

&lt;p&gt;export HADOOP_OPTS=&quot;-ea -esa&quot;&lt;/p&gt;

&lt;p&gt;This worked, and allowed me to see assertion failures when executing via CLI.&lt;/p&gt;

&lt;p&gt;But then I tried to run a test, and got an assertion failure from the following code in ExecDriver.execute:&lt;/p&gt;

&lt;p&gt;    // Turn on speculative execution for reducers&lt;br/&gt;
    HiveConf.setVar(job, HiveConf.ConfVars.HADOOPSPECULATIVEEXECREDUCERS,&lt;br/&gt;
        HiveConf.getVar(job, HiveConf.ConfVars.HIVESPECULATIVEEXECREDUCERS));&lt;/p&gt;

&lt;p&gt;The assertion says it should be using getBoolVar/setBoolVar instead.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12455228">HIVE-1129</key>
            <summary>Fix Assertion in ExecDriver.execute when assertions are enabled in HADOOP_OPTS</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/bug.png">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.png">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="jvs">John Sichi</assignee>
                                    <reporter username="jvs">John Sichi</reporter>
                        <labels>
                    </labels>
                <created>Wed, 3 Feb 2010 20:22:00 +0000</created>
                <updated>Sat, 17 Dec 2011 00:03:41 +0000</updated>
                            <resolved>Sat, 6 Feb 2010 00:18:01 +0000</resolved>
                                    <version>0.5.0</version>
                                    <fixVersion>0.6.0</fixVersion>
                                    <component>Query Processor</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                <comments>
                            <comment id="12829234" author="jvs" created="Wed, 3 Feb 2010 20:22:40 +0000"  >&lt;p&gt;Here&apos;s the assertion stack:&lt;/p&gt;

&lt;p&gt;    &lt;span class=&quot;error&quot;&gt;&amp;#91;junit&amp;#93;&lt;/span&gt; Exception in thread &quot;main&quot; java.lang.AssertionError&lt;br/&gt;
    &lt;span class=&quot;error&quot;&gt;&amp;#91;junit&amp;#93;&lt;/span&gt; 	at org.apache.hadoop.hive.conf.HiveConf.getVar(HiveConf.java:292)&lt;br/&gt;
    &lt;span class=&quot;error&quot;&gt;&amp;#91;junit&amp;#93;&lt;/span&gt; 	at org.apache.hadoop.hive.ql.exec.ExecDriver.execute(ExecDriver.java:569)&lt;br/&gt;
    &lt;span class=&quot;error&quot;&gt;&amp;#91;junit&amp;#93;&lt;/span&gt; 	at org.apache.hadoop.hive.ql.exec.ExecDriver.main(ExecDriver.java:946)&lt;/p&gt;</comment>
                            <comment id="12829235" author="jvs" created="Wed, 3 Feb 2010 20:23:20 +0000"  >&lt;p&gt;Also, I don&apos;t really understand what this code is doing.  Why is doing setVar using the current result of getVar?  Doesn&apos;t that mean it has no effect?&lt;/p&gt;</comment>
                            <comment id="12829244" author="pauly" created="Wed, 3 Feb 2010 20:36:09 +0000"  >&lt;p&gt;Aren&apos;t those two different variables - getVar is accessing HIVESPECULATIVEEXECREDUCERS, while the setVar is setting HADOOPSPECULATIVEEXECREDUCERS.&lt;/p&gt;</comment>
                            <comment id="12829249" author="jvs" created="Wed, 3 Feb 2010 20:46:36 +0000"  >&lt;p&gt;Haha, you&apos;re right, I should get my eyes checked.&lt;/p&gt;</comment>
                            <comment id="12829322" author="namit" created="Wed, 3 Feb 2010 23:54:12 +0000"  >&lt;p&gt;A parameter exists for enabling speculative execution for reducers in hive - the reason we added it about a month back was that we &lt;br/&gt;
wanted to test it easily &amp;#8211; there were some bugs in speculative execution for reducers in hadoop 17, which is why we had disabled it.&lt;br/&gt;
Now that those bugs have been solved, we wanted to test it gradually.&lt;/p&gt;</comment>
                            <comment id="12829339" author="jvs" created="Thu, 4 Feb 2010 00:18:20 +0000"  >&lt;p&gt;Here&apos;s a patch for getting/setting the variables in such a way that the assertions are not triggered.&lt;/p&gt;</comment>
                            <comment id="12829474" author="zshao" created="Thu, 4 Feb 2010 06:32:30 +0000"  >&lt;p&gt;Hi John, can you add the setBoolVar() function to HiveConf class just like the getBoolVar()? That makes the code easier to read and also more consistent.&lt;/p&gt;</comment>
                            <comment id="12829757" author="jvs" created="Thu, 4 Feb 2010 20:19:42 +0000"  >&lt;p&gt;In the spirit of keeping patch transactions small and focused, maybe it would be better to commit this patch as is and assign me a separate JIRA for adding and using the setter methods?  The reason I say this is that my patch followed the existing pattern here in the same file:&lt;/p&gt;

&lt;p&gt;    if(work.getMinSplitSize() != null) &lt;/p&gt;
{
      job.setInt(HiveConf.ConfVars.MAPREDMINSPLITSIZE.varname, 
         work.getMinSplitSize().intValue());
    }

&lt;p&gt;So that code will need to be changed too as part of consistently using the new setters, and that change is unrelated to my fix for the existing bug with assertions.&lt;/p&gt;</comment>
                            <comment id="12830339" author="jvs" created="Fri, 5 Feb 2010 22:27:12 +0000"  >&lt;p&gt;Resubmitting patch as is.  If you agree with me, I&apos;ll create a followup for adding the setters; otherwise, cancel it and I&apos;ll combine the two changes.&lt;/p&gt;</comment>
                            <comment id="12830386" author="zshao" created="Sat, 6 Feb 2010 00:10:18 +0000"  >&lt;p&gt;+1. That makes sense to me.&lt;br/&gt;
Please open a follow-up as an &quot;improvement&quot;.&lt;/p&gt;</comment>
                            <comment id="12830388" author="zshao" created="Sat, 6 Feb 2010 00:18:01 +0000"  >&lt;p&gt;Committed. Thanks John!&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12434739" name="HIVE-1129.1.patch" size="928" author="jvs" created="Thu, 4 Feb 2010 00:18:20 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Wed, 3 Feb 2010 20:36:09 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>73081</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310191" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                        <customfieldname>Hadoop Flags</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10343"><![CDATA[Reviewed]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            6 years, 44 weeks ago
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0ldjz:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>122846</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        </customfields>
    </item>
</channel>
</rss>