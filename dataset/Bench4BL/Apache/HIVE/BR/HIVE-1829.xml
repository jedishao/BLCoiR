<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Sat Dec 03 00:56:23 UTC 2016

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/HIVE-1829/HIVE-1829.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[HIVE-1829] Fix intermittent failures in TestRemoteMetaStore</title>
                <link>https://issues.apache.org/jira/browse/HIVE-1829</link>
                <project id="12310843" key="HIVE">Hive</project>
                    <description>&lt;p&gt;Notice how Running metastore! appears twice.&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;test:
    [junit] Running org.apache.hadoop.hive.metastore.TestEmbeddedHiveMetaStore
    [junit] BR.recoverFromMismatchedToken
    [junit] Tests run: 11, Failures: 0, Errors: 0, Time elapsed: 36.697 sec
    [junit] Running org.apache.hadoop.hive.metastore.TestRemoteHiveMetaStore
    [junit] Running metastore!
    [junit] Running metastore!
    [junit] org.apache.thrift.transport.TTransportException: Could not create ServerSocket on address 0.0.0.0/0.0.0.0:29083.
    [junit] 	at org.apache.thrift.transport.TServerSocket.&amp;lt;init&amp;gt;(TServerSocket.java:98)
    [junit] 	at org.apache.thrift.transport.TServerSocket.&amp;lt;init&amp;gt;(TServerSocket.java:79)
    [junit] 	at org.apache.hadoop.hive.metastore.TServerSocketKeepAlive.&amp;lt;init&amp;gt;(TServerSocketKeepAlive.java:34)
    [junit] 	at org.apache.hadoop.hive.metastore.HiveMetaStore.main(HiveMetaStore.java:2189)
    [junit] 	at org.apache.hadoop.hive.metastore.TestRemoteHiveMetaStore$RunMS.run(TestRemoteHiveMetaStore.java:35)
    [junit] 	at java.lang.Thread.run(Thread.java:619)
    [junit] Running org.apache.hadoop.hive.metastore.TestRemoteHiveMetaStore
    [junit] Tests run: 1, Failures: 0, Errors: 1, Time elapsed: 0 sec
    [junit] Test org.apache.hadoop.hive.metastore.TestRemoteHiveMetaStore FAILED (crashed)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</description>
                <environment></environment>
        <key id="12492031">HIVE-1829</key>
            <summary>Fix intermittent failures in TestRemoteMetaStore</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/bug.png">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.png">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="cwsteinbach">Carl Steinbach</assignee>
                                    <reporter username="appodictic">Edward Capriolo</reporter>
                        <labels>
                    </labels>
                <created>Fri, 3 Dec 2010 21:12:44 +0000</created>
                <updated>Fri, 16 Dec 2011 23:59:38 +0000</updated>
                            <resolved>Tue, 11 Jan 2011 17:28:46 +0000</resolved>
                                    <version>0.6.0</version>
                                    <fixVersion>0.7.0</fixVersion>
                                    <component>Metastore</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                <comments>
                            <comment id="12969891" author="ashutoshc" created="Thu, 9 Dec 2010 19:36:32 +0000"  >&lt;p&gt;I see similar errors randomly. But, whenever I see doing following always get me past it:&lt;/p&gt;

&lt;p&gt;TestRemoteHiveMetaStore.java line number 51:&lt;br/&gt;
 -Thread.sleep(5000);&lt;br/&gt;
 +Thread.sleep(20000); &lt;/p&gt;

&lt;p&gt;So, not sure if it has to do anything with machine having multiple IPs. I also see &quot;Running metastore!&quot; occurring  2-7 times when there is a random failure.&lt;/p&gt;</comment>
                            <comment id="12977042" author="ashutoshc" created="Tue, 4 Jan 2011 00:34:57 +0000"  >&lt;p&gt;This issue can now be seen on latest builds on apache machines as well &lt;a href=&quot;https://hudson.apache.org/hudson/job/Hive-trunk-h0.20/465/console&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://hudson.apache.org/hudson/job/Hive-trunk-h0.20/465/console&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="12977143" author="appodictic" created="Tue, 4 Jan 2011 06:41:05 +0000"  >&lt;p&gt;Thank you for confirming. It is good to know that I am not going crazy. I have two separate machines running into this issue. I noticed this test &quot;disipeared&quot; from trunk so I assume someone else is having problems with it not testing as well.&lt;/p&gt;</comment>
                            <comment id="12977703" author="cwsteinbach" created="Wed, 5 Jan 2011 09:55:47 +0000"  >&lt;p&gt;Ashutosh&apos;s hunch is right &amp;#8211; this doesn&apos;t have anything to do with multiple IPs.&lt;/p&gt;

&lt;p&gt;The problem is caused by the setUp method in TestRemoteHiveMetaStore:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
  &lt;span class=&quot;code-keyword&quot;&gt;protected&lt;/span&gt; void setUp() &lt;span class=&quot;code-keyword&quot;&gt;throws&lt;/span&gt; Exception {
    &lt;span class=&quot;code-keyword&quot;&gt;super&lt;/span&gt;.setUp();
    &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt;(isServerRunning) {
      &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt;;
    }
    &lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt; t = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;(&lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; RunMS());
    t.start();

    &lt;span class=&quot;code-comment&quot;&gt;// Wait a little bit &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; the metastore to start. Should probably have
&lt;/span&gt;    &lt;span class=&quot;code-comment&quot;&gt;// a better way of detecting &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; the metastore has started?
&lt;/span&gt;    &lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;.sleep(5000);

    &lt;span class=&quot;code-comment&quot;&gt;// ...
&lt;/span&gt;
    client = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; HiveMetaStoreClient(hiveConf);
    isThriftClient = &lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;;

    &lt;span class=&quot;code-comment&quot;&gt;// Now you have the client - run necessary tests.
&lt;/span&gt;    isServerRunning = &lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;;
  }
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;JUnit calls this method once before running each testcase, and if setUp() throws an&lt;br/&gt;
exception it will fail the current test before continuing onto the next one.&lt;/p&gt;

&lt;p&gt;On slow machines it can take longer than 5 seconds for the MetaStore server process&lt;br/&gt;
to initialize and open a listening socket (RunMS()). When this happens the&lt;br/&gt;
HiveMetaStoreClient constructor fails with an exception that causes setUp to exit before&lt;br/&gt;
setting isServerRunning to true. JUnit then fails the current testcase and immediately begins initializing&lt;br/&gt;
the next testcase, which results in another call to setUp(). Since isServerRunning is still false&lt;br/&gt;
we end up starting another MetaStore server thread which will attempt to open a listening&lt;br/&gt;
socket on the same port as the first thread, which is what causes the TTransportException&lt;br/&gt;
that you see in the log above.&lt;/p&gt;</comment>
                            <comment id="12977770" author="appodictic" created="Wed, 5 Jan 2011 14:10:47 +0000"  >&lt;p&gt;Right I noticed that isServerRunning check is failing. I do not think it is limited to &apos;slow machines&apos; this fails on server class hardware as well as my laptop with 4GB ram and a quad core. &lt;/p&gt;</comment>
                            <comment id="12979065" author="cwsteinbach" created="Sat, 8 Jan 2011 02:05:40 +0000"  >&lt;p&gt;This patch attempts to fix the intermittent failures in TestRemoteHiveMetaStore by instituting a 60 second&lt;br/&gt;
wait between consecutive connection attempts in HiveMetaStoreClient. This wait period is configurable&lt;br/&gt;
via the new configuration property hive.metastore.client.connect.retry.delay. The patch also defines the&lt;br/&gt;
new configuration property hive.metastore.client.socket.timeout that is used to set the timeout value on&lt;br/&gt;
Thrift socket wrapped by HiveMetaStoreClient.&lt;/p&gt;</comment>
                            <comment id="12979068" author="cwsteinbach" created="Sat, 8 Jan 2011 02:08:22 +0000"  >&lt;p&gt;Review request: &lt;a href=&quot;https://reviews.apache.org/r/260/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/260/&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="12979773" author="jvs" created="Mon, 10 Jan 2011 21:26:09 +0000"  >&lt;p&gt;+1.  Will commit when tests pass.&lt;/p&gt;</comment>
                            <comment id="12980196" author="jvs" created="Tue, 11 Jan 2011 17:28:46 +0000"  >&lt;p&gt;Committed.  Thanks Carl!&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12467785" name="HIVE-1829.1.patch.txt" size="10902" author="cwsteinbach" created="Sat, 8 Jan 2011 02:05:40 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Thu, 9 Dec 2010 19:36:32 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>72678</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310191" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                        <customfieldname>Hadoop Flags</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10343"><![CDATA[Reviewed]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            5 years, 47 weeks, 3 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0lh5j:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>123429</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        </customfields>
    </item>
</channel>
</rss>