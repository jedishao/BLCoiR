<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Sat Dec 03 23:17:33 UTC 2016

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/HIVE-3171/HIVE-3171.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[HIVE-3171] Bucketed sort merge join doesn&apos;t work when multiple files exist for small alias</title>
                <link>https://issues.apache.org/jira/browse/HIVE-3171</link>
                <project id="12310843" key="HIVE">Hive</project>
                    <description>&lt;p&gt;Executing a query with the MAPJOIN hint and the bucketed sort merge join optimizations enabled:&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;set hive.input.format=org.apache.hadoop.hive.ql.io.BucketizedHiveInputFormat;
set hive.optimize.bucketmapjoin = true;
set hive.optimize.bucketmapjoin.sortedmerge = true;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;works fine with partitioned tables if there is only one partition in the table. However, if you add a second partition, Hive attempts to do a regular map-side join which can fail because the tables are too large. Hive ought to be able to still do the bucketed sort merge join with partitions.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12595463">HIVE-3171</key>
            <summary>Bucketed sort merge join doesn&apos;t work when multiple files exist for small alias</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/bug.png">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.png">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="navis">Navis</assignee>
                                    <reporter username="fwiffo">Joey Echeverria</reporter>
                        <labels>
                            <label>bucketing</label>
                            <label>joins</label>
                            <label>partitioning</label>
                    </labels>
                <created>Thu, 21 Jun 2012 18:09:50 +0000</created>
                <updated>Thu, 10 Jan 2013 19:53:10 +0000</updated>
                            <resolved>Fri, 7 Sep 2012 17:41:00 +0000</resolved>
                                    <version>0.10.0</version>
                                    <fixVersion>0.10.0</fixVersion>
                                    <component>Query Processor</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>7</watches>
                                                                <comments>
                            <comment id="13424742" author="navis" created="Mon, 30 Jul 2012 08:15:23 +0000"  >&lt;p&gt;Small aliases can have multiple partitions or can have more buckets than driving alias or both.&lt;/p&gt;</comment>
                            <comment id="13424747" author="navis" created="Mon, 30 Jul 2012 08:25:05 +0000"  >&lt;p&gt;&lt;a href=&quot;https://reviews.facebook.net/D4425&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.facebook.net/D4425&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This is the last one.&lt;/p&gt;</comment>
                            <comment id="13436634" author="cwsteinbach" created="Fri, 17 Aug 2012 09:51:58 +0000"  >&lt;p&gt;@Navis: I see failures in the following tests. Can you please take a look? Thanks.&lt;/p&gt;

&lt;ul&gt;
	&lt;li&gt;TestMinimrCliDriver bucketmapjoin6.q, bucketmapjoin3.q, smb_mapjoin_8.q&lt;/li&gt;
	&lt;li&gt;TestNegativeCliDriver stats_aggregator_error1&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="13437661" author="navis" created="Mon, 20 Aug 2012 05:52:12 +0000"  >&lt;p&gt;I think the patch is not reflecting various changes made on the FetchWork. I&apos;ll start working on this when &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2925&quot; title=&quot;Support non-MR fetching for simple queries with select/limit/filter operations only&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-2925&quot;&gt;&lt;del&gt;HIVE-2925&lt;/del&gt;&lt;/a&gt; is visible on trunk.&lt;/p&gt;</comment>
                            <comment id="13439286" author="navis" created="Wed, 22 Aug 2012 05:24:02 +0000"  >&lt;p&gt;@Carl: Fixed bug (thanks) and passed tests mentioned above. I&apos;ll update patch after passing full test.&lt;/p&gt;</comment>
                            <comment id="13439390" author="namit" created="Wed, 22 Aug 2012 10:07:31 +0000"  >&lt;p&gt;comments&lt;/p&gt;</comment>
                            <comment id="13439967" author="navis" created="Thu, 23 Aug 2012 00:21:21 +0000"  >&lt;p&gt;Addressed comments. &lt;/p&gt;</comment>
                            <comment id="13440508" author="cwsteinbach" created="Thu, 23 Aug 2012 18:13:00 +0000"  >&lt;p&gt;+1. Will commit if tests pass.&lt;/p&gt;</comment>
                            <comment id="13440629" author="cwsteinbach" created="Thu, 23 Aug 2012 20:31:40 +0000"  >&lt;p&gt;@Navis: Can you please attach the most recent version of the patch to this ticket? Thanks.&lt;/p&gt;</comment>
                            <comment id="13440852" author="navis" created="Fri, 24 Aug 2012 01:23:33 +0000"  >&lt;p&gt;Passed all tests&lt;/p&gt;</comment>
                            <comment id="13440869" author="cwsteinbach" created="Fri, 24 Aug 2012 01:47:36 +0000"  >&lt;p&gt;@Navis: Since the tests passed can you please commit this yourself? Thanks.&lt;/p&gt;</comment>
                            <comment id="13440886" author="navis" created="Fri, 24 Aug 2012 02:29:56 +0000"  >&lt;p&gt;@Carl: I&apos;ve not yet received account for ASF, and is it ok to commit by myself? (I thought that the author and the committer should be different)&lt;/p&gt;</comment>
                            <comment id="13440920" author="namit" created="Fri, 24 Aug 2012 03:48:40 +0000"  >&lt;p&gt;@Carl, @Navis, we mostly don&apos;t commit our patches. There have been a few exceptions, but I think&lt;br/&gt;
we should try to stick to this policy: dont commit our own patches.&lt;/p&gt;

&lt;p&gt;Also, can you hold off for a few hours - I wanted to take a pass at this patch. Should be done today itself.&lt;/p&gt;
</comment>
                            <comment id="13440964" author="namit" created="Fri, 24 Aug 2012 05:13:18 +0000"  >&lt;p&gt;some small comments on phabricator&lt;/p&gt;</comment>
                            <comment id="13442354" author="cwsteinbach" created="Mon, 27 Aug 2012 10:29:51 +0000"  >&lt;p&gt;@Namit: The Apache Hive Project Bylaws are located here: &lt;a href=&quot;https://cwiki.apache.org/confluence/display/Hive/Bylaws&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://cwiki.apache.org/confluence/display/Hive/Bylaws&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;The bylaws explicitly prohibit committers from voting on their own patches, but they don&apos;t prohibit committers from committing their own patches as long as another committer has already reviewed and +1&apos;d the patch. It&apos;s also worth noting that the bylaws stipulate that the +1 vote must be sent to dev@hive, and that 24 hours must elapse between the first +1 vote and the point at which the patch is committed.&lt;/p&gt;</comment>
                            <comment id="13443929" author="cwsteinbach" created="Wed, 29 Aug 2012 09:21:30 +0000"  >&lt;p&gt;@Navis: I added a couple small comments on phabricator. Thanks.&lt;/p&gt;</comment>
                            <comment id="13448872" author="namit" created="Wed, 5 Sep 2012 16:37:38 +0000"  >&lt;p&gt;@Navis, are you planning to work on this ?&lt;br/&gt;
Most of the comments are minor - it would be useful to get it in.&lt;/p&gt;</comment>
                            <comment id="13449275" author="navis" created="Wed, 5 Sep 2012 23:51:38 +0000"  >&lt;p&gt;I&apos;ve addressed comments and just finished full test. Will update patch shortly.&lt;/p&gt;</comment>
                            <comment id="13449295" author="navis" created="Thu, 6 Sep 2012 00:13:03 +0000"  >&lt;p&gt;Passed all tests&lt;/p&gt;</comment>
                            <comment id="13449425" author="cwsteinbach" created="Thu, 6 Sep 2012 05:10:01 +0000"  >&lt;p&gt;+1. Will commit if tests pass.&lt;/p&gt;</comment>
                            <comment id="13450762" author="namit" created="Fri, 7 Sep 2012 16:25:26 +0000"  >&lt;p&gt;@Carl, let me know if you are busy.&lt;br/&gt;
I also ran the tests, and they ran fine.&lt;br/&gt;
I can commit it.&lt;/p&gt;

&lt;p&gt;I need this patch for some other jiras, and the sooner I get it in, the easier it is for me.&lt;/p&gt;</comment>
                            <comment id="13450822" author="cwsteinbach" created="Fri, 7 Sep 2012 17:41:00 +0000"  >&lt;p&gt;Committed to trunk. Thanks Navis!&lt;/p&gt;</comment>
                            <comment id="13451254" author="hudson" created="Sat, 8 Sep 2012 05:24:39 +0000"  >&lt;p&gt;Integrated in Hive-trunk-h0.21 #1655 (See &lt;a href=&quot;https://builds.apache.org/job/Hive-trunk-h0.21/1655/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/Hive-trunk-h0.21/1655/&lt;/a&gt;)&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-3171&quot; title=&quot;Bucketed sort merge join doesn&amp;#39;t work when multiple files exist for small alias&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-3171&quot;&gt;&lt;del&gt;HIVE-3171&lt;/del&gt;&lt;/a&gt;. Bucketed sort merge join doesn&apos;t work when multiple files exist for small alias (Navis Ryu via cws) (Revision 1382098)&lt;/p&gt;

&lt;p&gt;     Result = FAILURE&lt;br/&gt;
cws : &lt;a href=&quot;http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&amp;amp;view=rev&amp;amp;rev=1382098&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&amp;amp;view=rev&amp;amp;rev=1382098&lt;/a&gt;&lt;br/&gt;
Files : &lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/hive/trunk/ql/src/java/org/apache/hadoop/hive/ql/exec/ExecMapperContext.java&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/java/org/apache/hadoop/hive/ql/exec/FetchOperator.java&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/java/org/apache/hadoop/hive/ql/exec/MapredLocalTask.java&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/java/org/apache/hadoop/hive/ql/exec/SMBMapJoinOperator.java&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/java/org/apache/hadoop/hive/ql/optimizer/SortedMergeBucketMapJoinOptimizer.java&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/java/org/apache/hadoop/hive/ql/plan/FetchWork.java&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/java/org/apache/hadoop/hive/ql/util/ObjectPair.java&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/queries/clientpositive/bucketcontext_1.q&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/queries/clientpositive/bucketcontext_2.q&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/queries/clientpositive/bucketcontext_3.q&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/queries/clientpositive/bucketcontext_4.q&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/queries/clientpositive/bucketcontext_5.q&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/queries/clientpositive/bucketcontext_6.q&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/results/clientpositive/bucketcontext_2.q.out&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/results/clientpositive/bucketcontext_3.q.out&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/results/clientpositive/bucketcontext_4.q.out&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/results/clientpositive/bucketcontext_5.q.out&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/results/clientpositive/bucketcontext_6.q.out&lt;/li&gt;
	&lt;li&gt;/hive/trunk/serde/src/java/org/apache/hadoop/hive/serde2/ColumnProjectionUtils.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="13547958" author="hudson" created="Wed, 9 Jan 2013 10:23:44 +0000"  >&lt;p&gt;Integrated in Hive-trunk-hadoop2 #54 (See &lt;a href=&quot;https://builds.apache.org/job/Hive-trunk-hadoop2/54/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/Hive-trunk-hadoop2/54/&lt;/a&gt;)&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-3171&quot; title=&quot;Bucketed sort merge join doesn&amp;#39;t work when multiple files exist for small alias&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-3171&quot;&gt;&lt;del&gt;HIVE-3171&lt;/del&gt;&lt;/a&gt;. Bucketed sort merge join doesn&apos;t work when multiple files exist for small alias (Navis Ryu via cws) (Revision 1382098)&lt;/p&gt;

&lt;p&gt;     Result = ABORTED&lt;br/&gt;
cws : &lt;a href=&quot;http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&amp;amp;view=rev&amp;amp;rev=1382098&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&amp;amp;view=rev&amp;amp;rev=1382098&lt;/a&gt;&lt;br/&gt;
Files : &lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;/hive/trunk/ql/src/java/org/apache/hadoop/hive/ql/exec/ExecMapperContext.java&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/java/org/apache/hadoop/hive/ql/exec/FetchOperator.java&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/java/org/apache/hadoop/hive/ql/exec/MapredLocalTask.java&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/java/org/apache/hadoop/hive/ql/exec/SMBMapJoinOperator.java&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/java/org/apache/hadoop/hive/ql/optimizer/SortedMergeBucketMapJoinOptimizer.java&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/java/org/apache/hadoop/hive/ql/plan/FetchWork.java&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/java/org/apache/hadoop/hive/ql/util/ObjectPair.java&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/queries/clientpositive/bucketcontext_1.q&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/queries/clientpositive/bucketcontext_2.q&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/queries/clientpositive/bucketcontext_3.q&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/queries/clientpositive/bucketcontext_4.q&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/queries/clientpositive/bucketcontext_5.q&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/queries/clientpositive/bucketcontext_6.q&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/results/clientpositive/bucketcontext_2.q.out&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/results/clientpositive/bucketcontext_3.q.out&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/results/clientpositive/bucketcontext_4.q.out&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/results/clientpositive/bucketcontext_5.q.out&lt;/li&gt;
	&lt;li&gt;/hive/trunk/ql/src/test/results/clientpositive/bucketcontext_6.q.out&lt;/li&gt;
	&lt;li&gt;/hive/trunk/serde/src/java/org/apache/hadoop/hive/serde2/ColumnProjectionUtils.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="13550046" author="ashutoshc" created="Thu, 10 Jan 2013 19:53:10 +0000"  >&lt;p&gt;This issue is fixed and released as part of 0.10.0 release. If you find an issue which seems to be related to this one, please create a new jira and link this one with new jira.&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10032">
                    <name>Blocker</name>
                                            <outwardlinks description="blocks">
                                        <issuelink>
            <issuekey id="12599817">HIVE-3290</issuekey>
        </issuelink>
                            </outwardlinks>
                                                                <inwardlinks description="is blocked by">
                                        <issuelink>
            <issuekey id="12596480">HIVE-3218</issuekey>
        </issuelink>
            <issuelink>
            <issuekey id="12596234">HIVE-3210</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12542224" name="HIVE-3171.1.patch.txt" size="83875" author="navis" created="Fri, 24 Aug 2012 01:23:33 +0000"/>
                            <attachment id="12543944" name="HIVE-3171.2.patch.txt" size="90115" author="navis" created="Thu, 6 Sep 2012 00:13:29 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Mon, 30 Jul 2012 08:15:23 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>255901</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310191" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                        <customfieldname>Hadoop Flags</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10343"><![CDATA[Reviewed]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            3 years, 47 weeks, 2 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0fvpr:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>90736</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        </customfields>
    </item>
</channel>
</rss>