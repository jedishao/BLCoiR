<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Fri Dec 02 06:02:34 UTC 2016

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/HIVE-14357/HIVE-14357.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[HIVE-14357] TestDbTxnManager2#testLocksInSubquery failing in branch-2.1</title>
                <link>https://issues.apache.org/jira/browse/HIVE-14357</link>
                <project id="12310843" key="HIVE">Hive</project>
                    <description>&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;checkCmdOnDriver(driver.compileAndRespond(&quot;insert into R select * from S where a in (select a from T where b = 1)&quot;));
    txnMgr.openTxn(&quot;three&quot;);
    txnMgr.acquireLocks(driver.getPlan(), ctx, &quot;three&quot;);
    locks = getLocks();
    Assert.assertEquals(&quot;Unexpected lock count&quot;, 3, locks.size());
    checkLock(LockType.SHARED_READ, LockState.ACQUIRED, &quot;default&quot;, &quot;T&quot;, null, locks.get(0));
    checkLock(LockType.SHARED_READ, LockState.ACQUIRED, &quot;default&quot;, &quot;S&quot;, null, locks.get(1));
    checkLock(LockType.SHARED_READ, LockState.ACQUIRED, &quot;default&quot;, &quot;R&quot;, null, locks.get(2));
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;This test case is failing. The expected order of locks is supposed to be T, S, R. But upon closer inspection, it seems to be R,S,T. &lt;/p&gt;

&lt;p&gt;I&apos;m not much familiar with what these locks are and why the order is important. Raising this jira so while I try to understand it all. Meanwhile, if somebody can explain here, would be helpful. &lt;/p&gt;
</description>
                <environment></environment>
        <key id="12992913">HIVE-14357</key>
            <summary>TestDbTxnManager2#testLocksInSubquery failing in branch-2.1</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/bug.png">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.png">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="sershe">Sergey Shelukhin</assignee>
                                    <reporter username="prongs">Rajat Khandelwal</reporter>
                        <labels>
                    </labels>
                <created>Wed, 27 Jul 2016 12:35:48 +0000</created>
                <updated>Mon, 1 Aug 2016 18:39:51 +0000</updated>
                            <resolved>Mon, 1 Aug 2016 18:39:51 +0000</resolved>
                                    <version>2.1.1</version>
                                    <fixVersion>2.2.0</fixVersion>
                    <fixVersion>2.1.1</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>4</watches>
                                                                <comments>
                            <comment id="15395593" author="prongs" created="Wed, 27 Jul 2016 12:37:39 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=ekoifman&quot; class=&quot;user-hover&quot; rel=&quot;ekoifman&quot;&gt;Eugene Koifman&lt;/a&gt; Since you are the original author of this code, can you please take a look?&lt;/p&gt;

&lt;p&gt;Reference commit: &lt;a href=&quot;https://github.com/apache/hive/commit/47bf055c02990272753105b917b487c5bbfe9208&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://github.com/apache/hive/commit/47bf055c02990272753105b917b487c5bbfe9208&lt;/a&gt;&lt;br/&gt;
JIRA which introduced this code: &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-11848&quot; title=&quot;tables in subqueries don&amp;#39;t get locked&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-11848&quot;&gt;&lt;del&gt;HIVE-11848&lt;/del&gt;&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="15400282" author="sershe" created="Sat, 30 Jul 2016 00:08:56 +0000"  >&lt;p&gt;Removed the order dependency from test. When it fails, the error looks like this:&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;java.lang.AssertionError: Could&apos;t find {SHARED_READ, ACQUIRED, default, XYZY, null} in [ShowLocksResponseElement(lockid:2, dbname:default, tablename:xyz, state:ACQUIRED, type:SHARED_READ, txnid:0, lastheartbeat:1469837191676, acquiredat:1469837191676, user:XYZ, hostname:reznor-mbp-2.local, agentInfo:sergey_20160729170623_e1153b39-54d3-4cab-9766-c1349c8efa4a, lockIdInternal:1)]&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="15400283" author="sershe" created="Sat, 30 Jul 2016 00:09:26 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=ekoifman&quot; class=&quot;user-hover&quot; rel=&quot;ekoifman&quot;&gt;Eugene Koifman&lt;/a&gt; &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=wzheng&quot; class=&quot;user-hover&quot; rel=&quot;wzheng&quot;&gt;Wei Zheng&lt;/a&gt; can you take a look?&lt;/p&gt;</comment>
                            <comment id="15400332" author="ekoifman" created="Sat, 30 Jul 2016 00:57:52 +0000"  >&lt;p&gt;+1 pending tests&lt;/p&gt;</comment>
                            <comment id="15401444" author="hiveqa" created="Mon, 1 Aug 2016 02:16:04 +0000"  >

&lt;p&gt;Here are the results of testing the latest attachment:&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/secure/attachment/12821120/HIVE-14357.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/secure/attachment/12821120/HIVE-14357.patch&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;font color=&quot;green&quot;&gt;SUCCESS:&lt;/font&gt; +1 due to 2 test(s) being added or modified.&lt;/p&gt;

&lt;p&gt;&lt;font color=&quot;red&quot;&gt;ERROR:&lt;/font&gt; -1 due to 9 failed/errored test(s), 10418 tests executed&lt;br/&gt;
&lt;b&gt;Failed tests:&lt;/b&gt;&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;TestMsgBusConnection - did not produce a TEST-*.xml file
org.apache.hadoop.hive.cli.TestCliDriver.testCliDriver_avro_nullable_union
org.apache.hadoop.hive.cli.TestCliDriver.testCliDriver_list_bucket_dml_12
org.apache.hadoop.hive.cli.TestCliDriver.testCliDriver_stats_list_bucket
org.apache.hadoop.hive.cli.TestCliDriver.testCliDriver_subquery_multiinsert
org.apache.hadoop.hive.cli.TestMiniLlapCliDriver.testCliDriver_orc_llap_counters
org.apache.hadoop.hive.cli.TestNegativeCliDriver.testNegativeCliDriver_avro_non_nullable_union
org.apache.hadoop.hive.metastore.TestHiveMetaStoreTxns.stringifyValidTxns
org.apache.hadoop.hive.metastore.TestHiveMetaStoreTxns.testTxnRange
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Test results: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HIVE-MASTER-Build/714/testReport&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HIVE-MASTER-Build/714/testReport&lt;/a&gt;&lt;br/&gt;
Console output: &lt;a href=&quot;https://builds.apache.org/job/PreCommit-HIVE-MASTER-Build/714/console&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/job/PreCommit-HIVE-MASTER-Build/714/console&lt;/a&gt;&lt;br/&gt;
Test logs: &lt;a href=&quot;http://ec2-204-236-174-241.us-west-1.compute.amazonaws.com/logs/PreCommit-HIVE-MASTER-Build-714/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://ec2-204-236-174-241.us-west-1.compute.amazonaws.com/logs/PreCommit-HIVE-MASTER-Build-714/&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Messages:&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;Executing org.apache.hive.ptest.execution.TestCheckPhase
Executing org.apache.hive.ptest.execution.PrepPhase
Executing org.apache.hive.ptest.execution.ExecutionPhase
Executing org.apache.hive.ptest.execution.ReportingPhase
Tests exited with: TestsFailedException: 9 tests failed
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;This message is automatically generated.&lt;/p&gt;

&lt;p&gt;ATTACHMENT ID: 12821120 - PreCommit-HIVE-MASTER-Build&lt;/p&gt;</comment>
                            <comment id="15401653" author="prongs" created="Mon, 1 Aug 2016 07:36:57 +0000"  >&lt;p&gt;+1. Changes look good. &lt;/p&gt;

&lt;p&gt;One question: Do these tests fail in 2.1 release too? The commit seems to be a part of 2.1.0-rc3. If yes, it makes sense to get 2.1.1 out soon. cc &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=jcamachorodriguez&quot; class=&quot;user-hover&quot; rel=&quot;jcamachorodriguez&quot;&gt;Jesus Camacho Rodriguez&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Secondly, can we merge this to branch-2.1 soon? I&apos;m kind of blocked on this for something, Thanks. &lt;/p&gt;


</comment>
                            <comment id="15402506" author="sershe" created="Mon, 1 Aug 2016 17:55:33 +0000"  >&lt;p&gt;I will commit to both places. It&apos;s a test-only issue though, so I dunno if it should really impact the release plans.&lt;/p&gt;</comment>
                            <comment id="15402604" author="sershe" created="Mon, 1 Aug 2016 18:39:51 +0000"  >&lt;p&gt;Committed to master and branch-2.1&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12821120" name="HIVE-14357.patch" size="48851" author="sershe" created="Sat, 30 Jul 2016 00:08:56 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Sat, 30 Jul 2016 00:08:56 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            17 weeks, 3 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i31kh3:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                    <customfield id="customfield_12310320" key="com.atlassian.jira.plugin.system.customfieldtypes:multiversion">
                        <customfieldname>Target Version/s</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue>12335838</customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        </customfields>
    </item>
</channel>
</rss>