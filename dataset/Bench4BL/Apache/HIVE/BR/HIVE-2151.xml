<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Sat Dec 03 01:17:20 UTC 2016

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/HIVE-2151/HIVE-2151.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[HIVE-2151] Too many open files in running negative cli tests</title>
                <link>https://issues.apache.org/jira/browse/HIVE-2151</link>
                <project id="12310843" key="HIVE">Hive</project>
                    <description></description>
                <environment></environment>
        <key id="12506358">HIVE-2151</key>
            <summary>Too many open files in running negative cli tests</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/bug.png">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.png">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="he yongqiang">He Yongqiang</assignee>
                                    <reporter username="he yongqiang">He Yongqiang</reporter>
                        <labels>
                    </labels>
                <created>Fri, 6 May 2011 01:57:55 +0000</created>
                <updated>Fri, 16 Dec 2011 23:55:37 +0000</updated>
                            <resolved>Tue, 10 May 2011 14:31:27 +0000</resolved>
                                                    <fixVersion>0.8.0</fixVersion>
                                    <component>CLI</component>
                    <component>Testing Infrastructure</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                <comments>
                            <comment id="13029696" author="ashutoshc" created="Fri, 6 May 2011 02:07:25 +0000"  >&lt;p&gt;I have hit this issue too.&lt;/p&gt;</comment>
                            <comment id="13029813" author="jiraposter@reviews.apache.org" created="Fri, 6 May 2011 07:50:03 +0000"  >
&lt;p&gt;-----------------------------------------------------------&lt;br/&gt;
This is an automatically generated e-mail. To reply, visit:&lt;br/&gt;
&lt;a href=&quot;https://reviews.apache.org/r/696/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/696/&lt;/a&gt;&lt;br/&gt;
-----------------------------------------------------------&lt;/p&gt;

&lt;p&gt;Review request for hive.&lt;/p&gt;


&lt;p&gt;Summary&lt;br/&gt;
-------&lt;/p&gt;

&lt;p&gt;Too many open files in running negative cli tests&lt;/p&gt;


&lt;p&gt;This addresses bug &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2151&quot; title=&quot;Too many open files in running negative cli tests&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-2151&quot;&gt;&lt;del&gt;HIVE-2151&lt;/del&gt;&lt;/a&gt;.&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2151&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/HIVE-2151&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;Diffs&lt;/p&gt;
&lt;hr /&gt;

&lt;p&gt;  trunk/ql/src/java/org/apache/hadoop/hive/ql/Driver.java 1100117 &lt;/p&gt;

&lt;p&gt;Diff: &lt;a href=&quot;https://reviews.apache.org/r/696/diff&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/696/diff&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;Testing&lt;br/&gt;
-------&lt;/p&gt;


&lt;p&gt;Thanks,&lt;/p&gt;

&lt;p&gt;Yongqiang&lt;/p&gt;
</comment>
                            <comment id="13030069" author="nzhang" created="Fri, 6 May 2011 18:17:46 +0000"  >&lt;p&gt;We did an offline review and found a better fix. Yongqiang will upload a new patch soon. &lt;/p&gt;</comment>
                            <comment id="13030098" author="jiraposter@reviews.apache.org" created="Fri, 6 May 2011 19:18:03 +0000"  >
&lt;p&gt;-----------------------------------------------------------&lt;br/&gt;
This is an automatically generated e-mail. To reply, visit:&lt;br/&gt;
&lt;a href=&quot;https://reviews.apache.org/r/696/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/696/&lt;/a&gt;&lt;br/&gt;
-----------------------------------------------------------&lt;/p&gt;

&lt;p&gt;(Updated 2011-05-06 19:17:48.260294)&lt;/p&gt;


&lt;p&gt;Review request for hive.&lt;/p&gt;


&lt;p&gt;Changes&lt;br/&gt;
-------&lt;/p&gt;

&lt;p&gt;new diff&lt;/p&gt;


&lt;p&gt;Summary&lt;br/&gt;
-------&lt;/p&gt;

&lt;p&gt;Too many open files in running negative cli tests&lt;/p&gt;


&lt;p&gt;This addresses bug &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2151&quot; title=&quot;Too many open files in running negative cli tests&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-2151&quot;&gt;&lt;del&gt;HIVE-2151&lt;/del&gt;&lt;/a&gt;.&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2151&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/HIVE-2151&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;Diffs (updated)&lt;/p&gt;
&lt;hr /&gt;

&lt;p&gt;  trunk/ql/src/java/org/apache/hadoop/hive/ql/Driver.java 1100117 &lt;/p&gt;

&lt;p&gt;Diff: &lt;a href=&quot;https://reviews.apache.org/r/696/diff&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/696/diff&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;Testing&lt;br/&gt;
-------&lt;/p&gt;


&lt;p&gt;Thanks,&lt;/p&gt;

&lt;p&gt;Yongqiang&lt;/p&gt;
</comment>
                            <comment id="13030364" author="nzhang" created="Sat, 7 May 2011 15:32:26 +0000"  >&lt;p&gt;Can you update the review board with the latest patch? It&apos;s much easier to add comments.&lt;/p&gt;

&lt;p&gt;In ZooKeeperHiveLockManager.close(), I&apos;m not sure if the change is desired. According to the comment, it simply close the client to release transient locks. The later removeAllRedundantNodes() call may be needed after the client close to clean up further. So changing the order may results in undesired behavior. Namit, can you comment on this?&lt;/p&gt;

&lt;p&gt;Driver.java:148, add comments wht ctx needs to set HiveLockManager. &lt;/p&gt;</comment>
                            <comment id="13030384" author="he yongqiang" created="Sat, 7 May 2011 18:21:40 +0000"  >&lt;p&gt;removeAllRedundantNodes() leaks a zookeeper connection. it should be put before closing zookeeper instance because it is still using the zookeeper instance.&lt;/p&gt;</comment>
                            <comment id="13030819" author="jiraposter@reviews.apache.org" created="Mon, 9 May 2011 17:15:03 +0000"  >
&lt;p&gt;-----------------------------------------------------------&lt;br/&gt;
This is an automatically generated e-mail. To reply, visit:&lt;br/&gt;
&lt;a href=&quot;https://reviews.apache.org/r/696/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/696/&lt;/a&gt;&lt;br/&gt;
-----------------------------------------------------------&lt;/p&gt;

&lt;p&gt;(Updated 2011-05-09 17:15:15.221624)&lt;/p&gt;


&lt;p&gt;Review request for hive.&lt;/p&gt;


&lt;p&gt;Changes&lt;br/&gt;
-------&lt;/p&gt;

&lt;p&gt;reverted the change in ZooKeeperHiveLockManager&apos;s close, but put a zookeeper close in removeReduantNodes&lt;br/&gt;
added more comments in Driver.&lt;/p&gt;


&lt;p&gt;Summary&lt;br/&gt;
-------&lt;/p&gt;

&lt;p&gt;Too many open files in running negative cli tests&lt;/p&gt;


&lt;p&gt;This addresses bug &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2151&quot; title=&quot;Too many open files in running negative cli tests&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-2151&quot;&gt;&lt;del&gt;HIVE-2151&lt;/del&gt;&lt;/a&gt;.&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2151&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/HIVE-2151&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;Diffs (updated)&lt;/p&gt;
&lt;hr /&gt;

&lt;p&gt;  trunk/ql/src/java/org/apache/hadoop/hive/ql/Driver.java 1101116 &lt;br/&gt;
  trunk/ql/src/java/org/apache/hadoop/hive/ql/lockmgr/zookeeper/ZooKeeperHiveLockManager.java 1101116 &lt;/p&gt;

&lt;p&gt;Diff: &lt;a href=&quot;https://reviews.apache.org/r/696/diff&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/696/diff&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;Testing&lt;br/&gt;
-------&lt;/p&gt;


&lt;p&gt;Thanks,&lt;/p&gt;

&lt;p&gt;Yongqiang&lt;/p&gt;
</comment>
                            <comment id="13030820" author="he yongqiang" created="Mon, 9 May 2011 17:15:49 +0000"  >&lt;p&gt;Talked with namit offline, this new patch reverted the change in ZooKeeperHiveLockManager&apos;s close, but put a zookeeper close in removeReduantNodes.&lt;br/&gt;
Also added more comments in Driver to address Ning&apos;s last comments.&lt;/p&gt;</comment>
                            <comment id="13030877" author="nzhang" created="Mon, 9 May 2011 20:01:44 +0000"  >&lt;p&gt;+1. Will commit if tests pass&lt;/p&gt;</comment>
                            <comment id="13030962" author="nzhang" created="Mon, 9 May 2011 23:56:49 +0000"  >&lt;p&gt;Yongqiang, the TestClilDriver failed (index_auto.q, etc.). It seems the change is conflict with the recent bitmap index changes. Can you take a look? &lt;/p&gt;</comment>
                            <comment id="13030988" author="he yongqiang" created="Tue, 10 May 2011 02:14:15 +0000"  >&lt;p&gt;Ning, it seems the index_auto.q still fail without this patch. Can you verify?&lt;/p&gt;</comment>
                            <comment id="13030992" author="jvs" created="Tue, 10 May 2011 02:45:39 +0000"  >&lt;p&gt;It has been passing fine in Jenkins:&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://builds.apache.org/hudson/job/Hive-trunk-h0.20/717/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/hudson/job/Hive-trunk-h0.20/717/&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="13030997" author="he yongqiang" created="Tue, 10 May 2011 03:35:08 +0000"  >&lt;p&gt;i got a failure on a clean check out when running index_auto.q. But when i run again, the error is not there. And also after apply the patch, there is also no error. &lt;/p&gt;

&lt;p&gt;Ning, can you do a &apos;ant clean run&apos;?&lt;/p&gt;</comment>
                            <comment id="13031004" author="nzhang" created="Tue, 10 May 2011 04:21:00 +0000"  >&lt;p&gt;OK. I got why it failed. index_auto.q build index to /tmp/index_where. I had run the test before under root, which makes the owner of /tmp/index_where root. Running the same test using my own user will fail because of write permission. &lt;/p&gt;

&lt;p&gt;Going forward I think we should change all index building tests to make results under trunk/build/ rather than /tmp, so that ant clean will clean all side effects.&lt;/p&gt;</comment>
                            <comment id="13031008" author="he yongqiang" created="Tue, 10 May 2011 04:30:36 +0000"  >&lt;p&gt;Good catch, Ning! At least we should make sure the /tmp/xxx dir got removed at the end of the testcase, if making it use build/tmp/ is not easy to do. &lt;/p&gt;</comment>
                            <comment id="13031017" author="nzhang" created="Tue, 10 May 2011 05:01:02 +0000"  >&lt;p&gt;Yongqiang, you can reference the build directory using &apos;$&lt;/p&gt;
{system:build.dir.hive}
&lt;p&gt;&apos;, which is defined in build-common.xml. Can you open a JIRA and fix all such index tests? &lt;/p&gt;</comment>
                            <comment id="13031205" author="nzhang" created="Tue, 10 May 2011 14:31:27 +0000"  >&lt;p&gt;Committed. Thanks Yongqiang!&lt;/p&gt;</comment>
                            <comment id="13032616" author="hudson" created="Thu, 12 May 2011 19:40:22 +0000"  >&lt;p&gt;Integrated in Hive-trunk-h0.20 #726 (See &lt;a href=&quot;https://builds.apache.org/hudson/job/Hive-trunk-h0.20/726/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/hudson/job/Hive-trunk-h0.20/726/&lt;/a&gt;)&lt;/p&gt;
</comment>
                    </comments>
                    <attachments>
                            <attachment id="12478385" name="HIVE-2151.1.patch" size="1352" author="he yongqiang" created="Fri, 6 May 2011 07:48:43 +0000"/>
                            <attachment id="12478461" name="HIVE-2151.2.patch" size="1262" author="he yongqiang" created="Fri, 6 May 2011 19:16:21 +0000"/>
                            <attachment id="12478472" name="HIVE-2151.3.patch" size="3891" author="he yongqiang" created="Fri, 6 May 2011 21:29:12 +0000"/>
                            <attachment id="12478621" name="HIVE-2151.4.patch" size="4384" author="he yongqiang" created="Mon, 9 May 2011 17:13:29 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>4.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Fri, 6 May 2011 02:07:25 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>72549</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            5 years, 30 weeks, 1 day ago
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0linj:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>123672</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        </customfields>
    </item>
</channel>
</rss>