<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Sat Dec 03 22:37:13 UTC 2016

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/HIVE-7741/HIVE-7741.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[HIVE-7741] Don&apos;t synchronize WriterImpl.addRow() when dynamic.partition is enabled</title>
                <link>https://issues.apache.org/jira/browse/HIVE-7741</link>
                <project id="12310843" key="HIVE">Hive</project>
                    <description>&lt;p&gt;When loading into an un-paritioned ORC table WriterImpl$StructTreeWriter.write method is synchronized.&lt;/p&gt;

&lt;p&gt;When hive.optimize.sort.dynamic.partition is enabled the current thread will be the only writer and the synchronization is not needed.&lt;/p&gt;

&lt;p&gt;Also  checking for memory per row is an over kill , this can be done per 1K rows or such&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
  &lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; void addRow(&lt;span class=&quot;code-object&quot;&gt;Object&lt;/span&gt; row) &lt;span class=&quot;code-keyword&quot;&gt;throws&lt;/span&gt; IOException {
    &lt;span class=&quot;code-keyword&quot;&gt;synchronized&lt;/span&gt; (&lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt;) {
      treeWriter.write(row);
      rowsInStripe += 1;
      &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (buildIndex) {
        rowsInIndex += 1;

        &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (rowsInIndex &amp;gt;= rowIndexStride) {
          createRowIndexEntry();
        }
      }
    }
    memoryManager.addedRow();
  }
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;This can improve ORC load performance by 7% &lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
Stack Trace	Sample Count	Percentage(%)
WriterImpl.addRow(&lt;span class=&quot;code-object&quot;&gt;Object&lt;/span&gt;)	5,852	65.782
   WriterImpl$StructTreeWriter.write(&lt;span class=&quot;code-object&quot;&gt;Object&lt;/span&gt;)	5,163	58.037
   MemoryManager.addedRow()	666	7.487
      MemoryManager.notifyWriters()	648	7.284
         WriterImpl.checkMemory(&lt;span class=&quot;code-object&quot;&gt;double&lt;/span&gt;)	645	7.25
            WriterImpl.flushStripe()	643	7.228
               WriterImpl$StructTreeWriter.writeStripe(OrcProto$StripeFooter$Builder, &lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt;)	584	6.565
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;


</description>
                <environment>&lt;p&gt;Loading into orc&lt;/p&gt;</environment>
        <key id="12734492">HIVE-7741</key>
            <summary>Don&apos;t synchronize WriterImpl.addRow() when dynamic.partition is enabled</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/bug.png">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.png">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="3">Duplicate</resolution>
                                        <assignee username="prasanth_j">Prasanth Jayachandran</assignee>
                                    <reporter username="mmokhtar">Mostafa Mokhtar</reporter>
                        <labels>
                            <label>performance</label>
                    </labels>
                <created>Fri, 15 Aug 2014 19:00:19 +0000</created>
                <updated>Tue, 7 Jul 2015 22:22:40 +0000</updated>
                            <resolved>Tue, 7 Jul 2015 22:22:40 +0000</resolved>
                                    <version>0.13.1</version>
                                                    <component>File Formats</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>3</watches>
                                                                <comments>
                            <comment id="14617546" author="prasanth_j" created="Tue, 7 Jul 2015 22:22:40 +0000"  >&lt;p&gt;Fixed by &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-10191&quot; title=&quot;ORC: Cleanup writer per-row synchronization&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-10191&quot;&gt;&lt;del&gt;HIVE-10191&lt;/del&gt;&lt;/a&gt;.&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                                                <inwardlinks description="is related to">
                                        <issuelink>
            <issuekey id="12787591">HIVE-10191</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Tue, 7 Jul 2015 22:22:40 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>412432</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            1 year, 21 weeks, 4 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i1yy8v:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>412419</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        </customfields>
    </item>
</channel>
</rss>