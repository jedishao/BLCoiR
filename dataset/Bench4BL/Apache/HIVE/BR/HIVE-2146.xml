<!-- 
RSS generated by JIRA (6.3.4#6332-sha1:51bc225ef474afe3128b2f66878477f322397b16) at Sat Dec 03 01:02:19 UTC 2016

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.apache.org/jira/si/jira.issueviews:issue-xml/HIVE-2146/HIVE-2146.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.3.4</version>
        <build-number>6332</build-number>
        <build-date>15-08-2014</build-date>
    </build-info>

<item>
            <title>[HIVE-2146] Block Sampling should adjust number of reducers accordingly to make it useful</title>
                <link>https://issues.apache.org/jira/browse/HIVE-2146</link>
                <project id="12310843" key="HIVE">Hive</project>
                    <description>&lt;p&gt;Now number of reducers of block sampling is not modified, so that queries like:&lt;br/&gt;
select c from tab tablesample(1 percent) group by c;&lt;br/&gt;
can generate huge number of reducers although the input is sampled to be small.&lt;br/&gt;
We need to shrink number of reducers to make block sampling more useful.&lt;br/&gt;
Since now number of reducers are determined before get splits, the way to do it probably is not clean enough, but we can do a good guess.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12506004">HIVE-2146</key>
            <summary>Block Sampling should adjust number of reducers accordingly to make it useful</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/images/icons/issuetypes/bug.png">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.png">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="sdong">Siying Dong</assignee>
                                    <reporter username="sdong">Siying Dong</reporter>
                        <labels>
                    </labels>
                <created>Tue, 3 May 2011 01:26:41 +0000</created>
                <updated>Fri, 16 Dec 2011 23:56:05 +0000</updated>
                            <resolved>Wed, 4 May 2011 19:07:58 +0000</resolved>
                                                    <fixVersion>0.8.0</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                <comments>
                            <comment id="13028532" author="nzhang" created="Wed, 4 May 2011 00:45:05 +0000"  >&lt;p&gt;Siying can you create a review request? &lt;/p&gt;

&lt;p&gt;I&apos;ve a couple of comments as well: &lt;br/&gt;
 1) comment in line 387 is not complete&lt;br/&gt;
 2) comments in line 388-389: can you give an example in which case all input alias are sampled by syntax but it actually cannot be sampled?&lt;br/&gt;
 3) line 391: if we want to mimic the old estimation algorithm it seems we shouldn&apos;t + bytesPerReducer here? It is added in line 399 right?  &lt;/p&gt;</comment>
                            <comment id="13028556" author="sdong" created="Wed, 4 May 2011 01:57:01 +0000"  >&lt;p&gt;for 2) the possibility that it can&apos;t be sampled is more likely to be the case that CombineHiveInputformat.getSplits() finally calls super.getSplits() for some reasons. In those cases, the data are not sampled at all. &lt;br/&gt;
Another possible is that, for example, two alias of the MapReduce job include the same directory. We can&apos;t sample it then.&lt;/p&gt;

&lt;p&gt;For 1) and 3), I think about it more. I&apos;ll remove the extra bytesPerReducer added. The worst case is that we run one less reducer. Shouldn&apos;t be so bad.&lt;/p&gt;</comment>
                            <comment id="13028563" author="sdong" created="Wed, 4 May 2011 02:15:50 +0000"  >&lt;p&gt;review board:&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://reviews.apache.org/r/685/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/685/&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="13028564" author="jiraposter@reviews.apache.org" created="Wed, 4 May 2011 02:16:03 +0000"  >
&lt;p&gt;-----------------------------------------------------------&lt;br/&gt;
This is an automatically generated e-mail. To reply, visit:&lt;br/&gt;
&lt;a href=&quot;https://reviews.apache.org/r/685/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/685/&lt;/a&gt;&lt;br/&gt;
-----------------------------------------------------------&lt;/p&gt;

&lt;p&gt;Review request for hive, Ning Zhang and namit jain.&lt;/p&gt;


&lt;p&gt;Summary&lt;br/&gt;
-------&lt;/p&gt;

&lt;p&gt;Now number of reducers of block sampling is not modified, so that queries like:&lt;br/&gt;
select c from tab tablesample(1 percent) group by c;&lt;br/&gt;
can generate huge number of reducers although the input is sampled to be small.&lt;br/&gt;
We need to shrink number of reducers to make block sampling more useful.&lt;br/&gt;
Since now number of reducers are determined before get splits, the way to do it probably is not clean enough, but we can do a good guess.&lt;/p&gt;


&lt;p&gt;This addresses bug &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2146&quot; title=&quot;Block Sampling should adjust number of reducers accordingly to make it useful&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HIVE-2146&quot;&gt;&lt;del&gt;HIVE-2146&lt;/del&gt;&lt;/a&gt;.&lt;br/&gt;
    &lt;a href=&quot;https://issues.apache.org/jira/browse/HIVE-2146&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/HIVE-2146&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;Diffs&lt;/p&gt;
&lt;hr /&gt;

&lt;p&gt;  trunk/ql/src/java/org/apache/hadoop/hive/ql/exec/MapRedTask.java 1098885 &lt;/p&gt;

&lt;p&gt;Diff: &lt;a href=&quot;https://reviews.apache.org/r/685/diff&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://reviews.apache.org/r/685/diff&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;Testing&lt;br/&gt;
-------&lt;/p&gt;


&lt;p&gt;Thanks,&lt;/p&gt;

&lt;p&gt;Siying&lt;/p&gt;
</comment>
                            <comment id="13028624" author="nzhang" created="Wed, 4 May 2011 06:11:00 +0000"  >&lt;p&gt;+1. Will commit if tests pass.&lt;/p&gt;</comment>
                            <comment id="13028899" author="nzhang" created="Wed, 4 May 2011 19:07:58 +0000"  >&lt;p&gt;Committed. Thanks Siying!&lt;/p&gt;</comment>
                            <comment id="13029816" author="hudson" created="Fri, 6 May 2011 07:59:29 +0000"  >&lt;p&gt;Integrated in Hive-trunk-h0.20 #712 (See &lt;a href=&quot;https://builds.apache.org/hudson/job/Hive-trunk-h0.20/712/&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://builds.apache.org/hudson/job/Hive-trunk-h0.20/712/&lt;/a&gt;)&lt;/p&gt;
</comment>
                    </comments>
                    <attachments>
                            <attachment id="12478013" name="HIVE-2146.1.patch" size="1866" author="sdong" created="Tue, 3 May 2011 01:31:26 +0000"/>
                            <attachment id="12478119" name="HIVE-2146.2.patch" size="1904" author="sdong" created="Wed, 4 May 2011 02:07:17 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310220" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>Date of First Response</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Wed, 4 May 2011 00:45:05 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>72550</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310191" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                        <customfieldname>Hadoop Flags</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10343"><![CDATA[Reviewed]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            5 years, 31 weeks ago
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0limf:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>123667</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310222" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        </customfields>
    </item>
</channel>
</rss>