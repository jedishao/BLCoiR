<!-- 
RSS generated by JIRA (7.2.3#72005-sha1:73be91d2b96fc29303a7eb6820acf420e5d0ed65) at Tue Dec 06 21:49:11 EST 2016

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.jboss.org/si/jira.issueviews:issue-xml/ENTESB-1937/ENTESB-1937.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>JBoss Issue Tracker</title>
    <link>https://issues.jboss.org</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-us</language>    <build-info>
        <version>7.2.3</version>
        <build-number>72005</build-number>
        <build-date>06-10-2016</build-date>
    </build-info>

<item>
            <title>[ENTESB-1937] patching turns example-mq into a hanged state</title>
                <link>https://issues.jboss.org/browse/ENTESB-1937</link>
                <project id="12314570" key="ENTESB">JBoss Fuse</project>
                    <description>&lt;p&gt;Attempting to patch with the testing patch (test-ose-patch-6.1.0.redhat-901.zip)  breaks a running example-mq. The container appears to be hanged, only logging&lt;/p&gt;

&lt;p/&gt;
&lt;div id=&quot;syntaxplugin&quot; class=&quot;syntaxplugin&quot; style=&quot;border: 1px dashed #bbb; border-radius: 5px !important; overflow: auto; max-height: 30em;&quot;&gt;
&lt;table cellspacing=&quot;0&quot; cellpadding=&quot;0&quot; border=&quot;0&quot; width=&quot;100%&quot; style=&quot;font-size: 1em; line-height: 1.4em !important; font-weight: normal; font-style: normal; color: black;&quot;&gt;
		&lt;tbody &gt;
				&lt;tr id=&quot;syntaxplugin_code_and_gutter&quot;&gt;
						&lt;td  style=&quot; line-height: 1.4em !important; padding: 0em; vertical-align: top;&quot;&gt;
					&lt;pre style=&quot;font-size: 1em; margin: 0 10px;  margin-top: 10px;   width: auto; padding: 0;&quot;&gt;&lt;span style=&quot;color: black; font-family: &apos;Consolas&apos;, &apos;Bitstream Vera Sans Mono&apos;, &apos;Courier New&apos;, Courier, monospace !important;&quot;&gt;2014-09-11 07:56:44,636 | WARN  | ActiveMQ Task-3  | FailoverTransport                | sport.failover.FailoverTransport 1119 | 264 - org.apache.activemq.activemq-osgi - 5.9.0.redhat-610901 | Failed to connect to [tcp://fuse2-foobar.apps.sample.com:60313] after: 20 attempt(s) continuing to retry.&lt;/span&gt;&lt;/pre&gt;
			&lt;/td&gt;
		&lt;/tr&gt;
				&lt;tr id=&quot;syntaxplugin_code_and_gutter&quot;&gt;
						&lt;td  style=&quot; line-height: 1.4em !important; padding: 0em; vertical-align: top;&quot;&gt;
					&lt;pre style=&quot;font-size: 1em; margin: 0 10px;   margin-bottom: 10px;  width: auto; padding: 0;&quot;&gt;&lt;span style=&quot;color: black; font-family: &apos;Consolas&apos;, &apos;Bitstream Vera Sans Mono&apos;, &apos;Courier New&apos;, Courier, monospace !important;&quot;&gt;2014-09-11 08:06:44,651 | WARN  | ActiveMQ Task-3  | FailoverTransport                | sport.failover.FailoverTransport 1119 | 264 - org.apache.activemq.activemq-osgi - 5.9.0.redhat-610901 | Failed to connect to [tcp://fuse2-foobar.apps.sample.com:60313] after: 30 attempt(s) continuing to retry.&lt;/span&gt;&lt;/pre&gt;
			&lt;/td&gt;
		&lt;/tr&gt;
			&lt;/tbody&gt;
&lt;/table&gt;
&lt;/div&gt;
&lt;p/&gt;

&lt;p&gt;even though the mentioned mq container ( fuse2-foobar.apps.sample.com:60313 ) appears to be alive and well.&lt;/p&gt;

&lt;p&gt;Note that this issue looks unrelated to &lt;a href=&quot;https://issues.jboss.org/browse/ENTESB-1343&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.jboss.org/browse/ENTESB-1343&lt;/a&gt; as in this case the container does not eventually come back to life and also the jstack suggests the condition is activemq-specific.&lt;/p&gt;</description>
                <environment>&lt;p&gt;OSE, builds 390-4, 390-5&lt;/p&gt;</environment>
        <key id="12551835">ENTESB-1937</key>
            <summary>patching turns example-mq into a hanged state</summary>
                <type id="1" iconUrl="https://issues.jboss.org/secure/viewavatar?size=xsmall&amp;avatarId=13263&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.jboss.org/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.jboss.org/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="3">Duplicate Issue</resolution>
                                        <assignee username="janstey">Jonathan Anstey</assignee>
                                    <reporter username="maschmid">Marek Schmidt</reporter>
                        <labels>
                    </labels>
                <created>Thu, 11 Sep 2014 08:14:46 -0400</created>
                <updated>Tue, 30 Jun 2015 10:23:35 -0400</updated>
                            <resolved>Thu, 16 Apr 2015 13:15:27 -0400</resolved>
                                    <version>jboss-fuse-6.1 on OSE</version>
                                    <fixVersion> jboss-fuse-6.2</fixVersion>
                                    <component>OpenShift</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>6</watches>
                                                                                                            <comments>
                            <comment id="13001353" author="maschmid" created="Thu, 11 Sep 2014 08:22:12 -0400"  >&lt;p&gt;After the patch has been applied, the same condition can be triggered by editing the patch/test/ose/patch/901.profile/io.fabric8.agent.properties (e.g. commenting in / out the mvn overrides) , so this doesn&apos;t seem to be specific to patching per se. The problem probably occurs when the connection is lost and at the same time the container is to be restarted (and is thus triggered by the patching process, as that causes exactly such condition)&lt;/p&gt;</comment>
                            <comment id="13001354" author="maschmid" created="Thu, 11 Sep 2014 08:24:21 -0400"  >&lt;p&gt;Also note that this issue is not specific to an example-mq. I have originally reproduced it with my custom camel/cxf/mq test application, the use of example-mq just make it easier to reproduce.&lt;/p&gt;</comment>
                            <comment id="13003602" author="janstey" created="Wed, 17 Sep 2014 14:01:15 -0400"  >&lt;p&gt;Fixed with &lt;br/&gt;
&lt;a href=&quot;https://github.com/jboss-fuse/fuse-openshift-cartridge/commit/ed1d68a6198b12ad436fc6633282d2a15850e83a&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://github.com/jboss-fuse/fuse-openshift-cartridge/commit/ed1d68a6198b12ad436fc6633282d2a15850e83a&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;The commit adds logic to detect if fabric did not provision after a patch had been applied, in which case the container is restarted.&lt;/p&gt;

&lt;p&gt;Will be available in the next RPM build (396-2 most likely).&lt;/p&gt;</comment>
                            <comment id="13003616" author="janstey" created="Wed, 17 Sep 2014 15:00:54 -0400"  >&lt;p&gt;I&apos;m uploading some dev RPMs to test out this fix now. Will be available later today at:&lt;/p&gt;

&lt;p&gt;Without patch - &lt;a href=&quot;https://repository.jboss.org/nexus/content/groups/ea/org/jboss/fuse/openshift-origin-cartridge-fuse/6.1.0.redhat.396-901/openshift-origin-cartridge-fuse-6.1.0.redhat.396-901-fc18.noarch.rpm&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://repository.jboss.org/nexus/content/groups/ea/org/jboss/fuse/openshift-origin-cartridge-fuse/6.1.0.redhat.396-901/openshift-origin-cartridge-fuse-6.1.0.redhat.396-901-fc18.noarch.rpm&lt;/a&gt;&lt;br/&gt;
With patch - &lt;a href=&quot;https://repository.jboss.org/nexus/content/groups/ea/org/jboss/fuse/openshift-origin-cartridge-fuse/6.1.0.redhat.396-902/openshift-origin-cartridge-fuse-6.1.0.redhat.396-902-fc18.noarch.rpm&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://repository.jboss.org/nexus/content/groups/ea/org/jboss/fuse/openshift-origin-cartridge-fuse/6.1.0.redhat.396-902/openshift-origin-cartridge-fuse-6.1.0.redhat.396-902-fc18.noarch.rpm&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="13005567" author="maschmid" created="Wed, 24 Sep 2014 01:59:56 -0400"  >&lt;p&gt;It seems that the restart didn&apos;t succeed.&lt;/p&gt;

&lt;p&gt;I can see the following in the /var/log/openshift/node/platform-trace.log:&lt;/p&gt;

&lt;p/&gt;
&lt;div id=&quot;syntaxplugin&quot; class=&quot;syntaxplugin&quot; style=&quot;border: 1px dashed #bbb; border-radius: 5px !important; overflow: auto; max-height: 30em;&quot;&gt;
&lt;table cellspacing=&quot;0&quot; cellpadding=&quot;0&quot; border=&quot;0&quot; width=&quot;100%&quot; style=&quot;font-size: 1em; line-height: 1.4em !important; font-weight: normal; font-style: normal; color: black;&quot;&gt;
		&lt;tbody &gt;
				&lt;tr id=&quot;syntaxplugin_code_and_gutter&quot;&gt;
						&lt;td  style=&quot; line-height: 1.4em !important; padding: 0em; vertical-align: top;&quot;&gt;
					&lt;pre style=&quot;font-size: 1em; margin: 0 10px;  margin-top: 10px;   width: auto; padding: 0;&quot;&gt;&lt;span style=&quot;color: black; font-family: &apos;Consolas&apos;, &apos;Bitstream Vera Sans Mono&apos;, &apos;Courier New&apos;, Courier, monospace !important;&quot;&gt;September 23 10:59:03 INFO oo_spawn running /bin/cp -ad /var/lib/openshift/.cartridge_repository/redhat-fuse/0.0.2/bin /var/lib/openshift/.cartridge_repository/redhat-fuse/0.0.2/template /var/lib/openshift/.cartridge_repository/redhat-fuse/0.0.2/COPYRIGHT /var/lib/openshift/.cartridge_repository/redhat-fuse/0.0.2/versions /var/lib/openshift/.cartridge_repository/redhat-fuse/0.0.2/README.md /var/lib/openshift/.cartridge_repository/redhat-fuse/0.0.2/patches /var/lib/openshift/.cartridge_repository/redhat-fuse/0.0.2/metadata /var/lib/openshift/.cartridge_repository/redhat-fuse/0.0.2/LICENSE /var/lib/openshift/.cartridge_repository/redhat-fuse/0.0.2/env /var/lib/openshift/.cartridge_repository/redhat-fuse/0.0.2/openshift-origin-cartridge.spec /var/lib/openshift/542185568db2275123000063/fuse: {:unsetenv_others=&amp;gt;false, :close_others=&amp;gt;true, :in=&amp;gt;&quot;/dev/null&quot;, :out=&amp;gt;#&amp;lt;IO:fd 12&amp;gt;, :err=&amp;gt;#&amp;lt;IO:fd 8&amp;gt;}&lt;/span&gt;&lt;/pre&gt;
			&lt;/td&gt;
		&lt;/tr&gt;
				&lt;tr id=&quot;syntaxplugin_code_and_gutter&quot;&gt;
						&lt;td  style=&quot; line-height: 1.4em !important; padding: 0em; vertical-align: top;&quot;&gt;
					&lt;pre style=&quot;font-size: 1em; margin: 0 10px;   width: auto; padding: 0;&quot;&gt;&lt;span style=&quot;color: black; font-family: &apos;Consolas&apos;, &apos;Bitstream Vera Sans Mono&apos;, &apos;Courier New&apos;, Courier, monospace !important;&quot;&gt;September 23 10:59:07 INFO oo_spawn running /sbin/runuser -s /bin/sh 542185568db2275123000063 -c &quot;exec /usr/bin/runcon &apos;unconfined_u:system_r:openshift_t:s0:c3,c725&apos; /bin/sh -c \&quot;/var/lib/openshift/542185568db2275123000063/fuse/bin/upgrade 1.0.0 0.0.1 0.0.2\&quot;&quot;: {:unsetenv_others=&amp;gt;false, :close_others=&amp;gt;true, :in=&amp;gt;&quot;/dev/null&quot;, :chdir=&amp;gt;&quot;/var/lib/openshift/542185568db2275123000063/fuse&quot;, :out=&amp;gt;#&amp;lt;IO:fd 12&amp;gt;, :err=&amp;gt;#&amp;lt;IO:fd 8&amp;gt;}&lt;/span&gt;&lt;/pre&gt;
			&lt;/td&gt;
		&lt;/tr&gt;
				&lt;tr id=&quot;syntaxplugin_code_and_gutter&quot;&gt;
						&lt;td  style=&quot; line-height: 1.4em !important; padding: 0em; vertical-align: top;&quot;&gt;
					&lt;pre style=&quot;font-size: 1em; margin: 0 10px;   width: auto; padding: 0;&quot;&gt;&lt;span style=&quot;color: black; font-family: &apos;Consolas&apos;, &apos;Bitstream Vera Sans Mono&apos;, &apos;Courier New&apos;, Courier, monospace !important;&quot;&gt;September 23 10:59:07 INFO oo_spawn buffer(11/) CLIENT_MESSAGE: Waiting for container to be provisioned...&lt;/span&gt;&lt;/pre&gt;
			&lt;/td&gt;
		&lt;/tr&gt;
				&lt;tr id=&quot;syntaxplugin_code_and_gutter&quot;&gt;
						&lt;td  style=&quot; line-height: 1.4em !important; padding: 0em; vertical-align: top;&quot;&gt;
					&lt;pre style=&quot;font-size: 1em; margin: 0 10px;   width: auto; padding: 0;&quot;&gt;&amp;nbsp;&lt;/pre&gt;
			&lt;/td&gt;
		&lt;/tr&gt;
				&lt;tr id=&quot;syntaxplugin_code_and_gutter&quot;&gt;
						&lt;td  style=&quot; line-height: 1.4em !important; padding: 0em; vertical-align: top;&quot;&gt;
					&lt;pre style=&quot;font-size: 1em; margin: 0 10px;   width: auto; padding: 0;&quot;&gt;&lt;span style=&quot;color: black; font-family: &apos;Consolas&apos;, &apos;Bitstream Vera Sans Mono&apos;, &apos;Courier New&apos;, Courier, monospace !important;&quot;&gt;September 23 10:59:07 INFO oo_spawn buffer(11/) client: JAVA_HOME not set; results may vary&lt;/span&gt;&lt;/pre&gt;
			&lt;/td&gt;
		&lt;/tr&gt;
				&lt;tr id=&quot;syntaxplugin_code_and_gutter&quot;&gt;
						&lt;td  style=&quot; line-height: 1.4em !important; padding: 0em; vertical-align: top;&quot;&gt;
					&lt;pre style=&quot;font-size: 1em; margin: 0 10px;   width: auto; padding: 0;&quot;&gt;&amp;nbsp;&lt;/pre&gt;
			&lt;/td&gt;
		&lt;/tr&gt;
				&lt;tr id=&quot;syntaxplugin_code_and_gutter&quot;&gt;
						&lt;td  style=&quot; line-height: 1.4em !important; padding: 0em; vertical-align: top;&quot;&gt;
					&lt;pre style=&quot;font-size: 1em; margin: 0 10px;   width: auto; padding: 0;&quot;&gt;&lt;span style=&quot;color: black; font-family: &apos;Consolas&apos;, &apos;Bitstream Vera Sans Mono&apos;, &apos;Courier New&apos;, Courier, monospace !important;&quot;&gt;September 23 10:59:08 INFO oo_spawn buffer(7/) 587 [pool-2-thread-2] WARN org.apache.sshd.client.keyverifier.AcceptAllServerKeyVerifier - Server at [/127.7.102.1:23101, DSA, ac:86:37:ae:3e:4a:9c:d2:c5:22:93:d2:c0:38:a4:ad] presented unverified {} key: {}&lt;/span&gt;&lt;/pre&gt;
			&lt;/td&gt;
		&lt;/tr&gt;
				&lt;tr id=&quot;syntaxplugin_code_and_gutter&quot;&gt;
						&lt;td  style=&quot; line-height: 1.4em !important; padding: 0em; vertical-align: top;&quot;&gt;
					&lt;pre style=&quot;font-size: 1em; margin: 0 10px;   width: auto; padding: 0;&quot;&gt;&amp;nbsp;&lt;/pre&gt;
			&lt;/td&gt;
		&lt;/tr&gt;
				&lt;tr id=&quot;syntaxplugin_code_and_gutter&quot;&gt;
						&lt;td  style=&quot; line-height: 1.4em !important; padding: 0em; vertical-align: top;&quot;&gt;
					&lt;pre style=&quot;font-size: 1em; margin: 0 10px;   width: auto; padding: 0;&quot;&gt;&lt;span style=&quot;color: black; font-family: &apos;Consolas&apos;, &apos;Bitstream Vera Sans Mono&apos;, &apos;Courier New&apos;, Courier, monospace !important;&quot;&gt;September 23 10:59:09 INFO oo_spawn buffer(11/) true&lt;/span&gt;&lt;/pre&gt;
			&lt;/td&gt;
		&lt;/tr&gt;
				&lt;tr id=&quot;syntaxplugin_code_and_gutter&quot;&gt;
						&lt;td  style=&quot; line-height: 1.4em !important; padding: 0em; vertical-align: top;&quot;&gt;
					&lt;pre style=&quot;font-size: 1em; margin: 0 10px;   width: auto; padding: 0;&quot;&gt;&amp;nbsp;&lt;/pre&gt;
			&lt;/td&gt;
		&lt;/tr&gt;
				&lt;tr id=&quot;syntaxplugin_code_and_gutter&quot;&gt;
						&lt;td  style=&quot; line-height: 1.4em !important; padding: 0em; vertical-align: top;&quot;&gt;
					&lt;pre style=&quot;font-size: 1em; margin: 0 10px;   width: auto; padding: 0;&quot;&gt;&lt;span style=&quot;color: black; font-family: &apos;Consolas&apos;, &apos;Bitstream Vera Sans Mono&apos;, &apos;Courier New&apos;, Courier, monospace !important;&quot;&gt;September 23 10:59:09 INFO oo_spawn buffer(11/) client: JAVA_HOME not set; results may vary&lt;/span&gt;&lt;/pre&gt;
			&lt;/td&gt;
		&lt;/tr&gt;
				&lt;tr id=&quot;syntaxplugin_code_and_gutter&quot;&gt;
						&lt;td  style=&quot; line-height: 1.4em !important; padding: 0em; vertical-align: top;&quot;&gt;
					&lt;pre style=&quot;font-size: 1em; margin: 0 10px;   width: auto; padding: 0;&quot;&gt;&amp;nbsp;&lt;/pre&gt;
			&lt;/td&gt;
		&lt;/tr&gt;
				&lt;tr id=&quot;syntaxplugin_code_and_gutter&quot;&gt;
						&lt;td  style=&quot; line-height: 1.4em !important; padding: 0em; vertical-align: top;&quot;&gt;
					&lt;pre style=&quot;font-size: 1em; margin: 0 10px;   width: auto; padding: 0;&quot;&gt;&lt;span style=&quot;color: black; font-family: &apos;Consolas&apos;, &apos;Bitstream Vera Sans Mono&apos;, &apos;Courier New&apos;, Courier, monospace !important;&quot;&gt;September 23 10:59:10 INFO oo_spawn buffer(7/) 612 [pool-2-thread-2] WARN org.apache.sshd.client.keyverifier.AcceptAllServerKeyVerifier - Server at [/127.7.102.1:23101, DSA, ac:86:37:ae:3e:4a:9c:d2:c5:22:93:d2:c0:38:a4:ad] presented unverified {} key: {}&lt;/span&gt;&lt;/pre&gt;
			&lt;/td&gt;
		&lt;/tr&gt;
				&lt;tr id=&quot;syntaxplugin_code_and_gutter&quot;&gt;
						&lt;td  style=&quot; line-height: 1.4em !important; padding: 0em; vertical-align: top;&quot;&gt;
					&lt;pre style=&quot;font-size: 1em; margin: 0 10px;   width: auto; padding: 0;&quot;&gt;&amp;nbsp;&lt;/pre&gt;
			&lt;/td&gt;
		&lt;/tr&gt;
				&lt;tr id=&quot;syntaxplugin_code_and_gutter&quot;&gt;
						&lt;td  style=&quot; line-height: 1.4em !important; padding: 0em; vertical-align: top;&quot;&gt;
					&lt;pre style=&quot;font-size: 1em; margin: 0 10px;   width: auto; padding: 0;&quot;&gt;&lt;span style=&quot;color: black; font-family: &apos;Consolas&apos;, &apos;Bitstream Vera Sans Mono&apos;, &apos;Courier New&apos;, Courier, monospace !important;&quot;&gt;September 23 10:59:10 INFO oo_spawn buffer(11/) SUCCESS&lt;/span&gt;&lt;/pre&gt;
			&lt;/td&gt;
		&lt;/tr&gt;
				&lt;tr id=&quot;syntaxplugin_code_and_gutter&quot;&gt;
						&lt;td  style=&quot; line-height: 1.4em !important; padding: 0em; vertical-align: top;&quot;&gt;
					&lt;pre style=&quot;font-size: 1em; margin: 0 10px;   width: auto; padding: 0;&quot;&gt;&amp;nbsp;&lt;/pre&gt;
			&lt;/td&gt;
		&lt;/tr&gt;
				&lt;tr id=&quot;syntaxplugin_code_and_gutter&quot;&gt;
						&lt;td  style=&quot; line-height: 1.4em !important; padding: 0em; vertical-align: top;&quot;&gt;
					&lt;pre style=&quot;font-size: 1em; margin: 0 10px;   width: auto; padding: 0;&quot;&gt;&lt;span style=&quot;color: black; font-family: &apos;Consolas&apos;, &apos;Bitstream Vera Sans Mono&apos;, &apos;Courier New&apos;, Courier, monospace !important;&quot;&gt;September 23 10:59:10 INFO oo_spawn buffer(11/) client: JAVA_HOME not set; results may vary&lt;/span&gt;&lt;/pre&gt;
			&lt;/td&gt;
		&lt;/tr&gt;
				&lt;tr id=&quot;syntaxplugin_code_and_gutter&quot;&gt;
						&lt;td  style=&quot; line-height: 1.4em !important; padding: 0em; vertical-align: top;&quot;&gt;
					&lt;pre style=&quot;font-size: 1em; margin: 0 10px;   width: auto; padding: 0;&quot;&gt;&amp;nbsp;&lt;/pre&gt;
			&lt;/td&gt;
		&lt;/tr&gt;
				&lt;tr id=&quot;syntaxplugin_code_and_gutter&quot;&gt;
						&lt;td  style=&quot; line-height: 1.4em !important; padding: 0em; vertical-align: top;&quot;&gt;
					&lt;pre style=&quot;font-size: 1em; margin: 0 10px;   width: auto; padding: 0;&quot;&gt;&lt;span style=&quot;color: black; font-family: &apos;Consolas&apos;, &apos;Bitstream Vera Sans Mono&apos;, &apos;Courier New&apos;, Courier, monospace !important;&quot;&gt;September 23 10:59:11 INFO oo_spawn buffer(7/) 735 [pool-2-thread-2] WARN org.apache.sshd.client.keyverifier.AcceptAllServerKeyVerifier - Server at [/127.7.102.1:23101, DSA, ac:86:37:ae:3e:4a:9c:d2:c5:22:93:d2:c0:38:a4:ad] presented unverified {} key: {}&lt;/span&gt;&lt;/pre&gt;
			&lt;/td&gt;
		&lt;/tr&gt;
				&lt;tr id=&quot;syntaxplugin_code_and_gutter&quot;&gt;
						&lt;td  style=&quot; line-height: 1.4em !important; padding: 0em; vertical-align: top;&quot;&gt;
					&lt;pre style=&quot;font-size: 1em; margin: 0 10px;   width: auto; padding: 0;&quot;&gt;&amp;nbsp;&lt;/pre&gt;
			&lt;/td&gt;
		&lt;/tr&gt;
				&lt;tr id=&quot;syntaxplugin_code_and_gutter&quot;&gt;
						&lt;td  style=&quot; line-height: 1.4em !important; padding: 0em; vertical-align: top;&quot;&gt;
					&lt;pre style=&quot;font-size: 1em; margin: 0 10px;   width: auto; padding: 0;&quot;&gt;&lt;span style=&quot;color: black; font-family: &apos;Consolas&apos;, &apos;Bitstream Vera Sans Mono&apos;, &apos;Courier New&apos;, Courier, monospace !important;&quot;&gt;September 23 10:59:12 INFO oo_spawn buffer(11/) true&lt;/span&gt;&lt;/pre&gt;
			&lt;/td&gt;
		&lt;/tr&gt;
				&lt;tr id=&quot;syntaxplugin_code_and_gutter&quot;&gt;
						&lt;td  style=&quot; line-height: 1.4em !important; padding: 0em; vertical-align: top;&quot;&gt;
					&lt;pre style=&quot;font-size: 1em; margin: 0 10px;   width: auto; padding: 0;&quot;&gt;&amp;nbsp;&lt;/pre&gt;
			&lt;/td&gt;
		&lt;/tr&gt;
				&lt;tr id=&quot;syntaxplugin_code_and_gutter&quot;&gt;
						&lt;td  style=&quot; line-height: 1.4em !important; padding: 0em; vertical-align: top;&quot;&gt;
					&lt;pre style=&quot;font-size: 1em; margin: 0 10px;   width: auto; padding: 0;&quot;&gt;&lt;span style=&quot;color: black; font-family: &apos;Consolas&apos;, &apos;Bitstream Vera Sans Mono&apos;, &apos;Courier New&apos;, Courier, monospace !important;&quot;&gt;September 23 10:59:12 INFO oo_spawn buffer(11/) CLIENT_MESSAGE: Patching all profile versions with /var/lib/openshift/542185568db2275123000063/fuse//patches/test-ose-patch-6.1.0.redhat-902.zip&lt;/span&gt;&lt;/pre&gt;
			&lt;/td&gt;
		&lt;/tr&gt;
				&lt;tr id=&quot;syntaxplugin_code_and_gutter&quot;&gt;
						&lt;td  style=&quot; line-height: 1.4em !important; padding: 0em; vertical-align: top;&quot;&gt;
					&lt;pre style=&quot;font-size: 1em; margin: 0 10px;   width: auto; padding: 0;&quot;&gt;&amp;nbsp;&lt;/pre&gt;
			&lt;/td&gt;
		&lt;/tr&gt;
				&lt;tr id=&quot;syntaxplugin_code_and_gutter&quot;&gt;
						&lt;td  style=&quot; line-height: 1.4em !important; padding: 0em; vertical-align: top;&quot;&gt;
					&lt;pre style=&quot;font-size: 1em; margin: 0 10px;   width: auto; padding: 0;&quot;&gt;&lt;span style=&quot;color: black; font-family: &apos;Consolas&apos;, &apos;Bitstream Vera Sans Mono&apos;, &apos;Courier New&apos;, Courier, monospace !important;&quot;&gt;September 23 10:59:12 INFO oo_spawn buffer(11/) client: JAVA_HOME not set; results may vary&lt;/span&gt;&lt;/pre&gt;
			&lt;/td&gt;
		&lt;/tr&gt;
				&lt;tr id=&quot;syntaxplugin_code_and_gutter&quot;&gt;
						&lt;td  style=&quot; line-height: 1.4em !important; padding: 0em; vertical-align: top;&quot;&gt;
					&lt;pre style=&quot;font-size: 1em; margin: 0 10px;   width: auto; padding: 0;&quot;&gt;&amp;nbsp;&lt;/pre&gt;
			&lt;/td&gt;
		&lt;/tr&gt;
				&lt;tr id=&quot;syntaxplugin_code_and_gutter&quot;&gt;
						&lt;td  style=&quot; line-height: 1.4em !important; padding: 0em; vertical-align: top;&quot;&gt;
					&lt;pre style=&quot;font-size: 1em; margin: 0 10px;   width: auto; padding: 0;&quot;&gt;&lt;span style=&quot;color: black; font-family: &apos;Consolas&apos;, &apos;Bitstream Vera Sans Mono&apos;, &apos;Courier New&apos;, Courier, monospace !important;&quot;&gt;September 23 10:59:13 INFO oo_spawn buffer(7/) 1042 [pool-2-thread-2] WARN org.apache.sshd.client.keyverifier.AcceptAllServerKeyVerifier - Server at [/127.7.102.1:23101, DSA, ac:86:37:ae:3e:4a:9c:d2:c5:22:93:d2:c0:38:a4:ad] presented unverified {} key: {}&lt;/span&gt;&lt;/pre&gt;
			&lt;/td&gt;
		&lt;/tr&gt;
				&lt;tr id=&quot;syntaxplugin_code_and_gutter&quot;&gt;
						&lt;td  style=&quot; line-height: 1.4em !important; padding: 0em; vertical-align: top;&quot;&gt;
					&lt;pre style=&quot;font-size: 1em; margin: 0 10px;   width: auto; padding: 0;&quot;&gt;&amp;nbsp;&lt;/pre&gt;
			&lt;/td&gt;
		&lt;/tr&gt;
				&lt;tr id=&quot;syntaxplugin_code_and_gutter&quot;&gt;
						&lt;td  style=&quot; line-height: 1.4em !important; padding: 0em; vertical-align: top;&quot;&gt;
					&lt;pre style=&quot;font-size: 1em; margin: 0 10px;   width: auto; padding: 0;&quot;&gt;&lt;span style=&quot;color: black; font-family: &apos;Consolas&apos;, &apos;Bitstream Vera Sans Mono&apos;, &apos;Courier New&apos;, Courier, monospace !important;&quot;&gt;September 23 11:01:51 INFO oo_spawn buffer(11/) CLIENT_MESSAGE: fuse3 fabric needs to be restarted to complete installation of patch.&lt;/span&gt;&lt;/pre&gt;
			&lt;/td&gt;
		&lt;/tr&gt;
				&lt;tr id=&quot;syntaxplugin_code_and_gutter&quot;&gt;
						&lt;td  style=&quot; line-height: 1.4em !important; padding: 0em; vertical-align: top;&quot;&gt;
					&lt;pre style=&quot;font-size: 1em; margin: 0 10px;   width: auto; padding: 0;&quot;&gt;&amp;nbsp;&lt;/pre&gt;
			&lt;/td&gt;
		&lt;/tr&gt;
				&lt;tr id=&quot;syntaxplugin_code_and_gutter&quot;&gt;
						&lt;td  style=&quot; line-height: 1.4em !important; padding: 0em; vertical-align: top;&quot;&gt;
					&lt;pre style=&quot;font-size: 1em; margin: 0 10px;   width: auto; padding: 0;&quot;&gt;&lt;span style=&quot;color: black; font-family: &apos;Consolas&apos;, &apos;Bitstream Vera Sans Mono&apos;, &apos;Courier New&apos;, Courier, monospace !important;&quot;&gt;September 23 11:01:53 INFO oo_spawn buffer(11/) karaf: JAVA_HOME not set; results may vary&lt;/span&gt;&lt;/pre&gt;
			&lt;/td&gt;
		&lt;/tr&gt;
				&lt;tr id=&quot;syntaxplugin_code_and_gutter&quot;&gt;
						&lt;td  style=&quot; line-height: 1.4em !important; padding: 0em; vertical-align: top;&quot;&gt;
					&lt;pre style=&quot;font-size: 1em; margin: 0 10px;   width: auto; padding: 0;&quot;&gt;&amp;nbsp;&lt;/pre&gt;
			&lt;/td&gt;
		&lt;/tr&gt;
				&lt;tr id=&quot;syntaxplugin_code_and_gutter&quot;&gt;
						&lt;td  style=&quot; line-height: 1.4em !important; padding: 0em; vertical-align: top;&quot;&gt;
					&lt;pre style=&quot;font-size: 1em; margin: 0 10px;   width: auto; padding: 0;&quot;&gt;&lt;span style=&quot;color: black; font-family: &apos;Consolas&apos;, &apos;Bitstream Vera Sans Mono&apos;, &apos;Courier New&apos;, Courier, monospace !important;&quot;&gt;September 23 11:01:54 INFO oo_spawn buffer(11/) CLIENT_RESULT: Stopped fuse3&lt;/span&gt;&lt;/pre&gt;
			&lt;/td&gt;
		&lt;/tr&gt;
				&lt;tr id=&quot;syntaxplugin_code_and_gutter&quot;&gt;
						&lt;td  style=&quot; line-height: 1.4em !important; padding: 0em; vertical-align: top;&quot;&gt;
					&lt;pre style=&quot;font-size: 1em; margin: 0 10px;   width: auto; padding: 0;&quot;&gt;&amp;nbsp;&lt;/pre&gt;
			&lt;/td&gt;
		&lt;/tr&gt;
				&lt;tr id=&quot;syntaxplugin_code_and_gutter&quot;&gt;
						&lt;td  style=&quot; line-height: 1.4em !important; padding: 0em; vertical-align: top;&quot;&gt;
					&lt;pre style=&quot;font-size: 1em; margin: 0 10px;   margin-bottom: 10px;  width: auto; padding: 0;&quot;&gt;&lt;span style=&quot;color: black; font-family: &apos;Consolas&apos;, &apos;Bitstream Vera Sans Mono&apos;, &apos;Courier New&apos;, Courier, monospace !important;&quot;&gt;September 23 11:01:54 INFO oo_spawn buffer(11/) CLIENT_MESSAGE: Started application&lt;/span&gt;&lt;/pre&gt;
			&lt;/td&gt;
		&lt;/tr&gt;
			&lt;/tbody&gt;
&lt;/table&gt;
&lt;/div&gt;
&lt;p/&gt;

&lt;p&gt;but the container is still not up and there are two java processes running in the gear, so it seems that the &quot;stop&quot; thinks it has managed to stop fuse even though it didn&apos;t.&lt;/p&gt;
</comment>
                            <comment id="13005569" author="maschmid" created="Wed, 24 Sep 2014 02:09:58 -0400"  >&lt;p&gt;attaching a jstack of the hanged process.&lt;/p&gt;</comment>
                            <comment id="13005598" author="maschmid" created="Wed, 24 Sep 2014 03:24:44 -0400"  >&lt;p&gt;The suspicious line is&lt;/p&gt;

&lt;p&gt;&quot;if ! ps -p $PID &amp;gt; /dev/null; then&quot;&lt;/p&gt;

&lt;p&gt;are you sure the condition is correct? ( &quot;ps -p $PID&quot; exits with 0 if the process exists, negating it makes it 1 (false) if the process exists, which seems like the opposite of what the condition should do)&lt;/p&gt;</comment>
                            <comment id="13005854" author="janstey" created="Wed, 24 Sep 2014 15:44:23 -0400"  >&lt;p&gt;Fixed with &lt;a href=&quot;https://github.com/jboss-fuse/fuse-openshift-cartridge/commit/3ad4f9fc26996cf9b02f80d144689167ab82b586&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://github.com/jboss-fuse/fuse-openshift-cartridge/commit/3ad4f9fc26996cf9b02f80d144689167ab82b586&lt;/a&gt;. Just need to generate some new RPMs for testing now.&lt;/p&gt;</comment>
                            <comment id="13006266" author="janstey" created="Thu, 25 Sep 2014 17:51:28 -0400"  >&lt;p&gt;New RPMs for testing patch fixes:&lt;br/&gt;
Without patch - &lt;a href=&quot;https://repository.jboss.org/nexus/content/groups/ea/org/jboss/fuse/openshift-origin-cartridge-fuse/6.1.0.redhat.396-903/openshift-origin-cartridge-fuse-6.1.0.redhat.396-903-fc18.noarch.rpm&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://repository.jboss.org/nexus/content/groups/ea/org/jboss/fuse/openshift-origin-cartridge-fuse/6.1.0.redhat.396-903/openshift-origin-cartridge-fuse-6.1.0.redhat.396-903-fc18.noarch.rpm&lt;/a&gt;&lt;br/&gt;
With patch - &lt;a href=&quot;https://repository.jboss.org/nexus/content/groups/ea/org/jboss/fuse/openshift-origin-cartridge-fuse/6.1.0.redhat.396-904/openshift-origin-cartridge-fuse-6.1.0.redhat.396-904-fc18.noarch.rpm&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://repository.jboss.org/nexus/content/groups/ea/org/jboss/fuse/openshift-origin-cartridge-fuse/6.1.0.redhat.396-904/openshift-origin-cartridge-fuse-6.1.0.redhat.396-904-fc18.noarch.rpm&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Please adjust timeouts as per &lt;a href=&quot;https://issues.jboss.org/browse/ENTESB-1999&quot; title=&quot;fuse gear creation sometimes exceeds OSE install timeout  &amp;quot;exceeded timeout of&amp;quot;&quot; class=&quot;issue-link&quot; data-issue-key=&quot;ENTESB-1999&quot;&gt;&lt;del&gt;ENTESB-1999&lt;/del&gt;&lt;/a&gt; as well. For my 0.5 CPU VM, 400s was sufficient.&lt;/p&gt;</comment>
                            <comment id="13007032" author="janstey" created="Mon, 29 Sep 2014 15:33:35 -0400"  >&lt;p&gt;Should be fixed in latest RPM.&lt;/p&gt;</comment>
                            <comment id="13008416" author="maschmid" created="Fri, 3 Oct 2014 04:24:45 -0400"  >&lt;p&gt;I believe the current script is still broken in the case the container is hanged.&lt;/p&gt;

&lt;p&gt;Since the container is hanged at the beginning of the upgrade script, it will first block at least 120 seconds on&lt;/p&gt;

&lt;p/&gt;
&lt;div id=&quot;syntaxplugin&quot; class=&quot;syntaxplugin&quot; style=&quot;border: 1px dashed #bbb; border-radius: 5px !important; overflow: auto; max-height: 30em;&quot;&gt;
&lt;table cellspacing=&quot;0&quot; cellpadding=&quot;0&quot; border=&quot;0&quot; width=&quot;100%&quot; style=&quot;font-size: 1em; line-height: 1.4em !important; font-weight: normal; font-style: normal; color: black;&quot;&gt;
		&lt;tbody &gt;
				&lt;tr id=&quot;syntaxplugin_code_and_gutter&quot;&gt;
						&lt;td  style=&quot; line-height: 1.4em !important; padding: 0em; vertical-align: top;&quot;&gt;
					&lt;pre style=&quot;font-size: 1em; margin: 0 10px;  margin-top: 10px;   margin-bottom: 10px;  width: auto; padding: 0;&quot;&gt;&lt;span style=&quot;color: black; font-family: &apos;Consolas&apos;, &apos;Bitstream Vera Sans Mono&apos;, &apos;Courier New&apos;, Courier, monospace !important;&quot;&gt;fabric:wait-for-provisioning --verbose --provision-timeout 120000&lt;/span&gt;&lt;/pre&gt;
			&lt;/td&gt;
		&lt;/tr&gt;
			&lt;/tbody&gt;
&lt;/table&gt;
&lt;/div&gt;
&lt;p/&gt;

&lt;p&gt;and then at least 300! seconds on&lt;/p&gt;

&lt;p/&gt;
&lt;div id=&quot;syntaxplugin&quot; class=&quot;syntaxplugin&quot; style=&quot;border: 1px dashed #bbb; border-radius: 5px !important; overflow: auto; max-height: 30em;&quot;&gt;
&lt;table cellspacing=&quot;0&quot; cellpadding=&quot;0&quot; border=&quot;0&quot; width=&quot;100%&quot; style=&quot;font-size: 1em; line-height: 1.4em !important; font-weight: normal; font-style: normal; color: black;&quot;&gt;
		&lt;tbody &gt;
				&lt;tr id=&quot;syntaxplugin_code_and_gutter&quot;&gt;
						&lt;td  style=&quot; line-height: 1.4em !important; padding: 0em; vertical-align: top;&quot;&gt;
					&lt;pre style=&quot;font-size: 1em; margin: 0 10px;  margin-top: 10px;   margin-bottom: 10px;  width: auto; padding: 0;&quot;&gt;&lt;span style=&quot;color: black; font-family: &apos;Consolas&apos;, &apos;Bitstream Vera Sans Mono&apos;, &apos;Courier New&apos;, Courier, monospace !important;&quot;&gt;is_fabric_provisioned&lt;/span&gt;&lt;/pre&gt;
			&lt;/td&gt;
		&lt;/tr&gt;
			&lt;/tbody&gt;
&lt;/table&gt;
&lt;/div&gt;
&lt;p/&gt;

&lt;p&gt;see&lt;/p&gt;

&lt;p/&gt;
&lt;div id=&quot;syntaxplugin&quot; class=&quot;syntaxplugin&quot; style=&quot;border: 1px dashed #bbb; border-radius: 5px !important; overflow: auto; max-height: 30em;&quot;&gt;
&lt;table cellspacing=&quot;0&quot; cellpadding=&quot;0&quot; border=&quot;0&quot; width=&quot;100%&quot; style=&quot;font-size: 1em; line-height: 1.4em !important; font-weight: normal; font-style: normal; color: black;&quot;&gt;
		&lt;tbody &gt;
				&lt;tr id=&quot;syntaxplugin_code_and_gutter&quot;&gt;
						&lt;td  style=&quot; line-height: 1.4em !important; padding: 0em; vertical-align: top;&quot;&gt;
					&lt;pre style=&quot;font-size: 1em; margin: 0 10px;  margin-top: 10px;   width: auto; padding: 0;&quot;&gt;&lt;span style=&quot;color: black; font-family: &apos;Consolas&apos;, &apos;Bitstream Vera Sans Mono&apos;, &apos;Courier New&apos;, Courier, monospace !important;&quot;&gt; retries=300&lt;/span&gt;&lt;/pre&gt;
			&lt;/td&gt;
		&lt;/tr&gt;
				&lt;tr id=&quot;syntaxplugin_code_and_gutter&quot;&gt;
						&lt;td  style=&quot; line-height: 1.4em !important; padding: 0em; vertical-align: top;&quot;&gt;
					&lt;pre style=&quot;font-size: 1em; margin: 0 10px;   width: auto; padding: 0;&quot;&gt;&lt;span style=&quot;color: black; font-family: &apos;Consolas&apos;, &apos;Bitstream Vera Sans Mono&apos;, &apos;Courier New&apos;, Courier, monospace !important;&quot;&gt;       fabric_loaded=0&lt;/span&gt;&lt;/pre&gt;
			&lt;/td&gt;
		&lt;/tr&gt;
				&lt;tr id=&quot;syntaxplugin_code_and_gutter&quot;&gt;
						&lt;td  style=&quot; line-height: 1.4em !important; padding: 0em; vertical-align: top;&quot;&gt;
					&lt;pre style=&quot;font-size: 1em; margin: 0 10px;   width: auto; padding: 0;&quot;&gt;&lt;span style=&quot;color: black; font-family: &apos;Consolas&apos;, &apos;Bitstream Vera Sans Mono&apos;, &apos;Courier New&apos;, Courier, monospace !important;&quot;&gt;       while [ $retries -gt 0 ]; do&lt;/span&gt;&lt;/pre&gt;
			&lt;/td&gt;
		&lt;/tr&gt;
				&lt;tr id=&quot;syntaxplugin_code_and_gutter&quot;&gt;
						&lt;td  style=&quot; line-height: 1.4em !important; padding: 0em; vertical-align: top;&quot;&gt;
					&lt;pre style=&quot;font-size: 1em; margin: 0 10px;   width: auto; padding: 0;&quot;&gt;&lt;span style=&quot;color: black; font-family: &apos;Consolas&apos;, &apos;Bitstream Vera Sans Mono&apos;, &apos;Courier New&apos;, Courier, monospace !important;&quot;&gt;          curl -s http://admin:${OPENSHIFT_FUSE_PASSWORD}@$OPENSHIFT_FUSE_IP:8080/jolokia/read/io.fabric8:type=Fabric/FabricServiceStatus | grep &apos;&quot;provisionComplete&quot;:true&apos; &amp;gt; /dev/null&lt;/span&gt;&lt;/pre&gt;
			&lt;/td&gt;
		&lt;/tr&gt;
				&lt;tr id=&quot;syntaxplugin_code_and_gutter&quot;&gt;
						&lt;td  style=&quot; line-height: 1.4em !important; padding: 0em; vertical-align: top;&quot;&gt;
					&lt;pre style=&quot;font-size: 1em; margin: 0 10px;   width: auto; padding: 0;&quot;&gt;&lt;span style=&quot;color: black; font-family: &apos;Consolas&apos;, &apos;Bitstream Vera Sans Mono&apos;, &apos;Courier New&apos;, Courier, monospace !important;&quot;&gt;          [ $? -eq 0 ] &amp;amp;&amp;amp; fabric_loaded=1 &amp;amp;&amp;amp; break&lt;/span&gt;&lt;/pre&gt;
			&lt;/td&gt;
		&lt;/tr&gt;
				&lt;tr id=&quot;syntaxplugin_code_and_gutter&quot;&gt;
						&lt;td  style=&quot; line-height: 1.4em !important; padding: 0em; vertical-align: top;&quot;&gt;
					&lt;pre style=&quot;font-size: 1em; margin: 0 10px;   width: auto; padding: 0;&quot;&gt;&lt;span style=&quot;color: black; font-family: &apos;Consolas&apos;, &apos;Bitstream Vera Sans Mono&apos;, &apos;Courier New&apos;, Courier, monospace !important;&quot;&gt;          let retries=$retries-1&lt;/span&gt;&lt;/pre&gt;
			&lt;/td&gt;
		&lt;/tr&gt;
				&lt;tr id=&quot;syntaxplugin_code_and_gutter&quot;&gt;
						&lt;td  style=&quot; line-height: 1.4em !important; padding: 0em; vertical-align: top;&quot;&gt;
					&lt;pre style=&quot;font-size: 1em; margin: 0 10px;   width: auto; padding: 0;&quot;&gt;&lt;span style=&quot;color: black; font-family: &apos;Consolas&apos;, &apos;Bitstream Vera Sans Mono&apos;, &apos;Courier New&apos;, Courier, monospace !important;&quot;&gt;          sleep 1&lt;/span&gt;&lt;/pre&gt;
			&lt;/td&gt;
		&lt;/tr&gt;
				&lt;tr id=&quot;syntaxplugin_code_and_gutter&quot;&gt;
						&lt;td  style=&quot; line-height: 1.4em !important; padding: 0em; vertical-align: top;&quot;&gt;
					&lt;pre style=&quot;font-size: 1em; margin: 0 10px;   width: auto; padding: 0;&quot;&gt;&lt;span style=&quot;color: black; font-family: &apos;Consolas&apos;, &apos;Bitstream Vera Sans Mono&apos;, &apos;Courier New&apos;, Courier, monospace !important;&quot;&gt;       done&lt;/span&gt;&lt;/pre&gt;
			&lt;/td&gt;
		&lt;/tr&gt;
				&lt;tr id=&quot;syntaxplugin_code_and_gutter&quot;&gt;
						&lt;td  style=&quot; line-height: 1.4em !important; padding: 0em; vertical-align: top;&quot;&gt;
					&lt;pre style=&quot;font-size: 1em; margin: 0 10px;   width: auto; padding: 0;&quot;&gt;&lt;span style=&quot;color: black; font-family: &apos;Consolas&apos;, &apos;Bitstream Vera Sans Mono&apos;, &apos;Courier New&apos;, Courier, monospace !important;&quot;&gt;       if [ $fabric_loaded -eq 1 ]; then&lt;/span&gt;&lt;/pre&gt;
			&lt;/td&gt;
		&lt;/tr&gt;
				&lt;tr id=&quot;syntaxplugin_code_and_gutter&quot;&gt;
						&lt;td  style=&quot; line-height: 1.4em !important; padding: 0em; vertical-align: top;&quot;&gt;
					&lt;pre style=&quot;font-size: 1em; margin: 0 10px;   width: auto; padding: 0;&quot;&gt;&lt;span style=&quot;color: black; font-family: &apos;Consolas&apos;, &apos;Bitstream Vera Sans Mono&apos;, &apos;Courier New&apos;, Courier, monospace !important;&quot;&gt;         return 0;&lt;/span&gt;&lt;/pre&gt;
			&lt;/td&gt;
		&lt;/tr&gt;
				&lt;tr id=&quot;syntaxplugin_code_and_gutter&quot;&gt;
						&lt;td  style=&quot; line-height: 1.4em !important; padding: 0em; vertical-align: top;&quot;&gt;
					&lt;pre style=&quot;font-size: 1em; margin: 0 10px;   margin-bottom: 10px;  width: auto; padding: 0;&quot;&gt;&lt;span style=&quot;color: black; font-family: &apos;Consolas&apos;, &apos;Bitstream Vera Sans Mono&apos;, &apos;Courier New&apos;, Courier, monospace !important;&quot;&gt;       fi&lt;/span&gt;&lt;/pre&gt;
			&lt;/td&gt;
		&lt;/tr&gt;
			&lt;/tbody&gt;
&lt;/table&gt;
&lt;/div&gt;
&lt;p/&gt;


&lt;p&gt;btw. it probably will also fail on &quot;let retries=$retries-1&quot; as it goes to zero, as the &quot;while [ $retries -gt 0 ]; &quot;   should be at least &quot;-gt 1&quot;&lt;/p&gt;


&lt;p&gt;I could probably adjust my timeouts to make for all the 420 seconds of waiting, but this is certainly not reasonable by default, as in a default setting it will never reach the &quot;restart&quot; part and the container will be hanged still.&lt;/p&gt;


&lt;p&gt;Another interesting thing (which I am not sure if it is a bug or not) is that the &quot;fabric:wait-for-provisioning&quot; will block all the containers, even those that are already provisioned if any of the containers is not provisioned (as it waits for the whole fabric), which unnecessarily delays patching for 120 seconds in such cases where at least one container in the fabric is hanged.&lt;/p&gt;</comment>
                            <comment id="13008484" author="maschmid" created="Fri, 3 Oct 2014 08:33:16 -0400"  >&lt;p&gt;In another run, the hanged container upgrade didn&apos;t fail, but the container is still hanged.  &lt;/p&gt;

&lt;p&gt;What seems to have happened was that the mq-example gear was upgraded first, and after that the other containers (enseble server and the mq-amq), which triggered the dead-lock condition.    &lt;/p&gt;

&lt;p&gt;So it seems that restarting after container was patched is not enough to prevent this condition. &lt;/p&gt;</comment>
                            <comment id="13009361" author="janstey" created="Tue, 7 Oct 2014 10:43:36 -0400"  >&lt;p&gt;Fixed with&lt;br/&gt;
&lt;a href=&quot;https://github.com/jboss-fuse/fuse-openshift-cartridge/commit/bcacdeac9820d57a792de523f151bb9b4e43cc42&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://github.com/jboss-fuse/fuse-openshift-cartridge/commit/bcacdeac9820d57a792de523f151bb9b4e43cc42&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="13010655" author="maschmid" created="Fri, 10 Oct 2014 09:35:43 -0400"  >&lt;p&gt;Tried with 403-1 and 403-2 as a patch version.&lt;/p&gt;

&lt;p&gt;The restart seems to work only if the container has the fabric profile (created via rhc) For containers created by fabric I am getting the following error on the example-mq container:&lt;/p&gt;

&lt;p/&gt;
&lt;div id=&quot;syntaxplugin&quot; class=&quot;syntaxplugin&quot; style=&quot;border: 1px dashed #bbb; border-radius: 5px !important; overflow: auto; max-height: 30em;&quot;&gt;
&lt;table cellspacing=&quot;0&quot; cellpadding=&quot;0&quot; border=&quot;0&quot; width=&quot;100%&quot; style=&quot;font-size: 1em; line-height: 1.4em !important; font-weight: normal; font-style: normal; color: black;&quot;&gt;
		&lt;tbody &gt;
				&lt;tr id=&quot;syntaxplugin_code_and_gutter&quot;&gt;
						&lt;td  style=&quot; line-height: 1.4em !important; padding: 0em; vertical-align: top;&quot;&gt;
					&lt;pre style=&quot;font-size: 1em; margin: 0 10px;  margin-top: 10px;   margin-bottom: 10px;  width: auto; padding: 0;&quot;&gt;&lt;span style=&quot;color: black; font-family: &apos;Consolas&apos;, &apos;Bitstream Vera Sans Mono&apos;, &apos;Courier New&apos;, Courier, monospace !important;&quot;&gt;javax.jms.JMSException: Could not create Transport. Reason: java.io.IOException: DiscoveryAgent scheme NOT recognized: [fabric]&lt;/span&gt;&lt;/pre&gt;
			&lt;/td&gt;
		&lt;/tr&gt;
			&lt;/tbody&gt;
&lt;/table&gt;
&lt;/div&gt;
&lt;p/&gt;

&lt;p&gt;Note that the container  works correctly until the patching happens. Also, manually restarting the container seems to make it eventually work again. &lt;/p&gt;</comment>
                            <comment id="13045732" author="maschmid" created="Tue, 3 Mar 2015 11:25:27 -0500"  >&lt;p&gt;I can reproduce the issue on the current version of 6.1.R2P1 ( openshift-origin-cartridge-fuse-6.1.1.redhat.412-6.el6.noarch.rpm )&lt;/p&gt;</comment>
                            <comment id="13059825" author="janstey" created="Thu, 16 Apr 2015 13:15:27 -0400"  >&lt;p&gt;Looks to be same issue as &lt;a href=&quot;https://issues.jboss.org/browse/ENTESB-2810&quot; title=&quot;[OSE] removing both mq-amq and example-mq profiles livelocks&quot; class=&quot;issue-link&quot; data-issue-key=&quot;ENTESB-2810&quot;&gt;&lt;del&gt;ENTESB-2810&lt;/del&gt;&lt;/a&gt;. Will need to verify though as the steps to reproduce are a little different.&lt;/p&gt;</comment>
                            <comment id="13084996" author="maschmid" created="Tue, 30 Jun 2015 10:23:35 -0400"  >&lt;p&gt;Verified as duplicate. &lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="12310220">
                    <name>Causality</name>
                                            <outwardlinks description="is caused by">
                                                        </outwardlinks>
                                                        </issuelinktype>
                            <issuelinktype id="12310001">
                    <name>Related</name>
                                            <outwardlinks description="relates to">
                                        <issuelink>
            <issuekey id="12565400">ENTESB-2810</issuekey>
        </issuelink>
                            </outwardlinks>
                                                                <inwardlinks description="is related to">
                                        <issuelink>
            <issuekey id="12553187">ENTESB-1997</issuekey>
        </issuelink>
            <issuelink>
            <issuekey id="12554375">ENTESB-2052</issuekey>
        </issuelink>
            <issuelink>
            <issuekey id="12549097">ENTESB-1798</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12388073" name="611r2p1_jstack.txt" size="56610" author="maschmid" created="Tue, 3 Mar 2015 11:31:38 -0500"/>
                            <attachment id="12388074" name="611r2p1_karaf-example.log" size="684626" author="maschmid" created="Tue, 3 Mar 2015 11:31:38 -0500"/>
                            <attachment id="12385309" name="after_patch_hang_jstack.txt" size="69888" author="maschmid" created="Wed, 24 Sep 2014 02:09:57 -0400"/>
                            <attachment id="12384930" name="example-mq-patching.jstack.txt" size="73117" author="maschmid" created="Thu, 11 Sep 2014 08:16:30 -0400"/>
                    </attachments>
                <subtasks>
                            <subtask id="12554990">ENTESB-2087</subtask>
                    </subtasks>
                <customfields>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310641" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Number of attachments</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>4.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310640" key="com.atlassian.jira.toolkit:comments">
                        <customfieldname>Number of comments</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>17.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12311940" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1|hzt78v:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310840" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                            <customfield id="customfield_12310183" key="com.atlassian.jira.plugin.system.customfieldtypes:textarea">
                        <customfieldname>Steps to Reproduce</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>&lt;ol&gt;
	&lt;li&gt;install build 390-4&lt;/li&gt;
	&lt;li&gt;create 3 fuse gears from OpenShift console&lt;/li&gt;
	&lt;li&gt;deploy mq-amq to fuse2  (you may need to do a workaround for &lt;a href=&quot;https://issues.jboss.org/browse/ENTESB-1860&quot; title=&quot;mq-amq profile using obsolete env variables OPENSHIFT_FUSE_AMQ_*PORT &quot; class=&quot;issue-link&quot; data-issue-key=&quot;ENTESB-1860&quot;&gt;&lt;del&gt;ENTESB-1860&lt;/del&gt;&lt;/a&gt; )&lt;/li&gt;
	&lt;li&gt;prepare patch upgrade to 390-5 by following steps from &lt;a href=&quot;https://mojo.redhat.com/docs/DOC-983150&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://mojo.redhat.com/docs/DOC-983150&lt;/a&gt;  (except the last step)&lt;/li&gt;
	&lt;li&gt;deploy the example-mq profile to fuse3&lt;/li&gt;
	&lt;li&gt;do the last step in the patch upgrade process (oo-admin-upgrade upgrade-node --version &amp;lt;OSE version&amp;gt;)&lt;/li&gt;
	&lt;li&gt;notice the fuse2 (the mq-amq one) and fuse3 are eventually restarted, but fuse3 never comes back to life (stays in &quot;finalizing&quot; state)&lt;/li&gt;
&lt;/ol&gt;
</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>