<!-- 
RSS generated by JIRA (7.2.3#72005-sha1:73be91d2b96fc29303a7eb6820acf420e5d0ed65) at Thu Dec 08 11:45:17 EST 2016

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.jboss.org/si/jira.issueviews:issue-xml/JBMETA-350/JBMETA-350.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>JBoss Issue Tracker</title>
    <link>https://issues.jboss.org</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-us</language>    <build-info>
        <version>7.2.3</version>
        <build-number>72005</build-number>
        <build-date>06-10-2016</build-date>
    </build-info>

<item>
            <title>[JBMETA-350] Merging entity bean metadata yields ClassCastException</title>
                <link>https://issues.jboss.org/browse/JBMETA-350</link>
                <project id="12310511" key="JBMETA">JBoss Metadata</project>
                    <description>&lt;p&gt;I have encountered this issue on JBoss AS 7.1.0.CR1b with an application containing EJB2 entity beans. When deploying the beans I get the following ClassCastException:&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;13:04:55,292 ERROR &lt;span class=&quot;error&quot;&gt;&amp;#91;org.jboss.msc.service.fail&amp;#93;&lt;/span&gt; (MSC service thread 1-1) MSC00001: Failed to start service jboss.deployment.subunit.&quot;myapp.ear&quot;.&quot;myapplication-ejb-1.3-SNAPSHOT.jar&quot;.PARSE: org.jboss.msc.service.StartException in service jboss.deployment.subunit.&quot;myapp.ear&quot;.&quot;myapplication-ejb-1.3-SNAPSHOT.jar&quot;.PARSE: Failed to process phase PARSE of subdeployment &quot;myapplication-ejb-1.3-SNAPSHOT.jar&quot; of deployment &quot;myapp.ear&quot;&lt;br/&gt;
        at org.jboss.as.server.deployment.DeploymentUnitPhaseService.start(DeploymentUnitPhaseService.java:121) &lt;span class=&quot;error&quot;&gt;&amp;#91;jboss-as-server-7.1.0.CR1b.jar:7.1.0.CR1b&amp;#93;&lt;/span&gt;&lt;br/&gt;
        at org.jboss.msc.service.ServiceControllerImpl$StartTask.startService(ServiceControllerImpl.java:1824) &lt;span class=&quot;error&quot;&gt;&amp;#91;jboss-msc-1.0.1.GA.jar:1.0.1.GA&amp;#93;&lt;/span&gt;&lt;br/&gt;
        at org.jboss.msc.service.ServiceControllerImpl$StartTask.run(ServiceControllerImpl.java:1759) &lt;span class=&quot;error&quot;&gt;&amp;#91;jboss-msc-1.0.1.GA.jar:1.0.1.GA&amp;#93;&lt;/span&gt;&lt;br/&gt;
        at java.util.concurrent.ThreadPoolExecutor$Worker.runTask(ThreadPoolExecutor.java:886) &lt;span class=&quot;error&quot;&gt;&amp;#91;:1.6.0_24&amp;#93;&lt;/span&gt;&lt;br/&gt;
        at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:908) &lt;span class=&quot;error&quot;&gt;&amp;#91;:1.6.0_24&amp;#93;&lt;/span&gt;&lt;br/&gt;
        at java.lang.Thread.run(Thread.java:662) &lt;span class=&quot;error&quot;&gt;&amp;#91;:1.6.0_24&amp;#93;&lt;/span&gt;&lt;br/&gt;
Caused by: java.lang.ClassCastException: org.jboss.metadata.ejb.spec.EntityBeanMetaData cannot be cast to org.jboss.metadata.ejb.jboss.ejb3.JBossGenericBeanMetaData&lt;br/&gt;
        at org.jboss.metadata.ejb.spec.EntityBeanMetaData.merge(EntityBeanMetaData.java:121)&lt;br/&gt;
        at org.jboss.metadata.ejb.spec.EntityBeanMetaData.createMerged(EntityBeanMetaData.java:112)&lt;br/&gt;
        at org.jboss.metadata.ejb.spec.EntityBeanMetaData.createMerged(EntityBeanMetaData.java:32)&lt;br/&gt;
        at org.jboss.metadata.ejb.spec.EnterpriseBeansMetaData.merge(EnterpriseBeansMetaData.java:81)&lt;br/&gt;
        at org.jboss.metadata.ejb.spec.EnterpriseBeansMetaData.createMerged(EnterpriseBeansMetaData.java:52)&lt;br/&gt;
        at org.jboss.metadata.ejb.spec.EjbJarMetaData.merge(EjbJarMetaData.java:175)&lt;br/&gt;
        at org.jboss.metadata.ejb.spec.EjbJarMetaData.createMerged(EjbJarMetaData.java:668)&lt;br/&gt;
        at org.jboss.as.ejb3.deployment.processors.EjbJarParsingDeploymentUnitProcessor.deploy(EjbJarParsingDeploymentUnitProcessor.java:124)&lt;br/&gt;
        at org.jboss.as.server.deployment.DeploymentUnitPhaseService.start(DeploymentUnitPhaseService.java:115) &lt;span class=&quot;error&quot;&gt;&amp;#91;jboss-as-server-7.1.0.CR1b.jar:7.1.0.CR1b&amp;#93;&lt;/span&gt;&lt;br/&gt;
        ... 5 more&lt;/p&gt;&lt;/blockquote&gt;


&lt;p&gt;I have recreated the exception in isolation in a unit test, which can be pulled from my fork of jboss-metadata at github &lt;a href=&quot;https://github.com/runeflobakk/metadata&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://github.com/runeflobakk/metadata&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;I have identified the bug to be a faulty cast at &lt;tt&gt;&lt;a href=&quot;https://github.com/jboss/metadata/blob/master/ejb/src/main/java/org/jboss/metadata/ejb/spec/EntityBeanMetaData.java#L121&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;EntityBeanMetaData.java:121&lt;/a&gt;&lt;/tt&gt; (well, obviously). The immediate cause of this is the call to &lt;tt&gt;EntityBeanMetaData#merge&lt;/tt&gt; at &lt;tt&gt;&lt;a href=&quot;https://github.com/jboss/metadata/blob/master/ejb/src/main/java/org/jboss/metadata/ejb/spec/EntityBeanMetaData.java#L112&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;EntityBeanMetaData.java:112&lt;/a&gt;&lt;/tt&gt;, passing &lt;tt&gt;this&lt;/tt&gt; as argument for the &lt;tt&gt;AbstractEnterpriseBeanMetaData or&lt;/tt&gt; parameter. &lt;tt&gt;or&lt;/tt&gt; is then being cast to &lt;tt&gt;JBossGenericBeanMetaData&lt;/tt&gt;, which is an entirely different type than &lt;tt&gt;EntityBeanMetaData&lt;/tt&gt;. The code simply cannot possibly run.&lt;/p&gt;

&lt;p&gt;I &lt;em&gt;can&lt;/em&gt; change the cast to EntityBeanMetaData and the code still compiles, but I do not know if this has any other implications, e.g. if the public &lt;tt&gt;merge&lt;/tt&gt; method is being called by any others which actually &lt;em&gt;do&lt;/em&gt; pass an JBossGenericBeanMetaData.&lt;/p&gt;</description>
                <environment>&lt;p&gt;JBoss AS 7.1.0.CR1b&lt;/p&gt;</environment>
        <key id="12456769">JBMETA-350</key>
            <summary>Merging entity bean metadata yields ClassCastException</summary>
                <type id="1" iconUrl="https://issues.jboss.org/secure/viewavatar?size=xsmall&amp;avatarId=13263&amp;avatarType=issuetype">Bug</type>
                                            <priority id="2" iconUrl="https://issues.jboss.org/images/icons/priorities/critical.svg">Critical</priority>
                        <status id="5" iconUrl="https://issues.jboss.org/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Done</resolution>
                                        <assignee username="wolfc">Carlo de Wolf</assignee>
                                    <reporter username="rflob">Rune Flobakk</reporter>
                        <labels>
                            <label>ejb2</label>
                            <label>entitybean</label>
                            <label>jboss-as</label>
                            <label>metadata</label>
                    </labels>
                <created>Tue, 17 Jan 2012 07:45:03 -0500</created>
                <updated>Tue, 12 Mar 2013 07:05:22 -0400</updated>
                            <resolved>Fri, 27 Jan 2012 09:41:27 -0500</resolved>
                                                    <fixVersion>7.0.0.Beta34</fixVersion>
                                    <component>ejb</component>
                        <due></due>
                            <votes>4</votes>
                                    <watches>4</watches>
                                                                <comments>
                            <comment id="12660722" author="jnjnc" created="Fri, 20 Jan 2012 04:49:15 -0500"  >&lt;p&gt;I had same kind of exceptions when deploying a MDB (EJB2) but it doesn&apos;t seems that the issue is linked to an additional deployment descriptor as I only deploy jboss-ejb3.xml files.&lt;/p&gt;

&lt;p&gt;Caused by: java.lang.ClassCastException: org.jboss.metadata.ejb.spec.MessageDrivenBean31MetaData cannot be cast to org.jboss.metadata.ejb.jboss.ejb3.JBossGenericBeanMetaData&lt;br/&gt;
        at org.jboss.metadata.ejb.spec.MessageDrivenBeanMetaData.merge(MessageDrivenBeanMetaData.java:353)&lt;br/&gt;
        at org.jboss.metadata.ejb.spec.MessageDrivenBeanMetaData.createMerged(MessageDrivenBeanMetaData.java:85)&lt;br/&gt;
        at org.jboss.metadata.ejb.spec.MessageDrivenBeanMetaData.createMerged(MessageDrivenBeanMetaData.java:36)&lt;br/&gt;
        at org.jboss.metadata.ejb.spec.EnterpriseBeansMetaData.merge(EnterpriseBeansMetaData.java:73)&lt;br/&gt;
        at org.jboss.metadata.ejb.spec.EnterpriseBeansMetaData.createMerged(EnterpriseBeansMetaData.java:52)&lt;br/&gt;
        at org.jboss.metadata.ejb.spec.EjbJarMetaData.merge(EjbJarMetaData.java:175)&lt;br/&gt;
        at org.jboss.metadata.ejb.spec.EjbJarMetaData.createMerged(EjbJarMetaData.java:668)&lt;br/&gt;
        at org.jboss.as.ejb3.deployment.processors.EjbJarParsingDeploymentUnitProcessor.deploy(EjbJarParsingDeploymentUnitProcessor.java:124)&lt;br/&gt;
        at org.jboss.as.server.deployment.DeploymentUnitPhaseService.start(DeploymentUnitPhaseService.java:115) &lt;span class=&quot;error&quot;&gt;&amp;#91;jboss-as-server-7.1.0.CR1b.jar:7.1.0.CR1b&amp;#93;&lt;/span&gt;&lt;br/&gt;
        ... 5 more&lt;/p&gt;</comment>
                            <comment id="12760506" author="wolfc" created="Tue, 12 Mar 2013 07:05:22 -0400"  >&lt;p&gt;&lt;a href=&quot;https://github.com/jboss/metadata/commit/3b6a4754c389ba175b26a6d9ddfb5ab91350f5cf&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://github.com/jboss/metadata/commit/3b6a4754c389ba175b26a6d9ddfb5ab91350f5cf&lt;/a&gt;&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10012">
                    <name>Dependency</name>
                                                                <inwardlinks description="blocks">
                                        <issuelink>
            <issuekey id="12457095">AS7-3380</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310220" key="org.jboss.labs.jira.plugin.jboss-custom-field-types-plugin:multiurl">
                        <customfieldname>Git Pull Request</customfieldname>
                        <customfieldvalues>
                            https://github.com/jboss/metadata/pull/29
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12310641" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Number of attachments</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310640" key="com.atlassian.jira.toolkit:comments">
                        <customfieldname>Number of comments</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12311940" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1|hysek7:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310840" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>16110</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12310183" key="com.atlassian.jira.plugin.system.customfieldtypes:textarea">
                        <customfieldname>Steps to Reproduce</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>&lt;p&gt;Either run unit test EntityBeanMetaDataMergingTestCase, or deploy an application to JBoss AS containing &lt;em&gt;both&lt;/em&gt; jbosscmp-jdbc.xml and jboss-ejb3.xml files.&lt;/p&gt;</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>