<!-- 
RSS generated by JIRA (6.4.11#64026-sha1:78f6ec473a3f058bd5d6c30e9319c7ab376bdb9c) at Thu Dec 22 14:02:39 UTC 2016

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://jira.spring.io/si/jira.issueviews:issue-xml/SGF-159/SGF-159.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>Spring JIRA</title>
    <link>https://jira.spring.io</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.4.11</version>
        <build-number>64026</build-number>
        <build-date>25-08-2015</build-date>
    </build-info>

<item>
            <title>[SGF-159] isRollbackOnCommitFailure flag is ignored by GemfireTransactionManager when transaction fails.</title>
                <link>https://jira.spring.io/browse/SGF-159</link>
                <project id="10462" key="SGF">Spring Data GemFire</project>
                    <description>&lt;p&gt;Bug was found with version 1.2.2.RELEASE of spring-data-gemfire, gemfire 7.0 and Spring framework 3.2.0.RELEASE.&lt;/p&gt;

&lt;p&gt;Method doCommit of GemfireTransactionManager catches org.springframework.transaction.TransactionException while com.gemstone.gemfire.cache.CacheTransactionManager.commit() throws com.gemstone.gemfire.cache.TransactionException when commit fails.&lt;br/&gt;
So gemfire exception is ignored by GemfireTransactionManager and is caught in&lt;br/&gt;
org.springframework.transaction.support.AbstractPlatformTransactionManager (line 779) as RuntimeException and isRollbackOnCommitFailure is ignored.&lt;br/&gt;
Roll back attempt fails with &quot;java.lang.IllegalStateException: Thread does not have an active transaction&quot; exception.&lt;/p&gt;

&lt;p&gt;Here are code fragments from AbstractPlatformTransactionManager:&lt;/p&gt;

&lt;p&gt;-------------&lt;br/&gt;
                        catch (TransactionException ex) {&lt;br/&gt;
                                // can only be caused by doCommit&lt;br/&gt;
                                if (isRollbackOnCommitFailure()) &lt;/p&gt;
{
                                        doRollbackOnCommitException(status, ex);
                                }
&lt;p&gt;                                else &lt;/p&gt;
{
                                        triggerAfterCompletion(status, TransactionSynchronization.STATUS_UNKNOWN);
                                }
&lt;p&gt;                                throw ex;&lt;br/&gt;
                        }&lt;br/&gt;
                        catch (RuntimeException ex) {&lt;br/&gt;
                                if (!beforeCompletionInvoked) &lt;/p&gt;
{
                                        triggerBeforeCompletion(status);
                                }
&lt;p&gt;                                doRollbackOnCommitException(status, ex);&lt;br/&gt;
                                throw ex;&lt;br/&gt;
                        }&lt;br/&gt;
-------------&lt;/p&gt;

&lt;p&gt;and GemfireTransactionManager:&lt;/p&gt;


&lt;p&gt;        @Override&lt;br/&gt;
        protected void doCommit(DefaultTransactionStatus status) throws TransactionException {&lt;br/&gt;
                // CacheTransactionObject txObject = (CacheTransactionObject)&lt;br/&gt;
                // status.getTransaction();&lt;br/&gt;
                if (status.isDebug()) &lt;/p&gt;
{
                        logger.debug(&quot;Committing Gemfire local transaction on Cache [&quot; + cache + &quot;]&quot;);
                }
&lt;p&gt;                try &lt;/p&gt;
{
                        cache.getCacheTransactionManager().commit();
                }
&lt;p&gt;                catch (IllegalStateException ex) &lt;/p&gt;
{
                        throw new NoTransactionException(
                                        &quot;No transaction associated with the current thread; are there multiple transaction managers ?&quot;, ex);
                }
&lt;p&gt;                catch (TransactionException ex) &lt;/p&gt;
{
                        throw new GemfireTransactionCommitException(&quot;Unexpected failure on commit of Cache local transaction&quot;, ex);
                }
&lt;p&gt;        }&lt;/p&gt;</description>
                <environment></environment>
        <key id="47573">SGF-159</key>
            <summary>isRollbackOnCommitFailure flag is ignored by GemfireTransactionManager when transaction fails.</summary>
                <type id="1" iconUrl="https://jira.spring.io/images/icons/issuetypes/bug.png">Bug</type>
                                            <priority id="3" iconUrl="https://jira.spring.io/images/icons/priorities/major.png">Major</priority>
                        <status id="6" iconUrl="https://jira.spring.io/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="dturanski">David Turanski</assignee>
                                    <reporter username="arogozinsky">Alex Rogozinsky</reporter>
                        <labels>
                    </labels>
                <created>Wed, 27 Feb 2013 17:18:34 +0000</created>
                <updated>Wed, 24 Apr 2013 01:07:34 +0000</updated>
                            <resolved>Thu, 18 Apr 2013 09:28:43 +0000</resolved>
                                    <version>1.2.2</version>
                                    <fixVersion>1.3.1</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>1</watches>
                                                                        <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                                                                                    <customfield id="customfield_10280" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>34158</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_10182" key="com.atlassian.jira.toolkit:lastupdaterorcommenter">
                        <customfieldname>Last updater</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>tmarshall</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_10880" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i065sf:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_10380" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>35976</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_10381" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Ranking</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>33860</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_10171" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                </customfields>
    </item>
</channel>
</rss>