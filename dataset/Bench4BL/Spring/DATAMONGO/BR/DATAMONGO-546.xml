<!-- 
RSS generated by JIRA (6.4.11#64026-sha1:78f6ec473a3f058bd5d6c30e9319c7ab376bdb9c) at Thu Dec 22 15:51:45 UTC 2016

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://jira.spring.io/si/jira.issueviews:issue-xml/DATAMONGO-546/DATAMONGO-546.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>Spring JIRA</title>
    <link>https://jira.spring.io</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.4.11</version>
        <build-number>64026</build-number>
        <build-date>25-08-2015</build-date>
    </build-info>

<item>
            <title>[DATAMONGO-546] spring-data-mongo 1.0.4: TransactionSyncManager in spring throws exception</title>
                <link>https://jira.spring.io/browse/DATAMONGO-546</link>
                <project id="10701" key="DATAMONGO">Spring Data MongoDB</project>
                    <description>&lt;p&gt;When I migrated to spring-data-mongo 1.0.4 from 1.0.2 I faced following stacktrace&lt;br/&gt;
2012-10-04 09:58:32,966 ERROR o.s.t.s.TransactionSynchronizationUtils - TransactionSynchronization.beforeCompletion threw exception&lt;br/&gt;
java.lang.IllegalStateException: No value for key &lt;span class=&quot;error&quot;&gt;&amp;#91;Mongo: localhost:27017&amp;#93;&lt;/span&gt; bound to thread &lt;span class=&quot;error&quot;&gt;&amp;#91;1128017935@qtp-1027055145-3&amp;#93;&lt;/span&gt;&lt;br/&gt;
	at org.springframework.transaction.support.TransactionSynchronizationManager.unbindResource(TransactionSynchronizationManager.java:209) ~&lt;span class=&quot;error&quot;&gt;&amp;#91;spring-tx-3.1.1.RELEASE.jar:3.1.1.RELEASE&amp;#93;&lt;/span&gt;&lt;br/&gt;
	at org.springframework.transaction.support.ResourceHolderSynchronization.beforeCompletion(ResourceHolderSynchronization.java:69) ~&lt;span class=&quot;error&quot;&gt;&amp;#91;spring-tx-3.1.1.RELEASE.jar:3.1.1.RELEASE&amp;#93;&lt;/span&gt;&lt;br/&gt;
	at org.springframework.transaction.support.TransactionSynchronizationUtils.triggerBeforeCompletion(TransactionSynchronizationUtils.java:106) ~&lt;span class=&quot;error&quot;&gt;&amp;#91;spring-tx-3.1.1.RELEASE.jar:3.1.1.RELEASE&amp;#93;&lt;/span&gt;&lt;br/&gt;
	at org.springframework.transaction.support.AbstractPlatformTransactionManager.triggerBeforeCompletion(AbstractPlatformTransactionManager.java:937) &lt;span class=&quot;error&quot;&gt;&amp;#91;spring-tx-3.1.1.RELEASE.jar:3.1.1.RELEASE&amp;#93;&lt;/span&gt;&lt;br/&gt;
	at org.springframework.transaction.support.AbstractPlatformTransactionManager.processCommit(AbstractPlatformTransactionManager.java:738) &lt;span class=&quot;error&quot;&gt;&amp;#91;spring-tx-3.1.1.RELEASE.jar:3.1.1.RELEASE&amp;#93;&lt;/span&gt;&lt;br/&gt;
	at org.springframework.transaction.support.AbstractPlatformTransactionManager.commit(AbstractPlatformTransactionManager.java:723) &lt;span class=&quot;error&quot;&gt;&amp;#91;spring-tx-3.1.1.RELEASE.jar:3.1.1.RELEASE&amp;#93;&lt;/span&gt;&lt;br/&gt;
	at org.springframework.transaction.interceptor.TransactionAspectSupport.commitTransactionAfterReturning(TransactionAspectSupport.java:393) &lt;span class=&quot;error&quot;&gt;&amp;#91;spring-tx-3.1.1.RELEASE.jar:3.1.1.RELEASE&amp;#93;&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;As result I can&apos;t work with mongo at all&lt;/p&gt;

&lt;p&gt;My mongo config is:&lt;br/&gt;
    &amp;lt;context:component-scan base-package=&quot;com.some.repository.mongo&quot; /&amp;gt;&lt;/p&gt;

&lt;p&gt;    &amp;lt;mongo:repositories base-package=&quot;com.some.domain.mongo&quot; /&amp;gt;&lt;/p&gt;

&lt;p&gt;    &amp;lt;mongo:db-factory dbname=&quot;content_documents&quot; host=&quot;localhost&quot; port=&quot;27017&quot;/&amp;gt;&lt;/p&gt;

&lt;p&gt;    &amp;lt;mongo:mapping-converter&amp;gt;&lt;br/&gt;
        &amp;lt;mongo:custom-converters&amp;gt;&lt;br/&gt;
            &amp;lt;mongo:converter&amp;gt;&lt;br/&gt;
                &amp;lt;bean class=&quot;com.some.OutlineWriteConverter&quot;/&amp;gt;&lt;br/&gt;
            &amp;lt;/mongo:converter&amp;gt;&lt;br/&gt;
            &amp;lt;mongo:converter&amp;gt;&lt;br/&gt;
                &amp;lt;bean class=&quot;com.some.OutlineReadConverter&quot;/&amp;gt;&lt;br/&gt;
            &amp;lt;/mongo:converter&amp;gt;&lt;br/&gt;
        &amp;lt;/mongo:custom-converters&amp;gt;&lt;br/&gt;
    &amp;lt;/mongo:mapping-converter&amp;gt;&lt;/p&gt;

&lt;p&gt;    &amp;lt;bean id=&quot;mongoTemplate&quot; class=&quot;org.springframework.data.mongodb.core.MongoTemplate&quot;&amp;gt;&lt;br/&gt;
        &amp;lt;constructor-arg name=&quot;mongoDbFactory&quot; ref=&quot;mongoDbFactory&quot;/&amp;gt;&lt;br/&gt;
        &amp;lt;constructor-arg name=&quot;mongoConverter&quot; ref=&quot;mappingConverter&quot; /&amp;gt;&lt;br/&gt;
    &amp;lt;/bean&amp;gt;&lt;br/&gt;
And transaction configured as:&lt;br/&gt;
 &amp;lt;aop:aspectj-autoproxy /&amp;gt;&lt;/p&gt;

&lt;p&gt;    &amp;lt;bean id=&quot;transactionManager&quot; class=&quot;org.springframework.jdbc.datasource.DataSourceTransactionManager&quot;&amp;gt;&lt;br/&gt;
        &amp;lt;property name=&quot;dataSource&quot; ref=&quot;dataSource&quot; /&amp;gt;&lt;br/&gt;
    &amp;lt;/bean&amp;gt;&lt;/p&gt;

&lt;p&gt;    &amp;lt;tx:advice id=&quot;txAdvice&quot; transaction-manager=&quot;transactionManager&quot;&amp;gt;&lt;br/&gt;
        &amp;lt;tx:attributes&amp;gt;&lt;br/&gt;
            &amp;lt;tx:method name=&quot;*&quot; propagation=&quot;REQUIRED&quot; isolation=&quot;READ_COMMITTED&quot; rollback-for=&quot;java.lang.RuntimeException&quot;/&amp;gt;&lt;br/&gt;
        &amp;lt;/tx:attributes&amp;gt;&lt;br/&gt;
    &amp;lt;/tx:advice&amp;gt;&lt;/p&gt;

&lt;p&gt;    &amp;lt;aop:config proxy-target-class=&quot;true&quot;&amp;gt;&lt;br/&gt;
        &amp;lt;aop:pointcut id=&quot;transactionServiceOperation&quot;&lt;br/&gt;
            expression=&quot;execution(* com.some..service..&lt;b&gt;Service.&lt;/b&gt;(..)) || @annotation(org.springframework.transaction.annotation.Transactional)&quot; /&amp;gt;&lt;br/&gt;
        &amp;lt;aop:advisor pointcut-ref=&quot;transactionServiceOperation&quot; advice-ref=&quot;txAdvice&quot; /&amp;gt;&lt;br/&gt;
    &amp;lt;/aop:config&amp;gt;&lt;/p&gt;</description>
                <environment></environment>
        <key id="45638">DATAMONGO-546</key>
            <summary>spring-data-mongo 1.0.4: TransactionSyncManager in spring throws exception</summary>
                <type id="1" iconUrl="https://jira.spring.io/images/icons/issuetypes/bug.png">Bug</type>
                                            <priority id="3" iconUrl="https://jira.spring.io/images/icons/priorities/major.png">Major</priority>
                        <status id="6" iconUrl="https://jira.spring.io/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="olivergierke">Oliver Gierke</assignee>
                                    <reporter username="sergiov">Sergio</reporter>
                        <labels>
                    </labels>
                <created>Thu, 4 Oct 2012 02:35:51 +0000</created>
                <updated>Mon, 25 Mar 2013 09:31:15 +0000</updated>
                            <resolved>Thu, 29 Nov 2012 04:49:33 +0000</resolved>
                                    <version>1.0.4</version>
                                    <fixVersion>1.1 GA</fixVersion>
                                    <component>Core</component>
                        <due></due>
                            <votes>2</votes>
                                    <watches>6</watches>
                                    <timeoriginalestimate seconds="0">0d</timeoriginalestimate>
                            <timeestimate seconds="0">0d</timeestimate>
                                        <comments>
                            <comment id="84002" author="sergiov" created="Thu, 4 Oct 2012 04:32:13 +0000"  >&lt;p&gt;Sorry little mistake - I can work with Mongo and this exception seems not to influence work at all, but it is still confusing and ugly&lt;/p&gt;</comment>
                            <comment id="84003" author="sergiov" created="Thu, 4 Oct 2012 04:45:50 +0000"  >&lt;p&gt;Seems it happens when multiple transactions are sequentially called. First TransactionSynchronizedManager.unbindResource called successfully without error, further calls issue exception because resource is already unbound&lt;/p&gt;</comment>
                            <comment id="84228" author="anztenney" created="Fri, 12 Oct 2012 07:28:53 +0000"  >&lt;p&gt;We&apos;re getting this in our application when we move to 1.0.4.  If I move back to 1.0.2 then this problem does not occur.  However, unlike for Sergio, this is blocking the application from executing properly.  I&apos;m going through several transactional services, but my mongo repository is not marked transactional.  I have not tried 1.1 yet&lt;/p&gt;</comment>
                            <comment id="84267" author="dbryant_uk" created="Mon, 15 Oct 2012 12:54:36 +0000"  >&lt;p&gt;I&apos;m getting this in 1.0.4 as well. I can&apos;t see any obvious side-effects with the data I am attempting to persist (i.e. all entities appear to save correctly). However, this make Exception appear many times in the logs (once for every Mongo save?) and in addition to making the logs look ugly it also makes me a bit nervous!&lt;/p&gt;</comment>
                            <comment id="84293" author="dizzy" created="Wed, 17 Oct 2012 08:17:39 +0000"  >&lt;p&gt;It could be related to the patch I submitted for &lt;a href=&quot;https://jira.springsource.org/browse/DATAMONGO-464&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://jira.springsource.org/browse/DATAMONGO-464&lt;/a&gt;&lt;br/&gt;
Will check if this is the case&lt;/p&gt;
</comment>
                            <comment id="84294" author="dbryant_uk" created="Wed, 17 Oct 2012 10:22:55 +0000"  >&lt;p&gt;Just a quick update - this Exception doesn&apos;t appear for me now that I have switched my Maven spring-data-mongodb dependency to version 1.1.0.RELEASE.&lt;/p&gt;</comment>
                            <comment id="84326" author="anztenney" created="Thu, 18 Oct 2012 16:43:06 +0000"  >&lt;p&gt;I also upgraded to 1.1.0.RELEASE and am no longer seeing the issue&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_10170" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>First Response Date</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Fri, 12 Oct 2012 07:28:53 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_10280" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>32559</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_10182" key="com.atlassian.jira.toolkit:lastupdaterorcommenter">
                        <customfieldname>Last updater</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>tmarshall</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_10880" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i05vzz:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_10380" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>34390</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_10381" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Ranking</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>32259</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_10171" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                </customfields>
    </item>
</channel>
</rss>