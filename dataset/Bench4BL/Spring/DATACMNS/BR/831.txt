AbstractMappingContext.getPersistentEntity sometimes returns an empty entity when called by multiple threads.
If you call the getPersistentEntity() method in the AbstractMappingContext class with the same type from multiple threads concurrently, you will sometimes get an empty entity back, i.e. an entity without any properties. 
This is caused by a race condition at the beginning of the addPersistentEntity() method. 
If one thread calls the method while another one is already executing inside the write lock in the method, the first thread will return an empty entity from the persistentEntities map even though the second thread is still populating it with properties. 
To fix this, the addPersistentEntity() method should acquire the read lock before accessing the persistentEntities map.