<!-- 
RSS generated by JIRA (6.4.11#64026-sha1:78f6ec473a3f058bd5d6c30e9319c7ab376bdb9c) at Fri Dec 23 01:40:11 UTC 2016

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://jira.spring.io/si/jira.issueviews:issue-xml/LDAP-179/LDAP-179.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>Spring JIRA</title>
    <link>https://jira.spring.io</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.4.11</version>
        <build-number>64026</build-number>
        <build-date>25-08-2015</build-date>
    </build-info>

<item>
            <title>[LDAP-179] DataSource connections not being released when LDAP connection fails in JDBC integrated transaction.</title>
                <link>https://jira.spring.io/browse/LDAP-179</link>
                <project id="10071" key="LDAP">Spring LDAP</project>
                    <description>&lt;p&gt;When using JDBC transaction integration in Spring LDAP, we have discovered that when our LDAP server is unavailable the doBegin() method of the ContextSourceAndDataSourceTransactionManager first calls super.doBegin() of the DataSourceTransactionManager which is successful, then it calls doBegin() of the ldapManagerDelegate which fails throwing a TransactionException , however no cleanup of the DataSource connection is being performed in this case.&lt;/p&gt;

&lt;p&gt;This leaves a binding in the TransactionSynchronizationManager resources for the DataSource and also an open connection to the database, even though it was never used. &lt;/p&gt;

&lt;p&gt;Later if the same thread attempts to create a transaction the following IllegalStateException is being thrown because the DataSource is still bound to the thread in the TransactionSynchronizationManager:&lt;/p&gt;

&lt;p&gt;java.lang.IllegalStateException: Already value &lt;span class=&quot;error&quot;&gt;&amp;#91;org.springframework.jdbc.datasource.ConnectionHold er@79b1d1&amp;#93;&lt;/span&gt; for key &lt;span class=&quot;error&quot;&gt;&amp;#91;org.apache.commons.dbcp.BasicDataSource@335297&amp;#93;&lt;/span&gt; bound to thread &lt;span class=&quot;error&quot;&gt;&amp;#91;DefaultQuartzScheduler_Worker-7&amp;#93;&lt;/span&gt;&lt;/p&gt;
</description>
                <environment>Spring 2.5, OpenLDAP, Oracle 9i</environment>
        <key id="26394">LDAP-179</key>
            <summary>DataSource connections not being released when LDAP connection fails in JDBC integrated transaction.</summary>
                <type id="1" iconUrl="https://jira.spring.io/images/icons/issuetypes/bug.png">Bug</type>
                                            <priority id="3" iconUrl="https://jira.spring.io/images/icons/priorities/major.png">Major</priority>
                        <status id="6" iconUrl="https://jira.spring.io/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="8">Complete</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="kbobrien">Keith O&apos;Brien</reporter>
                        <labels>
                    </labels>
                <created>Wed, 22 Apr 2009 21:12:19 +0000</created>
                <updated>Fri, 5 Feb 2016 21:18:30 +0000</updated>
                            <resolved>Wed, 14 Aug 2013 03:22:11 +0000</resolved>
                                    <version>1.3.0</version>
                                    <fixVersion>1.3.2</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>2</watches>
                                            <timeestimate seconds="0">0d</timeestimate>
                            <timespent seconds="3600">1h</timespent>
                                <comments>
                            <comment id="43810" author="kbobrien" created="Wed, 22 Apr 2009 21:30:20 +0000"  >&lt;p&gt;Suggested fix for this would be to add a try catch to ContextSourceAndDataSourceTransactionManager.doBegin() and call the doCleanupAfterCompletion() method.  However, some changes to AbstractCompensatingTransactionManagerDelegate.doCleanupAfterCompletion() would be required so that IllegalStateException is not thrown because the ContextSource part of the transaction has not been created yet. &lt;/p&gt;</comment>
                            <comment id="92753" author="marthursson" created="Wed, 14 Aug 2013 03:22:12 +0000"  >&lt;p&gt;Now making sure that the created DataSource or Hibernate transation is properly cleaned up (including closing the underlying database connection) if failing to create the Ldap transaction, e.g. if the LDAP server is not available.&lt;/p&gt;</comment>
                            <comment id="123622" author="rwinch" created="Fri, 5 Feb 2016 21:18:30 +0000"  >&lt;p&gt;This issue has been migrated to &lt;a href=&quot;https://github.com/spring-projects/spring-ldap/issues/213&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://github.com/spring-projects/spring-ldap/issues/213&lt;/a&gt;&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_10170" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>First Response Date</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Wed, 14 Aug 2013 03:22:12 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_10280" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>24886</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_10880" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0519z:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_10380" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>29413</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_10381" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Ranking</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>24977</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_10120" key="com.atlassian.jira.plugin.system.customfieldtypes:url">
                        <customfieldname>Reference URL</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[http://forum.springsource.org/showthread.php?p=237677#post237677]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_10171" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                </customfields>
    </item>
</channel>
</rss>