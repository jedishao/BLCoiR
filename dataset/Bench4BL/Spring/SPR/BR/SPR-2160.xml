<!-- 
RSS generated by JIRA (6.4.11#64026-sha1:78f6ec473a3f058bd5d6c30e9319c7ab376bdb9c) at Thu Dec 22 18:30:26 UTC 2016

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://jira.spring.io/si/jira.issueviews:issue-xml/SPR-2160/SPR-2160.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>Spring JIRA</title>
    <link>https://jira.spring.io</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.4.11</version>
        <build-number>64026</build-number>
        <build-date>25-08-2015</build-date>
    </build-info>

<item>
            <title>[SPR-2160] non-singleton FactoryBean is eagerly initialized</title>
                <link>https://jira.spring.io/browse/SPR-2160</link>
                <project id="10000" key="SPR">Spring Framework</project>
                    <description>&lt;p&gt;I wouldn&apos;t expect getObject() to be called on this bean:&lt;/p&gt;

&lt;p&gt;public class TestBean implements FactoryBean {&lt;br/&gt;
    public Object getObject() &lt;/p&gt;
{
        throw new IllegalStateException(&quot;should never be called&quot;);
    }

&lt;p&gt;    public Class getObjectType() &lt;/p&gt;
{
        return String.class;
    }

&lt;p&gt;    public boolean isSingleton() &lt;/p&gt;
{
        return false;
    }
&lt;p&gt;}&lt;/p&gt;

&lt;p&gt;when configured like this:&lt;/p&gt;

&lt;p&gt;&amp;lt;beans&amp;gt;&lt;br/&gt;
    &amp;lt;bean class=&quot;springext.TestBean&quot; /&amp;gt;&lt;br/&gt;
&amp;lt;/beans&amp;gt;&lt;/p&gt;

&lt;p&gt;public class Test {&lt;br/&gt;
    public static void main(String[] args) &lt;/p&gt;
{
        new FileSystemXmlApplicationContext(&quot;test.xml&quot;);
    }
&lt;p&gt;}&lt;/p&gt;

&lt;p&gt;But I do get the IllegalStateException:&lt;/p&gt;

&lt;p&gt;org.springframework.beans.factory.BeanCreationException: Error creating bean with name &apos;springext.TestBean&apos;: FactoryBean threw exception on object creation; nested exception is java.lang.IllegalStateException: should never be called&lt;br/&gt;
Caused by: java.lang.IllegalStateException: should never be called&lt;br/&gt;
	at springext.TestBean.getObject(TestBean.java:10)&lt;br/&gt;
	at org.springframework.beans.factory.support.AbstractBeanFactory.getObjectFromFactoryBean(AbstractBeanFactory.java:984)&lt;br/&gt;
	at org.springframework.beans.factory.support.AbstractBeanFactory.getObjectForBeanInstance(AbstractBeanFactory.java:959)&lt;br/&gt;
	at org.springframework.beans.factory.support.AbstractBeanFactory.getBean(AbstractBeanFactory.java:272)&lt;br/&gt;
	at org.springframework.beans.factory.support.AbstractBeanFactory.getBean(AbstractBeanFactory.java:168)&lt;br/&gt;
	at org.springframework.beans.factory.support.DefaultListableBeanFactory.preInstantiateSingletons(DefaultListableBeanFactory.java:253)&lt;br/&gt;
	at org.springframework.context.support.AbstractApplicationContext.refresh(AbstractApplicationContext.java:332)&lt;br/&gt;
	at org.springframework.context.support.FileSystemXmlApplicationContext.&amp;lt;init&amp;gt;(FileSystemXmlApplicationContext.java:89)&lt;br/&gt;
	at org.springframework.context.support.FileSystemXmlApplicationContext.&amp;lt;init&amp;gt;(FileSystemXmlApplicationContext.java:74)&lt;br/&gt;
	at org.springframework.context.support.FileSystemXmlApplicationContext.&amp;lt;init&amp;gt;(FileSystemXmlApplicationContext.java:65)&lt;br/&gt;
	at springext.Test.main(Test.java:10)&lt;/p&gt;

&lt;p&gt;Looking at preInstantiateSingletons() in DefaultListableBeanFactory:&lt;/p&gt;

&lt;p&gt;...&lt;br/&gt;
if (bd.hasBeanClass() &amp;amp;&amp;amp; FactoryBean.class.isAssignableFrom(bd.getBeanClass())) {&lt;br/&gt;
    FactoryBean factory = (FactoryBean) getBean(FACTORY_BEAN_PREFIX + beanName);&lt;br/&gt;
    if (factory.isSingleton()) &lt;/p&gt;
{
        getBean(beanName);
    }
&lt;p&gt;}&lt;br/&gt;
else {&lt;br/&gt;
    getBean(beanName);&lt;br/&gt;
}&lt;br/&gt;
...&lt;/p&gt;

&lt;p&gt;It turns out that the else block is executed instead of the if block, because bd.hasBeanClass() returns false, because the AbstractBeanDefinition&apos;s beanClass property is still the class name String instead of the Class object. I guess everything would be fine if hasBeanClass() returned true...&lt;/p&gt;

&lt;p&gt;Is this a bug or intended behavior?&lt;/p&gt;</description>
            <key id="14254">SPR-2160</key>
            <summary>non-singleton FactoryBean is eagerly initialized</summary>
                <type id="1" iconUrl="https://jira.spring.io/images/icons/issuetypes/bug.png">Bug</type>
                                            <priority id="3" iconUrl="https://jira.spring.io/images/icons/priorities/major.png">Major</priority>
                        <status id="6" iconUrl="https://jira.spring.io/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="juergen.hoeller">Juergen Hoeller</assignee>
                                    <reporter username="turelto">Tom Turelinckx</reporter>
                        <labels>
                    </labels>
                <created>Mon, 19 Jun 2006 22:03:52 +0000</created>
                <updated>Tue, 19 Jun 2012 03:52:35 +0000</updated>
                            <resolved>Mon, 19 Jun 2006 22:46:40 +0000</resolved>
                                    <version>2.0 M5</version>
                                    <fixVersion>2.0 RC1</fixVersion>
                                    <component>Core</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>1</watches>
                                                                <comments>
                            <comment id="18103" author="juergen.hoeller" created="Mon, 19 Jun 2006 22:46:40 +0000"  >&lt;p&gt;Thanks for spotting this - fixed through resolution of the bean class rather than going through a plain hasBeanClass call!&lt;/p&gt;

&lt;p&gt;Juergen&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_10180" key="com.atlassian.jira.toolkit:dayslastcommented">
                        <customfieldname>Days since last comment</customfieldname>
                        <customfieldvalues>
                                        10 years, 28 weeks, 2 days ago
    
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_10170" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>First Response Date</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Mon, 19 Jun 2006 22:46:40 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_10181" key="com.atlassian.jira.toolkit:lastusercommented">
                        <customfieldname>Last commented by a User</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>false</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_10182" key="com.atlassian.jira.toolkit:lastupdaterorcommenter">
                        <customfieldname>Last updater</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>tmarshall</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_10880" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i04v1j:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_10380" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>28403</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_10171" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                </customfields>
    </item>
</channel>
</rss>