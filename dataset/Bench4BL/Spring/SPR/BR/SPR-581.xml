<!-- 
RSS generated by JIRA (6.4.11#64026-sha1:78f6ec473a3f058bd5d6c30e9319c7ab376bdb9c) at Thu Dec 22 19:25:15 UTC 2016

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://jira.spring.io/si/jira.issueviews:issue-xml/SPR-581/SPR-581.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>Spring JIRA</title>
    <link>https://jira.spring.io</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.4.11</version>
        <build-number>64026</build-number>
        <build-date>25-08-2015</build-date>
    </build-info>

<item>
            <title>[SPR-581] Hibernate session closed after transaction was commited.</title>
                <link>https://jira.spring.io/browse/SPR-581</link>
                <project id="10000" key="SPR">Spring Framework</project>
                    <description>&lt;p&gt;I have the same problem exsactly as described in issue &apos;&lt;a href=&quot;https://jira.spring.io/browse/SPR-501&quot; title=&quot;Doc: Hibernate session closed after transaction was commited.&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SPR-501&quot;&gt;&lt;del&gt;SPR-501&lt;/del&gt;&lt;/a&gt;&apos;:&lt;br/&gt;
java.sql.SQLException: The transaction is no longer active - status: &apos;Committed&apos;. No further JDBC access is allowed within this transaction. &lt;br/&gt;
        at weblogic.jdbc.wrapper.JTSConnection.checkIfRolledBack(JTSConnection.java:118) &lt;br/&gt;
        at weblogic.jdbc.wrapper.JTSConnection.checkConnection(JTSConnection.java:127) &lt;br/&gt;
        at weblogic.jdbc.wrapper.Connection.preInvocationHandler(Connection.java:70) &lt;br/&gt;
.&lt;br/&gt;
.&lt;br/&gt;
.&lt;/p&gt;

&lt;p&gt;I am not using hibernate.properties as I use registry.xml in the following way, as you can see I trued to specify a WebLogic-specific TransactionManagerLookup as you said but probably incorrectly....&lt;br/&gt;
Can you please advice what is wrong:&lt;br/&gt;
my registry.xml file:&lt;/p&gt;

&lt;p&gt;&amp;lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&amp;gt;&lt;br/&gt;
&amp;lt;!DOCTYPE beans PUBLIC &quot;-//SPRING//DTD BEAN//EN&quot;&lt;br/&gt;
 &quot;http://www.springframework.org/dtd/spring-beans.dtd&quot;&amp;gt;&lt;/p&gt;

&lt;p&gt;&amp;lt;beans&amp;gt;&lt;/p&gt;

&lt;p&gt;    &amp;lt;bean id=&quot;jndiTransactionManager&quot;&lt;br/&gt;
        class=&quot;org.springframework.transaction.jta.WebLogicServerTransactionManagerFactoryBean&quot;&amp;gt;&lt;br/&gt;
    &amp;lt;/bean&amp;gt;&lt;/p&gt;

&lt;p&gt;    &amp;lt;!-- Jta platform tm --&amp;gt;&lt;br/&gt;
    &amp;lt;bean id=&quot;transactionManager&quot;&lt;br/&gt;
        class=&quot;org.springframework.transaction.jta.WebLogicJtaTransactionManager&quot;&amp;gt;&lt;br/&gt;
        &amp;lt;property name=&quot;transactionManager&quot;&amp;gt;&lt;br/&gt;
            &amp;lt;ref local=&quot;jndiTransactionManager&quot;/&amp;gt;&lt;br/&gt;
        &amp;lt;/property&amp;gt;&lt;br/&gt;
    &amp;lt;/bean&amp;gt;&lt;/p&gt;

&lt;p&gt;    &amp;lt;bean id=&quot;dataSource&quot;&lt;br/&gt;
        class=&quot;org.springframework.jndi.JndiObjectFactoryBean&quot;&amp;gt;&lt;br/&gt;
        &amp;lt;property name=&quot;jndiName&quot;&amp;gt;&lt;br/&gt;
            &amp;lt;value&amp;gt;TangoOracleDS&amp;lt;/value&amp;gt;&lt;br/&gt;
        &amp;lt;/property&amp;gt;&lt;br/&gt;
    &amp;lt;/bean&amp;gt;&lt;/p&gt;

&lt;p&gt;    &amp;lt;!-- Hibernate SessionFactory --&amp;gt;&lt;br/&gt;
    &amp;lt;bean id=&quot;hb8SessionFactory&quot;&lt;br/&gt;
        class=&quot;com.bmc.idm.ctsa.common.inbound.config.CTSALocalSessionFactoryBean&quot;&lt;br/&gt;
        destroy-method=&quot;destroy&quot;&amp;gt;&lt;br/&gt;
        &amp;lt;property name=&quot;dataSource&quot;&amp;gt;&lt;br/&gt;
            &amp;lt;ref local=&quot;dataSource&quot;/&amp;gt;&lt;br/&gt;
        &amp;lt;/property&amp;gt;&lt;br/&gt;
        &amp;lt;property name=&quot;jtaTransactionManager&quot;&amp;gt;&lt;br/&gt;
            &amp;lt;ref local=&quot;jndiTransactionManager&quot;/&amp;gt;&lt;br/&gt;
        &amp;lt;/property&amp;gt;&lt;br/&gt;
        &amp;lt;property name=&quot;hibernateProperties&quot;&amp;gt;&lt;br/&gt;
            &amp;lt;props&amp;gt;&lt;br/&gt;
                &amp;lt;!-&lt;del&gt;&amp;lt;prop key=&quot;query.substitutions&quot;&amp;gt;true 1, false 0, yes &apos;Y&apos;, no &apos;N&apos;&amp;lt;/prop&amp;gt;&lt;/del&gt;-&amp;gt;&lt;br/&gt;
                &amp;lt;prop key=&quot;hibernate.dialect&quot;&amp;gt;net.sf.hibernate.dialect.OracleDialect&amp;lt;/prop&amp;gt;&lt;br/&gt;
                &amp;lt;prop key=&quot;jdbc.batch_size&quot;&amp;gt;0&amp;lt;/prop&amp;gt;&lt;br/&gt;
                &amp;lt;prop key=&quot;jdbc.use_streams_for_binary&quot;&amp;gt;true&amp;lt;/prop&amp;gt;&lt;br/&gt;
                &amp;lt;prop key=&quot;max_fetch_depth&quot;&amp;gt;3&amp;lt;/prop&amp;gt;&lt;br/&gt;
                &amp;lt;!--                &amp;lt;prop key=&quot;cache.provider_class&quot;&amp;gt;net.sf.hibernate.cache.EhCacheProvider&amp;lt;/prop&amp;gt;--&amp;gt;&lt;br/&gt;
                &amp;lt;!--                &amp;lt;prop key=&quot;cache.use_query_cache&quot;&amp;gt;true&amp;lt;/prop&amp;gt;--&amp;gt;&lt;br/&gt;
                &amp;lt;prop key=&quot;show_sql&quot;&amp;gt;true&amp;lt;/prop&amp;gt;&lt;br/&gt;
            &amp;lt;/props&amp;gt;&lt;br/&gt;
        &amp;lt;/property&amp;gt;&lt;br/&gt;
    &amp;lt;/bean&amp;gt;&lt;br/&gt;
&amp;lt;/beans&amp;gt;&lt;/p&gt;
</description>
            <key id="10911">SPR-581</key>
            <summary>Hibernate session closed after transaction was commited.</summary>
                <type id="1" iconUrl="https://jira.spring.io/images/icons/issuetypes/bug.png">Bug</type>
                                            <priority id="3" iconUrl="https://jira.spring.io/images/icons/priorities/major.png">Major</priority>
                        <status id="6" iconUrl="https://jira.spring.io/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="juergen.hoeller">Juergen Hoeller</assignee>
                                    <reporter username="sbaror">Shauli Baror</reporter>
                        <labels>
                    </labels>
                <created>Tue, 21 Dec 2004 19:13:33 +0000</created>
                <updated>Thu, 27 Jan 2005 00:53:34 +0000</updated>
                            <resolved>Thu, 27 Jan 2005 00:53:34 +0000</resolved>
                                    <version>1.1.2</version>
                                    <fixVersion>1.1.4</fixVersion>
                                    <component>Data</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>1</watches>
                                                                <comments>
                            <comment id="11859" author="juergen.hoeller" created="Tue, 21 Dec 2004 23:59:24 +0000"  >&lt;p&gt;Your configuration looks alright to me. Can you provide the full stack trace and a startup log for your application (with DEBUG level logging for the org.springframework.orm.hibernate package)? The Spring-configured JTA TransactionManager should kick in there...&lt;/p&gt;

&lt;p&gt;Juergen&lt;/p&gt;</comment>
                            <comment id="11879" author="sbaror" created="Mon, 27 Dec 2004 02:17:03 +0000"  >&lt;p&gt;Attached is the application server log including the spring.&lt;br/&gt;
In addition the following is the log of hibernate:&lt;/p&gt;

&lt;p&gt;2004-12-27 18:13:30,739 DEBUG &lt;span class=&quot;error&quot;&gt;&amp;#91;ExecuteThread: &amp;#39;13&amp;#39; for queue: &amp;#39;weblogic.kernel.Default&amp;#39;&amp;#93;&lt;/span&gt; org.springframework.orm.hibernate.SessionFactoryUtils - Opening Hibernate session&lt;br/&gt;
2004-12-27 18:13:30,939 DEBUG &lt;span class=&quot;error&quot;&gt;&amp;#91;ExecuteThread: &amp;#39;13&amp;#39; for queue: &amp;#39;weblogic.kernel.Default&amp;#39;&amp;#93;&lt;/span&gt; org.springframework.orm.hibernate.SessionFactoryUtils - Registering JTA transaction synchronization for new Hibernate session&lt;br/&gt;
2004-12-27 18:13:32,832 DEBUG &lt;span class=&quot;error&quot;&gt;&amp;#91;ExecuteThread: &amp;#39;13&amp;#39; for queue: &amp;#39;weblogic.kernel.Default&amp;#39;&amp;#93;&lt;/span&gt; org.springframework.orm.hibernate.SessionFactoryUtils - Flushing Hibernate session on transaction synchronization&lt;br/&gt;
2004-12-27 18:13:32,972 DEBUG &lt;span class=&quot;error&quot;&gt;&amp;#91;ExecuteThread: &amp;#39;13&amp;#39; for queue: &amp;#39;weblogic.kernel.Default&amp;#39;&amp;#93;&lt;/span&gt; org.springframework.orm.hibernate.SessionFactoryUtils - Closing Hibernate session&lt;/p&gt;</comment>
                            <comment id="11915" author="siv972" created="Tue, 4 Jan 2005 22:14:26 +0000"  >&lt;p&gt;Spring and Hibernate startup log&lt;/p&gt;</comment>
                            <comment id="11916" author="siv972" created="Tue, 4 Jan 2005 22:16:47 +0000"  >&lt;p&gt;Hi,&lt;/p&gt;

&lt;p&gt;I have attached an additional log file. &lt;br/&gt;
Where do we currently stand regarding this issue?&lt;/p&gt;</comment>
                            <comment id="12096" author="juergen.hoeller" created="Thu, 27 Jan 2005 00:53:34 +0000"  >&lt;p&gt;The key here is that you&apos;re relying on direct JTA synchronization rather than Spring transaction synchronization (supposedly because you&apos;re using EJB CMT and no Spring-demarcated transactions).&lt;/p&gt;

&lt;p&gt;For Spring-driven synchronization, that problem doesn&apos;t occur because we&apos;re unbinding and closing the Session before transaction completion there - that&apos;s always possible there, due to Spring&apos;s fine-grained synchronozation callbacks.&lt;/p&gt;

&lt;p&gt;With direct JTA synchronization, the only reliable callback before transaction completion is in case of a commit. Therefore, Spring&apos;s unbinding and closing code resided in afterCompletion.&lt;/p&gt;

&lt;p&gt;However, there is potential for optimization here: In case of a commit, we can unbind before completion, just performing this in afterCompletion if not callled before. I&apos;ve just refined the code accordingly; this should remove the warning that you&apos;re experiencing.&lt;/p&gt;

&lt;p&gt;This is gonna be in Spring 1.1.4, to be released by the end of this week. Feel free to give a nightly snapshot a try for an early test!&lt;/p&gt;

&lt;p&gt;Juergen&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="10398" name="ctsa.log" size="20336" author="sbaror" created="Mon, 27 Dec 2004 02:17:03 +0000"/>
                            <attachment id="10412" name="spring-hibernate.log" size="6264" author="siv972" created="Tue, 4 Jan 2005 22:14:26 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_10180" key="com.atlassian.jira.toolkit:dayslastcommented">
                        <customfieldname>Days since last comment</customfieldname>
                        <customfieldvalues>
                                        11 years, 49 weeks ago
    
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_10170" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>First Response Date</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Tue, 21 Dec 2004 23:59:24 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_10181" key="com.atlassian.jira.toolkit:lastusercommented">
                        <customfieldname>Last commented by a User</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>false</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_10182" key="com.atlassian.jira.toolkit:lastupdaterorcommenter">
                        <customfieldname>Last updater</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>tmarshall</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_10880" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i01fkv:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_10380" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>8401</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_10171" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                </customfields>
    </item>
</channel>
</rss>