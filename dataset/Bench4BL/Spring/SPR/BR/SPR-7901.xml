<!-- 
RSS generated by JIRA (6.4.11#64026-sha1:78f6ec473a3f058bd5d6c30e9319c7ab376bdb9c) at Thu Dec 22 21:13:01 UTC 2016

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://jira.spring.io/si/jira.issueviews:issue-xml/SPR-7901/SPR-7901.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>Spring JIRA</title>
    <link>https://jira.spring.io</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.4.11</version>
        <build-number>64026</build-number>
        <build-date>25-08-2015</build-date>
    </build-info>

<item>
            <title>[SPR-7901] ConfigurationClassEnhancer prevents BeanFactory from being GCd</title>
                <link>https://jira.spring.io/browse/SPR-7901</link>
                <project id="10000" key="SPR">Spring Framework</project>
                    <description>&lt;p&gt;We&apos;re experiencing OOM errors during unit test runs.  We make fairly heavy use of Java based context configuration in our application as well as the tests.  Upon investigation, I see that there are a number of ApplicationContext instances still referenced on the heap that should be collectable.  It appears that the way the ConfigurationClassEnhancer is registering its BeanMethodInterceptor with the CGLIB generated subclass is the problem.  In &lt;a href=&quot;https://jira.spring.io/browse/SPR-5932&quot; title=&quot;Singleton-scoped @Bean methods behave like prototypes in a Spring DM environment&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SPR-5932&quot;&gt;&lt;del&gt;SPR-5932&lt;/del&gt;&lt;/a&gt;, this was changed from Enhancer.registerCallbacks() to Enhancer.registerStaticCallbacks() to work around the fact that the former only applies the advice when method calls originate from the same thread that registered the callback.  However using the static callback mechanism results in a static reference from the generated subclass to the interceptor, which in turn keeps a reference to the BeanFactory.  So the BeanFactory is never eligible for GC, even after its been closed.  Although problems running unit tests reveled the problem, we&apos;re most likely experiencing it at runtime as well since our application does close contexts and start new ones dynamically in response to some events.  &lt;/p&gt;

&lt;p&gt;As a potential fix, it would be nice if the BeanMethodInterceptor could receive a callback itself when the BeanFactory it references is closed, so it can then unregister itself from the CGLIB proxy.  Alternatively, perhaps a WeakReference to the BeanFactory could be used from the interceptor.  &lt;/p&gt;</description>
            <key id="35972">SPR-7901</key>
            <summary>ConfigurationClassEnhancer prevents BeanFactory from being GCd</summary>
                <type id="1" iconUrl="https://jira.spring.io/images/icons/issuetypes/bug.png">Bug</type>
                                            <priority id="3" iconUrl="https://jira.spring.io/images/icons/priorities/major.png">Major</priority>
                        <status id="6" iconUrl="https://jira.spring.io/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="cbeams">Chris Beams</assignee>
                                    <reporter username="tbecker">Tommy Becker</reporter>
                        <labels>
                    </labels>
                <created>Fri, 21 Jan 2011 09:51:51 +0000</created>
                <updated>Tue, 19 Jun 2012 03:39:30 +0000</updated>
                            <resolved>Mon, 30 May 2011 20:40:47 +0000</resolved>
                                    <version>3.0.3</version>
                                    <fixVersion>3.1 M2</fixVersion>
                                    <component>Core</component>
                        <due></due>
                            <votes>5</votes>
                                    <watches>3</watches>
                                    <timeoriginalestimate seconds="0">0d</timeoriginalestimate>
                            <timeestimate seconds="0">0d</timeestimate>
                                        <comments>
                            <comment id="63697" author="tbecker" created="Thu, 24 Feb 2011 07:14:07 +0000"  >&lt;p&gt;I&apos;ve investigated this some more and found some more information.  The use of static callbacks is not the root problem, as even the non-static callback mechanism uses ThreadLocals, and since the threads live for the lifetime of the JVM, the problem still exists.  The root issue is the callbacks, regardless of how they are registered, need to be cleared when the context is destroyed.  I&apos;ve managed to get this to work in the interim by adding a @PreDestroy method in the configuration class itself which simply calls Enhancer.registerStaticCallbacks(this.getClass(), null);  This is obviously cumbersome, but it does seem to work.  However it seems like this is clearly something Spring should handle for you.&lt;/p&gt;</comment>
                            <comment id="64129" author="cbeams" created="Thu, 10 Mar 2011 09:10:30 +0000"  >&lt;p&gt;Thanks for the detailed investigation and notes, Tommy.  I&apos;ll take a look.&lt;/p&gt;</comment>
                            <comment id="64251" author="cbeams" created="Mon, 14 Mar 2011 02:21:17 +0000"  >&lt;p&gt;    CGLIB-enhanced @Configuration subclasses now implement DisposableBean&lt;br/&gt;
    such that Enhancer.registerStaticCallbacks(subclass, null) is invoked&lt;br/&gt;
    on container shutdown. This ensures that garbage collection can work&lt;br/&gt;
    properly and avoids memory consumption issues for applications that&lt;br/&gt;
    create and destroy many application contexts within the same JVM.&lt;/p&gt;

&lt;p&gt;    Tommy, I&apos;m leaving this open in a &apos;Waiting for Feedback&apos; state as I&apos;d like to hear from you as to whether everything works as expected.  Would you mind grabbing tonight&apos;s snapshot and giving it a try?&lt;/p&gt;</comment>
                            <comment id="64287" author="tbecker" created="Mon, 14 Mar 2011 15:57:50 +0000"  >&lt;p&gt;Thanks for the fix Chris.  Will try and take a look at it soon, although even with the workaround I described in place, we were still having OOM issues, causing me to open &lt;a href=&quot;https://jira.springsource.org/browse/SPR-8008&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://jira.springsource.org/browse/SPR-8008&lt;/a&gt;  So it will take a little more work for me to verify this specific fix...&lt;/p&gt;</comment>
                            <comment id="64308" author="cbeams" created="Mon, 14 Mar 2011 23:52:12 +0000"  >&lt;p&gt;OK, I&apos;ll leave it in &apos;Waiting for Feedback&apos;, then.  Verification will be much appreciated.  These issues can be elusive, as you know too well &lt;img class=&quot;emoticon&quot; src=&quot;https://jira.spring.io/images/icons/emoticons/smile.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;  Note that we&apos;re targeting M2 for release within the next 2-3 weeks, to give you a timeframe.&lt;/p&gt;</comment>
                            <comment id="64966" author="cbeams" created="Mon, 4 Apr 2011 01:11:51 +0000"  >&lt;p&gt;@Tommy - any update on verifying this fix?&lt;/p&gt;</comment>
                            <comment id="65102" author="tbecker" created="Wed, 6 Apr 2011 06:11:08 +0000"  >&lt;p&gt;@Chris, we&apos;ve changed our build process such that I may not be able to replicate the issue, but I&apos;ll at least take a look at the fix.  Can you provide a link to where I can get a build and source with this included?&lt;/p&gt;</comment>
                            <comment id="65106" author="cbeams" created="Wed, 6 Apr 2011 07:54:30 +0000"  >&lt;p/&gt;
&lt;div id=&quot;syntaxplugin&quot; class=&quot;syntaxplugin&quot; style=&quot;border: 1px dashed #bbb; border-radius: 5px !important; overflow: auto; max-height: 30em;&quot;&gt;
&lt;table cellspacing=&quot;0&quot; cellpadding=&quot;0&quot; border=&quot;0&quot; width=&quot;100%&quot; style=&quot;font-size: 1em; line-height: 1.4em !important; font-weight: normal; font-style: normal; color: black;&quot;&gt;
		&lt;tbody &gt;
				&lt;tr id=&quot;syntaxplugin_code_and_gutter&quot;&gt;
						&lt;td  style=&quot; line-height: 1.4em !important; padding: 0em; vertical-align: top;&quot;&gt;
					&lt;pre style=&quot;font-size: 1em; margin: 0 10px;  margin-top: 10px;   width: auto; padding: 0;&quot;&gt;&lt;span style=&quot;color: black; font-family: &apos;Consolas&apos;, &apos;Bitstream Vera Sans Mono&apos;, &apos;Courier New&apos;, Courier, monospace !important;&quot;&gt;&amp;lt;repository&amp;gt;&lt;/span&gt;&lt;/pre&gt;
			&lt;/td&gt;
		&lt;/tr&gt;
				&lt;tr id=&quot;syntaxplugin_code_and_gutter&quot;&gt;
						&lt;td  style=&quot; line-height: 1.4em !important; padding: 0em; vertical-align: top;&quot;&gt;
					&lt;pre style=&quot;font-size: 1em; margin: 0 10px;   width: auto; padding: 0;&quot;&gt;&lt;span style=&quot;color: black; font-family: &apos;Consolas&apos;, &apos;Bitstream Vera Sans Mono&apos;, &apos;Courier New&apos;, Courier, monospace !important;&quot;&gt;  &amp;lt;id&amp;gt;spring-maven-snapshot&amp;lt;/id&amp;gt;&lt;/span&gt;&lt;/pre&gt;
			&lt;/td&gt;
		&lt;/tr&gt;
				&lt;tr id=&quot;syntaxplugin_code_and_gutter&quot;&gt;
						&lt;td  style=&quot; line-height: 1.4em !important; padding: 0em; vertical-align: top;&quot;&gt;
					&lt;pre style=&quot;font-size: 1em; margin: 0 10px;   width: auto; padding: 0;&quot;&gt;&lt;span style=&quot;color: black; font-family: &apos;Consolas&apos;, &apos;Bitstream Vera Sans Mono&apos;, &apos;Courier New&apos;, Courier, monospace !important;&quot;&gt;  &amp;lt;snapshots&amp;gt;&amp;lt;enabled&amp;gt;true&amp;lt;/enabled&amp;gt;&amp;lt;/snapshots&amp;gt;&lt;/span&gt;&lt;/pre&gt;
			&lt;/td&gt;
		&lt;/tr&gt;
				&lt;tr id=&quot;syntaxplugin_code_and_gutter&quot;&gt;
						&lt;td  style=&quot; line-height: 1.4em !important; padding: 0em; vertical-align: top;&quot;&gt;
					&lt;pre style=&quot;font-size: 1em; margin: 0 10px;   width: auto; padding: 0;&quot;&gt;&lt;span style=&quot;color: black; font-family: &apos;Consolas&apos;, &apos;Bitstream Vera Sans Mono&apos;, &apos;Courier New&apos;, Courier, monospace !important;&quot;&gt;  &amp;lt;name&amp;gt;Spring Framework Maven snapshot repository&amp;lt;/name&amp;gt;&lt;/span&gt;&lt;/pre&gt;
			&lt;/td&gt;
		&lt;/tr&gt;
				&lt;tr id=&quot;syntaxplugin_code_and_gutter&quot;&gt;
						&lt;td  style=&quot; line-height: 1.4em !important; padding: 0em; vertical-align: top;&quot;&gt;
					&lt;pre style=&quot;font-size: 1em; margin: 0 10px;   width: auto; padding: 0;&quot;&gt;&lt;span style=&quot;color: black; font-family: &apos;Consolas&apos;, &apos;Bitstream Vera Sans Mono&apos;, &apos;Courier New&apos;, Courier, monospace !important;&quot;&gt;  &amp;lt;url&amp;gt;http://maven.springframework.org/snapshot&amp;lt;/url&amp;gt;&lt;/span&gt;&lt;/pre&gt;
			&lt;/td&gt;
		&lt;/tr&gt;
				&lt;tr id=&quot;syntaxplugin_code_and_gutter&quot;&gt;
						&lt;td  style=&quot; line-height: 1.4em !important; padding: 0em; vertical-align: top;&quot;&gt;
					&lt;pre style=&quot;font-size: 1em; margin: 0 10px;   margin-bottom: 10px;  width: auto; padding: 0;&quot;&gt;&lt;span style=&quot;color: black; font-family: &apos;Consolas&apos;, &apos;Bitstream Vera Sans Mono&apos;, &apos;Courier New&apos;, Courier, monospace !important;&quot;&gt;&amp;lt;/repository&amp;gt;&lt;/span&gt;&lt;/pre&gt;
			&lt;/td&gt;
		&lt;/tr&gt;
			&lt;/tbody&gt;
&lt;/table&gt;
&lt;/div&gt;
&lt;p/&gt;

&lt;p&gt;If you&apos;re not using Maven, you can find the jars here: &lt;a href=&quot;http://bit.ly/hfy4KI&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://bit.ly/hfy4KI&lt;/a&gt;.  Note that the only module affected by this change was spring-context, but other changes may require pulling down other dependent modules.  The change was committed on March 14th, so anything after March 15th should include the change.&lt;/p&gt;

&lt;p&gt;Grab the latest to be safe, but it will also include the most dependecies on changes in other modules.&lt;/p&gt;</comment>
                            <comment id="66908" author="cbeams" created="Mon, 30 May 2011 20:40:51 +0000"  >&lt;p&gt;Resolving as fixed for M2.  The fix has been in for some time, and we&apos;ve not heard further complaints on this front since.  @Tommy, please re-open this issue at will if your verifications turn up negative.&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10000">
                    <name>Duplicate</name>
                                                                <inwardlinks description="is duplicated by">
                                        <issuelink>
            <issuekey id="37371">SPR-8229</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                            <issuelinktype id="10151">
                    <name>Relate</name>
                                                                <inwardlinks description="is related to">
                                        <issuelink>
            <issuekey id="36572">SPR-8008</issuekey>
        </issuelink>
            <issuelink>
            <issuekey id="37371">SPR-8229</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="17729" name="mylyn-context.zip" size="107950" author="cbeams" created="Mon, 14 Mar 2011 02:21:27 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_10180" key="com.atlassian.jira.toolkit:dayslastcommented">
                        <customfieldname>Days since last comment</customfieldname>
                        <customfieldvalues>
                                        5 years, 30 weeks, 3 days ago
    
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_10170" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>First Response Date</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Thu, 10 Mar 2011 09:10:30 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_10181" key="com.atlassian.jira.toolkit:lastusercommented">
                        <customfieldname>Last commented by a User</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>true</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_10182" key="com.atlassian.jira.toolkit:lastupdaterorcommenter">
                        <customfieldname>Last updater</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>tmarshall</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_10880" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i02udj:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_10380" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>16630</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_10171" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                </customfields>
    </item>
</channel>
</rss>