<!-- 
RSS generated by JIRA (6.4.11#64026-sha1:78f6ec473a3f058bd5d6c30e9319c7ab376bdb9c) at Thu Dec 22 10:45:46 UTC 2016

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://jira.spring.io/si/jira.issueviews:issue-xml/AMQP-148/AMQP-148.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>Spring JIRA</title>
    <link>https://jira.spring.io</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.4.11</version>
        <build-number>64026</build-number>
        <build-date>25-08-2015</build-date>
    </build-info>

<item>
            <title>[AMQP-148] Default number of consumers is 0 on SimpleMessageListenerContainer if afterPropertiesSet() not called</title>
                <link>https://jira.spring.io/browse/AMQP-148</link>
                <project id="10450" key="AMQP">Spring AMQP</project>
                    <description>&lt;p&gt;SimpleMessageListenerContainer has a default number of concurrent consumers set to 0, and the validateConfiguration() method, which checks for it and eventually set it to 1, seems to be never called.&lt;br/&gt;
This is very annoying, because applications using older versions will stop working with no apparent reason.&lt;/p&gt;

&lt;p&gt;Finally, please note that version M2 had a default number set to 1.&lt;/p&gt;</description>
                <environment></environment>
        <key id="37307">AMQP-148</key>
            <summary>Default number of consumers is 0 on SimpleMessageListenerContainer if afterPropertiesSet() not called</summary>
                <type id="1" iconUrl="https://jira.spring.io/images/icons/issuetypes/bug.png">Bug</type>
                                            <priority id="5" iconUrl="https://jira.spring.io/images/icons/priorities/trivial.png">Trivial</priority>
                        <status id="6" iconUrl="https://jira.spring.io/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="8">Complete</resolution>
                                        <assignee username="david_syer">Dave Syer</assignee>
                                    <reporter username="sbtourist">Sergio Bossa</reporter>
                        <labels>
                    </labels>
                <created>Mon, 4 Apr 2011 22:54:24 +0000</created>
                <updated>Fri, 29 Mar 2013 19:36:10 +0000</updated>
                            <resolved>Tue, 5 Apr 2011 10:23:54 +0000</resolved>
                                    <version>1.0.0.M3</version>
                    <version>1.0.0.RC1</version>
                                    <fixVersion>1.0.0.RC2</fixVersion>
                                    <component>RabbitMQ</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                    <timeoriginalestimate seconds="0">0d</timeoriginalestimate>
                            <timeestimate seconds="0">0d</timeestimate>
                                        <comments>
                            <comment id="65032" author="david_syer" created="Tue, 5 Apr 2011 01:13:38 +0000"  >&lt;p&gt;Thanks for the feedback.  I hope you don&apos;t mind if I changed the priority to &quot;trivial&quot; (it&apos;s not going to stop anyone using the framework).  Also, we have unit tests that assert the default is 1.  Can you provide a test case?&lt;/p&gt;</comment>
                            <comment id="65036" author="sbtourist" created="Tue, 5 Apr 2011 01:45:13 +0000"  >&lt;p&gt;It doesn&apos;t stop others using the framework, but stops the framework to work at all for those upgrading from M2 onwards, so I think priority should at least be &quot;major&quot;.&lt;/p&gt;

&lt;p&gt;By the way, I took a deeper look at the source code and I think you&apos;re referring to the SimpleMessageListenerContainerTests#testDefaConsumerCount() test: the problem is, it works because you&apos;re relying on the afterPropertiesSet() method which actually calls validateConfiguration() - sorry I missed that call on my previous comment - but, by doing so you&apos;re assuming the listener container is going to be created via Spring configuration ... which is not the case. So you should either clearly document that afterPropertiesSet() must always be called, or fix it.&lt;/p&gt;

&lt;p&gt;In the end I think the best fix would be to simply set SimpleMessageListenerContainerTests#concurrentConsumers to 1, rather than 0.&lt;/p&gt;</comment>
                            <comment id="65038" author="david_syer" created="Tue, 5 Apr 2011 01:53:57 +0000"  >&lt;p&gt;I see, so it&apos;s more of a pilot error and documentation problem.  How did you create your container?  We can try and make sure that it is initialized lazily to prevent this kind of error.  In general though, you should expect that if you create a component that is an InitializingBean and you don&apos;t use the container, you have to play the role of the container and call that method.  If you don&apos;t like that, raise a ticket in SPR-* as it&apos;s nothing to do with AMQP as such.&lt;/p&gt;

&lt;p&gt;(I don&apos;t want to argue about the priority, but this clearly does not stop anyone from using the framework, and it works if you use it correctly.)&lt;/p&gt;</comment>
                            <comment id="65045" author="sbtourist" created="Tue, 5 Apr 2011 05:00:10 +0000"  >&lt;p&gt;Sure, I don&apos;t really mind about the priority &lt;img class=&quot;emoticon&quot; src=&quot;https://jira.spring.io/images/icons/emoticons/smile.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;

&lt;p&gt;Talking about the real issue, I find it odd, other than a bad practice, to rely on subsequent method calls to construct a working object, even more because the method you have to call is tied to the spring container lifecycle management: but as you said, this issue doesn&apos;t belong here, so there&apos;s probably no point in discussing it.&lt;/p&gt;

&lt;p&gt;Feel free to close this issue but please document it and do not write that the default number of consumers is 1, because it isn&apos;t.&lt;/p&gt;</comment>
                            <comment id="65047" author="david_syer" created="Tue, 5 Apr 2011 05:22:57 +0000"  >&lt;p&gt;InitializingBean is an old and important contract, but that doesn&apos;t mean we can&apos;t make life easier for users who don&apos;t want to use the container.  So you create a SimpleMessageListenerContainer and then what?  Presumably you are willing to call at least one method to make it do something?  Maybe call start()?  We can put in a lazy initialization there and I would then say that the default is indeed 1.  Does that work for you?&lt;/p&gt;</comment>
                            <comment id="65084" author="david_syer" created="Wed, 6 Apr 2011 00:28:34 +0000"  >&lt;p&gt;I changed my mind on this, so thanks for stimulating the debate. Actually 1 is a perfectly valid default, and there&apos;s no need to change it if the user doesn&apos;t do so explicitly.  That simplifies the code a lot, but we still need a lazy initialization on start().&lt;/p&gt;</comment>
                            <comment id="65085" author="sbtourist" created="Wed, 6 Apr 2011 00:34:27 +0000"  >&lt;p&gt;Hey Dave, thanks to you for your open mind &lt;img class=&quot;emoticon&quot; src=&quot;https://jira.spring.io/images/icons/emoticons/wink.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt; Isn&apos;t sharing ideas at the heart of open source after all?&lt;/p&gt;

&lt;p&gt;I build my SimpleMessageListenerContainer and then call start and initialize, you can see the code here (but it&apos;s clojure): &lt;a href=&quot;https://github.com/sbtourist/clamq/blob/master/src/clamq/rabbitmq.clj&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://github.com/sbtourist/clamq/blob/master/src/clamq/rabbitmq.clj&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;By the way, I&apos;m glad you opted for a default value of 1, I think it is the best one and avoids violating the principle of least surprise &lt;img class=&quot;emoticon&quot; src=&quot;https://jira.spring.io/images/icons/emoticons/wink.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;

&lt;p&gt;Cheers,&lt;/p&gt;

&lt;p&gt;Sergio B.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_10170" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>First Response Date</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Tue, 5 Apr 2011 01:13:38 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_10280" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>3909</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_10880" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i028zr:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_10380" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>13166</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_10381" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Ranking</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>12911</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_10171" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                </customfields>
    </item>
</channel>
</rss>