<!-- 
RSS generated by JIRA (6.4.11#64026-sha1:78f6ec473a3f058bd5d6c30e9319c7ab376bdb9c) at Thu Dec 22 10:52:17 UTC 2016

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://jira.spring.io/si/jira.issueviews:issue-xml/AMQP-365/AMQP-365.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>Spring JIRA</title>
    <link>https://jira.spring.io</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.4.11</version>
        <build-number>64026</build-number>
        <build-date>25-08-2015</build-date>
    </build-info>

<item>
            <title>[AMQP-365] Fix Race Condition in Consumer Recovery Test Cases</title>
                <link>https://jira.spring.io/browse/AMQP-365</link>
                <project id="10450" key="AMQP">Spring AMQP</project>
                    <description>&lt;h4&gt;&lt;a name=&quot;Analysis&quot;&gt;&lt;/a&gt;Analysis&lt;/h4&gt;

&lt;p&gt;The test cases send 10 messages. The consumer uses manual ack and does a double ack on the first message causing the channel to be closed. It is a race between the broker closing the channel and the second message being received by the listener.&lt;/p&gt;

&lt;p&gt;The listener counts down a latch that the test is waiting on.&lt;/p&gt;

&lt;p&gt;If the broker loses the race, the channel is closed AFTER the second message is received by the listener and the message is redelivered after the consumer is recovered.&lt;/p&gt;

&lt;p&gt;This results in 11 messages being received and the final test for a null message fails.&lt;/p&gt;

&lt;h4&gt;&lt;a name=&quot;Solution&quot;&gt;&lt;/a&gt;Solution&lt;/h4&gt;

&lt;p&gt;In the listener, only count down the latch if the message is NOT a redelivery (because the latch would have already been counted down for this message). However, we can&apos;t just test the redelivered flag - the message might have been sent by the broker but not actually received by the listener.&lt;/p&gt;

&lt;p&gt;Add the message to a &lt;tt&gt;Set&lt;/tt&gt; and only countdown the latch if it&apos;s not already received.&lt;/p&gt;</description>
                <environment></environment>
        <key id="55331">AMQP-365</key>
            <summary>Fix Race Condition in Consumer Recovery Test Cases</summary>
                <type id="7" iconUrl="https://jira.spring.io/images/icons/issuetypes/bug.png">Defect</type>
                                            <priority id="4" iconUrl="https://jira.spring.io/images/icons/priorities/minor.png">Minor</priority>
                        <status id="6" iconUrl="https://jira.spring.io/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="8">Complete</resolution>
                                        <assignee username="grussell">Gary Russell</assignee>
                                    <reporter username="grussell">Gary Russell</reporter>
                        <labels>
                            <label>PullRequest</label>
                    </labels>
                <created>Fri, 24 Jan 2014 13:38:23 +0000</created>
                <updated>Thu, 27 Mar 2014 15:06:43 +0000</updated>
                            <resolved>Mon, 27 Jan 2014 08:42:00 +0000</resolved>
                                    <version>1.2.1</version>
                    <version>1.3.0.M1</version>
                                    <fixVersion>1.3.0.M2</fixVersion>
                    <fixVersion>1.2.2</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>1</watches>
                                                                <comments>
                            <comment id="97902" author="grussell" created="Fri, 24 Jan 2014 14:57:27 +0000"  >&lt;p&gt;1.3.x PR: &lt;a href=&quot;https://github.com/spring-projects/spring-amqp/pull/154&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://github.com/spring-projects/spring-amqp/pull/154&lt;/a&gt;&lt;br/&gt;
1.2.x PR: &lt;a href=&quot;https://github.com/spring-projects/spring-amqp/pull/155&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://github.com/spring-projects/spring-amqp/pull/155&lt;/a&gt;&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                                                                                    <customfield id="customfield_10280" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>41809</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_10880" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i079b3:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_10380" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>42380</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_10381" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Ranking</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>41511</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_10120" key="com.atlassian.jira.plugin.system.customfieldtypes:url">
                        <customfieldname>Reference URL</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[https://build.springsource.org/browse/AMQP-NITEALL-JOB1-124/test/case/135248009]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_10171" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                </customfields>
    </item>
</channel>
</rss>