<!-- 
RSS generated by JIRA (6.4.11#64026-sha1:78f6ec473a3f058bd5d6c30e9319c7ab376bdb9c) at Fri Dec 23 07:08:00 UTC 2016

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://jira.spring.io/si/jira.issueviews:issue-xml/SWS-564/SWS-564.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>Spring JIRA</title>
    <link>https://jira.spring.io</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.4.11</version>
        <build-number>64026</build-number>
        <build-date>25-08-2015</build-date>
    </build-info>

<item>
            <title>[SWS-564] CommonsHttpMessageSender no longer properly shuts down MultiThreadedHttpConnectionManager</title>
                <link>https://jira.spring.io/browse/SWS-564</link>
                <project id="10060" key="SWS">Spring Web Services</project>
                    <description>&lt;p&gt;As of revision 1414 of  CommonsHttpMessageSender, the MultiThreadedHttpConnectionManager never gets it&apos;s shutdown method invoked.&lt;/p&gt;

&lt;p&gt;It appears that the prior revision of CommonsHttpMessageSender implemented DisposableBean, and invoked this properly.&lt;br/&gt;
&lt;a href=&quot;https://jira.spring.io/browse/SWS-482&quot; title=&quot;java.lang.IllegalStateException: Connection factory has been shutdown&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SWS-482&quot;&gt;&lt;del&gt;SWS-482&lt;/del&gt;&lt;/a&gt; removed the destroy method to cope with a problem report, but the result is worse.&lt;/p&gt;

&lt;p&gt;If you use MultiThreadedHttpConnectionManager, you have to call it&apos;s shutdown method, or it will block application exit.&lt;br/&gt;
For example, I have a class with a main method that uses WebServiceTemplate along with CommonsHttpMessageSender that is invoked via an ant task. The main method will complete, but the JVM cannot exit.&lt;/p&gt;

&lt;p&gt;Lets revisit &lt;a href=&quot;https://jira.spring.io/browse/SWS-482&quot; title=&quot;java.lang.IllegalStateException: Connection factory has been shutdown&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SWS-482&quot;&gt;&lt;del&gt;SWS-482&lt;/del&gt;&lt;/a&gt; and come up with a means for resolving the issue appropriately.&lt;br/&gt;
The reporter of that issue mentions that:&lt;br/&gt;
&quot;it happens it is always after we redeploy our application (weblogic 9.2MP2)&quot;.&lt;/p&gt;</description>
                <environment></environment>
        <key id="27909">SWS-564</key>
            <summary>CommonsHttpMessageSender no longer properly shuts down MultiThreadedHttpConnectionManager</summary>
                <type id="1" iconUrl="https://jira.spring.io/images/icons/issuetypes/bug.png">Bug</type>
                                            <priority id="3" iconUrl="https://jira.spring.io/images/icons/priorities/major.png">Major</priority>
                        <status id="6" iconUrl="https://jira.spring.io/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="arjen.poutsma">Arjen Poutsma</assignee>
                                    <reporter username="nblair">Nicholas Blair</reporter>
                        <labels>
                    </labels>
                <created>Wed, 9 Sep 2009 03:22:33 +0000</created>
                <updated>Fri, 4 May 2012 07:03:31 +0000</updated>
                            <resolved>Tue, 10 Nov 2009 00:47:35 +0000</resolved>
                                                    <fixVersion>1.5.9</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                            <timeestimate seconds="0">0d</timeestimate>
                            <timespent seconds="14700">4h 5m</timespent>
                                <comments>
                            <comment id="46616" author="nblair" created="Wed, 9 Sep 2009 03:33:36 +0000"  >&lt;p&gt;The problem reported in &lt;a href=&quot;https://jira.spring.io/browse/SWS-482&quot; title=&quot;java.lang.IllegalStateException: Connection factory has been shutdown&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SWS-482&quot;&gt;&lt;del&gt;SWS-482&lt;/del&gt;&lt;/a&gt; is likely due to the following sequence of events (with the prior revision of CommonsHttpMessageSender):&lt;/p&gt;

&lt;p&gt;1. Customer tries to redeploy application using WebServiceTemplate and CommonsHttpMessageSender.&lt;br/&gt;
2. redeploy results in first stopping application, which shuts down Spring application context.&lt;br/&gt;
3. destroy in WebServiceTemplate results in CommonsHttpMessageSender#destroy&lt;br/&gt;
4. CommonsHttpMessageSender destroy results in MultiThreadedHttpConnectionManager#shutdown&lt;br/&gt;
5. Application shutdown, now started again by the container.&lt;/p&gt;

&lt;p&gt;I think the actual solution here isn&apos;t to remove DisposableBean (and the MultiThreadedHttpConnectionManager#shutdown) implementation on CommonsHttpMessageSender.&lt;/p&gt;

&lt;p&gt;One option might be to alter CommonsHttpMessageSender&apos;s afterPropertiesSet method - it should instantiate a new MultiThreadedHttpConnectionManager and supply it to the internal HttpClient.&lt;/p&gt;</comment>
                            <comment id="46639" author="arjen.poutsma" created="Thu, 10 Sep 2009 18:59:19 +0000"  >&lt;p&gt;Good suggestions, I will take a further look at this for 1.5.9.&lt;/p&gt;

&lt;p&gt;Thanks!&lt;/p&gt;</comment>
                            <comment id="48025" author="arjen.poutsma" created="Tue, 10 Nov 2009 00:47:36 +0000"  >&lt;p&gt;I reintroduced the shutdown() call, and also solved the problem reported in &lt;a href=&quot;https://jira.spring.io/browse/SWS-482&quot; title=&quot;java.lang.IllegalStateException: Connection factory has been shutdown&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SWS-482&quot;&gt;&lt;del&gt;SWS-482&lt;/del&gt;&lt;/a&gt;. &lt;/p&gt;

&lt;p&gt;The underlying problem (in &lt;a href=&quot;https://jira.spring.io/browse/SWS-482&quot; title=&quot;java.lang.IllegalStateException: Connection factory has been shutdown&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SWS-482&quot;&gt;&lt;del&gt;SWS-482&lt;/del&gt;&lt;/a&gt;) was that a connection was retrieved from the CommonsHttpMessageSender, the app context was closed resulting in a the connection pool shutdown, and then the connection was used, resulting in the IllegalStateException. Now, we create a new, single-use connection pool for that connection. Not pretty, but it works.&lt;/p&gt;</comment>
                            <comment id="78262" author="arjen.poutsma" created="Fri, 4 May 2012 07:03:31 +0000"  >&lt;p&gt;Closing old issues&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10020">
                    <name>Related</name>
                                            <outwardlinks description="is related to">
                                        <issuelink>
            <issuekey id="25603">SWS-482</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                    </issuelinks>
                <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_10170" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>First Response Date</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Thu, 10 Sep 2009 18:59:19 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_10280" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>7564</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_10880" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i040br:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_10380" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>23427</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_10381" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Ranking</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>19951</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_10171" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                </customfields>
    </item>
</channel>
</rss>