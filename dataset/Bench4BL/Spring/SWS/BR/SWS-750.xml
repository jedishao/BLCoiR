<!-- 
RSS generated by JIRA (6.4.11#64026-sha1:78f6ec473a3f058bd5d6c30e9319c7ab376bdb9c) at Fri Dec 23 06:56:23 UTC 2016

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://jira.spring.io/si/jira.issueviews:issue-xml/SWS-750/SWS-750.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>Spring JIRA</title>
    <link>https://jira.spring.io</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.4.11</version>
        <build-number>64026</build-number>
        <build-date>25-08-2015</build-date>
    </build-info>

<item>
            <title>[SWS-750] SaajSoapMessageFactory&apos;s checkForUtf8ByteOrderMark is corrupting input stream</title>
                <link>https://jira.spring.io/browse/SWS-750</link>
                <project id="10060" key="SWS">Spring Web Services</project>
                    <description>&lt;p&gt;There appears to be a bug in the implementation of &quot;checkForUtf8ByteOrderMark&quot; in org.springframework.ws.soap.saaj.SaajSoapMessageFactory.&lt;/p&gt;

&lt;p&gt;Under certain circumstances, the call to pushbackInputStream.read(bom) will read less than the required 3 bytes into bom. Then, since the byte order mark isn&apos;t found, unread(bom) is called which results in some invalid bytes being added to the stream.&lt;/p&gt;

&lt;p&gt;The contract for PushbackInputStream.read(byte[] b, int off, int len) says &quot;Reads &lt;b&gt;up to&lt;/b&gt; len bytes of data.&quot; In our case, using Tomcat (versions 6 and 7) with recent releases of Chrome and IE, the call to inputstream.available() in BufferedInputStream&apos;s implementation of read returns 0. This is because no more data can be read without blocking. It seems to be just an unfortunate coincidence caused by the size of the header sent by the newest version of chrome and IE. The end result is that our soap envelope is corrupted and our system is unusable.&lt;/p&gt;</description>
                <environment></environment>
        <key id="41817">SWS-750</key>
            <summary>SaajSoapMessageFactory&apos;s checkForUtf8ByteOrderMark is corrupting input stream</summary>
                <type id="1" iconUrl="https://jira.spring.io/images/icons/issuetypes/bug.png">Bug</type>
                                            <priority id="2" iconUrl="https://jira.spring.io/images/icons/priorities/critical.png">Critical</priority>
                        <status id="6" iconUrl="https://jira.spring.io/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="arjen.poutsma">Arjen Poutsma</assignee>
                                    <reporter username="zakvandermerwe">Zak van der Merwe</reporter>
                        <labels>
                    </labels>
                <created>Fri, 20 Jan 2012 00:25:47 +0000</created>
                <updated>Tue, 20 Aug 2013 03:07:46 +0000</updated>
                            <resolved>Tue, 24 Jan 2012 07:16:16 +0000</resolved>
                                    <version>1.5.8</version>
                    <version>1.5.9</version>
                                    <fixVersion>2.0.4</fixVersion>
                                    <component>Core</component>
                        <due></due>
                            <votes>1</votes>
                                    <watches>2</watches>
                                                    <timespent seconds="1860">31m</timespent>
                                <comments>
                            <comment id="75006" author="arjen.poutsma" created="Tue, 24 Jan 2012 07:14:57 +0000"  >&lt;p&gt;This should be fixed now, as we now only unread the amount of bytes that were actually read.&lt;/p&gt;

&lt;p&gt;I do wonder, however, what Chrome and IE have to do with this bug. Are you sending SOAP messages to Spring-WS from these browsers?&lt;/p&gt;</comment>
                            <comment id="75031" author="zakvandermerwe" created="Tue, 24 Jan 2012 22:57:03 +0000"  >&lt;p&gt;Hi Arjen, thanks for your fast response!&lt;/p&gt;

&lt;p&gt;   &quot;I do wonder, however, what Chrome and IE have to do with this bug. Are you sending SOAP messages to Spring-WS from these browsers?&quot;&lt;br/&gt;
That&apos;s right, we are sending SOAP messages from these browsers. I only included this information in the ticket because it seems strange that we suddenly started to encounter this bug after using spring-ws without problems for a couple of years. We thought it must have something to do with a change in the payload sent by recent versions of these two browsers.&lt;/p&gt;

&lt;p&gt;Your change will fix our issue, but isn&apos;t it possible to miss a valid byte order mark if the first read call doesn&apos;t read all 3 bytes? It seems like you might need to call read() in a loop until 3 bytes have been read.&lt;/p&gt;</comment>
                            <comment id="75032" author="arjen.poutsma" created="Wed, 25 Jan 2012 01:10:39 +0000"  >&lt;p&gt;No problem. I was just wondering about the browser use, I have never seen it before &lt;img class=&quot;emoticon&quot; src=&quot;https://jira.spring.io/images/icons/emoticons/smile.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;.&lt;/p&gt;

&lt;p&gt;With regard to the fix: yes, it is possible to miss a BOM with this new code. However, I think the PushbackInputStream cannot unread multiple reads, so that would defy the purpose. Having a UTF-8 SOAP message with a BOM is quite uncommon anyway, so I don&apos;t think this will bother many users, if any at all.&lt;/p&gt;</comment>
                            <comment id="78366" author="arjen.poutsma" created="Fri, 4 May 2012 07:03:41 +0000"  >&lt;p&gt;Closing old issues&lt;/p&gt;</comment>
                            <comment id="88611" author="pkotlov" created="Sun, 10 Mar 2013 16:49:05 +0000"  >&lt;p&gt;Hello,&lt;/p&gt;

&lt;p&gt;having some hard time thinking of a hotfix for a release still using Spring-ws-1.5.9&lt;/p&gt;

&lt;p&gt;After reading this (It describes my problem pretty exact):&lt;br/&gt;
&lt;a href=&quot;http://forum.springsource.org/showthread.php?131438-Using-spring-ws-behind-https&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://forum.springsource.org/showthread.php?131438-Using-spring-ws-behind-https&lt;/a&gt;&lt;br/&gt;
I assumed SaajSoapMessageFactory could be the root of my problem. &lt;br/&gt;
I have already created a fixed version of spring-ws with the checkForUtf8ByteOrderMark &lt;br/&gt;
Method fixed but I am still facing the same Problem.&lt;/p&gt;

&lt;p&gt;I face the Problem only on my https server and only when using a special service.&lt;/p&gt;

&lt;p&gt;This is the SOAP Message that is passed to Xerces:&lt;br/&gt;
&amp;lt;nullnullSOAP-ENV:Envelope xmlns:SOAP-ENV=&quot;http://schemas.xmlsoap.org/soap/envelope/&quot;&amp;gt;&lt;/p&gt;

&lt;p&gt;For several reasons I will have to update to spring 3.2 and spring-ws 2.1 in 1-2 months. &lt;br/&gt;
It&apos; just, I can&apos;t do it right now.&lt;/p&gt;

&lt;p&gt;Any Help or pointing to the place where my problem could be, will be very much appreciated.&lt;/p&gt;


</comment>
                            <comment id="88612" author="pkotlov" created="Sun, 10 Mar 2013 19:33:59 +0000"  >&lt;p&gt;Hm... after 5 hours of trying different solution I found out that the only code that works for me is:&lt;/p&gt;

&lt;p/&gt;
&lt;div id=&quot;syntaxplugin&quot; class=&quot;syntaxplugin&quot; style=&quot;border: 1px dashed #bbb; border-radius: 5px !important; overflow: auto; max-height: 30em;&quot;&gt;
&lt;table cellspacing=&quot;0&quot; cellpadding=&quot;0&quot; border=&quot;0&quot; width=&quot;100%&quot; style=&quot;font-size: 1em; line-height: 1.4em !important; font-weight: normal; font-style: normal; color: black;&quot;&gt;
		&lt;thead&gt;
			&lt;tr id=&quot;syntaxplugin_title&quot;&gt;
			&lt;td bgcolor=&quot;#f5f5f5&quot; style=&quot;font-family: Arial,sans-serif; color: #333; border-bottom: 1px solid #bbb; background-color: #f5f5f5 !important; font-weight: bold; line-height: 1em;&quot; &gt;
				&lt;p style=&quot;margin: 5px 10px; padding: 0;&quot;&gt;SaajSoapMessageFactory.java&lt;/p&gt;
			&lt;/td&gt;
		&lt;/tr&gt;
			&lt;/thead&gt;
		&lt;tbody &gt;
				&lt;tr id=&quot;syntaxplugin_code_and_gutter&quot;&gt;
						&lt;td  style=&quot; line-height: 1.4em !important; padding: 0em; vertical-align: top;&quot;&gt;
					&lt;pre style=&quot;font-size: 1em; margin: 0 10px;  margin-top: 10px;   width: auto; padding: 0;&quot;&gt;&lt;span style=&quot;color: black; font-family: &apos;Consolas&apos;, &apos;Bitstream Vera Sans Mono&apos;, &apos;Courier New&apos;, Courier, monospace !important;&quot;&gt;    private InputStream checkForUtf8ByteOrderMark(InputStream inputStream) throws IOException {&lt;/span&gt;&lt;/pre&gt;
			&lt;/td&gt;
		&lt;/tr&gt;
				&lt;tr id=&quot;syntaxplugin_code_and_gutter&quot;&gt;
						&lt;td  style=&quot; line-height: 1.4em !important; padding: 0em; vertical-align: top;&quot;&gt;
					&lt;pre style=&quot;font-size: 1em; margin: 0 10px;   width: auto; padding: 0;&quot;&gt;&lt;span style=&quot;color: black; font-family: &apos;Consolas&apos;, &apos;Bitstream Vera Sans Mono&apos;, &apos;Courier New&apos;, Courier, monospace !important;&quot;&gt;        return inputStream;&lt;/span&gt;&lt;/pre&gt;
			&lt;/td&gt;
		&lt;/tr&gt;
				&lt;tr id=&quot;syntaxplugin_code_and_gutter&quot;&gt;
						&lt;td  style=&quot; line-height: 1.4em !important; padding: 0em; vertical-align: top;&quot;&gt;
					&lt;pre style=&quot;font-size: 1em; margin: 0 10px;   margin-bottom: 10px;  width: auto; padding: 0;&quot;&gt;&lt;span style=&quot;color: black; font-family: &apos;Consolas&apos;, &apos;Bitstream Vera Sans Mono&apos;, &apos;Courier New&apos;, Courier, monospace !important;&quot;&gt;    }&lt;/span&gt;&lt;/pre&gt;
			&lt;/td&gt;
		&lt;/tr&gt;
			&lt;/tbody&gt;
&lt;/table&gt;
&lt;/div&gt;
&lt;p/&gt; 
&lt;p&gt;I will digg into it if the update to 3.2/2.1 want work.&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10151">
                    <name>Relate</name>
                                            <outwardlinks description="relates to">
                                        <issuelink>
            <issuekey id="50244">SWS-845</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                    </issuelinks>
                <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_10170" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>First Response Date</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Tue, 24 Jan 2012 07:14:57 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_10280" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>29150</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_10880" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i03lzj:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_10380" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>21104</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_10381" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Ranking</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>17828</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_10171" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                </customfields>
    </item>
</channel>
</rss>