<!-- 
RSS generated by JIRA (6.4.11#64026-sha1:78f6ec473a3f058bd5d6c30e9319c7ab376bdb9c) at Fri Dec 23 09:56:51 UTC 2016

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://jira.spring.io/si/jira.issueviews:issue-xml/SEC-2025/SEC-2025.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>Spring JIRA</title>
    <link>https://jira.spring.io</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.4.11</version>
        <build-number>64026</build-number>
        <build-date>25-08-2015</build-date>
    </build-info>

<item>
            <title>[SEC-2025] HttpSessionSecurityContextRepository restores authentication to the new session if session is invalidated from another thread</title>
                <link>https://jira.spring.io/browse/SEC-2025</link>
                <project id="10040" key="SEC">Spring Security</project>
                    <description>&lt;p&gt;HttpSessionSecurityContextRepository restores authentication to the session if session is invalidated from another thread if SecurityContextPersistenceFilter execution takes significant amount of time.&lt;/p&gt;

&lt;p&gt;I am using Spring + JSF + DWR framework + GWT event service (ajax push). In any time there is at least one thread waiting at the server side for push events. This request is handled by SecurityContextPersistenceFilter which remembers the authentication at the moment of request&apos;s arriving to the server. If during the processing of this filter the session is being invalidated (by clicking logout in another tab of invalidating session by id from admin area) then HttpSessionSecurityContextRepository put the outdated authentication to the new session(which is created by JSF framework, so the session is changed during the processing of SecurityContextPersistenceFilter ).&lt;br/&gt;
This easily reproducable if some processing delay is inserted to SecurityContextPersistenceFilter.&lt;/p&gt;

&lt;p&gt;SaveToSessionResponseWrapper should remember the initial HttpSession and check if the original session was invalidated so it won&apos;t set the current authentication to the new session.&lt;/p&gt;</description>
                <environment>Windows 7 64bit, jdk 1.7.04, tomcat 7.0.28</environment>
        <key id="44787">SEC-2025</key>
            <summary>HttpSessionSecurityContextRepository restores authentication to the new session if session is invalidated from another thread</summary>
                <type id="1" iconUrl="https://jira.spring.io/images/icons/issuetypes/bug.png">Bug</type>
                                            <priority id="4" iconUrl="https://jira.spring.io/images/icons/priorities/minor.png">Minor</priority>
                        <status id="6" iconUrl="https://jira.spring.io/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="rwinch">Rob Winch</assignee>
                                    <reporter username="werdex">Paul Khodchenkov</reporter>
                        <labels>
                    </labels>
                <created>Sun, 5 Aug 2012 09:10:29 +0000</created>
                <updated>Sat, 6 Feb 2016 06:20:16 +0000</updated>
                            <resolved>Fri, 5 Oct 2012 16:41:30 +0000</resolved>
                                    <version>3.0.7</version>
                    <version>3.1.1</version>
                                    <fixVersion>3.0.8</fixVersion>
                    <fixVersion>3.1.3</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>5</watches>
                                                                <comments>
                            <comment id="82337" author="rwinch" created="Tue, 7 Aug 2012 08:26:07 +0000"  >&lt;p&gt;First thank you for taking the time to report the issue and make Spring Security better. I&apos;m afraid the answer to this isn&apos;t quite so simple. I see a few problems with the proposed solution. The first is that user&apos;s may choose not to destroy the HttpSession at time of logout (i.e. setting SecurityContextLogoutHandler.invalidateHttpSession=false). In this case the HTTP session would not be invalidated thus resulting in the same problem. The second issue is that if an HttpSession already existed and session fixation protection was enabled (on by default), the session will always be invalidated and so the SecurityContext would never be stored. In short, I&apos;ll have to give this issue some thought and investigate why some things were done to ensure we don&apos;t break other use cases (i.e. the issue seems related to &lt;a href=&quot;https://jira.spring.io/browse/SEC-1561&quot; title=&quot;HttpSecurityContextRepository fails to store security context to a newly authenticated session&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SEC-1561&quot;&gt;&lt;del&gt;SEC-1561&lt;/del&gt;&lt;/a&gt;)&lt;/p&gt;</comment>
                            <comment id="82338" author="werdex" created="Tue, 7 Aug 2012 08:46:24 +0000"  >&lt;p&gt;Hi Rob,&lt;br/&gt;
One of the possible workarounds is to remember the id of the session which is invalidated by logout(not by session fixation) and then check if the original session id (at the moment of arriving request to SaveToSessionResponseWrapper ) is in the list of invalidated sessions...&lt;/p&gt;</comment>
                            <comment id="83586" author="werdex" created="Fri, 14 Sep 2012 07:20:04 +0000"  >&lt;p&gt;I partially solved the issue by moving long-pooling url to standalone endpoint and creating ReadOnlySecurityContextRepository (which reads , but does not save session authentication)&lt;br/&gt;
&amp;lt;http pattern=&quot;/event/**&quot;  use-expressions=&quot;true&quot;&lt;br/&gt;
          security-context-repository-ref=&quot;readOnlyRepository&quot;&amp;gt;&lt;br/&gt;
&amp;lt;/http&amp;gt;&lt;br/&gt;
However, this will not help in case when some part of the page is reloaded using ajax (which is not long-pooling url) and logout is done at the same time. But now i have a much smaller percents of such cases.&lt;/p&gt;</comment>
                            <comment id="84066" author="rwinch" created="Fri, 5 Oct 2012 16:41:30 +0000"  >&lt;p&gt;This was resolved by updating the SecurityContextLogoutHandler to also remove the Authentication from the SecurityContext. See &lt;a href=&quot;https://github.com/SpringSource/spring-security/commit/d3339a1e32ae356fc108a1bc3ee890706a3a119a#L0R67&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;the commit&lt;/a&gt; for details.&lt;/p&gt;</comment>
                            <comment id="94497" author="variable" created="Tue, 15 Oct 2013 05:39:54 +0000"  >&lt;p&gt;This bug is not fixed. There is still data race. I have updated to spring security 3.1.4. You have to reopen this issue.&lt;/p&gt;

&lt;p&gt;p.s. &quot;I partially solved the issue&quot; =] it would be great if you solve this issue completely ;] thanks.&lt;/p&gt;</comment>
                            <comment id="94500" author="rwinch" created="Tue, 15 Oct 2013 06:03:32 +0000"  >&lt;p&gt;&lt;a href=&quot;https://jira.spring.io/secure/ViewProfile.jspa?name=variable&quot; class=&quot;user-hover&quot; rel=&quot;variable&quot;&gt;variable&lt;/a&gt; Once released issues do not get re-opened. You will need to create a new JIRA if you think you are still experiencing this issue. I still believe this issue has been resolved, so please provide any details on how to reproduce the issue in the newly created JIRA and a link to this issue.&lt;/p&gt;</comment>
                            <comment id="94790" author="variable" created="Wed, 23 Oct 2013 22:23:25 +0000"  >&lt;p&gt;Sorry Rob you are right, this issue has been resolved. I managed to reproduce this issue because when I did logout repeatedly, the logout &quot;GET&quot; request was cached, so that way it looked like user was not logged out.&lt;/p&gt;</comment>
                            <comment id="94808" author="rwinch" created="Thu, 24 Oct 2013 10:54:15 +0000"  >&lt;p&gt;&lt;a href=&quot;https://jira.spring.io/secure/ViewProfile.jspa?name=variable&quot; class=&quot;user-hover&quot; rel=&quot;variable&quot;&gt;variable&lt;/a&gt; Thanks for the update. PS: Once you are able to update to Spring Security 3.2 you can use the cache control support &lt;a href=&quot;http://docs.spring.io/spring-security/site/docs/3.2.x-SNAPSHOT/reference/html5/#headers-cache-control&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://docs.spring.io/spring-security/site/docs/3.2.x-SNAPSHOT/reference/html5/#headers-cache-control&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="94829" author="variable" created="Fri, 25 Oct 2013 04:50:04 +0000"  >&lt;p&gt;Rob, that&apos;s what I did. These configuration with headers are nice feature. Thanks a lot ;]&lt;/p&gt;</comment>
                            <comment id="124991" author="issuemaster" created="Sat, 6 Feb 2016 06:20:16 +0000"  >&lt;p&gt;This issue has been migrated to &lt;a href=&quot;https://github.com/spring-projects/spring-security/issues/2250&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://github.com/spring-projects/spring-security/issues/2250&lt;/a&gt;&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_10170" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>First Response Date</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Tue, 7 Aug 2012 08:26:07 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_10280" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>31831</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_10880" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i05rlb:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_10380" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>33676</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_10381" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Ranking</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>31531</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_10171" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                </customfields>
    </item>
</channel>
</rss>