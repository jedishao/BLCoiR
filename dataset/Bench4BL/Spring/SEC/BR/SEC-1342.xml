<!-- 
RSS generated by JIRA (6.4.11#64026-sha1:78f6ec473a3f058bd5d6c30e9319c7ab376bdb9c) at Fri Dec 23 10:06:05 UTC 2016

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://jira.spring.io/si/jira.issueviews:issue-xml/SEC-1342/SEC-1342.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>Spring JIRA</title>
    <link>https://jira.spring.io</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>6.4.11</version>
        <build-number>64026</build-number>
        <build-date>25-08-2015</build-date>
    </build-info>

<item>
            <title>[SEC-1342] intercept-url EL expressions are parsed or validated incorrectly</title>
                <link>https://jira.spring.io/browse/SEC-1342</link>
                <project id="10040" key="SEC">Spring Security</project>
                    <description>&lt;p&gt;	&amp;lt;security:http use-expressions=&quot;true&quot;&amp;gt;&lt;/p&gt;

&lt;p&gt;		&amp;lt;security:access-denied-handler error-page=&quot;/authfail.html&quot; /&amp;gt;&lt;/p&gt;

&lt;p&gt;		&amp;lt;!-- XXX requires-channel=&quot;https&quot; --&amp;gt;&lt;br/&gt;
		&amp;lt;security:intercept-url pattern=&quot;/app/**&quot; access=&quot;hasAnyRole(&apos;ROLE_A&apos;,&apos;ROLE_B&apos;,&apos;ROLE_C&apos;,&apos;ROLE_D&apos;)&quot; /&amp;gt;&lt;/p&gt;

&lt;p&gt;		&amp;lt;security:intercept-url pattern=&quot;/css/**&quot; access=&quot;isAuthenticated()&quot; /&amp;gt;&lt;/p&gt;

&lt;p&gt;		&amp;lt;security:intercept-url pattern=&quot;/images/logo.png&quot; access=&quot;permitAll&quot; /&amp;gt;&lt;/p&gt;

&lt;p&gt;		&amp;lt;security:intercept-url pattern=&quot;/images/**&quot; access=&quot;isAuthenticated()&quot; /&amp;gt;&lt;/p&gt;

&lt;p&gt;		&amp;lt;security:intercept-url pattern=&quot;/xmlhttp/**&quot; access=&quot;isAuthenticated()&quot; /&amp;gt;&lt;/p&gt;

&lt;p&gt;		&amp;lt;security:intercept-url pattern=&quot;/authfail.html&quot; access=&quot;permitAll&quot; /&amp;gt;&lt;/p&gt;

&lt;p&gt;		&amp;lt;security:intercept-url pattern=&quot;/login.jsp&quot; access=&quot;permitAll&quot; /&amp;gt;&lt;/p&gt;

&lt;p&gt;		&amp;lt;security:intercept-url pattern=&quot;/**&quot; access=&quot;denyAll&quot; /&amp;gt;&lt;/p&gt;

&lt;p&gt;		&amp;lt;security:form-login always-use-default-target=&quot;true&quot; default-target-url=&quot;/app/index.jspx&quot; login-page=&quot;/&quot; /&amp;gt;&lt;/p&gt;

&lt;p&gt;		&amp;lt;security:logout invalidate-session=&quot;true&quot; logout-success-url=&quot;/&quot; /&amp;gt;&lt;/p&gt;

&lt;p&gt;		&amp;lt;security:anonymous /&amp;gt;&lt;/p&gt;

&lt;p&gt;		&amp;lt;security:session-management&amp;gt;&lt;br/&gt;
			&amp;lt;security:concurrency-control max-sessions=&quot;1&quot; /&amp;gt;&lt;br/&gt;
		&amp;lt;/security:session-management&amp;gt;&lt;/p&gt;

&lt;p&gt;	&amp;lt;/security:http&amp;gt;&lt;/p&gt;

&lt;p&gt;When the context loads, this happens:&lt;/p&gt;

&lt;p&gt;Caused by: java.lang.IllegalArgumentException: Expected a single expression attribute for &lt;span class=&quot;error&quot;&gt;&amp;#91;&amp;lt;url&amp;gt;&amp;#93;&lt;/span&gt;&lt;br/&gt;
	at org.springframework.util.Assert.isTrue(Assert.java:65)&lt;br/&gt;
	at org.springframework.security.web.access.expression.ExpressionBasedFilterInvocationSecurityMetadataSource.processMap(ExpressionBasedFilterInvocationSecurityMetadataSource.java:43)&lt;br/&gt;
	at org.springframework.security.web.access.expression.ExpressionBasedFilterInvocationSecurityMetadataSource.&amp;lt;init&amp;gt;(ExpressionBasedFilterInvocationSecurityMetadataSource.java:30)&lt;br/&gt;
	at sun.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method)&lt;br/&gt;
	at sun.reflect.NativeConstructorAccessorImpl.newInstance(NativeConstructorAccessorImpl.java:39)&lt;br/&gt;
	at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:27)&lt;br/&gt;
	at java.lang.reflect.Constructor.newInstance(Constructor.java:513)&lt;br/&gt;
	at org.springframework.beans.BeanUtils.instantiateClass(BeanUtils.java:126)&lt;br/&gt;
	... 37 more&lt;/p&gt;

&lt;p&gt;That bit of code in o.s.s.web.access.expression.ExpressionBasedFilterInvocationSecurityMetadataSource looks like this:&lt;/p&gt;

&lt;p&gt;    public ExpressionBasedFilterInvocationSecurityMetadataSource(UrlMatcher urlMatcher,&lt;br/&gt;
            LinkedHashMap&amp;lt;RequestKey, Collection&amp;lt;ConfigAttribute&amp;gt;&amp;gt; requestMap, WebSecurityExpressionHandler expressionHandler) &lt;/p&gt;
{
        super(urlMatcher, processMap(requestMap, expressionHandler.getExpressionParser()));
        Assert.notNull(expressionHandler, &quot;A non-null SecurityExpressionHandler is required&quot;);
    }

&lt;p&gt;    private static LinkedHashMap&amp;lt;RequestKey, Collection&amp;lt;ConfigAttribute&amp;gt;&amp;gt; processMap(&lt;br/&gt;
            LinkedHashMap&amp;lt;RequestKey,Collection&amp;lt;ConfigAttribute&amp;gt;&amp;gt; requestMap, ExpressionParser parser) {&lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;...&amp;#93;&lt;/span&gt;&lt;br/&gt;
        for (Map.Entry&amp;lt;RequestKey, Collection&amp;lt;ConfigAttribute&amp;gt;&amp;gt; entry : requestMap.entrySet()) {&lt;br/&gt;
            RequestKey request = entry.getKey();&lt;br/&gt;
            Assert.isTrue(entry.getValue().size() == 1, &quot;Expected a single expression attribute for &quot; + request);&lt;/p&gt;

&lt;p&gt;The Assert is line 43, where the failure happens. In the debugger, entry.getValue() has 4 entries. It is basically the expression hasAnyRole(&apos;ROLE_A&apos;,&apos;ROLE_B&apos;,&apos;ROLE_C&apos;,&apos;ROLE_D&apos;) tokenized on the commas.&lt;/p&gt;</description>
                <environment></environment>
        <key id="29381">SEC-1342</key>
            <summary>intercept-url EL expressions are parsed or validated incorrectly</summary>
                <type id="1" iconUrl="https://jira.spring.io/images/icons/issuetypes/bug.png">Bug</type>
                                            <priority id="3" iconUrl="https://jira.spring.io/images/icons/priorities/major.png">Major</priority>
                        <status id="6" iconUrl="https://jira.spring.io/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="luke">Luke Taylor</assignee>
                                    <reporter username="cstach">Christopher G. Stach II</reporter>
                        <labels>
                    </labels>
                <created>Tue, 22 Dec 2009 22:13:05 +0000</created>
                <updated>Sat, 6 Feb 2016 06:13:06 +0000</updated>
                            <resolved>Wed, 23 Dec 2009 00:56:51 +0000</resolved>
                                    <version>3.0.0.RC2</version>
                                    <fixVersion>3.0.1</fixVersion>
                                    <component>Web</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>1</watches>
                                                                <comments>
                            <comment id="49606" author="cstach" created="Tue, 22 Dec 2009 23:38:14 +0000"  >&lt;p&gt;It looks like ConstructorResolver.instantiateUsingFactoryMethod determines that SecurityConfig.createList wants a String[], so it hands it off to BeanWrapperImpl.convertIfNecessary at line 447 to convert. It happily does so at line 225 by tokenizing on commas, and then things proceed to break.&lt;/p&gt;</comment>
                            <comment id="49608" author="luke" created="Tue, 22 Dec 2009 23:56:38 +0000"  >&lt;p&gt;Yes, it looks like Spring is trying to be helpful and converting the String to an array. You can use an &quot;or&quot; expression in the meantime as a workaround.&lt;/p&gt;</comment>
                            <comment id="49613" author="luke" created="Wed, 23 Dec 2009 00:56:51 +0000"  >&lt;p&gt;I&apos;ve added another factory method to SecurityConfig - createSingleAttributeList, which prevents this problem.&lt;/p&gt;</comment>
                            <comment id="124251" author="issuemaster" created="Sat, 6 Feb 2016 06:13:06 +0000"  >&lt;p&gt;This issue has been migrated to &lt;a href=&quot;https://github.com/spring-projects/spring-security/issues/1587&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://github.com/spring-projects/spring-security/issues/1587&lt;/a&gt;&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_10170" key="com.atlassian.jira.ext.charting:firstresponsedate">
                        <customfieldname>First Response Date</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>Tue, 22 Dec 2009 23:56:38 +0000</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_10280" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>19608</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_10880" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i02usf:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_10380" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>16697</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_10381" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Ranking</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>15713</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_10171" key="com.atlassian.jira.ext.charting:timeinstatus">
                        <customfieldname>Time in Status</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                </customfields>
    </item>
</channel>
</rss>