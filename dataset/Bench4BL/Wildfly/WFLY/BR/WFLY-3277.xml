<!-- 
RSS generated by JIRA (7.2.3#72005-sha1:73be91d2b96fc29303a7eb6820acf420e5d0ed65) at Tue Dec 06 13:21:06 EST 2016

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.jboss.org/si/jira.issueviews:issue-xml/WFLY-3277/WFLY-3277.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>JBoss Issue Tracker</title>
    <link>https://issues.jboss.org</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-us</language>    <build-info>
        <version>7.2.3</version>
        <build-number>72005</build-number>
        <build-date>06-10-2016</build-date>
    </build-info>

<item>
            <title>[WFLY-3277] Fix for JAVASERVERFACES-3189 causes memory leak</title>
                <link>https://issues.jboss.org/browse/WFLY-3277</link>
                <project id="12313721" key="WFLY">WildFly</project>
                    <description>&lt;p&gt;Running capedwarf testsuite we found out that after upgrade to 8.1.0.CR1 testsuite does not complete as server dies with OOM.&lt;/p&gt;

&lt;p&gt;I traced problem down to this commit: &lt;a href=&quot;https://github.com/jboss/mojarra/commit/d0f9f873dc0f99047a0a5031631d091fa65b6b33&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://github.com/jboss/mojarra/commit/d0f9f873dc0f99047a0a5031631d091fa65b6b33&lt;/a&gt;&lt;br/&gt;
reverting it fixes the problem.&lt;/p&gt;

&lt;p&gt;For what is worth, I think original problem comes from fact that we somehow register two ConfigureListeners for every deployment.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12538759">WFLY-3277</key>
            <summary>Fix for JAVASERVERFACES-3189 causes memory leak</summary>
                <type id="1" iconUrl="https://issues.jboss.org/secure/viewavatar?size=xsmall&amp;avatarId=13263&amp;avatarType=issuetype">Bug</type>
                                            <priority id="1" iconUrl="https://issues.jboss.org/images/icons/priorities/blocker.svg">Blocker</priority>
                        <status id="5" iconUrl="https://issues.jboss.org/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Done</resolution>
                                        <assignee username="fjuma">Farah Juma</assignee>
                                    <reporter username="ctomc">Tomaz Cerar</reporter>
                        <labels>
                    </labels>
                <created>Tue, 22 Apr 2014 09:10:25 -0400</created>
                <updated>Thu, 4 Sep 2014 09:18:22 -0400</updated>
                            <resolved>Mon, 5 May 2014 09:59:11 -0400</resolved>
                                    <version>8.1.0.CR1</version>
                                    <fixVersion>8.1.0.CR2</fixVersion>
                    <fixVersion>8.1.0.Final</fixVersion>
                                    <component>JSF</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>3</watches>
                                                                <comments>
                            <comment id="12963016" author="ctomc" created="Tue, 22 Apr 2014 09:11:20 -0400"  >&lt;p&gt;Problem can be easily reproduced by attached war.&lt;br/&gt;
Deploy it, undeploy it and do memory dump with profiler&lt;br/&gt;
then look for &quot;DeploymentUnit&quot; instances&lt;/p&gt;</comment>
                            <comment id="12964481" author="fjuma" created="Tue, 29 Apr 2014 12:13:04 -0400"  >&lt;p&gt;Because the JSF implementation module dependency is added to every deployment, one ConfigureListener gets registered for every deployment even if it doesn&apos;t use JSF (the ConfigureListener is defined in the jsf_core.tld file in the jsf-impl.jar). For apps that use JSF, a second ConfigureListener ends up getting added by Mojarra if the app doesn&apos;t contain a mapping of FacesServlet in its web.xml file (this is because of a &lt;a href=&quot;https://issues.jboss.org/browse/WFLY-2594?focusedCommentId=12946617&amp;amp;page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-12946617&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;workaround &lt;/a&gt; for a GlassFish issue that was added to Mojarra 2.x).&lt;/p&gt;

&lt;p&gt;I found that the memory leak only affects non-JSF apps though. As discussed with Tomaz, one way to work around the issue is to have the JSF subsystem remove the ConfigureListener from the TLD metadata unless the app has a mapping of FacesServlet in its web.xml. I tried this out (see &lt;a href=&quot;https://github.com/fjuma/wildfly/commit/fc9157ffc734960f20feb2262ea8c05095479391&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;here&lt;/a&gt;) and it does work. However, I think I just found a better way to fix this in ConfigureListener by making sure that appropriate clean up is done when ConfigureListener.contextInitialized() is called for an app that doesn&apos;t use JSF. I&apos;ve created the following upstream issue and if my fix looks good to the Mojarra team, I can apply it to our fork:&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://java.net/jira/browse/JAVASERVERFACES-3260&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://java.net/jira/browse/JAVASERVERFACES-3260&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="12965215" author="fjuma" created="Fri, 2 May 2014 14:25:24 -0400"  >&lt;p&gt;My patch for &lt;a href=&quot;https://java.net/jira/browse/JAVASERVERFACES-3260&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;JAVASERVERFACES-3260&lt;/a&gt; has been merged upstream. I&apos;ve also applied this fix to our fork and released the 2.2.6-jbossorg-4 version of jsf-impl. With this, I was able to run the CapeDwarf testsuite without running into OOM issues. &lt;a href=&quot;https://issues.jboss.org/secure/ViewProfile.jspa?name=alesj&quot; class=&quot;user-hover&quot; rel=&quot;alesj&quot;&gt;Ales Justin&lt;/a&gt;, please let me know if you still see issues with this though.&lt;/p&gt;</comment>
                            <comment id="12965413" author="alesj" created="Mon, 5 May 2014 04:42:25 -0400"  >&lt;p&gt;&lt;a href=&quot;https://issues.jboss.org/secure/ViewProfile.jspa?name=fjuma&quot; class=&quot;user-hover&quot; rel=&quot;fjuma&quot;&gt;Farah Juma&lt;/a&gt; looks like it&apos;s OK, or at least our CapeDwarf testsuite fully passes.&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10012">
                    <name>Dependency</name>
                                            <outwardlinks description="is blocked by">
                                        <issuelink>
            <issuekey id="12539619">WFLY-3308</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12381975" name="capedwarf-test.war" size="13862" author="ctomc" created="Tue, 22 Apr 2014 09:11:20 -0400"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310641" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Number of attachments</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310640" key="com.atlassian.jira.toolkit:comments">
                        <customfieldname>Number of comments</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>4.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12311940" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1|hznewn:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310840" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>196843</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>