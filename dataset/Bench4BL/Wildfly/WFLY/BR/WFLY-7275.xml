<!-- 
RSS generated by JIRA (7.2.3#72005-sha1:73be91d2b96fc29303a7eb6820acf420e5d0ed65) at Tue Dec 06 14:40:32 EST 2016

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.jboss.org/si/jira.issueviews:issue-xml/WFLY-7275/WFLY-7275.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>JBoss Issue Tracker</title>
    <link>https://issues.jboss.org</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-us</language>    <build-info>
        <version>7.2.3</version>
        <build-number>72005</build-number>
        <build-date>06-10-2016</build-date>
    </build-info>

<item>
            <title>[WFLY-7275] Wildfly eats the CPU up to 100% and does not respond</title>
                <link>https://issues.jboss.org/browse/WFLY-7275</link>
                <project id="12313721" key="WFLY">WildFly</project>
                    <description>&lt;p&gt;Hi!&lt;/p&gt;

&lt;p&gt;I have a JAX-RS application and after a lot of load, one thread eats up the CPU (100% usage) even when the load test app is terminated, and never drops down until I restart the app server.&lt;br/&gt;
It causes me a lot of headeches because it totally makes the app server unusable until I restart, but the users unable to use the app in the meanwhile.&lt;/p&gt;

&lt;p&gt;I&apos;v attached the stack trace but I unfortunately don&apos;t see anything according to my knowledge.&lt;br/&gt;
Please help me, I can provide more information if necessary.&lt;/p&gt;</description>
                <environment>&lt;p&gt;Ubuntu 14.04, Linux 3.19, Oracle Java 8u91 64-bit&lt;/p&gt;</environment>
        <key id="12653856">WFLY-7275</key>
            <summary>Wildfly eats the CPU up to 100% and does not respond</summary>
                <type id="1" iconUrl="https://issues.jboss.org/secure/viewavatar?size=xsmall&amp;avatarId=13263&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.jboss.org/images/icons/priorities/major.svg">Major</priority>
                        <status id="5" iconUrl="https://issues.jboss.org/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Done</resolution>
                                        <assignee username="swd847">Stuart Douglas</assignee>
                                    <reporter username="krisztian.kocsis">Krisztian Kocsis</reporter>
                        <labels>
                    </labels>
                <created>Fri, 7 Oct 2016 13:36:04 -0400</created>
                <updated>Sun, 4 Dec 2016 19:36:17 -0500</updated>
                            <resolved>Sun, 4 Dec 2016 19:36:17 -0500</resolved>
                                    <version>10.1.0.Final</version>
                                    <fixVersion>11.0.0.Alpha1</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>10</watches>
                                                                <comments>
                            <comment id="13304445" author="dmlloyd" created="Fri, 7 Oct 2016 14:00:05 -0400"  >&lt;p&gt;What thread? You can find out by using &quot;ps&quot; or &quot;top&quot; to display the PID of the thread, and then convert that value to hexadecimal and search for that value in the output of jstack.&lt;/p&gt;</comment>
                            <comment id="13304446" author="jamezp" created="Fri, 7 Oct 2016 14:03:12 -0400"  >&lt;p&gt;Are you using a scheduled job with the &lt;tt&gt;ManagedScheduledExecutorService&lt;/tt&gt;? I didn&apos;t look in detail on the thread-dump, but noticed some parked EE concurrency threads. They don&apos;t look unusual, just trying to get an idea of what your application might be doing.&lt;/p&gt;</comment>
                            <comment id="13304448" author="krisztian.kocsis" created="Fri, 7 Oct 2016 14:10:21 -0400"  >&lt;p&gt;@David: I try to reproduce the issue, it takes some time. The main thread was show and 10108 in htop as using 100% but I think there was an other thread too (I don&apos;t remember correctly).&lt;/p&gt;

&lt;p&gt;@James: Yes, I run a periodic (every 2 minutes) EJB task that imports data from one datasource to an other datasource.&lt;/p&gt;</comment>
                            <comment id="13304453" author="krisztian.kocsis" created="Fri, 7 Oct 2016 14:30:36 -0400"  >&lt;p&gt;So, I run a test with *h2load -n 5000 -c 1000 &lt;a href=&quot;https://...*&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://...*&lt;/a&gt;. After that even -c 10 does not work (10 concurrent conn.). I&apos;v attached the screenshots of htop after the load test + two stack traces directly after the hang and after 1min (unable to recover without restart). SSL config: TLS 1.2 only, (ciphers only: AES128GCM, ECDHE+RSA). Note that actually the scheduled EJB task is properly executed in every 2 minutes (checked the log files), only the web interface is dead, but it is totally.&lt;/p&gt;</comment>
                            <comment id="13304459" author="krisztian.kocsis" created="Fri, 7 Oct 2016 14:47:59 -0400"  >&lt;p&gt;Note that I 2 months ago I was able to produce h2load -n 1000000 -c 20000 without any errors to a Vert.X (Netty) server on the same machine.&lt;/p&gt;</comment>
                            <comment id="13304484" author="krisztian.kocsis" created="Fri, 7 Oct 2016 16:17:19 -0400"  >&lt;p&gt;Ok, now I uploaded the real stacktrace &lt;b&gt;wildfly-hang-real-stacktrace.txt&lt;/b&gt;. Unfortunately, the hung threads are in compiled code except 2-3 which are in:&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;org.xnio.ChannelListener.invokeChannelListener(java.nio.channels.Channel, org.xnio.ChannelListener)&lt;/li&gt;
	&lt;li&gt;org.xnio.nio.QueuedTcpServer$1.run()&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="13305943" author="swd847" created="Wed, 12 Oct 2016 05:38:14 -0400"  >&lt;p&gt;I have submitted an XNIO pull request that should fix this. I think the problem is caused by the use of  CONNECTION_HIGH_WATER to control the max number of connections.&lt;/p&gt;</comment>
                            <comment id="13309057" author="heruan" created="Wed, 19 Oct 2016 02:42:05 -0400"  >&lt;p&gt;I&apos;m experiencing this too, can you please link your PR? Thank you!&lt;/p&gt;</comment>
                            <comment id="13309187" author="mkopecky" created="Wed, 19 Oct 2016 05:52:13 -0400"  >&lt;p&gt;PR is linked in &lt;a href=&quot;https://issues.jboss.org/browse/XNIO-276&quot; title=&quot;If QueuedNioTcpServer hits the max connection limit it gets stuck in an infinite loop&quot; class=&quot;issue-link&quot; data-issue-key=&quot;XNIO-276&quot;&gt;&lt;del&gt;XNIO-276&lt;/del&gt;&lt;/a&gt;: &lt;a href=&quot;https://github.com/xnio/xnio/pull/97&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://github.com/xnio/xnio/pull/97&lt;/a&gt;&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="12310120">
                    <name>Cloners</name>
                                            <outwardlinks description="cloned from">
                                        <issuelink>
            <issuekey id="12654364">JBEAP-6397</issuekey>
        </issuelink>
                            </outwardlinks>
                                                                <inwardlinks description="cloned to">
                                        <issuelink>
            <issuekey id="12654358">XNIO-276</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                            <issuelinktype id="10012">
                    <name>Dependency</name>
                                            <outwardlinks description="is blocked by">
                                        <issuelink>
            <issuekey id="12656302">WFCORE-1889</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12410447" name="Screen Shot 2016-10-07 at 20.18.27.png" size="1169264" author="krisztian.kocsis" created="Fri, 7 Oct 2016 14:25:39 -0400"/>
                            <attachment id="12410446" name="Screen Shot 2016-10-07 at 20.18.31.png" size="1163232" author="krisztian.kocsis" created="Fri, 7 Oct 2016 14:25:39 -0400"/>
                            <attachment id="12410448" name="wildfly-after-hang+1min.txt" size="185291" author="krisztian.kocsis" created="Fri, 7 Oct 2016 14:24:18 -0400"/>
                            <attachment id="12410449" name="wildfly-after-hang.txt" size="182871" author="krisztian.kocsis" created="Fri, 7 Oct 2016 14:24:18 -0400"/>
                            <attachment id="12410457" name="wildfly-hang-real-stacktrace.txt" size="102541" author="krisztian.kocsis" created="Fri, 7 Oct 2016 16:13:30 -0400"/>
                            <attachment id="12410444" name="wildfly-hang.txt" size="186207" author="krisztian.kocsis" created="Fri, 7 Oct 2016 13:35:40 -0400"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310641" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Number of attachments</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>6.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310640" key="com.atlassian.jira.toolkit:comments">
                        <customfieldname>Number of comments</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12311940" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1|i09kkf:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310840" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>