<!-- 
RSS generated by JIRA (7.2.3#72005-sha1:73be91d2b96fc29303a7eb6820acf420e5d0ed65) at Mon Dec 12 13:43:02 EST 2016

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.jboss.org/si/jira.issueviews:issue-xml/WFLY-3548/WFLY-3548.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>JBoss Issue Tracker</title>
    <link>https://issues.jboss.org</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-us</language>    <build-info>
        <version>7.2.3</version>
        <build-number>72005</build-number>
        <build-date>06-10-2016</build-date>
    </build-info>

<item>
            <title>[WFLY-3548] JTA synchronization for a distributed transaction called with incorrect TCCL</title>
                <link>https://issues.jboss.org/browse/WFLY-3548</link>
                <project id="12313721" key="WFLY">WildFly</project>
                    <description>&lt;p&gt;It seems the RequestProcessor which is processing JTA synchronizations&lt;br/&gt;
does not have the right TCCL set.&lt;/p&gt;

&lt;p&gt;As a result, during synchronization invocation:&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;&lt;tt&gt;NameNotFoundException&lt;/tt&gt; is thrown for a JNDI lookup of &quot;java:comp/UserTransaction&quot;&lt;/li&gt;
	&lt;li&gt;if we try to acccess &lt;tt&gt;org.jboss.weld.Container&lt;/tt&gt; by means of &lt;tt&gt;org.jboss.as.weld.services.ModuleGroupSingletonProvider.TCCLSingleton&lt;/tt&gt;, we get ISE: &quot;Singleton not set....This means that you are trying to access a weld deployment with a Thread Context ClassLoader that is not associated with the deployment.&quot;&lt;/li&gt;
&lt;/ul&gt;
</description>
                <environment></environment>
        <key id="12544774">WFLY-3548</key>
            <summary>JTA synchronization for a distributed transaction called with incorrect TCCL</summary>
                <type id="1" iconUrl="https://issues.jboss.org/secure/viewavatar?size=xsmall&amp;avatarId=13263&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.jboss.org/images/icons/priorities/major.svg">Major</priority>
                        <status id="5" iconUrl="https://issues.jboss.org/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Done</resolution>
                                        <assignee username="mkouba">Martin Kouba</assignee>
                                    <reporter username="mkouba">Martin Kouba</reporter>
                        <labels>
                    </labels>
                <created>Wed, 25 Jun 2014 08:15:14 -0400</created>
                <updated>Thu, 8 Jan 2015 04:28:43 -0500</updated>
                            <resolved>Thu, 8 Jan 2015 04:28:43 -0500</resolved>
                                    <version>8.1.0.Final</version>
                                    <fixVersion>9.0.0.Beta1</fixVersion>
                                    <component>Transactions</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>7</watches>
                                                                <comments>
                            <comment id="12979951" author="gytis" created="Fri, 27 Jun 2014 09:46:43 -0400"  >&lt;p&gt;&lt;a href=&quot;https://issues.jboss.org/secure/ViewProfile.jspa?name=mkouba&quot; class=&quot;user-hover&quot; rel=&quot;mkouba&quot;&gt;Martin Kouba&lt;/a&gt;, do you have a reproducer by any chance?&lt;/p&gt;</comment>
                            <comment id="12980522" author="mkouba" created="Mon, 30 Jun 2014 03:18:08 -0400"  >&lt;p&gt;One way is described in the referenced &lt;a href=&quot;https://bugzilla.redhat.com/show_bug.cgi?id=1098127&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;bugzilla issue&lt;/a&gt;. &lt;/p&gt;

&lt;p&gt;The other way is a bit simpler:&lt;/p&gt;
&lt;ol&gt;
	&lt;li&gt;Enable JTS&lt;/li&gt;
	&lt;li&gt;Run CDI TCK test: &lt;tt&gt;org.jboss.cdi.tck.tests.event.observer.transactional.TransactionalObserverTest&lt;/tt&gt; - note that this test is currently missing some assertions (&lt;a href=&quot;https://issues.jboss.org/browse/CDITCK-427&quot; title=&quot;NormalSelfConsumingDependentProducer is illegal&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CDITCK-427&quot;&gt;&lt;del&gt;CDITCK-427&lt;/del&gt;&lt;/a&gt;) and does not fail, however you should see exceptions in the log
	&lt;ol&gt;
		&lt;li&gt;git clone git@github.com:weld/core.git&lt;/li&gt;
		&lt;li&gt;cd core/jboss-tck-runner/1.1/&lt;/li&gt;
		&lt;li&gt;mvn clean test -Dincontainer -DtckTest=TransactionalObserverTest#testSucessfullTransaction&lt;/li&gt;
	&lt;/ol&gt;
	&lt;/li&gt;
&lt;/ol&gt;
</comment>
                            <comment id="12985489" author="jira-bugzilla-migration" created="Wed, 16 Jul 2014 04:21:37 -0400"  >&lt;p&gt;Gytis Trikleris &amp;lt;gtrikler@redhat.com&amp;gt; changed the Status of &lt;a href=&quot;https://bugzilla.redhat.com/show_bug.cgi?id=1098127&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;bug 1098127&lt;/a&gt; from NEW to ASSIGNED&lt;/p&gt;</comment>
                            <comment id="12985701" author="gytis" created="Wed, 16 Jul 2014 11:57:05 -0400"  >&lt;p&gt;&lt;a href=&quot;https://issues.jboss.org/secure/ViewProfile.jspa?name=martinkouba&quot; class=&quot;user-hover&quot; rel=&quot;martinkouba&quot;&gt;Martin Kouba&lt;/a&gt;, I have spend a lot of time debugging this issue today, and I think that the problem might not be in the transactions side. I&apos;ll roughly explain what I found bellow.&lt;/p&gt;

&lt;p&gt;I came to this conclusion by adding break points on org.jboss.as.ee.component.NamespaceContextInterceptor#processInvocation and org.jboss.as.naming.InitialContext.DefaultInitialContext#findContext methods. Latter method throws the exception in question (NameNotFoundException), if &quot;comp&quot; context is not available in the context selector. While the first method is responsible for making sure that the correct selector is created before invoking findContext method.&lt;/p&gt;

&lt;p&gt;Problem arises in org.jboss.as.naming.context.NamespaceContextSelector class which uses ThreadLocalStack to keep context selectors. JTA tests work fine because processInvocation and findContext methods are always invoked on the same thread. However, if JTS is enabled it is not always the case. Therefore, if threads are different, required context selector is not available for findContext method, which leads to the NameNotFoundException.&lt;/p&gt;

&lt;p&gt;Any ideas why this could happen?&lt;/p&gt;</comment>
                            <comment id="12985838" author="mkouba" created="Thu, 17 Jul 2014 03:15:22 -0400"  >&lt;p&gt;&lt;a href=&quot;https://issues.jboss.org/secure/ViewProfile.jspa?name=gytis&quot; class=&quot;user-hover&quot; rel=&quot;gytis&quot;&gt;Gytis Trikleris&lt;/a&gt; I have no idea. Maybe there are two unrelated issues (NamespaceContextSelector and TCCL). Have you tried the reproducer attached to the bugzilla issue? This should result in a different exception - see also the description.&lt;/p&gt;</comment>
                            <comment id="13013894" author="zhfeng" created="Tue, 21 Oct 2014 10:37:37 -0400"  >&lt;p&gt;&lt;a href=&quot;https://issues.jboss.org/secure/ViewProfile.jspa?name=mkouba&quot; class=&quot;user-hover&quot; rel=&quot;mkouba&quot;&gt;Martin Kouba&lt;/a&gt; The TCCL issue should be resolve in &lt;a href=&quot;https://issues.jboss.org/browse/JBTM-2272&quot; title=&quot;ISE failure in CDI transactional observer methods with remote EJB call using JTS&quot; class=&quot;issue-link&quot; data-issue-key=&quot;JBTM-2272&quot;&gt;&lt;del&gt;JBTM-2272&lt;/del&gt;&lt;/a&gt; and it needs to upgrade the jbossts version 4.17.24&lt;br/&gt;
In term of the NameNotFoundException, I think the reason that the thread created by the JacOrb might be out of the EE scope and it should not find &quot;java:comp/UserTransaction&quot;.&lt;/p&gt;</comment>
                            <comment id="13022258" author="tomekadamski" created="Mon, 24 Nov 2014 05:07:31 -0500"  >&lt;p&gt;NameNotFound exception fixed.&lt;/p&gt;</comment>
                            <comment id="13023617" author="mkouba" created="Thu, 27 Nov 2014 09:42:29 -0500"  >&lt;p&gt;The &lt;tt&gt;NameNotFoundException&lt;/tt&gt; is gone and the CDI TCK test is passing. Waiting for the verification of the second part of the issue (TCCL).&lt;/p&gt;</comment>
                            <comment id="13025882" author="jira-bugzilla-migration" created="Mon, 8 Dec 2014 08:47:14 -0500"  >&lt;p&gt;Amos Feng &amp;lt;zfeng@redhat.com&amp;gt; changed the Status of &lt;a href=&quot;https://bugzilla.redhat.com/show_bug.cgi?id=1098127&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;bug 1098127&lt;/a&gt; from ASSIGNED to POST&lt;/p&gt;</comment>
                            <comment id="13026006" author="jira-bugzilla-migration" created="Mon, 8 Dec 2014 14:06:34 -0500"  >&lt;p&gt;Kabir Khan &amp;lt;kkhan@redhat.com&amp;gt; changed the Status of &lt;a href=&quot;https://bugzilla.redhat.com/show_bug.cgi?id=1098127&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;bug 1098127&lt;/a&gt; from POST to MODIFIED&lt;/p&gt;</comment>
                            <comment id="13026466" author="jira-bugzilla-migration" created="Tue, 9 Dec 2014 18:17:01 -0500"  >&lt;p&gt;Paul Gier &amp;lt;pgier@redhat.com&amp;gt; changed the Status of &lt;a href=&quot;https://bugzilla.redhat.com/show_bug.cgi?id=1098127&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;bug 1098127&lt;/a&gt; from MODIFIED to ON_QA&lt;/p&gt;</comment>
                            <comment id="13027379" author="jira-bugzilla-migration" created="Fri, 12 Dec 2014 09:54:52 -0500"  >&lt;p&gt;Matous Jobanek &amp;lt;mjobanek@redhat.com&amp;gt; changed the Status of &lt;a href=&quot;https://bugzilla.redhat.com/show_bug.cgi?id=1098127&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;bug 1098127&lt;/a&gt; from ON_QA to VERIFIED&lt;/p&gt;</comment>
                            <comment id="13027921" author="zhfeng" created="Tue, 16 Dec 2014 07:47:56 -0500"  >&lt;p&gt;The TCCL issue should be fixed in Narayana 5.0.4.Final&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10012">
                    <name>Dependency</name>
                                            <outwardlinks description="is blocked by">
                                        <issuelink>
            <issuekey id="12555556">JBTM-2272</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                    </issuelinks>
                <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310440" key="org.jboss.labs.jira.plugin.jboss-custom-field-types-plugin:multiurl">
                        <customfieldname>Bugzilla References</customfieldname>
                        <customfieldvalues>
                            https://bugzilla.redhat.com/show_bug.cgi?id=1098127
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310341" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                        <customfieldname>Bugzilla Update</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10250"><![CDATA[Perform]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310220" key="org.jboss.labs.jira.plugin.jboss-custom-field-types-plugin:multiurl">
                        <customfieldname>Git Pull Request</customfieldname>
                        <customfieldvalues>
                            https://github.com/wildfly/wildfly/pull/6988, https://github.com/wildfly/wildfly/pull/7036
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12310641" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Number of attachments</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310640" key="com.atlassian.jira.toolkit:comments">
                        <customfieldname>Number of comments</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>13.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12311940" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1|hzs2zj:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310840" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                </customfields>
    </item>
</channel>
</rss>