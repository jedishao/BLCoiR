<!-- 
RSS generated by JIRA (7.2.3#72005-sha1:73be91d2b96fc29303a7eb6820acf420e5d0ed65) at Tue Dec 06 12:54:41 EST 2016

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.jboss.org/si/jira.issueviews:issue-xml/WFLY-1329/WFLY-1329.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>JBoss Issue Tracker</title>
    <link>https://issues.jboss.org</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-us</language>    <build-info>
        <version>7.2.3</version>
        <build-number>72005</build-number>
        <build-date>06-10-2016</build-date>
    </build-info>

<item>
            <title>[WFLY-1329] &apos;whoami&apos; operation unexpectedly requires the domain wide configuration lock</title>
                <link>https://issues.jboss.org/browse/WFLY-1329</link>
                <project id="12313721" key="WFLY">WildFly</project>
                    <description>&lt;p&gt;&apos;whoami&apos; operation in domain mode seems to require the domain wide configuration lock.  This is problematic when there is an editing operation of domain.xml like a long running undeployment because all &apos;whoami&apos; requests are blocked by the existing task.  The number of blocked thread increases indefinitely and it will cause an OutOfMemoryError.&lt;br/&gt;
It doesn&apos;t happen in standalone mode.&lt;/p&gt;</description>
                <environment>&lt;p&gt;7.2.0.Final (EAP 6.1.0.Beta1)&lt;/p&gt;</environment>
        <key id="12491500">WFLY-1329</key>
            <summary>&apos;whoami&apos; operation unexpectedly requires the domain wide configuration lock</summary>
                <type id="1" iconUrl="https://issues.jboss.org/secure/viewavatar?size=xsmall&amp;avatarId=13263&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.jboss.org/images/icons/priorities/major.svg">Major</priority>
                        <status id="5" iconUrl="https://issues.jboss.org/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Done</resolution>
                                        <assignee username="emuckenhuber">Emanuel Muckenhuber</assignee>
                                    <reporter username="osamu.nagano">Osamu Nagano</reporter>
                        <labels>
                    </labels>
                <created>Thu, 9 May 2013 23:18:17 -0400</created>
                <updated>Thu, 4 Sep 2014 09:51:15 -0400</updated>
                            <resolved>Mon, 20 May 2013 18:39:20 -0400</resolved>
                                                    <fixVersion>8.0.0.Alpha2</fixVersion>
                                    <component>Domain Management</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>2</watches>
                                                                <comments>
                            <comment id="12773349" author="osamu.nagano" created="Thu, 9 May 2013 23:21:04 -0400"  >&lt;p&gt;Attached &apos;slowdeployweb.war&apos; just sleeps for 1 hour in javax.servlet.ServletContextListener#contextDestroyed() to emulate a long undeployment.&lt;/p&gt;</comment>
                            <comment id="12773350" author="jira-bugzilla-migration" created="Thu, 9 May 2013 23:32:34 -0400"  >&lt;p&gt;Osamu Nagano &amp;lt;onagano@redhat.com&amp;gt; made a comment on &lt;a href=&quot;https://bugzilla.redhat.com/show_bug.cgi?id=960497&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;bug 960497&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;It reproduces in EAP 6.1.0.Beta1 (Wildfly 7.2.0.Final) too.  I created a ticket for the upstream project.&lt;br/&gt;
&lt;a href=&quot;https://issues.jboss.org/browse/WFLY-1329&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.jboss.org/browse/WFLY-1329&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Note that JON agent sends a lot of &apos;whoami&apos; requests periodically.  A long running undeployment and JON are a common environment and OOME in DC is actually happening at the customer.&lt;/p&gt;</comment>
                            <comment id="12778726" author="jira-bugzilla-migration" created="Mon, 3 Jun 2013 04:24:51 -0400"  >&lt;p&gt;Emanuel Muckenhuber &amp;lt;emuckenh@redhat.com&amp;gt; changed the Status of &lt;a href=&quot;https://bugzilla.redhat.com/show_bug.cgi?id=960497&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;bug 960497&lt;/a&gt; from NEW to ASSIGNED&lt;/p&gt;</comment>
                            <comment id="12780894" author="jira-bugzilla-migration" created="Tue, 11 Jun 2013 13:11:37 -0400"  >&lt;p&gt;Brian Stansberry &amp;lt;brian.stansberry@redhat.com&amp;gt; changed the Status of &lt;a href=&quot;https://bugzilla.redhat.com/show_bug.cgi?id=960497&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;bug 960497&lt;/a&gt; from ASSIGNED to POST&lt;/p&gt;</comment>
                            <comment id="12783944" author="jira-bugzilla-migration" created="Mon, 24 Jun 2013 08:27:43 -0400"  >&lt;p&gt;Carlo de Wolf &amp;lt;cdewolf@redhat.com&amp;gt; changed the Status of &lt;a href=&quot;https://bugzilla.redhat.com/show_bug.cgi?id=960497&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;bug 960497&lt;/a&gt; from POST to MODIFIED&lt;/p&gt;</comment>
                            <comment id="12787097" author="jira-bugzilla-migration" created="Tue, 2 Jul 2013 18:05:23 -0400"  >&lt;p&gt;Paul Gier &amp;lt;pgier@redhat.com&amp;gt; changed the Status of &lt;a href=&quot;https://bugzilla.redhat.com/show_bug.cgi?id=960497&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;bug 960497&lt;/a&gt; from MODIFIED to ON_QA&lt;/p&gt;</comment>
                            <comment id="12787619" author="jira-bugzilla-migration" created="Thu, 4 Jul 2013 07:17:24 -0400"  >&lt;p&gt;pkremens@redhat.com made a comment on &lt;a href=&quot;https://bugzilla.redhat.com/show_bug.cgi?id=960497&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;bug 960497&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Verified on EAP 6.1.1 ER2&lt;/p&gt;</comment>
                            <comment id="12787620" author="jira-bugzilla-migration" created="Thu, 4 Jul 2013 07:17:29 -0400"  >&lt;p&gt;pkremens@redhat.com changed the Status of &lt;a href=&quot;https://bugzilla.redhat.com/show_bug.cgi?id=960497&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;bug 960497&lt;/a&gt; from ON_QA to VERIFIED&lt;/p&gt;</comment>
                            <comment id="12797783" author="jira-bugzilla-migration" created="Mon, 19 Aug 2013 22:32:47 -0400"  >&lt;p&gt;Scott Mumford &amp;lt;smumford@redhat.com&amp;gt; made a comment on &lt;a href=&quot;https://bugzilla.redhat.com/show_bug.cgi?id=960497&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;bug 960497&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Emanue, can I ask you to provide some details for the 6.1.1 release notes? &lt;/p&gt;

&lt;p&gt;We need an outline of what was causing the problem to manifest, what change was implemented to fix it, and how the product behaves now to avoid the issue.&lt;/p&gt;

&lt;p&gt;Thanks for any help you can offer.&lt;/p&gt;</comment>
                            <comment id="12798057" author="jira-bugzilla-migration" created="Tue, 20 Aug 2013 19:36:58 -0400"  >&lt;p&gt;Scott Mumford &amp;lt;smumford@redhat.com&amp;gt; made a comment on &lt;a href=&quot;https://bugzilla.redhat.com/show_bug.cgi?id=960497&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;bug 960497&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Thanks for the content Emanual.&lt;/p&gt;

&lt;p&gt;I&apos;ve used it to craft a release note which I&apos;m marking for inclusion in the document.&lt;/p&gt;

&lt;p&gt;Please comment if you feel anything has been lost in translation.&lt;/p&gt;</comment>
                            <comment id="12804810" author="jira-bugzilla-migration" created="Mon, 16 Sep 2013 16:28:32 -0400"  >&lt;p&gt;mark yarborough &amp;lt;myarboro@redhat.com&amp;gt; changed the Status of &lt;a href=&quot;https://bugzilla.redhat.com/show_bug.cgi?id=960497&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;bug 960497&lt;/a&gt; from VERIFIED to CLOSED&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12362435" name="slowdeployweb.war" size="4666" author="osamu.nagano" created="Thu, 9 May 2013 23:21:04 -0400"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310440" key="org.jboss.labs.jira.plugin.jboss-custom-field-types-plugin:multiurl">
                        <customfieldname>Bugzilla References</customfieldname>
                        <customfieldvalues>
                            https://bugzilla.redhat.com/show_bug.cgi?id=960497
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310220" key="org.jboss.labs.jira.plugin.jboss-custom-field-types-plugin:multiurl">
                        <customfieldname>Git Pull Request</customfieldname>
                        <customfieldvalues>
                            https://github.com/wildfly/wildfly/pull/4515
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12310641" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Number of attachments</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310640" key="com.atlassian.jira.toolkit:comments">
                        <customfieldname>Number of comments</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>11.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12311940" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1|hzgtlz:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310840" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>158580</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                            <customfield id="customfield_12310183" key="com.atlassian.jira.plugin.system.customfieldtypes:textarea">
                        <customfieldname>Steps to Reproduce</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>&lt;p&gt;1. Start EAP 6 in domain mode.  The out-of-the-box domain.xml is sufficient.&lt;br/&gt;
2. Deploy attached &apos;slowdeployweb.war&apos;.&lt;br/&gt;
3. Undeploy it from CLI.  It will take about 1 hour.&lt;br/&gt;
4. In another terminal, execute several &apos;whoami&apos; HTTP management requests like this:&lt;br/&gt;
&amp;#8211;&lt;br/&gt;
curl --digest -L -D - &lt;a href=&quot;http://admin:password@localhost:9990/management&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://admin:password@localhost:9990/management&lt;/a&gt; --header &quot;Content-Type: application/json&quot; -d &apos;&lt;/p&gt;
{&quot;operation&quot;:&quot;whoami&quot;,&quot;address&quot;:[],&quot;json.pretty&quot;:1}
&lt;p&gt;&apos; &amp;amp;&lt;br/&gt;
&amp;#8211;&lt;br/&gt;
5. Take a thread dump of the host controller.  You can see all &apos;HttpManagementService-threads&apos; are stuck.&lt;/p&gt;</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>