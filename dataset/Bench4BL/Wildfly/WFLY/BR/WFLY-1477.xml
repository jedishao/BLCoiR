<!-- 
RSS generated by JIRA (7.2.3#72005-sha1:73be91d2b96fc29303a7eb6820acf420e5d0ed65) at Tue Dec 06 14:19:31 EST 2016

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.jboss.org/si/jira.issueviews:issue-xml/WFLY-1477/WFLY-1477.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>JBoss Issue Tracker</title>
    <link>https://issues.jboss.org</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-us</language>    <build-info>
        <version>7.2.3</version>
        <build-number>72005</build-number>
        <build-date>06-10-2016</build-date>
    </build-info>

<item>
            <title>[WFLY-1477] JACC HttpServletRequestPolicyContextHandler removal on single application undeploy impacting all other deployed applications</title>
                <link>https://issues.jboss.org/browse/WFLY-1477</link>
                <project id="12313721" key="WFLY">WildFly</project>
                    <description>&lt;p&gt;Please see the following forum post for a detailed explanation and findings(and potential workaround):&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://community.jboss.org/message/822054#822054&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://community.jboss.org/message/822054#822054&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;If multiple WARs are deployed that depend on a login module leveraging:&lt;/p&gt;

&lt;p&gt;HttpServletRequest request = (HttpServletRequest)PolicyContext.getContext(&quot;javax.servlet.http.HttpServletRequest&quot;);&lt;/p&gt;

&lt;p&gt;then upon undeploy of any web application in the container the HttpServletRequestPolicyContextHandler is removed(deregistered) in the stop() lifecycle method of the JBossWebRealmService, resulting in:&lt;/p&gt;

&lt;p&gt;13:03:35,335 ERROR &lt;span class=&quot;error&quot;&gt;&amp;#91;org.jboss.security.authentication.JBossCachedAuthenticationManager&amp;#93;&lt;/span&gt; (ajp--0.0.0.0-8009-1) Login failure: javax.security.auth.login.LoginException: java.lang.IllegalArgumentException: No PolicyContextHandler for key=javax.servlet.http.HttpServletRequest at javax.security.jacc.PolicyContext.getContext(PolicyContext.java:117)&lt;/p&gt;

&lt;p&gt;for any webapps still deployed for every subsequent access to them.  &lt;/p&gt;

&lt;p&gt;Simply redeploying any ONE of the remaining webapps or the previously undeployed webapp causes this problem to go away for all deployed applications.&lt;/p&gt;</description>
                <environment>&lt;p&gt;CentOS 6.x, JBoss AS 7.1.1.Final&lt;/p&gt;</environment>
        <key id="12493868">WFLY-1477</key>
            <summary>JACC HttpServletRequestPolicyContextHandler removal on single application undeploy impacting all other deployed applications</summary>
                <type id="1" iconUrl="https://issues.jboss.org/secure/viewavatar?size=xsmall&amp;avatarId=13263&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.jboss.org/images/icons/priorities/major.svg">Major</priority>
                        <status id="5" iconUrl="https://issues.jboss.org/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Done</resolution>
                                        <assignee username="ctomc">Tomaz Cerar</assignee>
                                    <reporter username="steve_167">Steve S</reporter>
                        <labels>
                            <label>domain</label>
                            <label>jaas</label>
                            <label>jboss</label>
                            <label>jbossweb</label>
                            <label>login</label>
                            <label>module</label>
                            <label>security</label>
                    </labels>
                <created>Fri, 7 Jun 2013 23:41:52 -0400</created>
                <updated>Thu, 4 Sep 2014 09:51:16 -0400</updated>
                            <resolved>Thu, 27 Feb 2014 05:16:35 -0500</resolved>
                                    <version>8.0.0.Alpha1</version>
                                    <fixVersion>8.0.0.Final</fixVersion>
                                    <component>Web (Undertow)</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>8</watches>
                                                                <comments>
                            <comment id="12780401" author="jaikiran" created="Sat, 8 Jun 2013 09:01:59 -0400"  >&lt;p&gt;FYI - the forum thread notes that this is against 7.1.1. Needs to be tested against WildFly.&lt;/p&gt;</comment>
                            <comment id="12780662" author="steve_167" created="Mon, 10 Jun 2013 18:53:08 -0400"  >&lt;p&gt;I was able to test this out against WildFly 8.0.0.Alpha1 running the jboss web subsystem(not undertow).  I can confirm that the same undesired behavior is present and results in the same exception.  I should be able to test with the undertow subsystem in the next day or two.&lt;/p&gt;</comment>
                            <comment id="12926815" author="fcorneli" created="Tue, 26 Nov 2013 10:29:20 -0500"  >&lt;p&gt;Just tested out the latest WildFly github tree. Issue still present:&lt;br/&gt;
Caused by: java.lang.IllegalArgumentException: No PolicyContextHandler for key=javax.servlet.http.HttpServletRequest&lt;/p&gt;</comment>
                            <comment id="12926977" author="rmaucher" created="Wed, 27 Nov 2013 03:35:27 -0500"  >&lt;p&gt;You mean you&apos;re still using web with Wildfly ? That would not be supported anymore.&lt;/p&gt;</comment>
                            <comment id="12927022" author="fcorneli" created="Wed, 27 Nov 2013 06:01:41 -0500"  >&lt;p&gt;What do you mean by &quot;using web with WildFly&quot;? I use the default Undertow. From a servlet I end up in some EJB3 session bean. There I do:&lt;br/&gt;
HttpServletRequest request = (HttpServletRequest)PolicyContext.getContext(&quot;javax.servlet.http.HttpServletRequest&quot;);&lt;br/&gt;
and then it explodes. This should not happen. I should be able to get the HttpServletRequest.&lt;/p&gt;</comment>
                            <comment id="12927050" author="rmaucher" created="Wed, 27 Nov 2013 07:10:21 -0500"  >&lt;p&gt;Well, the bug is assigned to JBoss Web, not Undertow, and was real (it got fixed in the web subsystem). So if something is wrong about undertow in Wildfly, it is a different issue.&lt;/p&gt;</comment>
                            <comment id="12927057" author="fcorneli" created="Wed, 27 Nov 2013 07:30:32 -0500"  >&lt;p&gt;OK, I didn&apos;t notice the Component being set to JBoss Web. So yes, there seems to be a similar issue with Undertow.&lt;/p&gt;</comment>
                            <comment id="12927722" author="steve_167" created="Mon, 2 Dec 2013 00:19:35 -0500"  >&lt;p&gt;&lt;a href=&quot;https://issues.jboss.org/secure/ViewProfile.jspa?name=rmaucher&quot; class=&quot;user-hover&quot; rel=&quot;rmaucher&quot;&gt;Remy Maucherat&lt;/a&gt; can you provide more information on the official fix that went into the web subsystem?  Thanks.&lt;/p&gt;</comment>
                            <comment id="12927747" author="rmaucher" created="Mon, 2 Dec 2013 03:58:32 -0500"  >&lt;p&gt;It is this PR: &lt;a href=&quot;https://github.com/jbossas/jboss-eap/pull/625&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://github.com/jbossas/jboss-eap/pull/625&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="12943056" author="ctomc" created="Mon, 10 Feb 2014 09:49:31 -0500"  >&lt;p&gt;Frank / Steve, does this issue still occurs in latest builds of WildFly 8?&lt;br/&gt;
There ware many fixes in this area post CR1&lt;/p&gt;</comment>
                            <comment id="12948588" author="ctomc" created="Thu, 27 Feb 2014 05:16:35 -0500"  >&lt;p&gt;This should be fixed in 8.0.0.Final&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310641" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Number of attachments</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310640" key="com.atlassian.jira.toolkit:comments">
                        <customfieldname>Number of comments</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>11.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12311940" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1|hzh9wn:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310840" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>161212</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>