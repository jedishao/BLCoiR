<!-- 
RSS generated by JIRA (7.2.3#72005-sha1:73be91d2b96fc29303a7eb6820acf420e5d0ed65) at Tue Dec 06 12:15:04 EST 2016

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.jboss.org/si/jira.issueviews:issue-xml/WFLY-2391/WFLY-2391.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>JBoss Issue Tracker</title>
    <link>https://issues.jboss.org</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-us</language>    <build-info>
        <version>7.2.3</version>
        <build-number>72005</build-number>
        <build-date>06-10-2016</build-date>
    </build-info>

<item>
            <title>[WFLY-2391] Wildfly caches content in exploded mode, breaking developer productivity</title>
                <link>https://issues.jboss.org/browse/WFLY-2391</link>
                <project id="12313721" key="WFLY">WildFly</project>
                    <description>&lt;p&gt;While I was building a sample application with JBoss Tools 4.1.1.beta1 on WildFly 8.0.Beta1, I noticed that after a few minutes (or a few browser requests), the content of my index.html file seemed to be cached by the server, although I used the &quot;exploded content&quot; deployment mode (since I published the content using the WildFly Server Adapter in JBoss Tools).&lt;/p&gt;



&lt;p&gt;I checked the actual content of the index.html in the deployments folder and it contained the latest changes, which means that the JBoss Tools Server Adapter is doing its job well &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.jboss.org/images/icons/emoticons/wink.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;

&lt;p&gt;I also tried to edit the index.html file directly in the deployments folder, and once again, I got no update in both Chrome and Firefox browsers.&lt;/p&gt;



&lt;p&gt;I checked in the &quot;Network&quot; tab of the browsers and could see that the server response for the index.html page had a &quot;200 OK&quot; status, which means that there&apos;s no browser caching involved.&lt;/p&gt;

&lt;p&gt;I tried to get the index.html page with cUrl and got the same old version, which definitely excludes a browser caching issue.&lt;/p&gt;

&lt;p&gt;At the end of the dat, this means that after a few changes, my browsers keep getting an old version of the deployed resources, which in turns means that I have to stop and restart the server to get the new content, and this is pretty bad in term of dev productivity.&lt;/p&gt;</description>
                <environment>&lt;p&gt;MacOSX with JBossTools 4.1.1.Beta1&lt;/p&gt;</environment>
        <key id="12508879">WFLY-2391</key>
            <summary>Wildfly caches content in exploded mode, breaking developer productivity</summary>
                <type id="1" iconUrl="https://issues.jboss.org/secure/viewavatar?size=xsmall&amp;avatarId=13263&amp;avatarType=issuetype">Bug</type>
                                            <priority id="2" iconUrl="https://issues.jboss.org/images/icons/priorities/critical.svg">Critical</priority>
                        <status id="5" iconUrl="https://issues.jboss.org/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Done</resolution>
                                        <assignee username="swd847">Stuart Douglas</assignee>
                                    <reporter username="xcoulon">Xavier Coulon</reporter>
                        <labels>
                    </labels>
                <created>Mon, 28 Oct 2013 09:24:47 -0400</created>
                <updated>Fri, 14 Oct 2016 18:36:30 -0400</updated>
                            <resolved>Fri, 22 Nov 2013 04:48:43 -0500</resolved>
                                    <version>8.0.0.Beta1</version>
                                    <fixVersion>8.0.0.CR1</fixVersion>
                                    <component>Web (Undertow)</component>
                        <due></due>
                            <votes>5</votes>
                                    <watches>17</watches>
                                                                <comments>
                            <comment id="12825301" author="maxandersen" created="Mon, 28 Oct 2013 11:29:36 -0400"  >&lt;p&gt;&lt;a href=&quot;https://issues.jboss.org/browse/UNDERTOW-117&quot; title=&quot;Implement cache expiration for files based on the Xnio watch service&quot; class=&quot;issue-link&quot; data-issue-key=&quot;UNDERTOW-117&quot;&gt;&lt;del&gt;UNDERTOW-117&lt;/del&gt;&lt;/a&gt; seems related&lt;/p&gt;</comment>
                            <comment id="12825307" author="maxandersen" created="Mon, 28 Oct 2013 12:16:12 -0400"  >&lt;p&gt;I&apos;ve done a bit to reproduce this.&lt;/p&gt;

&lt;p&gt;First of, it does not happen on just a few requests. &lt;br/&gt;
Before 5 hits updates happens including noticing restarts and .dodeploy markers.&lt;/p&gt;

&lt;p&gt;Force refreshing the browser ~5 times and suddenly things gets weird.&lt;br/&gt;
updates to html has no effect.&lt;br/&gt;
restarting via management service sees the module be restarted but the content is still the old one.&lt;br/&gt;
restarting via .dodeploy works too - but content not refreshed.&lt;/p&gt;

&lt;p&gt;This last one I can&apos;t find a way to reproduce reliably but it has happend 3 times now:&lt;br/&gt;
...I&apos;m even seeing the app being undeployed by the server (I didn&apos;t request it, but .undeployed file is there and log prints its undeployed) and the content is still being served. &lt;/p&gt;</comment>
                            <comment id="12825309" author="maxandersen" created="Mon, 28 Oct 2013 12:18:09 -0400"  >&lt;p&gt;only way I found it to be able to reliable reload content is by restarting the server.&lt;/p&gt;</comment>
                            <comment id="12825315" author="maxandersen" created="Mon, 28 Oct 2013 12:38:49 -0400"  >&lt;p&gt;Eventually I end up having that index.html is not serving out content anymore, it returns 0 bytes. Again I have to restart the server.&lt;/p&gt;

</comment>
                            <comment id="12825317" author="maxandersen" created="Mon, 28 Oct 2013 12:40:15 -0400"  >&lt;p&gt;jboss-as-kitchensink-html5-mobile.war.zip is what I put (unzipped) into deployments folder.&lt;/p&gt;

&lt;p&gt;Notice that this app in its state is not a fully working app but it should still not bring wf8/undertow into this state I can&apos;t recover from.&lt;/p&gt;
</comment>
                            <comment id="12825405" author="goot" created="Tue, 29 Oct 2013 02:09:55 -0400"  >&lt;p&gt;I reproduced this issue with Wildfly Beta1. Pleace notice:&lt;/p&gt;

&lt;p&gt;I deployed a simple WAR file containing a Spring project and JSP&apos;s.&lt;br/&gt;
The problem still appeared after I removed the tmp folder from wildfly.&lt;br/&gt;
I can&apos;t debug my EJB&apos;s, even though the handshake has been successful. Debug mode just won&apos;t let me access my EJB code...&lt;br/&gt;
I&apos;ll try to reinstall Wildfly Beta1&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://community.jboss.org/thread/233965&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://community.jboss.org/thread/233965&lt;/a&gt;&lt;/p&gt;

</comment>
                            <comment id="12825455" author="goot" created="Tue, 29 Oct 2013 06:28:41 -0400"  >&lt;p&gt;EDIT: &lt;/p&gt;

&lt;p&gt;I removed caching from servlet container, deploying is now possible&lt;/p&gt;

&lt;p&gt;I removed:&lt;br/&gt;
                &amp;lt;buffer-cache name=&quot;default&quot; buffer-size=&quot;1024&quot; buffers-per-region=&quot;1024&quot; max-regions=&quot;10&quot;/&amp;gt;&lt;/p&gt;

&lt;p&gt;I&apos;m unable to deploy my projects now:&lt;/p&gt;

&lt;p&gt;11:27:20,808 ERROR &lt;span class=&quot;error&quot;&gt;&amp;#91;org.jboss.as.controller.management-operation&amp;#93;&lt;/span&gt; (DeploymentScanner-threads - 2) JBAS014613: Operation (&quot;deploy&quot;) failed - address: (&lt;span class=&quot;error&quot;&gt;&amp;#91;(&amp;quot;deployment&amp;quot; =&amp;gt; &amp;quot;foo_frontend.war&amp;quot;)&amp;#93;&lt;/span&gt;) - failure description: {&quot;JBAS014879: One or more services were unable to start due to one or more indirect dependencies not being available.&quot; =&amp;gt; {&lt;br/&gt;
    &quot;Services that were unable to start:&quot; =&amp;gt; &lt;span class=&quot;error&quot;&gt;&amp;#91;&amp;quot;jboss.deployment.unit.\&amp;quot;foo_frontend.war\&amp;quot;.INSTALL&amp;quot;&amp;#93;&lt;/span&gt;,&lt;br/&gt;
    &quot;Services that may be the cause:&quot; =&amp;gt; [&lt;br/&gt;
        &quot;jboss.remoting.remotingConnectorInfoService.http-remoting-connector&quot;,&lt;br/&gt;
        &quot;jboss.undertow.bufferCache.default&quot;&lt;br/&gt;
    ]&lt;br/&gt;
}}&lt;/p&gt;
</comment>
                            <comment id="12850791" author="xcoulon" created="Tue, 5 Nov 2013 06:00:48 -0500"  >&lt;p&gt;Following &lt;a href=&quot;https://issues.jboss.org/secure/ViewProfile.jspa?name=goot&quot; class=&quot;user-hover&quot; rel=&quot;goot&quot;&gt;Chris R.&lt;/a&gt;&apos;s idea, I configured the buffer-cache to its minimal size as a workaround and it works:&lt;/p&gt;

&lt;p/&gt;
&lt;div id=&quot;syntaxplugin&quot; class=&quot;syntaxplugin&quot; style=&quot;border: 1px dashed #bbb; border-radius: 5px !important; overflow: auto; max-height: 30em;&quot;&gt;
&lt;table cellspacing=&quot;0&quot; cellpadding=&quot;0&quot; border=&quot;0&quot; width=&quot;100%&quot; style=&quot;font-size: 1em; line-height: 1.4em !important; font-weight: normal; font-style: normal; color: black;&quot;&gt;
		&lt;tbody &gt;
				&lt;tr id=&quot;syntaxplugin_code_and_gutter&quot;&gt;
						&lt;td  style=&quot; line-height: 1.4em !important; padding: 0em; vertical-align: top;&quot;&gt;
					&lt;pre style=&quot;font-size: 1em; margin: 0 10px;  margin-top: 10px;   width: auto; padding: 0;&quot;&gt;&lt;span style=&quot;color: black; font-family: &apos;Consolas&apos;, &apos;Bitstream Vera Sans Mono&apos;, &apos;Courier New&apos;, Courier, monospace !important;&quot;&gt;&amp;lt;buffer-caches&amp;gt;&lt;/span&gt;&lt;/pre&gt;
			&lt;/td&gt;
		&lt;/tr&gt;
				&lt;tr id=&quot;syntaxplugin_code_and_gutter&quot;&gt;
						&lt;td  style=&quot; line-height: 1.4em !important; padding: 0em; vertical-align: top;&quot;&gt;
					&lt;pre style=&quot;font-size: 1em; margin: 0 10px;   width: auto; padding: 0;&quot;&gt;&lt;span style=&quot;color: black; font-family: &apos;Consolas&apos;, &apos;Bitstream Vera Sans Mono&apos;, &apos;Courier New&apos;, Courier, monospace !important;&quot;&gt;  &amp;lt;buffer-cache name=&quot;default&quot; buffer-size=&quot;1&quot; buffers-per-region=&quot;1&quot; max-regions=&quot;1&quot;/&amp;gt;&lt;/span&gt;&lt;/pre&gt;
			&lt;/td&gt;
		&lt;/tr&gt;
				&lt;tr id=&quot;syntaxplugin_code_and_gutter&quot;&gt;
						&lt;td  style=&quot; line-height: 1.4em !important; padding: 0em; vertical-align: top;&quot;&gt;
					&lt;pre style=&quot;font-size: 1em; margin: 0 10px;   margin-bottom: 10px;  width: auto; padding: 0;&quot;&gt;&lt;span style=&quot;color: black; font-family: &apos;Consolas&apos;, &apos;Bitstream Vera Sans Mono&apos;, &apos;Courier New&apos;, Courier, monospace !important;&quot;&gt;&amp;lt;/buffer-caches&amp;gt;&lt;/span&gt;&lt;/pre&gt;
			&lt;/td&gt;
		&lt;/tr&gt;
			&lt;/tbody&gt;
&lt;/table&gt;
&lt;/div&gt;
&lt;p/&gt;

&lt;p&gt;You should probably load an unrelated page (like /index.html) 5 times in a row after server startup to fill the cache before working on your application, since the minimal acceptable cache size is 1, not 0.&lt;/p&gt;

&lt;p&gt;Granted, this is just a workaround &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.jboss.org/images/icons/emoticons/wink.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;</comment>
                            <comment id="12850849" author="dimitris" created="Tue, 5 Nov 2013 08:04:29 -0500"  >&lt;p&gt;We definitely need to schedule a fix before final goes out.&lt;/p&gt;</comment>
                            <comment id="12850857" author="swd847" created="Tue, 5 Nov 2013 08:26:02 -0500"  >&lt;p&gt;I have just been waiting for an XNIO release to get this in. Hopefully that will happen today.&lt;/p&gt;</comment>
                            <comment id="12926012" author="xcoulon" created="Fri, 22 Nov 2013 04:56:07 -0500"  >&lt;p&gt;Awesome news, &lt;a href=&quot;https://issues.jboss.org/secure/ViewProfile.jspa?name=swd847&quot; class=&quot;user-hover&quot; rel=&quot;swd847&quot;&gt;Stuart Douglas&lt;/a&gt; ! Thanks !&lt;/p&gt;</comment>
                            <comment id="12926018" author="swd847" created="Fri, 22 Nov 2013 05:11:37 -0500"  >&lt;p&gt;For now this should just expire after 2 seconds. In the very near future it will also support watch service based expiration.&lt;/p&gt;</comment>
                            <comment id="12926022" author="xcoulon" created="Fri, 22 Nov 2013 05:15:22 -0500"  >&lt;p&gt;&lt;a href=&quot;https://issues.jboss.org/secure/ViewProfile.jspa?name=swd847&quot; class=&quot;user-hover&quot; rel=&quot;swd847&quot;&gt;Stuart Douglas&lt;/a&gt;, can you precise what you mean by &apos;it should expire after 2 seconds&apos; ? &lt;br/&gt;
For example, how will the app server behave when a new version of a file is deployed ?&lt;/p&gt;

&lt;p&gt;Thanks.&lt;/p&gt;</comment>
                            <comment id="12926025" author="swd847" created="Fri, 22 Nov 2013 05:23:41 -0500"  >&lt;p&gt;If the file is cached it will only remain cached for at most 2 seconds. If you update a file the longest you will have to wait is 2 seconds before the new content is available. &lt;/p&gt;

&lt;p&gt;The reason why we cache at all is basically just to prevent bogus benchmarks. Without any caching serving resources from an exploded deployment is super slow. &lt;/p&gt;</comment>
                            <comment id="13040386" author="gugrim" created="Mon, 16 Feb 2015 04:32:32 -0500"  >&lt;p&gt;Why does this bug have status &quot;Resolved&quot;. I have this problem all the time on 8.2.0. Wildfly serves old html files even after undeploy, restart and redeploy. The undertow cache seems to survive everything I&apos;ve thrown at it.&lt;/p&gt;</comment>
                            <comment id="13040432" author="rob.stryker" created="Mon, 16 Feb 2015 05:54:30 -0500"  >&lt;p&gt;I just tested this in JBossTools and it seems to work as &lt;a href=&quot;https://issues.jboss.org/secure/ViewProfile.jspa?name=swd847&quot; class=&quot;user-hover&quot; rel=&quot;swd847&quot;&gt;Stuart Douglas&lt;/a&gt; says for wf8.2:   when using an external firefox, it seems to refresh within the 2 seconds limit.  &lt;/p&gt;


&lt;p&gt;In JBT, using the embedded browser, however, the browser can sometimes not refresh properly or show outdated content when using the &apos;run on server&apos; action. See &lt;a href=&quot;https://issues.jboss.org/browse/JBIDE-18685&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.jboss.org/browse/JBIDE-18685&lt;/a&gt;  for our bug on that issue, or the underlying eclipse bug &lt;a href=&quot;https://bugs.eclipse.org/bugs/show_bug.cgi?id=448933&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://bugs.eclipse.org/bugs/show_bug.cgi?id=448933&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="13040434" author="swd847" created="Mon, 16 Feb 2015 05:57:06 -0500"  >&lt;p&gt;I also tested locally, and it worked as expected.&lt;/p&gt;</comment>
                            <comment id="13040455" author="maxandersen" created="Mon, 16 Feb 2015 06:15:54 -0500"  >&lt;p&gt;Stuart - is there  a command line flag we can set to disable this caching completely when launching from jboss tools ?&lt;/p&gt;</comment>
                            <comment id="13040470" author="swd847" created="Mon, 16 Feb 2015 06:47:12 -0500"  >&lt;p&gt;You can remove the buffer cache from the undertow subsystem.&lt;/p&gt;

&lt;p&gt;It really should not be an issue though. For exploded deployments the TTL&lt;br/&gt;
is 2 second, and in most cases the watch service will invalidate it&lt;br/&gt;
immediately.&lt;/p&gt;

&lt;p&gt;Stuart&lt;/p&gt;

&lt;p&gt;On Mon, 16 Feb 2015 7:16 pm Max Rydahl Andersen (JIRA) &amp;lt;issues@jboss.org&amp;gt;&lt;/p&gt;
</comment>
                            <comment id="13307429" author="vachr" created="Fri, 14 Oct 2016 18:36:30 -0400"  >&lt;p&gt;Hi,&lt;br/&gt;
I have the same problem with exploded files. After some time wildfly start to cache XHTML file and provide me old files. I have Wildfly 10.1&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="12310001">
                    <name>Related</name>
                                                                <inwardlinks description="is related to">
                                        <issuelink>
            <issuekey id="12508878">UNDERTOW-117</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                            <issuelinktype id="10011">
                    <name>Superset</name>
                                                                <inwardlinks description="is incorporated by">
                                                        </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12366809" name="jboss-as-kitchensink-html5-mobile.war.zip" size="330225" author="maxandersen" created="Mon, 28 Oct 2013 12:40:15 -0400"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12310010" key="org.jboss.labs.jira.plugin.jboss-custom-field-types-plugin:multiurl">
                        <customfieldname>Forum Reference</customfieldname>
                        <customfieldvalues>
                            https://community.jboss.org/message/843381
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                <customfield id="customfield_12310641" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Number of attachments</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310640" key="com.atlassian.jira.toolkit:comments">
                        <customfieldname>Number of comments</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>20.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12311940" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1|hzje7j:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310840" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>173446</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12310090" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                        <customfieldname>Workaround</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10060"><![CDATA[Workaround Exists]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310091" key="com.atlassian.jira.plugin.system.customfieldtypes:textarea">
                        <customfieldname>Workaround Description</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>&lt;p&gt;Delete the &amp;lt;buffer-cache&amp;gt; element from the undertow subsystem, and also remove the default-buffer-cache=&quot;default&quot;  element from the servlet container.&lt;/p&gt;</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                    </customfields>
    </item>
</channel>
</rss>