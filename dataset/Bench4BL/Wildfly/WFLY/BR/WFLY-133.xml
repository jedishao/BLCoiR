<!-- 
RSS generated by JIRA (7.2.3#72005-sha1:73be91d2b96fc29303a7eb6820acf420e5d0ed65) at Tue Dec 06 12:47:57 EST 2016

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.jboss.org/si/jira.issueviews:issue-xml/WFLY-133/WFLY-133.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>JBoss Issue Tracker</title>
    <link>https://issues.jboss.org</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-us</language>    <build-info>
        <version>7.2.3</version>
        <build-number>72005</build-number>
        <build-date>06-10-2016</build-date>
    </build-info>

<item>
            <title>[WFLY-133] ClusteredSingleSignOn ClassCastException with non-distributable apps</title>
                <link>https://issues.jboss.org/browse/WFLY-133</link>
                <project id="12313721" key="WFLY">WildFly</project>
                    <description>&lt;p&gt;When ClusteredSingleSignOn is enabled, and a user has an active session in a non-distributable web application, invalidating any session in the same SSO from a different AS instance in the cluster causes the following exception (logged numerous times in various ways):&lt;/p&gt;

&lt;p&gt;ERROR &lt;span class=&quot;error&quot;&gt;&amp;#91;org.infinispan.interceptors.InvocationContextInterceptor&amp;#93;&lt;/span&gt; (OOB-20,null) ISPN000136: Execution error: org.infinispan.CacheException: Caught exception &lt;span class=&quot;error&quot;&gt;&amp;#91;java.lang.ClassCastException&amp;#93;&lt;/span&gt; while invoking method &lt;span class=&quot;error&quot;&gt;&amp;#91;public void org.jboss.as.clustering.web.sso.infinispan.SSOClusterManager.cacheEntryRemoved(org.infinispan.notifications.cachelistener.event.CacheEntryRemovedEvent)&amp;#93;&lt;/span&gt; on listener instance: org.jboss.as.clustering.web.sso.infinispan.SSOClusterManager@28e13c84&lt;br/&gt;
...&lt;br/&gt;
Caused by: java.lang.ClassCastException: org.apache.catalina.session.StandardSession cannot be cast to org.jboss.as.web.session.ClusteredSession&lt;br/&gt;
    at org.jboss.as.web.sso.ClusteredSingleSignOn.deregisterLocal(ClusteredSingleSignOn.java:523) &lt;span class=&quot;error&quot;&gt;&amp;#91;jboss-as-web-7.1.3.Final-redhat-4.jar:7.1.3.Final-redhat-4&amp;#93;&lt;/span&gt;&lt;br/&gt;
    ...&lt;/p&gt;</description>
                <environment></environment>
        <key id="12486369">WFLY-133</key>
            <summary>ClusteredSingleSignOn ClassCastException with non-distributable apps</summary>
                <type id="1" iconUrl="https://issues.jboss.org/secure/viewavatar?size=xsmall&amp;avatarId=13263&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.jboss.org/images/icons/priorities/major.svg">Major</priority>
                        <status id="5" iconUrl="https://issues.jboss.org/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Done</resolution>
                                        <assignee username="jesper.pedersen">Jesper Pedersen</assignee>
                                    <reporter username="dereed">Dennis Reed</reporter>
                        <labels>
                    </labels>
                <created>Tue, 5 Mar 2013 18:36:48 -0500</created>
                <updated>Tue, 16 Feb 2016 07:22:05 -0500</updated>
                            <resolved>Mon, 25 Mar 2013 18:46:09 -0400</resolved>
                                                    <fixVersion>8.0.0.Alpha1</fixVersion>
                                    <component>Web (Undertow)</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>3</watches>
                                                                <comments>
                            <comment id="12758762" author="dereed" created="Tue, 5 Mar 2013 18:41:13 -0500"  >&lt;p&gt;The bug is in the following line in ClusteredSingleSignOn#deregisterLocal:&lt;/p&gt;

&lt;p&gt;            ClusteredSession&amp;lt;OutgoingDistributableSessionData&amp;gt; clusteredSession = (ClusteredSession&amp;lt;OutgoingDistributableSessionData&amp;gt;) session ;&lt;/p&gt;

&lt;p&gt;It incorrectly assumes every session tied to the SSO is a ClusteredSession, which is not true for non-distributable applications.&lt;/p&gt;</comment>
                            <comment id="12758764" author="dereed" created="Tue, 5 Mar 2013 18:50:51 -0500"  >&lt;p&gt;This issue was introduced in &lt;a href=&quot;https://issues.jboss.org/browse/AS7-5144&quot; title=&quot;Occurrence of &amp;quot;Exception acquiring ownership of X&amp;quot; when invalidating session with SSO enabled&quot; class=&quot;issue-link&quot; data-issue-key=&quot;AS7-5144&quot;&gt;&lt;del&gt;AS7-5144&lt;/del&gt;&lt;/a&gt;.&lt;/p&gt;</comment>
                            <comment id="12760413" author="jira-bugzilla-migration" created="Mon, 11 Mar 2013 18:12:52 -0400"  >&lt;p&gt;dereed@redhat.com made a comment on &lt;a href=&quot;https://bugzilla.redhat.com/show_bug.cgi?id=920367&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;bug 920367&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.jboss.org/browse/AS7-6681&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.jboss.org/browse/AS7-6681&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;When ClusteredSingleSignOn is enabled, and a user has an active session in a non-distributable web application, invalidating any session in the same SSO from a different AS instance in the cluster causes the following exception (logged numerous times in various ways):&lt;/p&gt;

&lt;p&gt;ERROR &lt;span class=&quot;error&quot;&gt;&amp;#91;org.infinispan.interceptors.InvocationContextInterceptor&amp;#93;&lt;/span&gt; (OOB-20,null) ISPN000136: Execution error: org.infinispan.CacheException: Caught exception &lt;span class=&quot;error&quot;&gt;&amp;#91;java.lang.ClassCastException&amp;#93;&lt;/span&gt; while invoking method &lt;span class=&quot;error&quot;&gt;&amp;#91;public void org.jboss.as.clustering.web.sso.infinispan.SSOClusterManager.cacheEntryRemoved(org.infinispan.notifications.cachelistener.event.CacheEntryRemovedEvent)&amp;#93;&lt;/span&gt; on listener instance: org.jboss.as.clustering.web.sso.infinispan.SSOClusterManager@28e13c84&lt;br/&gt;
...&lt;br/&gt;
Caused by: java.lang.ClassCastException: org.apache.catalina.session.StandardSession cannot be cast to org.jboss.as.web.session.ClusteredSession&lt;br/&gt;
at org.jboss.as.web.sso.ClusteredSingleSignOn.deregisterLocal(ClusteredSingleSignOn.java:523) &lt;span class=&quot;error&quot;&gt;&amp;#91;jboss-as-web-7.1.3.Final-redhat-4.jar:7.1.3.Final-redhat-4&amp;#93;&lt;/span&gt;&lt;br/&gt;
...&lt;/p&gt;</comment>
                            <comment id="12761672" author="dereed" created="Mon, 18 Mar 2013 16:04:36 -0400"  >&lt;p&gt;The behavior is a little different in AS 7.1.3 and AS 7.2.&lt;/p&gt;

&lt;p&gt;In both, this will cause some sessions to not be expired correctly.&lt;br/&gt;
In 7.1.3 this will also cause an error in the request (the error happened during the prepare phase and caused a rollback)&lt;br/&gt;
In 7.2 it will no longer cause an error in the request (side effect of &lt;a href=&quot;https://issues.jboss.org/browse/ISPN-2054&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.jboss.org/browse/ISPN-2054&lt;/a&gt; causes the notification to happen during the commit instead of the prepare phase).&lt;/p&gt;</comment>
                            <comment id="12762489" author="jira-bugzilla-migration" created="Thu, 21 Mar 2013 18:16:00 -0400"  >&lt;p&gt;dereed@redhat.com made a comment on &lt;a href=&quot;https://bugzilla.redhat.com/show_bug.cgi?id=920367&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;bug 920367&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Attaching AS7 test case as a patch.&lt;/p&gt;

&lt;p&gt;Does not detect the bug in EAP 6.1+ due to unrelated changes.&lt;/p&gt;</comment>
                            <comment id="12763068" author="jira-bugzilla-migration" created="Mon, 25 Mar 2013 17:41:38 -0400"  >&lt;p&gt;Brian Stansberry &amp;lt;brian.stansberry@redhat.com&amp;gt; changed the Status of &lt;a href=&quot;https://bugzilla.redhat.com/show_bug.cgi?id=920367&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;bug 920367&lt;/a&gt; from NEW to POST&lt;/p&gt;</comment>
                            <comment id="12763864" author="jira-bugzilla-migration" created="Thu, 28 Mar 2013 15:36:28 -0400"  >&lt;p&gt;Brian Stansberry &amp;lt;brian.stansberry@redhat.com&amp;gt; changed the Status of &lt;a href=&quot;https://bugzilla.redhat.com/show_bug.cgi?id=920367&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;bug 920367&lt;/a&gt; from POST to MODIFIED&lt;/p&gt;</comment>
                            <comment id="12768228" author="jira-bugzilla-migration" created="Wed, 17 Apr 2013 16:15:17 -0400"  >&lt;p&gt;Paul Gier &amp;lt;pgier@redhat.com&amp;gt; changed the Status of &lt;a href=&quot;https://bugzilla.redhat.com/show_bug.cgi?id=920367&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;bug 920367&lt;/a&gt; from MODIFIED to ON_QA&lt;/p&gt;</comment>
                            <comment id="12770669" author="jira-bugzilla-migration" created="Mon, 29 Apr 2013 09:04:28 -0400"  >&lt;p&gt;Jitka Kudrnacova &amp;lt;jkudrnac@redhat.com&amp;gt; made a comment on &lt;a href=&quot;https://bugzilla.redhat.com/show_bug.cgi?id=920367&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;bug 920367&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Verified.&lt;/p&gt;</comment>
                            <comment id="12770670" author="jira-bugzilla-migration" created="Mon, 29 Apr 2013 09:04:29 -0400"  >&lt;p&gt;Jitka Kudrnacova &amp;lt;jkudrnac@redhat.com&amp;gt; changed the Status of &lt;a href=&quot;https://bugzilla.redhat.com/show_bug.cgi?id=920367&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;bug 920367&lt;/a&gt; from ON_QA to VERIFIED&lt;/p&gt;</comment>
                            <comment id="12791880" author="jira-bugzilla-migration" created="Tue, 23 Jul 2013 14:38:22 -0400"  >&lt;p&gt;mark yarborough &amp;lt;myarboro@redhat.com&amp;gt; changed the Status of &lt;a href=&quot;https://bugzilla.redhat.com/show_bug.cgi?id=920367&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;bug 920367&lt;/a&gt; from VERIFIED to CLOSED&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10012">
                    <name>Dependency</name>
                                            <outwardlinks description="is blocked by">
                                        <issuelink>
            <issuekey id="12470138">AS7-5144</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12361093" name="test.war" size="939" author="dereed" created="Tue, 5 Mar 2013 18:39:10 -0500"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                <customfield id="customfield_12310031" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                        <customfieldname>Affects</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10090"><![CDATA[Release Notes]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310440" key="org.jboss.labs.jira.plugin.jboss-custom-field-types-plugin:multiurl">
                        <customfieldname>Bugzilla References</customfieldname>
                        <customfieldvalues>
                            https://bugzilla.redhat.com/show_bug.cgi?id=920367
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310641" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Number of attachments</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310640" key="com.atlassian.jira.toolkit:comments">
                        <customfieldname>Number of comments</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>11.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12311940" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1|hzg1lb:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310840" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>154046</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                            <customfield id="customfield_12310183" key="com.atlassian.jira.plugin.system.customfieldtypes:textarea">
                        <customfieldname>Steps to Reproduce</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>&lt;p&gt;Deploy attached test.war to two clustered instances on the same host (so the SSO cookie is shared).&lt;/p&gt;

&lt;p&gt;Access http://&amp;lt;hostname&amp;gt;:&amp;lt;port&amp;gt;/test for both instances.&lt;br/&gt;
Access http://&amp;lt;hostname&amp;gt;:&amp;lt;port&amp;gt;/test?x=1 for one instance (the x=1 triggers a session.invalidate() call)&lt;/p&gt;

&lt;p&gt;Expected Result: no errors&lt;br/&gt;
Actual Result: The exception in the description&lt;/p&gt;</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>