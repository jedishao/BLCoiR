<!-- 
RSS generated by JIRA (7.2.3#72005-sha1:73be91d2b96fc29303a7eb6820acf420e5d0ed65) at Tue Dec 06 13:17:57 EST 2016

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.jboss.org/si/jira.issueviews:issue-xml/WFLY-2550/WFLY-2550.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>JBoss Issue Tracker</title>
    <link>https://issues.jboss.org</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-us</language>    <build-info>
        <version>7.2.3</version>
        <build-number>72005</build-number>
        <build-date>06-10-2016</build-date>
    </build-info>

<item>
            <title>[WFLY-2550] Setting the response encoding via Filter doesn&apos;t work, is always null</title>
                <link>https://issues.jboss.org/browse/WFLY-2550</link>
                <project id="12313721" key="WFLY">WildFly</project>
                    <description>&lt;p&gt;When trying to set the character encoding of the HTTP response, the encoding stays null.&lt;/p&gt;

&lt;p&gt;This is our filter implementation:&lt;/p&gt;

&lt;p&gt;	public void doFilter(HttpServletRequest request, HttpServletResponse response, HttpSession session,&lt;br/&gt;
			FilterChain chain) throws ServletException, IOException&lt;br/&gt;
	{&lt;br/&gt;
		System.out.println(&quot;encoding is &quot; + request.getCharacterEncoding());&lt;br/&gt;
		if (request.getCharacterEncoding() == null) &lt;/p&gt;
{
			request.setCharacterEncoding(&quot;UTF-8&quot;);
		}
&lt;p&gt;		if (request.getCharacterEncoding() == null) &lt;/p&gt;
{
			System.out.println(&quot;could not set encoding&quot;);
			Thread.dumpStack();
		}

&lt;p&gt;		chain.doFilter(request, response);&lt;br/&gt;
	}&lt;/p&gt;

&lt;p&gt;The stack trace implies that there is only undertow beneath us &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.jboss.org/images/icons/emoticons/wink.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt; Some element in the chain has already touched the response.&lt;/p&gt;

&lt;p&gt;could not set encoding&lt;br/&gt;
java.lang.Exception: Stack trace&lt;br/&gt;
  at java.lang.Thread.dumpStack(Thread.java:1342)&lt;br/&gt;
  at de.mdkgmbh.sp.MdkCharacterEncodingFilter.doFilter(MdkCharacterEncodingFilter.java:24)&lt;br/&gt;
  at org.omnifaces.filter.HttpFilter.doFilter(HttpFilter.java:75)&lt;br/&gt;
  at io.undertow.servlet.core.ManagedFilter.doFilter(ManagedFilter.java:56)&lt;br/&gt;
  at io.undertow.servlet.handlers.FilterHandler$FilterChainImpl.doFilter(FilterHandler.java:132)&lt;br/&gt;
  at io.undertow.servlet.handlers.FilterHandler.handleRequest(FilterHandler.java:85)&lt;br/&gt;
  at io.undertow.servlet.handlers.security.ServletSecurityRoleHandler.handleRequest(ServletSecurityRoleHandler.java:59)&lt;br/&gt;
  at io.undertow.servlet.handlers.ServletDispatchingHandler.handleRequest(ServletDispatchingHandler.java:36)&lt;br/&gt;
  at org.wildfly.extension.undertow.security.SecurityContextAssociationHandler.handleRequest(SecurityContextAssociationHandler.java:81)&lt;br/&gt;
  at io.undertow.server.handlers.PredicateHandler.handleRequest(PredicateHandler.java:25)&lt;br/&gt;
  at io.undertow.servlet.handlers.security.SSLInformationAssociationHandler.handleRequest(SSLInformationAssociationHandler.java:113)&lt;br/&gt;
  at io.undertow.security.handlers.AuthenticationCallHandler.handleRequest(AuthenticationCallHandler.java:52)&lt;br/&gt;
  at io.undertow.security.handlers.AbstractConfidentialityHandler.handleRequest(AbstractConfidentialityHandler.java:45)&lt;br/&gt;
  at io.undertow.servlet.handlers.security.CachedAuthenticatedSessionHandler.handleRequest(CachedAuthenticatedSessionHandler.java:65)&lt;br/&gt;
  at io.undertow.security.handlers.SecurityInitialHandler.handleRequest(SecurityInitialHandler.java:70)&lt;br/&gt;
  at io.undertow.server.handlers.PredicateHandler.handleRequest(PredicateHandler.java:25)&lt;br/&gt;
  at io.undertow.server.handlers.PredicateHandler.handleRequest(PredicateHandler.java:25)&lt;br/&gt;
  at io.undertow.servlet.handlers.ServletInitialHandler.handleFirstRequest(ServletInitialHandler.java:218)&lt;br/&gt;
  at io.undertow.servlet.handlers.ServletInitialHandler.dispatchRequest(ServletInitialHandler.java:205)&lt;br/&gt;
  at io.undertow.servlet.handlers.ServletInitialHandler.access$000(ServletInitialHandler.java:69)&lt;br/&gt;
  at io.undertow.servlet.handlers.ServletInitialHandler$1.handleRequest(ServletInitialHandler.java:134)&lt;br/&gt;
  at io.undertow.server.HttpHandlers.executeRootHandler(HttpHandlers.java:36)&lt;br/&gt;
  at io.undertow.server.HttpServerExchange$1.run(HttpServerExchange.java:619)&lt;br/&gt;
  at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1145)&lt;br/&gt;
  at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:615)&lt;br/&gt;
  at java.lang.Thread.run(Thread.java:722)&lt;/p&gt;

&lt;p&gt;We need a solution for this, as we rely on UTF-8.&lt;/p&gt;

&lt;p&gt;We have found no way to configure the listener either, seeing that the old JBoss Web way doesn&apos;t work anymore (&lt;a href=&quot;https://issues.jboss.org/browse/WFLY-2276&quot; title=&quot;URI ENCODING does not work in the beta1 version (UTF-8)&quot; class=&quot;issue-link&quot; data-issue-key=&quot;WFLY-2276&quot;&gt;&lt;del&gt;WFLY-2276&lt;/del&gt;&lt;/a&gt;)&lt;/p&gt;</description>
                <environment>&lt;p&gt;Linux and Windows&lt;/p&gt;</environment>
        <key id="12525903">WFLY-2550</key>
            <summary>Setting the response encoding via Filter doesn&apos;t work, is always null</summary>
                <type id="1" iconUrl="https://issues.jboss.org/secure/viewavatar?size=xsmall&amp;avatarId=13263&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.jboss.org/images/icons/priorities/major.svg">Major</priority>
                        <status id="5" iconUrl="https://issues.jboss.org/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="3">Duplicate Issue</resolution>
                                        <assignee username="swd847">Stuart Douglas</assignee>
                                    <reporter username="dxmann73">David Mann</reporter>
                        <labels>
                            <label>undertow</label>
                            <label>utf-8</label>
                    </labels>
                <created>Fri, 22 Nov 2013 06:43:41 -0500</created>
                <updated>Thu, 4 Sep 2014 09:32:05 -0400</updated>
                            <resolved>Fri, 22 Nov 2013 08:00:23 -0500</resolved>
                                    <version>8.0.0.Beta1</version>
                                                    <component>Web (Undertow)</component>
                        <due></due>
                            <votes>1</votes>
                                    <watches>4</watches>
                                                                <comments>
                            <comment id="12926041" author="ctomc" created="Fri, 22 Nov 2013 06:48:37 -0500"  >&lt;p&gt;We added many configuration options for listeners after beta1.&lt;br/&gt;
one of them is also encoding.&lt;/p&gt;

&lt;p&gt;could you try with nightly build &lt;a href=&quot;https://community.jboss.org/thread/224262&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://community.jboss.org/thread/224262&lt;/a&gt; and let us know if problems persists?&lt;/p&gt;

</comment>
                            <comment id="12926044" author="dxmann73" created="Fri, 22 Nov 2013 07:09:56 -0500"  >&lt;p&gt;Thanks Tomaz for the quick reply. We had the same problem with yesterdays nightly build.&lt;/p&gt;

&lt;p&gt;The only possible option that I can see from the xsd  is &lt;br/&gt;
 &amp;lt;xs:attribute name=&quot;url-charset&quot; type=&quot;xs:string&quot; default=&quot;UTF-8&quot;/&amp;gt;&lt;br/&gt;
which relates to the URI and defaults to UTF-8 anyway.&lt;/p&gt;

&lt;p&gt;Maybe there are other options that I am not aware of?&lt;/p&gt;</comment>
                            <comment id="12926046" author="swd847" created="Fri, 22 Nov 2013 07:14:14 -0500"  >&lt;p&gt;This is caused by &lt;a href=&quot;https://issues.jboss.org/browse/WELD-1549&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.jboss.org/browse/WELD-1549&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;See the workaround in the issue description. &lt;/p&gt;

&lt;p&gt;This is a problem, and I think we are going to have to come up with some kind of solution, even if it is not 100% compliant with the CDI spec.&lt;/p&gt;</comment>
                            <comment id="12926058" author="dxmann73" created="Fri, 22 Nov 2013 07:57:53 -0500"  >&lt;p&gt;Thanks, putting the CDI Conversation Filter after our Filter worked.&lt;/p&gt;

&lt;p&gt;Regarding a possible solution: Couldn&apos;t undertow set the character set of the response &lt;b&gt;before&lt;/b&gt; the conversation filter kicks in? Looking at the stacktrace above, there seem to be a lot of possibilities for this.&lt;/p&gt;

&lt;p&gt;Resolving this because a workaround exists.&lt;/p&gt;</comment>
                            <comment id="12926059" author="dxmann73" created="Fri, 22 Nov 2013 08:00:23 -0500"  >&lt;p&gt;Caused by &lt;a href=&quot;https://issues.jboss.org/browse/WELD-1549&quot; title=&quot;ConversationContextActivator calls Request.getParameter(), which forces form data to be parsed&quot; class=&quot;issue-link&quot; data-issue-key=&quot;WELD-1549&quot;&gt;&lt;del&gt;WELD-1549&lt;/del&gt;&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Workaround exists, see &lt;a href=&quot;http://weld.cdi-spec.org/documentation/#3&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://weld.cdi-spec.org/documentation/#3&lt;/a&gt; (you need a custom Filter to set the character set in the response, see description for a possible implementation, based on OmniFaces)&lt;/p&gt;</comment>
                            <comment id="12926063" author="ctomc" created="Fri, 22 Nov 2013 08:10:53 -0500"  >&lt;p&gt;&lt;a href=&quot;https://issues.jboss.org/secure/ViewProfile.jspa?name=dxmann73&quot; class=&quot;user-hover&quot; rel=&quot;dxmann73&quot;&gt;David Mann&lt;/a&gt; see also &lt;a href=&quot;https://issues.jboss.org/browse/WFLY-2533&quot; title=&quot;Add ability to set default character encoding on a subsystem level&quot; class=&quot;issue-link&quot; data-issue-key=&quot;WFLY-2533&quot;&gt;&lt;del&gt;WFLY-2533&lt;/del&gt;&lt;/a&gt; which will allow you to set default encoding for deployment / server-wide&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10012">
                    <name>Dependency</name>
                                            <outwardlinks description="is blocked by">
                                        <issuelink>
            <issuekey id="12526694">CDI-411</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                    </issuelinks>
                <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310641" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Number of attachments</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310640" key="com.atlassian.jira.toolkit:comments">
                        <customfieldname>Number of comments</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>6.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12311940" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1|hzkydj:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310840" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>182525</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>