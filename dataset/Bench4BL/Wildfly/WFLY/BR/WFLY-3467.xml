<!-- 
RSS generated by JIRA (7.2.3#72005-sha1:73be91d2b96fc29303a7eb6820acf420e5d0ed65) at Mon Dec 12 13:34:51 EST 2016

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.jboss.org/si/jira.issueviews:issue-xml/WFLY-3467/WFLY-3467.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>JBoss Issue Tracker</title>
    <link>https://issues.jboss.org</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-us</language>    <build-info>
        <version>7.2.3</version>
        <build-number>72005</build-number>
        <build-date>06-10-2016</build-date>
    </build-info>

<item>
            <title>[WFLY-3467] Wildfly URI encoding (again..)</title>
                <link>https://issues.jboss.org/browse/WFLY-3467</link>
                <project id="12313721" key="WFLY">WildFly</project>
                    <description>&lt;p&gt;I have a very simple Servlet&lt;/p&gt;

&lt;p&gt;@WebServlet(&quot;/HelloServlet&quot;)&lt;br/&gt;
public class HelloServlet extends HttpServlet&lt;/p&gt;

&lt;p&gt;with a doGet method that prints and returns the &quot;foo&quot; parameter:&lt;/p&gt;

&lt;p&gt;protected void doGet(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException &lt;/p&gt;
{
		response.setContentType(&quot;text/html;charset=UTF-8&quot;);
		PrintWriter out = response.getWriter();
		String foo = request.getParameter(&quot;foo&quot;);
		out.println(&quot;Hello &quot; + foo);
		System.out.println(&quot;Hello &quot; + foo);
		out.close();
	}

&lt;p&gt;When running jboss 7.1.1.Final this works fine. I can test with a simple curl script:&lt;/p&gt;

&lt;p&gt;curl &lt;a href=&quot;http://127.0.0.1:8080/hello-1/HelloServlet?foo=b$&amp;#39;xc3xa5&amp;#39;r&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://127.0.0.1:8080/hello-1/HelloServlet?foo=b$&apos;\xc3\xa5&apos;r&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;where  $&apos;\xc3\xa5&apos; is &quot;aring&quot; or &quot;a with a ring&quot;, (&#229;). I know the console can handle this, because echo $&apos;\xc3\xa5&apos; gives:&lt;/p&gt;

&lt;p&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;slydell@localhost hello&amp;#93;&lt;/span&gt;$ echo $&apos;\xc3\xa5&apos;&lt;br/&gt;
&#229;&lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;slydell@localhost hello&amp;#93;&lt;/span&gt;$ &lt;/p&gt;

&lt;p&gt;If I run the curl script on jboss 7.1.1.Final I get:&lt;/p&gt;

&lt;p&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;slydell@localhost hello&amp;#93;&lt;/span&gt;$ curl &lt;a href=&quot;http://127.0.0.1:8080/hello-1/HelloServlet?foo=b$&amp;#39;xc3xa5&amp;#39;r&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://127.0.0.1:8080/hello-1/HelloServlet?foo=b$&apos;\xc3\xa5&apos;r&lt;/a&gt;&lt;br/&gt;
Hello b&#195;&#165;r&lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;slydell@localhost hello&amp;#93;&lt;/span&gt;$&lt;/p&gt;

&lt;p&gt;and the jboss console output says:&lt;br/&gt;
09:18:19,483 INFO  &lt;span class=&quot;error&quot;&gt;&amp;#91;stdout&amp;#93;&lt;/span&gt; (http--127.0.0.1-8080-1) Hello b&#195;&#165;r&lt;/p&gt;

&lt;p&gt;I can change this output by adding &lt;br/&gt;
JAVA_OPTS=&quot;$JAVA_OPTS -Dorg.apache.catalina.connector.URI_ENCODING=UTF-8&quot;&lt;/p&gt;

&lt;p&gt;to the standalone.conf. With that flag I get:&lt;/p&gt;

&lt;p&gt;09:20:57,780 INFO  &lt;span class=&quot;error&quot;&gt;&amp;#91;stdout&amp;#93;&lt;/span&gt; (http--127.0.0.1-8080-1) Hello b&#229;r&lt;/p&gt;

&lt;p&gt;But when I run the curl script on wildfly 8.1.0.Final I get different results. I know that the catalina flag has no effect on undertow, and I have also tried all the workarounds I&apos;ve seen, e.g.&lt;/p&gt;

&lt;ul&gt;
	&lt;li&gt;implement a CharacterEncoding filter&lt;/li&gt;
	&lt;li&gt;set encoding in jboss-web.xml&lt;/li&gt;
	&lt;li&gt;set default-encoding in servlet-containter in the standalone.xml&lt;/li&gt;
	&lt;li&gt;set encoding in the http-listener in the standalone.xml&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;None of these workarounds have any effect. I always get the same result:&lt;/p&gt;

&lt;p&gt;09:22:42,330 INFO  &lt;span class=&quot;error&quot;&gt;&amp;#91;stdout&amp;#93;&lt;/span&gt; (default task-1) Hello b&#65475;&#65445;r&lt;br/&gt;
which does not look like anything I&apos;ve seen in UTF-8 or ISO-8859-1.&lt;/p&gt;

&lt;p&gt;If I could get the same output as I do in the jboss 7.1.1.Final (without the catalina flag) I would be very happy. The standard non-modified jboss 7.1.1 gave me this output:&lt;/p&gt;

&lt;p&gt;09:31:11,723 INFO  &lt;span class=&quot;error&quot;&gt;&amp;#91;stdout&amp;#93;&lt;/span&gt; (http--127.0.0.1-8080-1) Hello b&#195;&#165;r&lt;/p&gt;

&lt;p&gt;So my question is, how do I modify/configure wildfly so that I get the same output as I do in the standard jboss 7.1.1.Final?  I have tried the known workarounds, and they did not change any output.&lt;/p&gt;</description>
                <environment>&lt;p&gt;Linux CentOS&lt;/p&gt;</environment>
        <key id="12543131">WFLY-3467</key>
            <summary>Wildfly URI encoding (again..)</summary>
                <type id="1" iconUrl="https://issues.jboss.org/secure/viewavatar?size=xsmall&amp;avatarId=13263&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.jboss.org/images/icons/priorities/major.svg">Major</priority>
                        <status id="5" iconUrl="https://issues.jboss.org/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Done</resolution>
                                        <assignee username="swd847">Stuart Douglas</assignee>
                                    <reporter username="psonpson2">Bob Slydell</reporter>
                        <labels>
                    </labels>
                <created>Sat, 7 Jun 2014 05:41:23 -0400</created>
                <updated>Wed, 8 Oct 2014 18:18:25 -0400</updated>
                            <resolved>Wed, 8 Oct 2014 18:18:24 -0400</resolved>
                                    <version>8.1.0.Final</version>
                                    <fixVersion>9.0.0.Beta1</fixVersion>
                                    <component>Web (Undertow)</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>3</watches>
                                                                <comments>
                            <comment id="12975822" author="swd847" created="Thu, 12 Jun 2014 15:28:07 -0400"  >&lt;p&gt;So if the URL is encoded using percent encoding ?foo=b%c3%a5r gives the expected response (Hello b&#229;r), from my testing browsers will do this encoding automatically.&lt;/p&gt;

&lt;p&gt;As far as I can tell according to rfc3986 this is the correct behaviour, as URL&apos;s should not have UTF-8 bytes embedded directly in the URL.&lt;/p&gt;</comment>
                            <comment id="13004548" author="swd847" created="Mon, 22 Sep 2014 02:19:35 -0400"  >&lt;p&gt;Undertow 1.1.0.Beta9 will include support for non percent encoded URL&apos;s.&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10012">
                    <name>Dependency</name>
                                            <outwardlinks description="is blocked by">
                                        <issuelink>
            <issuekey id="12543696">UNDERTOW-257</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                    </issuelinks>
                <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310641" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Number of attachments</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310640" key="com.atlassian.jira.toolkit:comments">
                        <customfieldname>Number of comments</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12311940" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1|hzo4o7:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310840" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>201041</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12310183" key="com.atlassian.jira.plugin.system.customfieldtypes:textarea">
                        <customfieldname>Steps to Reproduce</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>&lt;ul&gt;
	&lt;li&gt;Run CentOS.&lt;/li&gt;
	&lt;li&gt;Create a war file that contains the servlet shown above&lt;/li&gt;
	&lt;li&gt;unzip the standard jboss 7.1.1.Final&lt;/li&gt;
	&lt;li&gt;copy the war to standalone/deployments&lt;/li&gt;
	&lt;li&gt;run curl &lt;a href=&quot;http://127.0.0.1:8080/hello-1/HelloServlet?foo=b$&amp;#39;xc3xa5&amp;#39;r&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://127.0.0.1:8080/hello-1/HelloServlet?foo=b$&apos;\xc3\xa5&apos;r&lt;/a&gt;&lt;/li&gt;
	&lt;li&gt;unzip the standard wildfly 8.1.0.Final&lt;/li&gt;
	&lt;li&gt;copy the war to standalone/deployments&lt;/li&gt;
	&lt;li&gt;run curl &lt;a href=&quot;http://127.0.0.1:8080/hello-1/HelloServlet?foo=b$&amp;#39;xc3xa5&amp;#39;r&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://127.0.0.1:8080/hello-1/HelloServlet?foo=b$&apos;\xc3\xa5&apos;r&lt;/a&gt;&lt;/li&gt;
	&lt;li&gt;Note the differences in the console output&lt;/li&gt;
&lt;/ul&gt;
</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>