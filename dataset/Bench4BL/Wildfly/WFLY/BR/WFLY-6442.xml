<!-- 
RSS generated by JIRA (7.2.3#72005-sha1:73be91d2b96fc29303a7eb6820acf420e5d0ed65) at Tue Dec 06 11:43:04 EST 2016

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.jboss.org/si/jira.issueviews:issue-xml/WFLY-6442/WFLY-6442.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>JBoss Issue Tracker</title>
    <link>https://issues.jboss.org</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-us</language>    <build-info>
        <version>7.2.3</version>
        <build-number>72005</build-number>
        <build-date>06-10-2016</build-date>
    </build-info>

<item>
            <title>[WFLY-6442] Inconsistent behavior of journal object store for heuristic state</title>
                <link>https://issues.jboss.org/browse/WFLY-6442</link>
                <project id="12313721" key="WFLY">WildFly</project>
                    <description>&lt;p&gt;We do experience inconsistent behavior of journal object store (amq) against shadow store. This starts to happen from EAP7/Narayana 5.2.14.Final.&lt;/p&gt;

&lt;p&gt;Our test case:&lt;br/&gt;
*&#160;enlist activemq JMS resource&lt;br/&gt;
*&#160;enlist test XA resource&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;prepare JMS resource&lt;/li&gt;
	&lt;li&gt;prepare test XA resource&lt;/li&gt;
	&lt;li&gt;commit JMS resource&lt;/li&gt;
	&lt;li&gt;commit test XA resource
	&lt;ul&gt;
		&lt;li&gt;byteman force &lt;tt&gt;topLevelCommit&lt;/tt&gt; to return &lt;tt&gt;XAException.XA_HEURRB&lt;/tt&gt;&lt;br/&gt;
2PC result for XA resource is &lt;tt&gt;TwoPhaseOutcome.HEURISTIC_HAZARD&lt;/tt&gt; and client gets &lt;tt&gt;javax.transaction.HeuristicMixedException&lt;/tt&gt;&#160;&lt;/li&gt;
	&lt;/ul&gt;
	&lt;/li&gt;
	&lt;li&gt;probing log and showing state of transactions &lt;tt&gt;/subsystem=transactions/log-store=log-store:probe&lt;/tt&gt;
	&lt;ul&gt;
		&lt;li&gt;expecting one indoubt participant in HEURISTIC state&lt;/li&gt;
	&lt;/ul&gt;
	&lt;/li&gt;
	&lt;li&gt;calling operation &lt;tt&gt;recovery&lt;/tt&gt; on all transaction&apos;s participants&lt;/li&gt;
	&lt;li&gt;do recovery&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;This works fine when Shadow log store or jdbc object store is used. For AMQ object log store the participant is first not in HEURISTIC state but is in state PREPARED. And second there is not only one participant of transaction in-doubt but they&apos;re returned two participants.&lt;/p&gt;

&lt;p&gt;Then during recovery process the periodic recovery also can see two participants for recovery (that&apos;s my feeling from log). Not only one as expected as first resource was already correctly committed (that&apos;s how shadow log store works).&lt;/p&gt;</description>
                <environment></environment>
        <key id="12612444">WFLY-6442</key>
            <summary>Inconsistent behavior of journal object store for heuristic state</summary>
                <type id="1" iconUrl="https://issues.jboss.org/secure/viewavatar?size=xsmall&amp;avatarId=13263&amp;avatarType=issuetype">Bug</type>
                                            <priority id="1" iconUrl="https://issues.jboss.org/images/icons/priorities/blocker.svg">Blocker</priority>
                        <status id="5" iconUrl="https://issues.jboss.org/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Done</resolution>
                                        <assignee username="tomjenkinson">Tom Jenkinson</assignee>
                                    <reporter username="ochaloup">Ondra Chaloupka</reporter>
                        <labels>
                    </labels>
                <created>Wed, 30 Mar 2016 10:19:16 -0400</created>
                <updated>Thu, 18 Aug 2016 23:49:45 -0400</updated>
                            <resolved>Tue, 17 May 2016 09:09:26 -0400</resolved>
                                                    <fixVersion>10.1.0.CR1</fixVersion>
                    <fixVersion>10.1.0.Final</fixVersion>
                                    <component>Transactions</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>3</watches>
                                                                    <issuelinks>
                            <issuelinktype id="12310120">
                    <name>Cloners</name>
                                            <outwardlinks description="cloned from">
                                        <issuelink>
            <issuekey id="12612410">JBEAP-3994</issuekey>
        </issuelink>
                            </outwardlinks>
                                                                <inwardlinks description="cloned to">
                                        <issuelink>
            <issuekey id="12612445">JBTM-2649</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                            <issuelinktype id="10012">
                    <name>Dependency</name>
                                            <outwardlinks description="is blocked by">
                                        <issuelink>
            <issuekey id="12612573">WFLY-6446</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                            <issuelinktype id="10011">
                    <name>Superset</name>
                                                                <inwardlinks description="is incorporated by">
                                        <issuelink>
            <issuekey id="12614300">WFLY-6507</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                                                                                    <customfield id="customfield_12311245" key="org.jboss.labs.jira.plugin.cdw-plugin:cdwflagprogman">
                        <customfieldname>CDW blocker</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12311243" key="org.jboss.labs.jira.plugin.cdw-plugin:cdwflagdevel">
                        <customfieldname>CDW devel_ack</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12311941" key="org.jboss.labs.jira.plugin.cdw-plugin:cdwflagdocs">
                        <customfieldname>CDW docs_ack</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12311242" key="org.jboss.labs.jira.plugin.cdw-plugin:cdwflagpm">
                        <customfieldname>CDW pm_ack</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12311244" key="org.jboss.labs.jira.plugin.cdw-plugin:cdwflagqa">
                        <customfieldname>CDW qa_ack</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12311241" key="org.jboss.labs.jira.plugin.cdw-plugin:cdwflagrelease">
                        <customfieldname>CDW release</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                            <customfield id="customfield_12310220" key="org.jboss.labs.jira.plugin.jboss-custom-field-types-plugin:multiurl">
                        <customfieldname>Git Pull Request</customfieldname>
                        <customfieldvalues>
                            https://github.com/wildfly/wildfly/pull/8840
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12310641" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Number of attachments</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310640" key="com.atlassian.jira.toolkit:comments">
                        <customfieldname>Number of comments</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12311940" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1|i02vzj:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310840" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                            <customfield id="customfield_12310183" key="com.atlassian.jira.plugin.system.customfieldtypes:textarea">
                        <customfieldname>Steps to Reproduce</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>&lt;ul&gt;
	&lt;li&gt;&lt;tt&gt;git clone &lt;a href=&quot;http://git.app.eng.bos.redhat.com/git/jbossqe-eap-tests-transactions.git&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://git.app.eng.bos.redhat.com/git/jbossqe-eap-tests-transactions.git&lt;/a&gt;&lt;/tt&gt;&lt;/li&gt;
	&lt;li&gt;&lt;tt&gt;cd jbossqe-eap-tests-transactions&lt;/tt&gt;&lt;/li&gt;
	&lt;li&gt;{{download and unzip EAP 7.0.0.ER7}: &lt;a href=&quot;http://download.eng.brq.redhat.com/devel/candidates/JBEAP/JBEAP-7.0.0.ER7/jboss-eap-7.0.0.ER7.zip&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://download.eng.brq.redhat.com/devel/candidates/JBEAP/JBEAP-7.0.0.ER7/jboss-eap-7.0.0.ER7.zip&lt;/a&gt;&lt;/li&gt;
	&lt;li&gt;&lt;tt&gt;export JBOSS_HOME=path/to/er7&lt;/tt&gt;&lt;/li&gt;
	&lt;li&gt;&lt;tt&gt;mvn clean verify -am -pl jbossts -DfailIfNoTests=false -fn -Dtest=ToolingTestCase#heuristicRecover -Djbossts.noJTS -Djbossts.objectstore.type=activemq&lt;/tt&gt;&lt;/li&gt;
&lt;/ul&gt;
</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12311240" key="org.jboss.labs.jira.plugin.cdw-plugin:cdwtargetreleasebyversion">
                        <customfieldname>Target Release</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue>12326621</customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12310080" key="com.atlassian.jira.plugin.system.customfieldtypes:userpicker">
                        <customfieldname>Tester</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>ochaloup</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                            </customfields>
    </item>
</channel>
</rss>