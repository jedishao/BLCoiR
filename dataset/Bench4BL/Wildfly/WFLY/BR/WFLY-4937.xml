<!-- 
RSS generated by JIRA (7.2.3#72005-sha1:73be91d2b96fc29303a7eb6820acf420e5d0ed65) at Tue Dec 06 16:03:04 EST 2016

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.jboss.org/si/jira.issueviews:issue-xml/WFLY-4937/WFLY-4937.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>JBoss Issue Tracker</title>
    <link>https://issues.jboss.org</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-us</language>    <build-info>
        <version>7.2.3</version>
        <build-number>72005</build-number>
        <build-date>06-10-2016</build-date>
    </build-info>

<item>
            <title>[WFLY-4937] Implement graceful shutdown for transactions</title>
                <link>https://issues.jboss.org/browse/WFLY-4937</link>
                <project id="12313721" key="WFLY">WildFly</project>
                    <description>&lt;p&gt;This feature will allow EAP supported transaction services to react to suspend and resume requests. The supported services are JTA, JTS, WS-AT, and WS-BA.&lt;br/&gt;
After suspend, all the services remain functional. All external requests bound to the existing transactions are allowed in. All external requests requiring new transaction are blocked. All remote transaction management requests, except begin, are allowed in.&lt;br/&gt;
After resume, all requests are allowed in.&lt;br/&gt;
After suspend timeout, all services must shutdown.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12578249">WFLY-4937</key>
            <summary>Implement graceful shutdown for transactions</summary>
                <type id="2" iconUrl="https://issues.jboss.org/secure/viewavatar?size=xsmall&amp;avatarId=13271&amp;avatarType=issuetype">Feature Request</type>
                                            <priority id="2" iconUrl="https://issues.jboss.org/images/icons/priorities/critical.svg">Critical</priority>
                        <status id="1" iconUrl="https://issues.jboss.org/images/icons/statuses/open.png" description="The issue is open and ready for the assignee to start work on it.">Open</status>
                    <statusCategory id="2" key="new" colorName="blue-gray"/>
                                    <resolution id="-1">Unresolved</resolution>
                                        <assignee username="gytis">Gytis Trikleris</assignee>
                                    <reporter username="mmusgrov">Michael Musgrove</reporter>
                        <labels>
                    </labels>
                <created>Thu, 16 Jul 2015 05:35:19 -0400</created>
                <updated>Mon, 21 Nov 2016 06:32:37 -0500</updated>
                                                            <fixVersion>11.0.0.Alpha1</fixVersion>
                                    <component>Transactions</component>
                    <component>XTS</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>8</watches>
                                                                <comments>
                            <comment id="13090067" author="dmlloyd" created="Thu, 16 Jul 2015 09:56:35 -0400"  >&lt;p&gt;Are you certain that this is the right behavior?  If we disallow new transactions, then existing EJB sessions (for example) might fail to be completed.&lt;/p&gt;

&lt;p&gt;Since the transaction manager is not considered an &quot;entry point&quot; in terms of graceful shutdown, it should not respond to a graceful shutdown other than perhaps registering outstanding transactions with the shutdown manager.&lt;/p&gt;</comment>
                            <comment id="13090068" author="jesper.pedersen" created="Thu, 16 Jul 2015 10:00:54 -0400"  >&lt;p&gt;Same category as JCA based resources. Narayana may support graceful shutdown of transactions, but it can&apos;t be used in WildFly as they maybe needed of the &quot;front-end&quot; services&lt;/p&gt;</comment>
                            <comment id="13090085" author="mmusgrov" created="Thu, 16 Jul 2015 10:48:15 -0400"  >&lt;p&gt;OK that makes sense, thanks. I assume that:&lt;/p&gt;

&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;there is no benefit in handling the suspended event by not reporting done if there are still outstanding transactions;&lt;/li&gt;
	&lt;li&gt;there is no concept of ordering of shutdown callbacks according to the subsystem dependency graph.&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;If my assumptions are correct I will reject the JIRA&lt;/p&gt;</comment>
                            <comment id="13090088" author="jason.greene" created="Thu, 16 Jul 2015 10:53:26 -0400"  >&lt;p&gt;IMO this capability is really about new inbound &lt;b&gt;distributed&lt;/b&gt; transactions, since those are external to the server. &lt;/p&gt;</comment>
                            <comment id="13090305" author="tomjenkinson" created="Fri, 17 Jul 2015 05:55:26 -0400"  >&lt;p&gt;We could do something with existing inbound distributed transactions to pause in suspend() until they are completed (and prevent new inbound distributed transactions as Jason indicates) if that would help?&lt;/p&gt;</comment>
                            <comment id="13094402" author="jason.greene" created="Thu, 30 Jul 2015 15:36:53 -0400"  >&lt;p&gt;Hi &lt;a href=&quot;https://issues.jboss.org/secure/ViewProfile.jspa?name=tomjenkinson&quot; class=&quot;user-hover&quot; rel=&quot;tomjenkinson&quot;&gt;Tom Jenkinson&lt;/a&gt;,&lt;/p&gt;

&lt;p&gt;Do you mean pausing existing distributed transactions? That&apos;s an interesting point to consider. IMO it seems reasonable to allow an existing distributed transaction to prepare + commit/rollback. However, interesting things happen if additional data modification changes originating from the external node happen on the suspended node as part of the overall work of that distributed transaction. They won&apos;t be allowed to proceed, so I imagine the transaction will rollback.  &lt;/p&gt;

&lt;p&gt;More explicitly I mean something like:&lt;/p&gt;

&lt;p&gt;server A starts transaction&lt;br/&gt;
server A writes to local resource AR&lt;br/&gt;
server A calls server B&apos;s ejb doStuff&lt;br/&gt;
server B&apos;s doStuff writes to local resource BR and returns&lt;br/&gt;
server B is suspended&lt;br/&gt;
server A calls server B&apos;s ejb doOtherStuff&lt;br/&gt;
server B rejects the call throwing an exception&lt;br/&gt;
server A rolls the transaction back&lt;br/&gt;
resource AR changes are reverted&lt;br/&gt;
resource BR changes are reverted, even though the node is suspended&lt;/p&gt;</comment>
                            <comment id="13094723" author="tomjenkinson" created="Fri, 31 Jul 2015 12:19:03 -0400"  >&lt;p&gt;Sorry, I was unclear. I wasn&apos;t proposing to pause the individual transactions.&lt;/p&gt;

&lt;p&gt;What I meant was:&lt;br/&gt;
1. When suspend is called&lt;br/&gt;
2. Allow existing remote transactions to complete&lt;br/&gt;
3. Do not allow new remote transactions to be created&lt;br/&gt;
4. Until resume is called (or server restarts)&lt;/p&gt;

&lt;p&gt;Is that the intended behavior? I think it would be consistent with what you are proposing (so long as doOtherStuff is @RequiresNew - if it was @Requires as the TX is already existing we wouldn&apos;t actually reject those ones as the lookup of the transaction would succeed)&lt;/p&gt;</comment>
                            <comment id="13094753" author="jason.greene" created="Fri, 31 Jul 2015 14:16:16 -0400"  >&lt;p&gt;Ah ok yes I think that sounds like the desired behavior.&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="12310120">
                    <name>Cloners</name>
                                            <outwardlinks description="cloned from">
                                                        </outwardlinks>
                                                        </issuelinktype>
                            <issuelinktype id="10012">
                    <name>Dependency</name>
                                            <outwardlinks description="is blocked by">
                                        <issuelink>
            <issuekey id="12651810">WFLY-7207</issuekey>
        </issuelink>
            <issuelink>
            <issuekey id="12651813">WFLY-7208</issuekey>
        </issuelink>
            <issuelink>
            <issuekey id="12652367">JBTM-2760</issuekey>
        </issuelink>
            <issuelink>
            <issuekey id="12652398">WFLY-7233</issuekey>
        </issuelink>
            <issuelink>
            <issuekey id="12658130">JBEAP-6745</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                            <issuelinktype id="12310000">
                    <name>Duplicate</name>
                                                                <inwardlinks description="is duplicated by">
                                        <issuelink>
            <issuekey id="12651798">WFLY-7206</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                            <issuelinktype id="10011">
                    <name>Superset</name>
                                            <outwardlinks description="incorporates">
                                        <issuelink>
            <issuekey id="12658430">WFLY-7439</issuekey>
        </issuelink>
            <issuelink>
            <issuekey id="12660156">WFLY-7514</issuekey>
        </issuelink>
            <issuelink>
            <issuekey id="12662694">JBEAP-7420</issuekey>
        </issuelink>
            <issuelink>
            <issuekey id="12662695">JBEAP-7421</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                    </issuelinks>
                <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310641" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Number of attachments</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310640" key="com.atlassian.jira.toolkit:comments">
                        <customfieldname>Number of comments</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>8.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12311940" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1|hzmuvl:xvx</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310840" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                </customfields>
    </item>
</channel>
</rss>