<!-- 
RSS generated by JIRA (7.2.3#72005-sha1:73be91d2b96fc29303a7eb6820acf420e5d0ed65) at Mon Dec 12 13:45:23 EST 2016

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.jboss.org/si/jira.issueviews:issue-xml/WFLY-3626/WFLY-3626.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>JBoss Issue Tracker</title>
    <link>https://issues.jboss.org</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-us</language>    <build-info>
        <version>7.2.3</version>
        <build-number>72005</build-number>
        <build-date>06-10-2016</build-date>
    </build-info>

<item>
            <title>[WFLY-3626] JAASIdentityManagerImpl reauthenticates on verify(), CallerPrincipal mapping bug</title>
                <link>https://issues.jboss.org/browse/WFLY-3626</link>
                <project id="12313721" key="WFLY">WildFly</project>
                    <description>&lt;p&gt;cf. forum&lt;/p&gt;

&lt;p&gt;org.wildfly.extension.undertow.security.JAASIdentityManagerImpl.verify(Account) - which is called on every request - results in reauthentication of Account: performance issue, in my case this includes an Ldap bind&lt;/p&gt;

&lt;p&gt;also, if CallerPrincipal mapping is used, the original (ldap) username that was successfully authenticated via ldap bind, gets mapped to an application username. Account verification reauthenticates with the mapped application username not the original ldap username and therefore fails ldap bind and verify.&lt;/p&gt;

&lt;p&gt;So with regards to CallerPrincipal, JAASIdentityManagerImpl.verify(Account) is faulty.&lt;/p&gt;

&lt;p&gt;injection of JAASIdentityManagerImpl cannot be parameterized, nor its verify(Account) behaviour.&lt;/p&gt;

&lt;p&gt;as mentioned in the forum thread, my workaround was to replace JAASIdentityManagerImpl after injection with a delegating IdentityManager that does not reauthenticate on verify().&lt;/p&gt;

&lt;p&gt;Replacement happens via means of io.undertow.servlet.ServletExtension as explained in &lt;a href=&quot;http://undertow.io/documentation/servlet/using-non-blocking-handlers-with-servlet.html&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://undertow.io/documentation/servlet/using-non-blocking-handlers-with-servlet.html&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Sidenote: org.jboss.as.domain.http.server.security.RealmIdentityManager.verify(Account) simply returns account;&lt;/p&gt;</description>
                <environment>&lt;p&gt;wildfly-8.1.Final&lt;/p&gt;</environment>
        <key id="12544771">WFLY-3626</key>
            <summary>JAASIdentityManagerImpl reauthenticates on verify(), CallerPrincipal mapping bug</summary>
                <type id="1" iconUrl="https://issues.jboss.org/secure/viewavatar?size=xsmall&amp;avatarId=13263&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.jboss.org/images/icons/priorities/major.svg">Major</priority>
                        <status id="5" iconUrl="https://issues.jboss.org/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Done</resolution>
                                        <assignee username="swd847">Stuart Douglas</assignee>
                                    <reporter username="work_registries">Juergen H</reporter>
                        <labels>
                    </labels>
                <created>Wed, 25 Jun 2014 07:43:04 -0400</created>
                <updated>Thu, 4 Sep 2014 09:20:07 -0400</updated>
                            <resolved>Wed, 16 Jul 2014 18:45:08 -0400</resolved>
                                                    <fixVersion>9.0.0.Alpha1</fixVersion>
                                    <component>Web (Undertow)</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>2</watches>
                                                                <comments>
                            <comment id="12984961" author="swd847" created="Tue, 15 Jul 2014 01:30:18 -0400"  >&lt;p&gt;Linked PR fixed issue with incorrect principal on verify() call. &lt;/p&gt;

&lt;p&gt;The authenticate call per request is per design, if it is causing performance problems these should be addressed by using caching in the security domain.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12310010" key="org.jboss.labs.jira.plugin.jboss-custom-field-types-plugin:multiurl">
                        <customfieldname>Forum Reference</customfieldname>
                        <customfieldvalues>
                            https://community.jboss.org/thread/241966
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310220" key="org.jboss.labs.jira.plugin.jboss-custom-field-types-plugin:multiurl">
                        <customfieldname>Git Pull Request</customfieldname>
                        <customfieldvalues>
                            https://github.com/wildfly/wildfly/pull/6513
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12310641" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Number of attachments</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310640" key="com.atlassian.jira.toolkit:comments">
                        <customfieldname>Number of comments</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12311940" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1|hzs2yv:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310840" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                </customfields>
    </item>
</channel>
</rss>