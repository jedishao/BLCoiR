<!-- 
RSS generated by JIRA (7.2.3#72005-sha1:73be91d2b96fc29303a7eb6820acf420e5d0ed65) at Tue Dec 06 14:47:29 EST 2016

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.jboss.org/si/jira.issueviews:issue-xml/WFLY-674/WFLY-674.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>JBoss Issue Tracker</title>
    <link>https://issues.jboss.org</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-us</language>    <build-info>
        <version>7.2.3</version>
        <build-number>72005</build-number>
        <build-date>06-10-2016</build-date>
    </build-info>

<item>
            <title>[WFLY-674] NPE in thread &quot;vfs-shutdown&quot; </title>
                <link>https://issues.jboss.org/browse/WFLY-674</link>
                <project id="12313721" key="WFLY">WildFly</project>
                    <description>&lt;p&gt;When I shutdown a standalone server I&apos;m getting a NPE. The shutdown command is:&lt;br/&gt;
jboss-admin.bat --connect command=:shutdown&lt;/p&gt;

&lt;p&gt;Console log:&lt;br/&gt;
...&lt;br/&gt;
18:24:55,990 INFO  &lt;span class=&quot;error&quot;&gt;&amp;#91;org.jboss.as.logging&amp;#93;&lt;/span&gt; Restored bootstrap log handlers&lt;br/&gt;
18:24:55,990 INFO  &lt;span class=&quot;error&quot;&gt;&amp;#91;org.jboss.as.jmx.JMXConnectorService&amp;#93;&lt;/span&gt; JMX remote connector stopped&lt;br/&gt;
18:24:56,075 INFO  &lt;span class=&quot;error&quot;&gt;&amp;#91;org.jboss.osgi.framework.internal.HostBundleState&amp;#93;&lt;/span&gt; Bundle stopped: jboss-as-osgi-configadmin:7.1.0.Alpha1-SNAPSHOT&lt;br/&gt;
18:24:56,125 INFO  &lt;span class=&quot;error&quot;&gt;&amp;#91;org.jboss.osgi.framework.internal.HostBundleState&amp;#93;&lt;/span&gt; Bundle stopped: org.apache.felix.log:1.0.0&lt;br/&gt;
18:24:56,230 INFO  &lt;span class=&quot;error&quot;&gt;&amp;#91;org.apache.catalina.core.StandardContext&amp;#93;&lt;/span&gt; Container org.apache.catalina.core.ContainerBase.&lt;span class=&quot;error&quot;&gt;&amp;#91;jboss.web&amp;#93;&lt;/span&gt;.&lt;span class=&quot;error&quot;&gt;&amp;#91;default-host&amp;#93;&lt;/span&gt;.&lt;span class=&quot;error&quot;&gt;&amp;#91;/&amp;#93;&lt;/span&gt; has not been started&lt;br/&gt;
18:24:56,286 INFO  &lt;span class=&quot;error&quot;&gt;&amp;#91;org.jboss.osgi.framework.internal.HostBundleState&amp;#93;&lt;/span&gt; Bundle stopped: org.apache.felix.configadmin:1.2.8&lt;br/&gt;
18:24:56,323 INFO  &lt;span class=&quot;error&quot;&gt;&amp;#91;org.jboss.osgi.framework.internal.HostBundleState&amp;#93;&lt;/span&gt; Bundle stopped: jboss-osgi-logging:1.0.0&lt;br/&gt;
18:24:56,330 INFO  &lt;span class=&quot;error&quot;&gt;&amp;#91;com.arjuna.ats.jbossatx&amp;#93;&lt;/span&gt; ARJUNA32018: Destroying TransactionManagerService&lt;br/&gt;
18:24:56,331 INFO  &lt;span class=&quot;error&quot;&gt;&amp;#91;com.arjuna.ats.jbossatx&amp;#93;&lt;/span&gt; ARJUNA32014: Stopping transaction recovery manager&lt;br/&gt;
18:24:56,368 ERROR &lt;span class=&quot;error&quot;&gt;&amp;#91;stderr&amp;#93;&lt;/span&gt; Exception in thread &quot;vfs-shutdown&quot; java.lang.NullPointerException&lt;br/&gt;
18:24:56,368 ERROR &lt;span class=&quot;error&quot;&gt;&amp;#91;stderr&amp;#93;&lt;/span&gt; 	at org.jboss.vfs.TempFileProvider$DeleteTask.run(TempFileProvider.java:151)&lt;br/&gt;
18:24:56,368 ERROR &lt;span class=&quot;error&quot;&gt;&amp;#91;stderr&amp;#93;&lt;/span&gt; 	at org.jboss.vfs.TempFileProvider.close(TempFileProvider.java:132)&lt;br/&gt;
18:24:56,368 ERROR &lt;span class=&quot;error&quot;&gt;&amp;#91;stderr&amp;#93;&lt;/span&gt; 	at org.jboss.osgi.vfs30.VirtualFileAdaptor30$2.run(VirtualFileAdaptor30.java:94)&lt;/p&gt;</description>
                <environment>&lt;p&gt;7.1.0.Alpha1 Jenkins build 1402&lt;/p&gt;</environment>
        <key id="12441752">WFLY-674</key>
            <summary>NPE in thread &quot;vfs-shutdown&quot; </summary>
                <type id="1" iconUrl="https://issues.jboss.org/secure/viewavatar?size=xsmall&amp;avatarId=13263&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.jboss.org/images/icons/priorities/major.svg">Major</priority>
                        <status id="5" iconUrl="https://issues.jboss.org/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Done</resolution>
                                        <assignee username="dmlloyd">David Lloyd</assignee>
                                    <reporter username="juergen.zimmermann">Juergen Zimmermann</reporter>
                        <labels>
                    </labels>
                <created>Thu, 14 Jul 2011 12:31:41 -0400</created>
                <updated>Fri, 4 Oct 2013 17:47:52 -0400</updated>
                            <resolved>Fri, 4 Oct 2013 17:47:52 -0400</resolved>
                                                    <fixVersion>8.0.0.Beta1</fixVersion>
                                    <component>VFS</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>8</watches>
                                                                <comments>
                            <comment id="12706044" author="mreasy" created="Mon, 16 Jul 2012 03:55:35 -0400"  >&lt;p&gt;Also happens with 7.1.1.Final and using domain-mode.&lt;/p&gt;</comment>
                            <comment id="12753717" author="ejroberts" created="Tue, 12 Feb 2013 11:48:30 -0500"  >&lt;p&gt;I have had a very similar NPE stack pop out on 7.2.0.Alpha1, but slightly different line numbers. Is this the same problem ?&lt;/p&gt;

&lt;p/&gt;
&lt;div id=&quot;syntaxplugin&quot; class=&quot;syntaxplugin&quot; style=&quot;border: 1px dashed #bbb; border-radius: 5px !important; overflow: auto; max-height: 30em;&quot;&gt;
&lt;table cellspacing=&quot;0&quot; cellpadding=&quot;0&quot; border=&quot;0&quot; width=&quot;100%&quot; style=&quot;font-size: 1em; line-height: 1.4em !important; font-weight: normal; font-style: normal; color: black;&quot;&gt;
		&lt;tbody &gt;
				&lt;tr id=&quot;syntaxplugin_code_and_gutter&quot;&gt;
						&lt;td  style=&quot; line-height: 1.4em !important; padding: 0em; vertical-align: top;&quot;&gt;
					&lt;pre style=&quot;font-size: 1em; margin: 0 10px;  margin-top: 10px;   width: auto; padding: 0;&quot;&gt;&lt;span style=&quot;color: black; font-family: &apos;Consolas&apos;, &apos;Bitstream Vera Sans Mono&apos;, &apos;Courier New&apos;, Courier, monospace !important;&quot;&gt;2013-02-12 16:14:33,117 ERROR [stderr](vfs-shutdown) Exception in thread &quot;vfs-shutdown&quot; java.lang.NullPointerException&lt;/span&gt;&lt;/pre&gt;
			&lt;/td&gt;
		&lt;/tr&gt;
				&lt;tr id=&quot;syntaxplugin_code_and_gutter&quot;&gt;
						&lt;td  style=&quot; line-height: 1.4em !important; padding: 0em; vertical-align: top;&quot;&gt;
					&lt;pre style=&quot;font-size: 1em; margin: 0 10px;   width: auto; padding: 0;&quot;&gt;&lt;span style=&quot;color: black; font-family: &apos;Consolas&apos;, &apos;Bitstream Vera Sans Mono&apos;, &apos;Courier New&apos;, Courier, monospace !important;&quot;&gt;2013-02-12 16:14:33,117 ERROR [stderr](vfs-shutdown) 	at org.jboss.vfs.TempFileProvider$DeleteTask.run(TempFileProvider.java:151)&lt;/span&gt;&lt;/pre&gt;
			&lt;/td&gt;
		&lt;/tr&gt;
				&lt;tr id=&quot;syntaxplugin_code_and_gutter&quot;&gt;
						&lt;td  style=&quot; line-height: 1.4em !important; padding: 0em; vertical-align: top;&quot;&gt;
					&lt;pre style=&quot;font-size: 1em; margin: 0 10px;   width: auto; padding: 0;&quot;&gt;&lt;span style=&quot;color: black; font-family: &apos;Consolas&apos;, &apos;Bitstream Vera Sans Mono&apos;, &apos;Courier New&apos;, Courier, monospace !important;&quot;&gt;2013-02-12 16:14:33,117 ERROR [stderr](vfs-shutdown) 	at org.jboss.vfs.TempFileProvider.close(TempFileProvider.java:132)&lt;/span&gt;&lt;/pre&gt;
			&lt;/td&gt;
		&lt;/tr&gt;
				&lt;tr id=&quot;syntaxplugin_code_and_gutter&quot;&gt;
						&lt;td  style=&quot; line-height: 1.4em !important; padding: 0em; vertical-align: top;&quot;&gt;
					&lt;pre style=&quot;font-size: 1em; margin: 0 10px;   margin-bottom: 10px;  width: auto; padding: 0;&quot;&gt;&lt;span style=&quot;color: black; font-family: &apos;Consolas&apos;, &apos;Bitstream Vera Sans Mono&apos;, &apos;Courier New&apos;, Courier, monospace !important;&quot;&gt;2013-02-12 16:14:33,117 ERROR [stderr](vfs-shutdown) 	at org.jboss.osgi.vfs30.VirtualFileAdaptor30$2.run(VirtualFileAdaptor30.java:110)&lt;/span&gt;&lt;/pre&gt;
			&lt;/td&gt;
		&lt;/tr&gt;
			&lt;/tbody&gt;
&lt;/table&gt;
&lt;/div&gt;
&lt;p/&gt;

&lt;p&gt;The cause of the exception in this case is the org.jboss.osgi.vfs30.VirtualFileAdaptor30.&lt;br/&gt;
It creates a TempFileProvider with a null executor, then adds a Shutdown hook to call the close method.&lt;br/&gt;
When the hook is triggered, if the first attempt to recursively delete the temporary directory .../vfs/osgitmp* fails, the executor is asked to schedule another attempt, and bang. Should the TempFileProvider throw an NPE if a null executor is passed in ?&lt;/p&gt;</comment>
                            <comment id="12765934" author="dlmiles" created="Tue, 9 Apr 2013 21:40:45 -0400"  >&lt;p&gt;PR &lt;a href=&quot;https://github.com/jbossas/jboss-vfs/pull/12&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://github.com/jbossas/jboss-vfs/pull/12&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Not sure what is difficult about the matter to need community assistance on it.  It is a NPE and somewhat obvious what is being referenced from the line number provided in the original report.&lt;/p&gt;

&lt;p&gt;Maybe it was rare and difficult to recreate however I get it reliably with EAP 6.1 using standalone-full.xml with osgi/snowdrop installed and enabled.  Then deploying 3 JDBC *-ds.xml and a JPA (that happens to have OSGi metadata) project.  I&apos;m not sure which thing is the trigger making it reliable to observe NPE.&lt;/p&gt;</comment>
                            <comment id="12765941" author="dlmiles" created="Tue, 9 Apr 2013 23:42:10 -0400"  >&lt;p&gt;If it helps the TempFileProvider$DeleteTask has a:&lt;/p&gt;

&lt;p&gt;filePath = null;&lt;br/&gt;
path = &quot;F:\Devel\deps\jboss-eap-6.1\standalone\tmp\vfs\osgitmp-449ec252f4170b79&quot;;&lt;br/&gt;
prefixLength = 3;&lt;/p&gt;

&lt;p&gt;The contents of this directory are empty.&lt;br/&gt;
I am able without any issue to &quot;rmdir&quot; the directory from a cmd.exe while the debugger has suspended the shutdown when the NPE is thrown.&lt;/p&gt;

&lt;p&gt;Maybe there is a shutdown timing issue and the an open file handle was closed and file deleted by OSGi subsystem after the NPE is thrown ?&lt;/p&gt;

&lt;p&gt;So I guess OSGi is the cause in my case if that help track the issue.&lt;/p&gt;</comment>
                            <comment id="12769671" author="jason.greene" created="Tue, 23 Apr 2013 18:15:36 -0400"  >&lt;p&gt;Correct migration&lt;/p&gt;</comment>
                            <comment id="12800397" author="ctomc" created="Thu, 29 Aug 2013 17:51:23 -0400"  >&lt;p&gt;Fix merged to vfs. we need new release of vfs to be used in WF&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10012">
                    <name>Dependency</name>
                                            <outwardlinks description="is blocked by">
                                        <issuelink>
            <issuekey id="12441769">JBVFS-175</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                    </issuelinks>
                <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310641" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Number of attachments</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310640" key="com.atlassian.jira.toolkit:comments">
                        <customfieldname>Number of comments</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>6.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12311940" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1|hys77b:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310840" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>14918</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>