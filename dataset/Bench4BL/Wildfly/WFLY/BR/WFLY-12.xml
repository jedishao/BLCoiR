<!-- 
RSS generated by JIRA (7.2.3#72005-sha1:73be91d2b96fc29303a7eb6820acf420e5d0ed65) at Tue Dec 06 14:04:43 EST 2016

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.jboss.org/si/jira.issueviews:issue-xml/WFLY-12/WFLY-12.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>JBoss Issue Tracker</title>
    <link>https://issues.jboss.org</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-us</language>    <build-info>
        <version>7.2.3</version>
        <build-number>72005</build-number>
        <build-date>06-10-2016</build-date>
    </build-info>

<item>
            <title>[WFLY-12] Replication of attribute changed in @PrePassivate method does not work for nested beans</title>
                <link>https://issues.jboss.org/browse/WFLY-12</link>
                <project id="12313721" key="WFLY">WildFly</project>
                    <description>&lt;p&gt;In case that a sfsb nested bean (a stateful bean which is injected into other bean in this case into a clustered bean) changes its attribute (member variable) in @PrePassivate method then the new state is not replicated to other nodes.&lt;br/&gt;
You can check my testcase:&lt;br/&gt;
&lt;a href=&quot;https://github.com/ochaloup/jboss-as/blob/67f992608bacc2bce95b0d7655083a83e70367e0/testsuite/integration/clust/src/test/java/org/jboss/as/test/clustering/cluster/ejb3/stateful/passivation/ClusterPassivationTestCase.java&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://github.com/ochaloup/jboss-as/blob/67f992608bacc2bce95b0d7655083a83e70367e0/testsuite/integration/clust/src/test/java/org/jboss/as/test/clustering/cluster/ejb3/stateful/passivation/ClusterPassivationTestCase.java&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;The steps done in tests are following:&lt;br/&gt;
1) Search for stateful bean (a &quot;parent&quot; bean for the nested one, bean where the nested one is injected to)&lt;br/&gt;
2) Let the stateful bean be passivated (in this time the nested bean is passivated as well, the @PrePassivate method is called)&lt;br/&gt;
3) A variable of the nested bean is changed in the @PrePassivate method&lt;br/&gt;
4) Do a call on second node - changed state isn&apos;t on the other node&lt;/p&gt;

&lt;p&gt;You can check it in the linked test. When no method on nested been is called (the call is commented now):&lt;br/&gt;
&lt;a href=&quot;https://github.com/ochaloup/jboss-as/blob/67f992608bacc2bce95b0d7655083a83e70367e0/testsuite/integration/clust/src/test/java/org/jboss/as/test/clustering/cluster/ejb3/stateful/passivation/ClusterPassivationTestCase.java#L305&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://github.com/ochaloup/jboss-as/blob/67f992608bacc2bce95b0d7655083a83e70367e0/testsuite/integration/clust/src/test/java/org/jboss/as/test/clustering/cluster/ejb3/stateful/passivation/ClusterPassivationTestCase.java#L305&lt;/a&gt;&lt;br/&gt;
Then the test on the changed attribute fails on the other server:&lt;br/&gt;
&lt;a href=&quot;https://github.com/ochaloup/jboss-as/blob/67f992608bacc2bce95b0d7655083a83e70367e0/testsuite/integration/clust/src/test/java/org/jboss/as/test/clustering/cluster/ejb3/stateful/passivation/ClusterPassivationTestCase.java#L318&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://github.com/ochaloup/jboss-as/blob/67f992608bacc2bce95b0d7655083a83e70367e0/testsuite/integration/clust/src/test/java/org/jboss/as/test/clustering/cluster/ejb3/stateful/passivation/ClusterPassivationTestCase.java#L318&lt;/a&gt;&lt;/p&gt;
</description>
                <environment></environment>
        <key id="12462276">WFLY-12</key>
            <summary>Replication of attribute changed in @PrePassivate method does not work for nested beans</summary>
                <type id="1" iconUrl="https://issues.jboss.org/secure/viewavatar?size=xsmall&amp;avatarId=13263&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.jboss.org/images/icons/priorities/major.svg">Major</priority>
                        <status id="5" iconUrl="https://issues.jboss.org/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Done</resolution>
                                        <assignee username="pferraro">Paul Ferraro</assignee>
                                    <reporter username="ochaloup">Ondra Chaloupka</reporter>
                        <labels>
                    </labels>
                <created>Thu, 22 Mar 2012 13:04:34 -0400</created>
                <updated>Tue, 23 Jun 2015 12:18:47 -0400</updated>
                            <resolved>Wed, 20 Nov 2013 14:32:41 -0500</resolved>
                                                    <fixVersion>8.0.0.CR1</fixVersion>
                                    <component>Clustering</component>
                    <component>EJB</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>3</watches>
                                                                <comments>
                            <comment id="12682427" author="jaikiran" created="Mon, 9 Apr 2012 02:21:56 -0400"  >&lt;p&gt;This looks more like a clustering related issue. Do you still see this against latest AS7 upstream? &lt;/p&gt;</comment>
                            <comment id="12683469" author="ochaloup" created="Thu, 12 Apr 2012 08:41:29 -0400"  >&lt;p&gt;Hi,&lt;br/&gt;
I&apos;ve checked it once again against AS7 upstream and it does not work for me. &lt;/p&gt;

&lt;p&gt;How I wrote above. Problem is when a method is defined as @PrePassivate. Then the passivation is run on node_1. The method is correctly invoked. The method changes some variable of a nested bean. After switching off the node_1, the node_2 (which is in a cluster with node_1) hasn&apos;t got the changed state of changed variable (about the variable which was changed in @PrePassivate method on node_1).&lt;/p&gt;</comment>
                            <comment id="13082962" author="jira-bugzilla-migration" created="Tue, 23 Jun 2015 12:18:47 -0400"  >&lt;p&gt;Ivo Studensky &amp;lt;istudens@redhat.com&amp;gt; changed the Status of &lt;a href=&quot;https://bugzilla.redhat.com/show_bug.cgi?id=900082&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;bug 900082&lt;/a&gt; from NEW to CLOSED&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="12310010">
                    <name>Cloners (old)</name>
                                            <outwardlinks description="cloned to">
                                        <issuelink>
            <issuekey id="12462277">JBPAPP6-1521</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                            <issuelinktype id="10012">
                    <name>Dependency</name>
                                            <outwardlinks description="is blocked by">
                                        <issuelink>
            <issuekey id="12502968">WFLY-2298</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                    </issuelinks>
                <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310440" key="org.jboss.labs.jira.plugin.jboss-custom-field-types-plugin:multiurl">
                        <customfieldname>Bugzilla References</customfieldname>
                        <customfieldvalues>
                            https://bugzilla.redhat.com/show_bug.cgi?id=900082
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310220" key="org.jboss.labs.jira.plugin.jboss-custom-field-types-plugin:multiurl">
                        <customfieldname>Git Pull Request</customfieldname>
                        <customfieldvalues>
                            https://github.com/wildfly/wildfly/pull/5357
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12310641" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Number of attachments</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310640" key="com.atlassian.jira.toolkit:comments">
                        <customfieldname>Number of comments</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>3.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12311940" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1|hyzix3:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310840" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>57644</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>