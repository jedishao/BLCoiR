<!-- 
RSS generated by JIRA (7.2.3#72005-sha1:73be91d2b96fc29303a7eb6820acf420e5d0ed65) at Mon Dec 12 13:54:26 EST 2016

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.jboss.org/si/jira.issueviews:issue-xml/WFLY-3808/WFLY-3808.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>JBoss Issue Tracker</title>
    <link>https://issues.jboss.org</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-us</language>    <build-info>
        <version>7.2.3</version>
        <build-number>72005</build-number>
        <build-date>06-10-2016</build-date>
    </build-info>

<item>
            <title>[WFLY-3808] PartitionPlan.getThreads() returning zero value causes batch job not be started</title>
                <link>https://issues.jboss.org/browse/WFLY-3808</link>
                <project id="12313721" key="WFLY">WildFly</project>
                    <description>&lt;p&gt;If you define a batch job to be divided to multiple partitions and write a PartitionMapper returning a PartitionPlanImpl object but don&apos;t override getThreads method, which means getThreads returns zero meaning thread count should be equal to partition count, but the batch job doesn&apos;t start.&lt;/p&gt;

&lt;p&gt;See &lt;a href=&quot;http://docs.oracle.com/javaee/7/api/javax/batch/api/partition/PartitionPlan.html#setThreads(int&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;http://docs.oracle.com/javaee/7/api/javax/batch/api/partition/PartitionPlan.html#setThreads(int&lt;/a&gt;)&lt;/p&gt;

&lt;p&gt;In GlassFish this works as expected: if getThreads is not overridden (thus returning zero), batch job is started in as many threads as there are partitions.&lt;/p&gt;

&lt;p&gt;See steps to reproduce for further details.&lt;/p&gt;</description>
                <environment>&lt;p&gt;Windows 7 Home Premium Service Pack 1 64-bit + JDK8u11 + WildFly 8.1.0 Final&lt;/p&gt;</environment>
        <key id="12551042">WFLY-3808</key>
            <summary>PartitionPlan.getThreads() returning zero value causes batch job not be started</summary>
                <type id="1" iconUrl="https://issues.jboss.org/secure/viewavatar?size=xsmall&amp;avatarId=13263&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.jboss.org/images/icons/priorities/major.svg">Major</priority>
                        <status id="5" iconUrl="https://issues.jboss.org/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Done</resolution>
                                        <assignee username="elguardian">Enrique Gonz&#225;lez Mart&#237;nez</assignee>
                                    <reporter username="arialfred">Ari Silvan</reporter>
                        <labels>
                    </labels>
                <created>Wed, 3 Sep 2014 17:10:12 -0400</created>
                <updated>Fri, 20 Mar 2015 09:05:29 -0400</updated>
                            <resolved>Fri, 20 Mar 2015 09:05:29 -0400</resolved>
                                    <version>8.1.0.Final</version>
                                    <fixVersion>9.0.0.Alpha1</fixVersion>
                                    <component>Batch</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>1</watches>
                                                                    <issuelinks>
                            <issuelinktype id="12310001">
                    <name>Related</name>
                                            <outwardlinks description="relates to">
                                        <issuelink>
            <issuekey id="12550630">JBERET-108</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                    </issuelinks>
                <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310641" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Number of attachments</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310640" key="com.atlassian.jira.toolkit:comments">
                        <customfieldname>Number of comments</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12311940" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1|hzt33z:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310840" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12310183" key="com.atlassian.jira.plugin.system.customfieldtypes:textarea">
                        <customfieldname>Steps to Reproduce</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>&lt;p&gt;Create a simple batch application. Define and write a PartitionMapper returning a PartionPlanImpl object, but don&apos;t override getThreads method. For example:&lt;/p&gt;

&lt;p&gt;package batchtest;&lt;/p&gt;

&lt;p&gt;import java.util.Properties;&lt;/p&gt;

&lt;p&gt;import javax.batch.api.partition.PartitionMapper;&lt;br/&gt;
import javax.batch.api.partition.PartitionPlan;&lt;br/&gt;
import javax.batch.api.partition.PartitionPlanImpl;&lt;br/&gt;
import javax.enterprise.context.Dependent;&lt;br/&gt;
import javax.inject.Named;&lt;/p&gt;

&lt;p&gt;@Dependent&lt;br/&gt;
@Named(&quot;TestPartitionMapper&quot;)&lt;br/&gt;
public class TestPartitionMapper implements PartitionMapper {&lt;br/&gt;
    @Override&lt;br/&gt;
    public PartitionPlan mapPartitions() throws Exception {&lt;br/&gt;
        return new PartitionPlanImpl() {&lt;br/&gt;
            @Override&lt;br/&gt;
            public int getPartitions() &lt;/p&gt;
{
                return 2;
            }

&lt;p&gt;            // getThreads() is not overridden&lt;br/&gt;
            // Defaults to zero, which means thread count &lt;br/&gt;
            // should be equal to partition count&lt;/p&gt;

&lt;p&gt;            @Override&lt;br/&gt;
            public Properties[] getPartitionProperties() &lt;/p&gt;
{
            	Properties[] props = new Properties[getPartitions()];
            	props[0] = new Properties();
            	props[1] = new Properties();
            	return props;
            }
&lt;p&gt;        };&lt;br/&gt;
    }&lt;br/&gt;
}&lt;/p&gt;

&lt;p&gt;Then try to start the batch job. Number of threads should be equal to number of partitions, but the batch job don&apos;t start in WildFly. In GlassFish the batch job is started in 2 threads as expected.&lt;/p&gt;</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>