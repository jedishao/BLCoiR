<!-- 
RSS generated by JIRA (7.2.3#72005-sha1:73be91d2b96fc29303a7eb6820acf420e5d0ed65) at Tue Dec 06 15:07:49 EST 2016

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.jboss.org/si/jira.issueviews:issue-xml/WFLY-2862/WFLY-2862.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>JBoss Issue Tracker</title>
    <link>https://issues.jboss.org</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-us</language>    <build-info>
        <version>7.2.3</version>
        <build-number>72005</build-number>
        <build-date>06-10-2016</build-date>
    </build-info>

<item>
            <title>[WFLY-2862] Liferay too many open files during deployment</title>
                <link>https://issues.jboss.org/browse/WFLY-2862</link>
                <project id="12313721" key="WFLY">WildFly</project>
                    <description>&lt;p&gt;Liferay 6.2 deploys as an exploded war. Normally after deployment it builds a theme (css/js boundles). Even if only Liferay is deployed a Too many open files exception is thrown. When /proc/sys/fs/file-max is 6815744. While trying to configure it or deploy other portlets (exploded wars too) the too many open files exception is encountered even at the deployment time (server start up). &lt;/p&gt;

&lt;p&gt;13:57:48,110 ERROR &lt;span class=&quot;error&quot;&gt;&amp;#91;MSC service thread 1-12&amp;#93;&lt;/span&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;MainServlet:262&amp;#93;&lt;/span&gt; java.io.FileNotFoundException: /home/munih/development/tools/wildfly-8.0.0.Final-SNAPSHOT/standalone/deployments/ROOT.war/WEB-INF/liferay-layout-templates.xml (Too many open files)&lt;/p&gt;</description>
                <environment>&lt;p&gt;linux 3.11.0-15-generic&lt;/p&gt;</environment>
        <key id="12531105">WFLY-2862</key>
            <summary>Liferay too many open files during deployment</summary>
                <type id="1" iconUrl="https://issues.jboss.org/secure/viewavatar?size=xsmall&amp;avatarId=13263&amp;avatarType=issuetype">Bug</type>
                                            <priority id="1" iconUrl="https://issues.jboss.org/images/icons/priorities/blocker.svg">Blocker</priority>
                        <status id="5" iconUrl="https://issues.jboss.org/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Done</resolution>
                                        <assignee username="ctomc">Tomaz Cerar</assignee>
                                    <reporter username="duckslo">Jakob Munih</reporter>
                        <labels>
                    </labels>
                <created>Tue, 4 Feb 2014 08:07:00 -0500</created>
                <updated>Thu, 4 Sep 2014 09:37:24 -0400</updated>
                            <resolved>Wed, 5 Feb 2014 09:48:20 -0500</resolved>
                                    <version>8.0.0.CR1</version>
                                    <fixVersion>8.0.0.Final</fixVersion>
                                    <component>Web (Undertow)</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>3</watches>
                                                                <comments>
                            <comment id="12941175" author="dmlloyd" created="Tue, 4 Feb 2014 08:44:09 -0500"  >&lt;p&gt;Can you paste the output of &lt;tt&gt;ulimit -a&lt;/tt&gt; please?&lt;/p&gt;</comment>
                            <comment id="12941245" author="duckslo" created="Tue, 4 Feb 2014 10:57:55 -0500"  >&lt;p&gt;I was forced to set the ulimit  up to more than 10k to be able to deploy LR. The file dump-9406-514 captured the 514 iteration of calling lsof after server start up that logs 9406 open files. As soon as LR deploys the number of openfiles  fails down to 1.2k. Issue not present in AS7, where the number of open files can rest on the linux default (1024). &lt;/p&gt;
&lt;p/&gt;
&lt;div id=&quot;syntaxplugin&quot; class=&quot;syntaxplugin&quot; style=&quot;border: 1px dashed #bbb; border-radius: 5px !important; overflow: auto; max-height: 30em;&quot;&gt;
&lt;table cellspacing=&quot;0&quot; cellpadding=&quot;0&quot; border=&quot;0&quot; width=&quot;100%&quot; style=&quot;font-size: 1em; line-height: 1.4em !important; font-weight: normal; font-style: normal; color: black;&quot;&gt;
		&lt;tbody &gt;
				&lt;tr id=&quot;syntaxplugin_code_and_gutter&quot;&gt;
						&lt;td  style=&quot; line-height: 1.4em !important; padding: 0em; vertical-align: top;&quot;&gt;
					&lt;pre style=&quot;font-size: 1em; margin: 0 10px;  margin-top: 10px;   width: auto; padding: 0;&quot;&gt;&lt;span style=&quot;color: black; font-family: &apos;Consolas&apos;, &apos;Bitstream Vera Sans Mono&apos;, &apos;Courier New&apos;, Courier, monospace !important;&quot;&gt;#!/bin/sh&lt;/span&gt;&lt;/pre&gt;
			&lt;/td&gt;
		&lt;/tr&gt;
				&lt;tr id=&quot;syntaxplugin_code_and_gutter&quot;&gt;
						&lt;td  style=&quot; line-height: 1.4em !important; padding: 0em; vertical-align: top;&quot;&gt;
					&lt;pre style=&quot;font-size: 1em; margin: 0 10px;   width: auto; padding: 0;&quot;&gt;&lt;span style=&quot;color: black; font-family: &apos;Consolas&apos;, &apos;Bitstream Vera Sans Mono&apos;, &apos;Courier New&apos;, Courier, monospace !important;&quot;&gt;PID=`ps -ef | awk &apos;/[j]boss/{print $2}&apos;`&lt;/span&gt;&lt;/pre&gt;
			&lt;/td&gt;
		&lt;/tr&gt;
				&lt;tr id=&quot;syntaxplugin_code_and_gutter&quot;&gt;
						&lt;td  style=&quot; line-height: 1.4em !important; padding: 0em; vertical-align: top;&quot;&gt;
					&lt;pre style=&quot;font-size: 1em; margin: 0 10px;   width: auto; padding: 0;&quot;&gt;&lt;span style=&quot;color: black; font-family: &apos;Consolas&apos;, &apos;Bitstream Vera Sans Mono&apos;, &apos;Courier New&apos;, Courier, monospace !important;&quot;&gt;echo $PID&lt;/span&gt;&lt;/pre&gt;
			&lt;/td&gt;
		&lt;/tr&gt;
				&lt;tr id=&quot;syntaxplugin_code_and_gutter&quot;&gt;
						&lt;td  style=&quot; line-height: 1.4em !important; padding: 0em; vertical-align: top;&quot;&gt;
					&lt;pre style=&quot;font-size: 1em; margin: 0 10px;   width: auto; padding: 0;&quot;&gt;&lt;span style=&quot;color: black; font-family: &apos;Consolas&apos;, &apos;Bitstream Vera Sans Mono&apos;, &apos;Courier New&apos;, Courier, monospace !important;&quot;&gt;N=1&lt;/span&gt;&lt;/pre&gt;
			&lt;/td&gt;
		&lt;/tr&gt;
				&lt;tr id=&quot;syntaxplugin_code_and_gutter&quot;&gt;
						&lt;td  style=&quot; line-height: 1.4em !important; padding: 0em; vertical-align: top;&quot;&gt;
					&lt;pre style=&quot;font-size: 1em; margin: 0 10px;   width: auto; padding: 0;&quot;&gt;&lt;span style=&quot;color: black; font-family: &apos;Consolas&apos;, &apos;Bitstream Vera Sans Mono&apos;, &apos;Courier New&apos;, Courier, monospace !important;&quot;&gt;while true;&lt;/span&gt;&lt;/pre&gt;
			&lt;/td&gt;
		&lt;/tr&gt;
				&lt;tr id=&quot;syntaxplugin_code_and_gutter&quot;&gt;
						&lt;td  style=&quot; line-height: 1.4em !important; padding: 0em; vertical-align: top;&quot;&gt;
					&lt;pre style=&quot;font-size: 1em; margin: 0 10px;   width: auto; padding: 0;&quot;&gt;&lt;span style=&quot;color: black; font-family: &apos;Consolas&apos;, &apos;Bitstream Vera Sans Mono&apos;, &apos;Courier New&apos;, Courier, monospace !important;&quot;&gt;	do&lt;/span&gt;&lt;/pre&gt;
			&lt;/td&gt;
		&lt;/tr&gt;
				&lt;tr id=&quot;syntaxplugin_code_and_gutter&quot;&gt;
						&lt;td  style=&quot; line-height: 1.4em !important; padding: 0em; vertical-align: top;&quot;&gt;
					&lt;pre style=&quot;font-size: 1em; margin: 0 10px;   width: auto; padding: 0;&quot;&gt;&lt;span style=&quot;color: black; font-family: &apos;Consolas&apos;, &apos;Bitstream Vera Sans Mono&apos;, &apos;Courier New&apos;, Courier, monospace !important;&quot;&gt;	content=`lsof -p $PID`; &lt;/span&gt;&lt;/pre&gt;
			&lt;/td&gt;
		&lt;/tr&gt;
				&lt;tr id=&quot;syntaxplugin_code_and_gutter&quot;&gt;
						&lt;td  style=&quot; line-height: 1.4em !important; padding: 0em; vertical-align: top;&quot;&gt;
					&lt;pre style=&quot;font-size: 1em; margin: 0 10px;   width: auto; padding: 0;&quot;&gt;&lt;span style=&quot;color: black; font-family: &apos;Consolas&apos;, &apos;Bitstream Vera Sans Mono&apos;, &apos;Courier New&apos;, Courier, monospace !important;&quot;&gt;	lines=`echo &quot;$content&quot; | wc -l`&lt;/span&gt;&lt;/pre&gt;
			&lt;/td&gt;
		&lt;/tr&gt;
				&lt;tr id=&quot;syntaxplugin_code_and_gutter&quot;&gt;
						&lt;td  style=&quot; line-height: 1.4em !important; padding: 0em; vertical-align: top;&quot;&gt;
					&lt;pre style=&quot;font-size: 1em; margin: 0 10px;   width: auto; padding: 0;&quot;&gt;&lt;span style=&quot;color: black; font-family: &apos;Consolas&apos;, &apos;Bitstream Vera Sans Mono&apos;, &apos;Courier New&apos;, Courier, monospace !important;&quot;&gt;	file=&quot;lsof_logs/dump-$lines-$N&quot;&lt;/span&gt;&lt;/pre&gt;
			&lt;/td&gt;
		&lt;/tr&gt;
				&lt;tr id=&quot;syntaxplugin_code_and_gutter&quot;&gt;
						&lt;td  style=&quot; line-height: 1.4em !important; padding: 0em; vertical-align: top;&quot;&gt;
					&lt;pre style=&quot;font-size: 1em; margin: 0 10px;   width: auto; padding: 0;&quot;&gt;&lt;span style=&quot;color: black; font-family: &apos;Consolas&apos;, &apos;Bitstream Vera Sans Mono&apos;, &apos;Courier New&apos;, Courier, monospace !important;&quot;&gt;	echo &quot;$content&quot; &amp;gt; $file;&lt;/span&gt;&lt;/pre&gt;
			&lt;/td&gt;
		&lt;/tr&gt;
				&lt;tr id=&quot;syntaxplugin_code_and_gutter&quot;&gt;
						&lt;td  style=&quot; line-height: 1.4em !important; padding: 0em; vertical-align: top;&quot;&gt;
					&lt;pre style=&quot;font-size: 1em; margin: 0 10px;   width: auto; padding: 0;&quot;&gt;&lt;span style=&quot;color: black; font-family: &apos;Consolas&apos;, &apos;Bitstream Vera Sans Mono&apos;, &apos;Courier New&apos;, Courier, monospace !important;&quot;&gt;	echo $file&lt;/span&gt;&lt;/pre&gt;
			&lt;/td&gt;
		&lt;/tr&gt;
				&lt;tr id=&quot;syntaxplugin_code_and_gutter&quot;&gt;
						&lt;td  style=&quot; line-height: 1.4em !important; padding: 0em; vertical-align: top;&quot;&gt;
					&lt;pre style=&quot;font-size: 1em; margin: 0 10px;   width: auto; padding: 0;&quot;&gt;&lt;span style=&quot;color: black; font-family: &apos;Consolas&apos;, &apos;Bitstream Vera Sans Mono&apos;, &apos;Courier New&apos;, Courier, monospace !important;&quot;&gt;	N=$((N+1))&lt;/span&gt;&lt;/pre&gt;
			&lt;/td&gt;
		&lt;/tr&gt;
				&lt;tr id=&quot;syntaxplugin_code_and_gutter&quot;&gt;
						&lt;td  style=&quot; line-height: 1.4em !important; padding: 0em; vertical-align: top;&quot;&gt;
					&lt;pre style=&quot;font-size: 1em; margin: 0 10px;   width: auto; padding: 0;&quot;&gt;&lt;span style=&quot;color: black; font-family: &apos;Consolas&apos;, &apos;Bitstream Vera Sans Mono&apos;, &apos;Courier New&apos;, Courier, monospace !important;&quot;&gt;done &lt;/span&gt;&lt;/pre&gt;
			&lt;/td&gt;
		&lt;/tr&gt;
				&lt;tr id=&quot;syntaxplugin_code_and_gutter&quot;&gt;
						&lt;td  style=&quot; line-height: 1.4em !important; padding: 0em; vertical-align: top;&quot;&gt;
					&lt;pre style=&quot;font-size: 1em; margin: 0 10px;   margin-bottom: 10px;  width: auto; padding: 0;&quot;&gt;&lt;span style=&quot;color: black; font-family: &apos;Consolas&apos;, &apos;Bitstream Vera Sans Mono&apos;, &apos;Courier New&apos;, Courier, monospace !important;&quot;&gt;&lt;/span&gt;&lt;/pre&gt;
			&lt;/td&gt;
		&lt;/tr&gt;
			&lt;/tbody&gt;
&lt;/table&gt;
&lt;/div&gt;
&lt;p/&gt;</comment>
                            <comment id="12941457" author="duckslo" created="Wed, 5 Feb 2014 06:49:21 -0500"  >&lt;p&gt;File-leak-detector shows that  21.444 files remains open on WF and only 1.368 on AS7. Attached the trace and the current open files list on WF.&lt;/p&gt;</comment>
                            <comment id="12941534" author="duckslo" created="Wed, 5 Feb 2014 09:39:35 -0500"  >&lt;p&gt;The issue was in Liferay. It does not close resource connections. After applying the LR patch the server below, WildFly8 starts with the 919 open descriptors.&lt;/p&gt;

&lt;p&gt;Liferay Issue&lt;br/&gt;
&lt;a href=&quot;https://issues.liferay.com/browse/LPS-44052&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.liferay.com/browse/LPS-44052&lt;/a&gt;&lt;br/&gt;
Lifery Patch:&lt;br/&gt;
&lt;a href=&quot;https://github.com/ctomc/liferay-portal/compare/file-handle-fix?expand=1&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://github.com/ctomc/liferay-portal/compare/file-handle-fix?expand=1&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="12941540" author="ctomc" created="Wed, 5 Feb 2014 09:48:20 -0500"  >&lt;p&gt;We found out that issue in LifeRay itself. &lt;br/&gt;
Issue for tracking that in Liferay is &lt;a href=&quot;https://issues.liferay.com/browse/LPS-44052&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.liferay.com/browse/LPS-44052&lt;/a&gt;&lt;br/&gt;
PR that fix that problem is &lt;a href=&quot;https://github.com/liferay/liferay-portal/pull/515&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://github.com/liferay/liferay-portal/pull/515&lt;/a&gt; &amp;amp; &lt;a href=&quot;https://github.com/liferay/liferay-portal/pull/516&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://github.com/liferay/liferay-portal/pull/516&lt;/a&gt; (for 6.2.x branch where the original issue was found)&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12380311" name="dump-9406-514" size="1996364" author="duckslo" created="Tue, 4 Feb 2014 10:57:55 -0500"/>
                            <attachment id="12380307" name="dump-fail-deply-lr.txt" size="141586" author="duckslo" created="Tue, 4 Feb 2014 08:08:34 -0500"/>
                            <attachment id="12380308" name="dump-nothingtodeploy.txt" size="127289" author="duckslo" created="Tue, 4 Feb 2014 08:08:34 -0500"/>
                            <attachment id="12380325" name="open-wildfly.b2" size="995731" author="duckslo" created="Wed, 5 Feb 2014 06:49:21 -0500"/>
                            <attachment id="12380306" name="server-fail-deploy-liferay.log" size="153030" author="duckslo" created="Tue, 4 Feb 2014 08:08:34 -0500"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12310010" key="org.jboss.labs.jira.plugin.jboss-custom-field-types-plugin:multiurl">
                        <customfieldname>Forum Reference</customfieldname>
                        <customfieldvalues>
                            https://community.jboss.org/message/850843
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                <customfield id="customfield_12310641" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Number of attachments</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>5.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310640" key="com.atlassian.jira.toolkit:comments">
                        <customfieldname>Number of comments</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>5.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12311940" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1|hzm2x3:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310840" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>189102</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>