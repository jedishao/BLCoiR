<!-- 
RSS generated by JIRA (7.2.3#72005-sha1:73be91d2b96fc29303a7eb6820acf420e5d0ed65) at Tue Dec 06 17:18:09 EST 2016

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.jboss.org/si/jira.issueviews:issue-xml/WFCORE-1481/WFCORE-1481.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>JBoss Issue Tracker</title>
    <link>https://issues.jboss.org</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-us</language>    <build-info>
        <version>7.2.3</version>
        <build-number>72005</build-number>
        <build-date>06-10-2016</build-date>
    </build-info>

<item>
            <title>[WFCORE-1481] list-add operation doesn&apos;t work on login-modules attribute</title>
                <link>https://issues.jboss.org/browse/WFCORE-1481</link>
                <project id="12315422" key="WFCORE">WildFly Core</project>
                    <description>&lt;p&gt;Executing list-add operation on login-modules results in the modules being replaced instead of appending new module.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12615627">WFCORE-1481</key>
            <summary>list-add operation doesn&apos;t work on login-modules attribute</summary>
                <type id="1" iconUrl="https://issues.jboss.org/secure/viewavatar?size=xsmall&amp;avatarId=13263&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.jboss.org/images/icons/priorities/major.svg">Major</priority>
                        <status id="5" iconUrl="https://issues.jboss.org/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Done</resolution>
                                        <assignee username="thofman">Tomas Hofman</assignee>
                                    <reporter username="spyrkob">Bartosz Spyrko-&#346;mietanko</reporter>
                        <labels>
                    </labels>
                <created>Mon, 18 Apr 2016 10:48:59 -0400</created>
                <updated>Mon, 25 Jul 2016 22:42:04 -0400</updated>
                            <resolved>Mon, 25 Jul 2016 22:42:04 -0400</resolved>
                                    <version>2.1.0.Final</version>
                                    <fixVersion>3.0.0.Alpha4</fixVersion>
                                    <component>Domain Management</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>5</watches>
                                                                <comments>
                            <comment id="13193238" author="spyrkob" created="Mon, 18 Apr 2016 10:58:58 -0400"  >&lt;p&gt;I think this is because login-modules attribute has been replaced with login-module sub-model. &lt;br/&gt;
When AbstractCollectionHandler checks if the login-modules attribute exists&lt;span class=&quot;error&quot;&gt;&amp;#91;1&amp;#93;&lt;/span&gt;, it succeeds, but when it tries to resolve current value &lt;span class=&quot;error&quot;&gt;&amp;#91;2&amp;#93;&lt;/span&gt; the resulting model is always undefined.&lt;/p&gt;

&lt;p&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;1&amp;#93;&lt;/span&gt; &lt;a href=&quot;https://github.com/wildfly/wildfly-core/blob/master/controller/src/main/java/org/jboss/as/controller/operations/global/AbstractCollectionHandler.java#L84&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://github.com/wildfly/wildfly-core/blob/master/controller/src/main/java/org/jboss/as/controller/operations/global/AbstractCollectionHandler.java#L84&lt;/a&gt;&lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;2&amp;#93;&lt;/span&gt; &lt;a href=&quot;https://github.com/wildfly/wildfly-core/blob/master/controller/src/main/java/org/jboss/as/controller/operations/global/AbstractCollectionHandler.java#L97&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://github.com/wildfly/wildfly-core/blob/master/controller/src/main/java/org/jboss/as/controller/operations/global/AbstractCollectionHandler.java#L97&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="13193408" author="brian.stansberry" created="Mon, 18 Apr 2016 17:27:24 -0400"  >&lt;p&gt;I&apos;m going to move this to WFCORE because that&apos;s where the problem is. It&apos;s not specific to this particular attribute.&lt;/p&gt;

&lt;p&gt;I believe the problem is AbstractCollectionHandler L91, which should not be a simple context.readResource(ForUpdate). Instead the handler needs to create a &quot;response&quot; ModelNode, create a &quot;read-attribute&quot; operation, pass in those two params to add a step to execute that op, and then another step that uses the data in the now-populated response node to do the rest of the manipulation.&lt;/p&gt;

&lt;p&gt;Basically, calling context.readResource(ForUpdate) only works if the attribute value is stored in the Resource&apos;s internal model. In this case it is not; it&apos;s synthetically derived by reading the child resources.&lt;/p&gt;

&lt;p&gt;A twist is adding a step with the read-resource op is not going to acquire the controller lock before the read, so you could have a race where the read is done, then another op writes, changing the relevant model, and then the write executes, overwriting the other op&apos;s change. Sure, it&apos;s a 1 in 1,000,000,000 case, but the simple solution is to call context.acquireControllerLock before adding the steps if requiredReadWriteAccess == true.&lt;/p&gt;</comment>
                            <comment id="13193791" author="ctomc" created="Tue, 19 Apr 2016 09:53:47 -0400"  >&lt;p&gt;This one is tricky, and was known issue when when we ware working on this feature.&lt;br/&gt;
if my memory serves me right it was decided we shouldn&apos;t need to complicate whole code with extra chaining of calls to address this one single use case, as security subsystem was on the way out to be replaced with Elytron.&lt;br/&gt;
But that is history, security subsystem is here to stay and we should address this. &lt;br/&gt;
Either by complicating code for this corner case within collection handling operations or maybe even change the way security subsystem code around &quot;virtual attribute&quot; login-modules behaves.&lt;/p&gt;</comment>
                            <comment id="13193818" author="brian.stansberry" created="Tue, 19 Apr 2016 10:15:24 -0400"  >&lt;p&gt;I think this can happen in other contexts. Basically there is no requirement that resources expose attribute values via Resource.getModel() so kernel code shouldn&apos;t be assuming they do.&lt;/p&gt;</comment>
                            <comment id="13205325" author="thofman" created="Fri, 13 May 2016 09:17:26 -0400"  >&lt;p&gt;I tried Brian&apos;s suggestion, and it&apos;s working, except that CollectionOperationsTestCase#test&lt;span class=&quot;error&quot;&gt;&amp;#91;Map/List&amp;#93;&lt;/span&gt;OperationsInComposite fails (&lt;a href=&quot;https://github.com/wildfly/wildfly-core/blob/master/controller/src/test/java/org/jboss/as/controller/operation/global/CollectionOperationsTestCase.java#L400&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://github.com/wildfly/wildfly-core/blob/master/controller/src/test/java/org/jboss/as/controller/operation/global/CollectionOperationsTestCase.java#L400&lt;/a&gt;).&lt;/p&gt;

&lt;p&gt;However, I think the test case doesn&apos;t represent real use cases.&lt;/p&gt;

&lt;p&gt;Reason why it&apos;s failing is that:&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;the tested attribute has Read Operation Step Handler defined, which simulates reading data from runtime,&lt;/li&gt;
	&lt;li&gt;the tested attribute also has WriteOSH defined, which updates the resource model, and adds another step to update runtime, but this step is added to RUNTIME stage,&lt;/li&gt;
	&lt;li&gt;so the list-add ops in the composite doesn&apos;t see results of previous list-add ops, because runtime is updated at the end of the composite op, not its&apos; individual steps.&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;This problem doesn&apos;t happen when:&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;ReadOSH is not set, because then the value is read from resource&apos;s model, which is up to date,&lt;/li&gt;
	&lt;li&gt;or WriteOSH is doing everything in DOMAIN stage.&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;So I tried to look for actually existing read-write list attributes in Wildfly. The only ones I found either doesn&apos;t have ReadOSH, or are using LegacyModulesAttributeReader/Writer. LegacyModulesAttributeWriter is not using RUNTIME stage, so is not affected by this problem.&lt;/p&gt;

&lt;p&gt;So I think this behaviour is OK..?&lt;/p&gt;</comment>
                            <comment id="13205564" author="brian.stansberry" created="Fri, 13 May 2016 11:36:06 -0400"  >&lt;p&gt;Just a quick comment on a couple details before digging in more on the main point you raised:&lt;/p&gt;

&lt;p&gt;&quot;WriteOSH is doing everything in DOMAIN stage&quot; is not ok. Stage.DOMAIN shouldn&apos;t be used by anything outside the specialized OSHs the HostControllers use for rolling changes out to the domain.&lt;/p&gt;

&lt;p&gt;The test sounds odd, in the &quot;the tested attribute also has WriteOSH defined, which updates the resource model&quot; bit. That sounds contrived; I would expect a runtime-only attribute to only write to the runtime, and never write to the model.&lt;/p&gt;

&lt;p&gt;But it sounds like changing that to not write to the model would not help the basic problem, which is that Stage.RUNTIME changes are not getting handled.&lt;/p&gt;

&lt;p&gt;I&apos;ll poke a bit. &lt;/p&gt;</comment>
                            <comment id="13237684" author="brian.stansberry" created="Fri, 13 May 2016 16:19:37 -0400"  >&lt;p&gt;I looked at the test case and I don&apos;t think my word &quot;contrived&quot; was accurate; I think there was just a small mistake in the test in not reading the attribute value in Stage.RUNTIME. &lt;a href=&quot;https://github.com/wildfly/wildfly-core/pull/1562&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://github.com/wildfly/wildfly-core/pull/1562&lt;/a&gt; fixes that.&lt;/p&gt;

&lt;p&gt;I think the fix you&apos;re trying will have problems with this scenario of working with a runtime-only attribute, but I think the existing code will too. I have some thoughts on how to get it to work, but it will be complex. If you can&apos;t find examples of runtime-only list and map attributes it may be ok to get the basic case corrected and file a JIRA for the runtime-only case. The runtime-only case fix will likely build on the simple case fix anyway. Probably by doing some gymnastics to get things to execute in Stage.RUNTIME at the right point. To get an effecdt like your Stage.DOMAIN suggestion, but Stage.RUNTIME instead of Stage.DOMAIN.&lt;/p&gt;

&lt;p&gt;Quick summary of the trick:&lt;br/&gt;
1) Find out before doing any read-attribute whether the attribute is runtime-only. This is done via context.getResourceRegistration().getAttributeAccess(...).getStorageType().&lt;/p&gt;

&lt;p&gt;2) If it&apos;s Storage.RUNTIME, then instead of registering the &quot;another step that uses the data in the now-populated response node to do the rest of the manipulation&quot; in Stage.MODEL, you do the following:&lt;/p&gt;

&lt;p&gt;a) Register a step in Stage.RUNTIME that does nothing except&lt;br/&gt;
b) Registers also in Stage.RUNTIME &quot;another step that uses the data in the now-populated response node to do the rest of the manipulation&quot;.&lt;/p&gt;

&lt;p&gt;Here&apos;s how this works. I&apos;ll describe the manipulation of the list of steps below, with this id syntax M## or R## where M is Stage.MODEL, R is Stage.RUNTIME and ## is a sequence number.&lt;/p&gt;

&lt;p&gt;I. The Storage.CONFIGURATION (i.e. non-runtime-only) attribute case looks like this:&lt;/p&gt;

&lt;p&gt;1) Begin operation execution:&lt;/p&gt;

&lt;p&gt;M0 (the PrepareStepHandler, which figures out which OSH is registered to handle the user&apos;s request and adds a step.)&lt;/p&gt;

&lt;p&gt;2) M0 executes:&lt;/p&gt;

&lt;p&gt;M0&lt;br/&gt;
M1 (ListAddHandler) &lt;/p&gt;

&lt;p&gt;3) M1 executes&lt;/p&gt;

&lt;p&gt;M0&lt;br/&gt;
M1&lt;br/&gt;
M2 (the handler for read-attribute)&lt;br/&gt;
M3 (the handler that takes the M2 result and adds write-attribute)&lt;/p&gt;

&lt;p&gt;4) M2 executes&lt;/p&gt;

&lt;p&gt;(same queue as 3))&lt;/p&gt;

&lt;p&gt;5) M3 executes&lt;/p&gt;

&lt;p&gt;M0&lt;br/&gt;
M1&lt;br/&gt;
M2&lt;br/&gt;
M3&lt;br/&gt;
M4 (the write-attribute step)&lt;/p&gt;

&lt;p&gt;6) M4 executes&lt;/p&gt;

&lt;p&gt;M0&lt;br/&gt;
M1&lt;br/&gt;
M2&lt;br/&gt;
M3&lt;br/&gt;
M4 &lt;br/&gt;
R1 (a step to update the runtime to reflect the write-attribute)&lt;/p&gt;


&lt;p&gt;II. The Storage.RUNTIME attribute case looks like this:&lt;/p&gt;

&lt;p&gt;1) and 2) are the same as above.&lt;/p&gt;

&lt;p&gt;3) M1 executes&lt;/p&gt;

&lt;p&gt;M0&lt;br/&gt;
M1&lt;br/&gt;
M2 (the handler for read-attribute)&lt;br/&gt;
R1 (the odd R handler that just adds a step)&lt;/p&gt;

&lt;p&gt;4) M2 executes&lt;/p&gt;

&lt;p&gt;M0&lt;br/&gt;
M1&lt;br/&gt;
M2&lt;br/&gt;
R1 (the odd R handler that just adds a step)&lt;br/&gt;
R2 (added by M2 to do the read of the runtime in Stage.RUNTIME)&lt;/p&gt;

&lt;p&gt;5) R1 executes&lt;/p&gt;

&lt;p&gt;M0&lt;br/&gt;
M1&lt;br/&gt;
M2&lt;br/&gt;
R1&lt;br/&gt;
R2&lt;br/&gt;
R3 (the handler that takes the R2 result and adds write-attribute)&lt;/p&gt;

&lt;p&gt;6) R2 executes&lt;/p&gt;

&lt;p&gt;same as 5)&lt;/p&gt;

&lt;p&gt;7) R3 executes&lt;/p&gt;

&lt;p&gt;M0&lt;br/&gt;
M1&lt;br/&gt;
M2&lt;br/&gt;
R1&lt;br/&gt;
R2&lt;br/&gt;
R3&lt;br/&gt;
R4 (the write-attribute step, registered in Stage.RUNTIME)&lt;/p&gt;


&lt;p&gt;8) R4 executes&lt;/p&gt;

&lt;p&gt;M0&lt;br/&gt;
M1&lt;br/&gt;
M2&lt;br/&gt;
R1&lt;br/&gt;
R2&lt;br/&gt;
R3&lt;br/&gt;
R4 &lt;/p&gt;

&lt;p&gt;So why the &quot;odd&quot; R1? Because R3 has to execute after R2, which means it needs to be registered after R2. The &quot;odd&quot; R1 executes after M2 so it is able to register R3 after R2.&lt;/p&gt;

&lt;p&gt;The reality is things are even more complex than this. But this illustrates the kind of things that can be done to trigger execution in the right spot.&lt;/p&gt;</comment>
                            <comment id="13237686" author="brian.stansberry" created="Fri, 13 May 2016 16:34:13 -0400"  >&lt;p&gt;I closed the PR I mentioned in my last comment. I get what the test is doing and it&apos;s not contrived and not mistaken. It&apos;s just validating that a normal Storage.CONFIGURATION attribute with a handler that updates the runtime works properly, all the way through to updating the runtime.&lt;/p&gt;</comment>
                            <comment id="13238041" author="thofman" created="Mon, 16 May 2016 07:52:04 -0400"  >&lt;p&gt;That&apos;s great explanation, I will try it out.&lt;/p&gt;

&lt;p&gt;&quot;or WriteOSH is doing everything in DOMAIN stage&quot; is actually typo - should have been MODEL, not DOMAIN. Never mind, I will see where I get with advice above.&lt;/p&gt;</comment>
                            <comment id="13239962" author="thofman" created="Thu, 19 May 2016 08:00:36 -0400"  >&lt;p&gt;Status update&lt;/p&gt;

&lt;p&gt;I committed my current version here: &lt;a href=&quot;https://github.com/TomasHofman/wildfly-core/commit/7f370a4a6ea1e8c48abc9330d7759afe5c4a0077#diff-caff84f283fb9500ec241e826f3a2728&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://github.com/TomasHofman/wildfly-core/commit/7f370a4a6ea1e8c48abc9330d7759afe5c4a0077#diff-caff84f283fb9500ec241e826f3a2728&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;I. Storage.RUNTIME&lt;/p&gt;

&lt;p&gt;I think this case is working fine. The only issue is that even if one uses AbstractWriteAttributeHandler as writing OSH, the handler doesn&apos;t validates the operation correctly. That is because validation is performed in MODEL stage when the final value is not yet determined, so the validation passes even if it shouldn&apos;t. It could be solved by performing the validation in RUNTIME stage manually like:&lt;/p&gt;

&lt;p/&gt;
&lt;div id=&quot;syntaxplugin&quot; class=&quot;syntaxplugin&quot; style=&quot;border: 1px dashed #bbb; border-radius: 5px !important; overflow: auto; max-height: 30em;&quot;&gt;
&lt;table cellspacing=&quot;0&quot; cellpadding=&quot;0&quot; border=&quot;0&quot; width=&quot;100%&quot; style=&quot;font-size: 1em; line-height: 1.4em !important; font-weight: normal; font-style: normal; color: black;&quot;&gt;
		&lt;tbody &gt;
				&lt;tr id=&quot;syntaxplugin_code_and_gutter&quot;&gt;
						&lt;td  style=&quot; line-height: 1.4em !important; padding: 0em; vertical-align: top;&quot;&gt;
					&lt;pre style=&quot;font-size: 1em; margin: 0 10px;  margin-top: 10px;   width: auto; padding: 0;&quot;&gt;&lt;span style=&quot;color: black; font-family: &apos;Consolas&apos;, &apos;Bitstream Vera Sans Mono&apos;, &apos;Courier New&apos;, Courier, monospace !important;&quot;&gt;.addReadWriteAttribute(LIST_ATTRIBUTE, readerOSH,&lt;/span&gt;&lt;/pre&gt;
			&lt;/td&gt;
		&lt;/tr&gt;
				&lt;tr id=&quot;syntaxplugin_code_and_gutter&quot;&gt;
						&lt;td  style=&quot; line-height: 1.4em !important; padding: 0em; vertical-align: top;&quot;&gt;
					&lt;pre style=&quot;font-size: 1em; margin: 0 10px;   width: auto; padding: 0;&quot;&gt;&lt;span style=&quot;color: black; font-family: &apos;Consolas&apos;, &apos;Bitstream Vera Sans Mono&apos;, &apos;Courier New&apos;, Courier, monospace !important;&quot;&gt;                        new OperationStepHandler() {&lt;/span&gt;&lt;/pre&gt;
			&lt;/td&gt;
		&lt;/tr&gt;
				&lt;tr id=&quot;syntaxplugin_code_and_gutter&quot;&gt;
						&lt;td  style=&quot; line-height: 1.4em !important; padding: 0em; vertical-align: top;&quot;&gt;
					&lt;pre style=&quot;font-size: 1em; margin: 0 10px;   width: auto; padding: 0;&quot;&gt;&lt;span style=&quot;color: black; font-family: &apos;Consolas&apos;, &apos;Bitstream Vera Sans Mono&apos;, &apos;Courier New&apos;, Courier, monospace !important;&quot;&gt;                            @Override&lt;/span&gt;&lt;/pre&gt;
			&lt;/td&gt;
		&lt;/tr&gt;
				&lt;tr id=&quot;syntaxplugin_code_and_gutter&quot;&gt;
						&lt;td  style=&quot; line-height: 1.4em !important; padding: 0em; vertical-align: top;&quot;&gt;
					&lt;pre style=&quot;font-size: 1em; margin: 0 10px;   width: auto; padding: 0;&quot;&gt;&lt;span style=&quot;color: black; font-family: &apos;Consolas&apos;, &apos;Bitstream Vera Sans Mono&apos;, &apos;Courier New&apos;, Courier, monospace !important;&quot;&gt;                            public void execute(OperationContext context, ModelNode operation) throws OperationFailedException {&lt;/span&gt;&lt;/pre&gt;
			&lt;/td&gt;
		&lt;/tr&gt;
				&lt;tr id=&quot;syntaxplugin_code_and_gutter&quot;&gt;
						&lt;td  style=&quot; line-height: 1.4em !important; padding: 0em; vertical-align: top;&quot;&gt;
					&lt;pre style=&quot;font-size: 1em; margin: 0 10px;   width: auto; padding: 0;&quot;&gt;&lt;span style=&quot;color: black; font-family: &apos;Consolas&apos;, &apos;Bitstream Vera Sans Mono&apos;, &apos;Courier New&apos;, Courier, monospace !important;&quot;&gt;                                context.addStep(operation, (context1, operation1) -&amp;gt; {&lt;/span&gt;&lt;/pre&gt;
			&lt;/td&gt;
		&lt;/tr&gt;
				&lt;tr id=&quot;syntaxplugin_code_and_gutter&quot;&gt;
						&lt;td  style=&quot; line-height: 1.4em !important; padding: 0em; vertical-align: top;&quot;&gt;
					&lt;pre style=&quot;font-size: 1em; margin: 0 10px;   width: auto; padding: 0;&quot;&gt;&lt;span style=&quot;color: black; font-family: &apos;Consolas&apos;, &apos;Bitstream Vera Sans Mono&apos;, &apos;Courier New&apos;, Courier, monospace !important;&quot;&gt;                                    // validate&lt;/span&gt;&lt;/pre&gt;
			&lt;/td&gt;
		&lt;/tr&gt;
				&lt;tr id=&quot;syntaxplugin_code_and_gutter&quot;&gt;
						&lt;td  style=&quot; line-height: 1.4em !important; padding: 0em; vertical-align: top;&quot;&gt;
					&lt;pre style=&quot;font-size: 1em; margin: 0 10px;   width: auto; padding: 0;&quot;&gt;&lt;span style=&quot;color: black; font-family: &apos;Consolas&apos;, &apos;Bitstream Vera Sans Mono&apos;, &apos;Courier New&apos;, Courier, monospace !important;&quot;&gt;                                    final ModelNode syntheticOp = new ModelNode();&lt;/span&gt;&lt;/pre&gt;
			&lt;/td&gt;
		&lt;/tr&gt;
				&lt;tr id=&quot;syntaxplugin_code_and_gutter&quot;&gt;
						&lt;td  style=&quot; line-height: 1.4em !important; padding: 0em; vertical-align: top;&quot;&gt;
					&lt;pre style=&quot;font-size: 1em; margin: 0 10px;   width: auto; padding: 0;&quot;&gt;&lt;span style=&quot;color: black; font-family: &apos;Consolas&apos;, &apos;Bitstream Vera Sans Mono&apos;, &apos;Courier New&apos;, Courier, monospace !important;&quot;&gt;                                    syntheticOp.get(LIST_ATTRIBUTE.getName()).set(operation.get(VALUE));&lt;/span&gt;&lt;/pre&gt;
			&lt;/td&gt;
		&lt;/tr&gt;
				&lt;tr id=&quot;syntaxplugin_code_and_gutter&quot;&gt;
						&lt;td  style=&quot; line-height: 1.4em !important; padding: 0em; vertical-align: top;&quot;&gt;
					&lt;pre style=&quot;font-size: 1em; margin: 0 10px;   width: auto; padding: 0;&quot;&gt;&lt;span style=&quot;color: black; font-family: &apos;Consolas&apos;, &apos;Bitstream Vera Sans Mono&apos;, &apos;Courier New&apos;, Courier, monospace !important;&quot;&gt;                                    LIST_ATTRIBUTE.validateOperation(syntheticOp);&lt;/span&gt;&lt;/pre&gt;
			&lt;/td&gt;
		&lt;/tr&gt;
				&lt;tr id=&quot;syntaxplugin_code_and_gutter&quot;&gt;
						&lt;td  style=&quot; line-height: 1.4em !important; padding: 0em; vertical-align: top;&quot;&gt;
					&lt;pre style=&quot;font-size: 1em; margin: 0 10px;   width: auto; padding: 0;&quot;&gt;&amp;nbsp;&lt;/pre&gt;
			&lt;/td&gt;
		&lt;/tr&gt;
				&lt;tr id=&quot;syntaxplugin_code_and_gutter&quot;&gt;
						&lt;td  style=&quot; line-height: 1.4em !important; padding: 0em; vertical-align: top;&quot;&gt;
					&lt;pre style=&quot;font-size: 1em; margin: 0 10px;   width: auto; padding: 0;&quot;&gt;&lt;span style=&quot;color: black; font-family: &apos;Consolas&apos;, &apos;Bitstream Vera Sans Mono&apos;, &apos;Courier New&apos;, Courier, monospace !important;&quot;&gt;                                    // set&lt;/span&gt;&lt;/pre&gt;
			&lt;/td&gt;
		&lt;/tr&gt;
				&lt;tr id=&quot;syntaxplugin_code_and_gutter&quot;&gt;
						&lt;td  style=&quot; line-height: 1.4em !important; padding: 0em; vertical-align: top;&quot;&gt;
					&lt;pre style=&quot;font-size: 1em; margin: 0 10px;   width: auto; padding: 0;&quot;&gt;&lt;span style=&quot;color: black; font-family: &apos;Consolas&apos;, &apos;Bitstream Vera Sans Mono&apos;, &apos;Courier New&apos;, Courier, monospace !important;&quot;&gt;                                    runtimeListAttributeValue = operation.get(VALUE);&lt;/span&gt;&lt;/pre&gt;
			&lt;/td&gt;
		&lt;/tr&gt;
				&lt;tr id=&quot;syntaxplugin_code_and_gutter&quot;&gt;
						&lt;td  style=&quot; line-height: 1.4em !important; padding: 0em; vertical-align: top;&quot;&gt;
					&lt;pre style=&quot;font-size: 1em; margin: 0 10px;   width: auto; padding: 0;&quot;&gt;&lt;span style=&quot;color: black; font-family: &apos;Consolas&apos;, &apos;Bitstream Vera Sans Mono&apos;, &apos;Courier New&apos;, Courier, monospace !important;&quot;&gt;                                }, OperationContext.Stage.RUNTIME);&lt;/span&gt;&lt;/pre&gt;
			&lt;/td&gt;
		&lt;/tr&gt;
				&lt;tr id=&quot;syntaxplugin_code_and_gutter&quot;&gt;
						&lt;td  style=&quot; line-height: 1.4em !important; padding: 0em; vertical-align: top;&quot;&gt;
					&lt;pre style=&quot;font-size: 1em; margin: 0 10px;   width: auto; padding: 0;&quot;&gt;&lt;span style=&quot;color: black; font-family: &apos;Consolas&apos;, &apos;Bitstream Vera Sans Mono&apos;, &apos;Courier New&apos;, Courier, monospace !important;&quot;&gt;                            }&lt;/span&gt;&lt;/pre&gt;
			&lt;/td&gt;
		&lt;/tr&gt;
				&lt;tr id=&quot;syntaxplugin_code_and_gutter&quot;&gt;
						&lt;td  style=&quot; line-height: 1.4em !important; padding: 0em; vertical-align: top;&quot;&gt;
					&lt;pre style=&quot;font-size: 1em; margin: 0 10px;   margin-bottom: 10px;  width: auto; padding: 0;&quot;&gt;&lt;span style=&quot;color: black; font-family: &apos;Consolas&apos;, &apos;Bitstream Vera Sans Mono&apos;, &apos;Courier New&apos;, Courier, monospace !important;&quot;&gt;                        })&lt;/span&gt;&lt;/pre&gt;
			&lt;/td&gt;
		&lt;/tr&gt;
			&lt;/tbody&gt;
&lt;/table&gt;
&lt;/div&gt;
&lt;p/&gt;

&lt;p&gt;So the person implementing the attribute has to be aware that:&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;he must add RUNTIME steps in his reader/writer OSHs,&lt;/li&gt;
	&lt;li&gt;he must perform validation manually, if he wants it.&lt;/li&gt;
&lt;/ul&gt;



&lt;p&gt;II. Storage.Configuration&lt;/p&gt;

&lt;p&gt;I still little bit struggle with composite operations, particularly in that test case which you were looking at.&lt;/p&gt;

&lt;p&gt;Lets have Storage.CONFIGURATION attribute with reader OSH like the one in the test case:&lt;/p&gt;

&lt;p/&gt;
&lt;div id=&quot;syntaxplugin&quot; class=&quot;syntaxplugin&quot; style=&quot;border: 1px dashed #bbb; border-radius: 5px !important; overflow: auto; max-height: 30em;&quot;&gt;
&lt;table cellspacing=&quot;0&quot; cellpadding=&quot;0&quot; border=&quot;0&quot; width=&quot;100%&quot; style=&quot;font-size: 1em; line-height: 1.4em !important; font-weight: normal; font-style: normal; color: black;&quot;&gt;
		&lt;tbody &gt;
				&lt;tr id=&quot;syntaxplugin_code_and_gutter&quot;&gt;
						&lt;td  style=&quot; line-height: 1.4em !important; padding: 0em; vertical-align: top;&quot;&gt;
					&lt;pre style=&quot;font-size: 1em; margin: 0 10px;  margin-top: 10px;   width: auto; padding: 0;&quot;&gt;&lt;span style=&quot;color: black; font-family: &apos;Consolas&apos;, &apos;Bitstream Vera Sans Mono&apos;, &apos;Courier New&apos;, Courier, monospace !important;&quot;&gt;StringListAttributeDefinition LIST_ATTRIBUTE = new StringListAttributeDefinition.Builder(&quot;my-list-attribute&quot;)&lt;/span&gt;&lt;/pre&gt;
			&lt;/td&gt;
		&lt;/tr&gt;
				&lt;tr id=&quot;syntaxplugin_code_and_gutter&quot;&gt;
						&lt;td  style=&quot; line-height: 1.4em !important; padding: 0em; vertical-align: top;&quot;&gt;
					&lt;pre style=&quot;font-size: 1em; margin: 0 10px;   width: auto; padding: 0;&quot;&gt;&lt;span style=&quot;color: black; font-family: &apos;Consolas&apos;, &apos;Bitstream Vera Sans Mono&apos;, &apos;Courier New&apos;, Courier, monospace !important;&quot;&gt;            .setAllowNull(true)&lt;/span&gt;&lt;/pre&gt;
			&lt;/td&gt;
		&lt;/tr&gt;
				&lt;tr id=&quot;syntaxplugin_code_and_gutter&quot;&gt;
						&lt;td  style=&quot; line-height: 1.4em !important; padding: 0em; vertical-align: top;&quot;&gt;
					&lt;pre style=&quot;font-size: 1em; margin: 0 10px;   width: auto; padding: 0;&quot;&gt;&lt;span style=&quot;color: black; font-family: &apos;Consolas&apos;, &apos;Bitstream Vera Sans Mono&apos;, &apos;Courier New&apos;, Courier, monospace !important;&quot;&gt;            .build();&lt;/span&gt;&lt;/pre&gt;
			&lt;/td&gt;
		&lt;/tr&gt;
				&lt;tr id=&quot;syntaxplugin_code_and_gutter&quot;&gt;
						&lt;td  style=&quot; line-height: 1.4em !important; padding: 0em; vertical-align: top;&quot;&gt;
					&lt;pre style=&quot;font-size: 1em; margin: 0 10px;   width: auto; padding: 0;&quot;&gt;&amp;nbsp;&lt;/pre&gt;
			&lt;/td&gt;
		&lt;/tr&gt;
				&lt;tr id=&quot;syntaxplugin_code_and_gutter&quot;&gt;
						&lt;td  style=&quot; line-height: 1.4em !important; padding: 0em; vertical-align: top;&quot;&gt;
					&lt;pre style=&quot;font-size: 1em; margin: 0 10px;   width: auto; padding: 0;&quot;&gt;&lt;span style=&quot;color: black; font-family: &apos;Consolas&apos;, &apos;Bitstream Vera Sans Mono&apos;, &apos;Courier New&apos;, Courier, monospace !important;&quot;&gt;ResourceBuilder.Factory.create(...)&lt;/span&gt;&lt;/pre&gt;
			&lt;/td&gt;
		&lt;/tr&gt;
				&lt;tr id=&quot;syntaxplugin_code_and_gutter&quot;&gt;
						&lt;td  style=&quot; line-height: 1.4em !important; padding: 0em; vertical-align: top;&quot;&gt;
					&lt;pre style=&quot;font-size: 1em; margin: 0 10px;   width: auto; padding: 0;&quot;&gt;&lt;span style=&quot;color: black; font-family: &apos;Consolas&apos;, &apos;Bitstream Vera Sans Mono&apos;, &apos;Courier New&apos;, Courier, monospace !important;&quot;&gt;    .addReadWriteAttribute(LIST_ATTRIBUTE, new OperationStepHandler() {&lt;/span&gt;&lt;/pre&gt;
			&lt;/td&gt;
		&lt;/tr&gt;
				&lt;tr id=&quot;syntaxplugin_code_and_gutter&quot;&gt;
						&lt;td  style=&quot; line-height: 1.4em !important; padding: 0em; vertical-align: top;&quot;&gt;
					&lt;pre style=&quot;font-size: 1em; margin: 0 10px;   width: auto; padding: 0;&quot;&gt;&lt;span style=&quot;color: black; font-family: &apos;Consolas&apos;, &apos;Bitstream Vera Sans Mono&apos;, &apos;Courier New&apos;, Courier, monospace !important;&quot;&gt;                    @Override&lt;/span&gt;&lt;/pre&gt;
			&lt;/td&gt;
		&lt;/tr&gt;
				&lt;tr id=&quot;syntaxplugin_code_and_gutter&quot;&gt;
						&lt;td  style=&quot; line-height: 1.4em !important; padding: 0em; vertical-align: top;&quot;&gt;
					&lt;pre style=&quot;font-size: 1em; margin: 0 10px;   width: auto; padding: 0;&quot;&gt;&lt;span style=&quot;color: black; font-family: &apos;Consolas&apos;, &apos;Bitstream Vera Sans Mono&apos;, &apos;Courier New&apos;, Courier, monospace !important;&quot;&gt;                    public void execute(OperationContext context, ModelNode operation) throws OperationFailedException {&lt;/span&gt;&lt;/pre&gt;
			&lt;/td&gt;
		&lt;/tr&gt;
				&lt;tr id=&quot;syntaxplugin_code_and_gutter&quot;&gt;
						&lt;td  style=&quot; line-height: 1.4em !important; padding: 0em; vertical-align: top;&quot;&gt;
					&lt;pre style=&quot;font-size: 1em; margin: 0 10px;   width: auto; padding: 0;&quot;&gt;&lt;span style=&quot;color: black; font-family: &apos;Consolas&apos;, &apos;Bitstream Vera Sans Mono&apos;, &apos;Courier New&apos;, Courier, monospace !important;&quot;&gt;                        context.getResult().set(runtimeListAttributeValue);&lt;/span&gt;&lt;/pre&gt;
			&lt;/td&gt;
		&lt;/tr&gt;
				&lt;tr id=&quot;syntaxplugin_code_and_gutter&quot;&gt;
						&lt;td  style=&quot; line-height: 1.4em !important; padding: 0em; vertical-align: top;&quot;&gt;
					&lt;pre style=&quot;font-size: 1em; margin: 0 10px;   width: auto; padding: 0;&quot;&gt;&lt;span style=&quot;color: black; font-family: &apos;Consolas&apos;, &apos;Bitstream Vera Sans Mono&apos;, &apos;Courier New&apos;, Courier, monospace !important;&quot;&gt;                    }&lt;/span&gt;&lt;/pre&gt;
			&lt;/td&gt;
		&lt;/tr&gt;
				&lt;tr id=&quot;syntaxplugin_code_and_gutter&quot;&gt;
						&lt;td  style=&quot; line-height: 1.4em !important; padding: 0em; vertical-align: top;&quot;&gt;
					&lt;pre style=&quot;font-size: 1em; margin: 0 10px;   width: auto; padding: 0;&quot;&gt;&lt;span style=&quot;color: black; font-family: &apos;Consolas&apos;, &apos;Bitstream Vera Sans Mono&apos;, &apos;Courier New&apos;, Courier, monospace !important;&quot;&gt;                }, new AbstractWriteAttributeHandler(LIST_ATTRIBUTE) {&lt;/span&gt;&lt;/pre&gt;
			&lt;/td&gt;
		&lt;/tr&gt;
				&lt;tr id=&quot;syntaxplugin_code_and_gutter&quot;&gt;
						&lt;td  style=&quot; line-height: 1.4em !important; padding: 0em; vertical-align: top;&quot;&gt;
					&lt;pre style=&quot;font-size: 1em; margin: 0 10px;   width: auto; padding: 0;&quot;&gt;&lt;span style=&quot;color: black; font-family: &apos;Consolas&apos;, &apos;Bitstream Vera Sans Mono&apos;, &apos;Courier New&apos;, Courier, monospace !important;&quot;&gt;                    @Override&lt;/span&gt;&lt;/pre&gt;
			&lt;/td&gt;
		&lt;/tr&gt;
				&lt;tr id=&quot;syntaxplugin_code_and_gutter&quot;&gt;
						&lt;td  style=&quot; line-height: 1.4em !important; padding: 0em; vertical-align: top;&quot;&gt;
					&lt;pre style=&quot;font-size: 1em; margin: 0 10px;   width: auto; padding: 0;&quot;&gt;&lt;span style=&quot;color: black; font-family: &apos;Consolas&apos;, &apos;Bitstream Vera Sans Mono&apos;, &apos;Courier New&apos;, Courier, monospace !important;&quot;&gt;                    protected boolean applyUpdateToRuntime(OperationContext context, ModelNode operation, String attributeName, ModelNode resolvedValue, ModelNode currentValue, HandbackHolder handbackHolder) throws OperationFailedException {&lt;/span&gt;&lt;/pre&gt;
			&lt;/td&gt;
		&lt;/tr&gt;
				&lt;tr id=&quot;syntaxplugin_code_and_gutter&quot;&gt;
						&lt;td  style=&quot; line-height: 1.4em !important; padding: 0em; vertical-align: top;&quot;&gt;
					&lt;pre style=&quot;font-size: 1em; margin: 0 10px;   width: auto; padding: 0;&quot;&gt;&lt;span style=&quot;color: black; font-family: &apos;Consolas&apos;, &apos;Bitstream Vera Sans Mono&apos;, &apos;Courier New&apos;, Courier, monospace !important;&quot;&gt;                        runtimeListAttributeValue = operation.get(VALUE);&lt;/span&gt;&lt;/pre&gt;
			&lt;/td&gt;
		&lt;/tr&gt;
				&lt;tr id=&quot;syntaxplugin_code_and_gutter&quot;&gt;
						&lt;td  style=&quot; line-height: 1.4em !important; padding: 0em; vertical-align: top;&quot;&gt;
					&lt;pre style=&quot;font-size: 1em; margin: 0 10px;   width: auto; padding: 0;&quot;&gt;&lt;span style=&quot;color: black; font-family: &apos;Consolas&apos;, &apos;Bitstream Vera Sans Mono&apos;, &apos;Courier New&apos;, Courier, monospace !important;&quot;&gt;                        return false;&lt;/span&gt;&lt;/pre&gt;
			&lt;/td&gt;
		&lt;/tr&gt;
				&lt;tr id=&quot;syntaxplugin_code_and_gutter&quot;&gt;
						&lt;td  style=&quot; line-height: 1.4em !important; padding: 0em; vertical-align: top;&quot;&gt;
					&lt;pre style=&quot;font-size: 1em; margin: 0 10px;   width: auto; padding: 0;&quot;&gt;&lt;span style=&quot;color: black; font-family: &apos;Consolas&apos;, &apos;Bitstream Vera Sans Mono&apos;, &apos;Courier New&apos;, Courier, monospace !important;&quot;&gt;                    }&lt;/span&gt;&lt;/pre&gt;
			&lt;/td&gt;
		&lt;/tr&gt;
				&lt;tr id=&quot;syntaxplugin_code_and_gutter&quot;&gt;
						&lt;td  style=&quot; line-height: 1.4em !important; padding: 0em; vertical-align: top;&quot;&gt;
					&lt;pre style=&quot;font-size: 1em; margin: 0 10px;   margin-bottom: 10px;  width: auto; padding: 0;&quot;&gt;&lt;span style=&quot;color: black; font-family: &apos;Consolas&apos;, &apos;Bitstream Vera Sans Mono&apos;, &apos;Courier New&apos;, Courier, monospace !important;&quot;&gt;                });&lt;/span&gt;&lt;/pre&gt;
			&lt;/td&gt;
		&lt;/tr&gt;
			&lt;/tbody&gt;
&lt;/table&gt;
&lt;/div&gt;
&lt;p/&gt;

&lt;p&gt;and execute composite operation containing two list-adds:&lt;/p&gt;

&lt;p/&gt;
&lt;div id=&quot;syntaxplugin&quot; class=&quot;syntaxplugin&quot; style=&quot;border: 1px dashed #bbb; border-radius: 5px !important; overflow: auto; max-height: 30em;&quot;&gt;
&lt;table cellspacing=&quot;0&quot; cellpadding=&quot;0&quot; border=&quot;0&quot; width=&quot;100%&quot; style=&quot;font-size: 1em; line-height: 1.4em !important; font-weight: normal; font-style: normal; color: black;&quot;&gt;
		&lt;tbody &gt;
				&lt;tr id=&quot;syntaxplugin_code_and_gutter&quot;&gt;
						&lt;td  style=&quot; line-height: 1.4em !important; padding: 0em; vertical-align: top;&quot;&gt;
					&lt;pre style=&quot;font-size: 1em; margin: 0 10px;  margin-top: 10px;   width: auto; padding: 0;&quot;&gt;&lt;span style=&quot;color: black; font-family: &apos;Consolas&apos;, &apos;Bitstream Vera Sans Mono&apos;, &apos;Courier New&apos;, Courier, monospace !important;&quot;&gt;{&lt;/span&gt;&lt;/pre&gt;
			&lt;/td&gt;
		&lt;/tr&gt;
				&lt;tr id=&quot;syntaxplugin_code_and_gutter&quot;&gt;
						&lt;td  style=&quot; line-height: 1.4em !important; padding: 0em; vertical-align: top;&quot;&gt;
					&lt;pre style=&quot;font-size: 1em; margin: 0 10px;   width: auto; padding: 0;&quot;&gt;&lt;span style=&quot;color: black; font-family: &apos;Consolas&apos;, &apos;Bitstream Vera Sans Mono&apos;, &apos;Courier New&apos;, Courier, monospace !important;&quot;&gt;    &quot;operation&quot; =&amp;gt; &quot;composite&quot;,&lt;/span&gt;&lt;/pre&gt;
			&lt;/td&gt;
		&lt;/tr&gt;
				&lt;tr id=&quot;syntaxplugin_code_and_gutter&quot;&gt;
						&lt;td  style=&quot; line-height: 1.4em !important; padding: 0em; vertical-align: top;&quot;&gt;
					&lt;pre style=&quot;font-size: 1em; margin: 0 10px;   width: auto; padding: 0;&quot;&gt;&lt;span style=&quot;color: black; font-family: &apos;Consolas&apos;, &apos;Bitstream Vera Sans Mono&apos;, &apos;Courier New&apos;, Courier, monospace !important;&quot;&gt;    &quot;address&quot; =&amp;gt; [],&lt;/span&gt;&lt;/pre&gt;
			&lt;/td&gt;
		&lt;/tr&gt;
				&lt;tr id=&quot;syntaxplugin_code_and_gutter&quot;&gt;
						&lt;td  style=&quot; line-height: 1.4em !important; padding: 0em; vertical-align: top;&quot;&gt;
					&lt;pre style=&quot;font-size: 1em; margin: 0 10px;   width: auto; padding: 0;&quot;&gt;&lt;span style=&quot;color: black; font-family: &apos;Consolas&apos;, &apos;Bitstream Vera Sans Mono&apos;, &apos;Courier New&apos;, Courier, monospace !important;&quot;&gt;    &quot;steps&quot; =&amp;gt; [&lt;/span&gt;&lt;/pre&gt;
			&lt;/td&gt;
		&lt;/tr&gt;
				&lt;tr id=&quot;syntaxplugin_code_and_gutter&quot;&gt;
						&lt;td  style=&quot; line-height: 1.4em !important; padding: 0em; vertical-align: top;&quot;&gt;
					&lt;pre style=&quot;font-size: 1em; margin: 0 10px;   width: auto; padding: 0;&quot;&gt;&lt;span style=&quot;color: black; font-family: &apos;Consolas&apos;, &apos;Bitstream Vera Sans Mono&apos;, &apos;Courier New&apos;, Courier, monospace !important;&quot;&gt;        {&lt;/span&gt;&lt;/pre&gt;
			&lt;/td&gt;
		&lt;/tr&gt;
				&lt;tr id=&quot;syntaxplugin_code_and_gutter&quot;&gt;
						&lt;td  style=&quot; line-height: 1.4em !important; padding: 0em; vertical-align: top;&quot;&gt;
					&lt;pre style=&quot;font-size: 1em; margin: 0 10px;   width: auto; padding: 0;&quot;&gt;&lt;span style=&quot;color: black; font-family: &apos;Consolas&apos;, &apos;Bitstream Vera Sans Mono&apos;, &apos;Courier New&apos;, Courier, monospace !important;&quot;&gt;            &quot;operation&quot; =&amp;gt; &quot;list-add&quot;,&lt;/span&gt;&lt;/pre&gt;
			&lt;/td&gt;
		&lt;/tr&gt;
				&lt;tr id=&quot;syntaxplugin_code_and_gutter&quot;&gt;
						&lt;td  style=&quot; line-height: 1.4em !important; padding: 0em; vertical-align: top;&quot;&gt;
					&lt;pre style=&quot;font-size: 1em; margin: 0 10px;   width: auto; padding: 0;&quot;&gt;&lt;span style=&quot;color: black; font-family: &apos;Consolas&apos;, &apos;Bitstream Vera Sans Mono&apos;, &apos;Courier New&apos;, Courier, monospace !important;&quot;&gt;            &quot;address&quot; =&amp;gt; [(&quot;subsystem&quot; =&amp;gt; &quot;test&quot;)],&lt;/span&gt;&lt;/pre&gt;
			&lt;/td&gt;
		&lt;/tr&gt;
				&lt;tr id=&quot;syntaxplugin_code_and_gutter&quot;&gt;
						&lt;td  style=&quot; line-height: 1.4em !important; padding: 0em; vertical-align: top;&quot;&gt;
					&lt;pre style=&quot;font-size: 1em; margin: 0 10px;   width: auto; padding: 0;&quot;&gt;&lt;span style=&quot;color: black; font-family: &apos;Consolas&apos;, &apos;Bitstream Vera Sans Mono&apos;, &apos;Courier New&apos;, Courier, monospace !important;&quot;&gt;            &quot;name&quot; =&amp;gt; &quot;my-list-attribute&quot;,&lt;/span&gt;&lt;/pre&gt;
			&lt;/td&gt;
		&lt;/tr&gt;
				&lt;tr id=&quot;syntaxplugin_code_and_gutter&quot;&gt;
						&lt;td  style=&quot; line-height: 1.4em !important; padding: 0em; vertical-align: top;&quot;&gt;
					&lt;pre style=&quot;font-size: 1em; margin: 0 10px;   width: auto; padding: 0;&quot;&gt;&lt;span style=&quot;color: black; font-family: &apos;Consolas&apos;, &apos;Bitstream Vera Sans Mono&apos;, &apos;Courier New&apos;, Courier, monospace !important;&quot;&gt;            &quot;value&quot; =&amp;gt; &quot;value1&quot;&lt;/span&gt;&lt;/pre&gt;
			&lt;/td&gt;
		&lt;/tr&gt;
				&lt;tr id=&quot;syntaxplugin_code_and_gutter&quot;&gt;
						&lt;td  style=&quot; line-height: 1.4em !important; padding: 0em; vertical-align: top;&quot;&gt;
					&lt;pre style=&quot;font-size: 1em; margin: 0 10px;   width: auto; padding: 0;&quot;&gt;&lt;span style=&quot;color: black; font-family: &apos;Consolas&apos;, &apos;Bitstream Vera Sans Mono&apos;, &apos;Courier New&apos;, Courier, monospace !important;&quot;&gt;        },&lt;/span&gt;&lt;/pre&gt;
			&lt;/td&gt;
		&lt;/tr&gt;
				&lt;tr id=&quot;syntaxplugin_code_and_gutter&quot;&gt;
						&lt;td  style=&quot; line-height: 1.4em !important; padding: 0em; vertical-align: top;&quot;&gt;
					&lt;pre style=&quot;font-size: 1em; margin: 0 10px;   width: auto; padding: 0;&quot;&gt;&lt;span style=&quot;color: black; font-family: &apos;Consolas&apos;, &apos;Bitstream Vera Sans Mono&apos;, &apos;Courier New&apos;, Courier, monospace !important;&quot;&gt;        {&lt;/span&gt;&lt;/pre&gt;
			&lt;/td&gt;
		&lt;/tr&gt;
				&lt;tr id=&quot;syntaxplugin_code_and_gutter&quot;&gt;
						&lt;td  style=&quot; line-height: 1.4em !important; padding: 0em; vertical-align: top;&quot;&gt;
					&lt;pre style=&quot;font-size: 1em; margin: 0 10px;   width: auto; padding: 0;&quot;&gt;&lt;span style=&quot;color: black; font-family: &apos;Consolas&apos;, &apos;Bitstream Vera Sans Mono&apos;, &apos;Courier New&apos;, Courier, monospace !important;&quot;&gt;            &quot;operation&quot; =&amp;gt; &quot;list-add&quot;,&lt;/span&gt;&lt;/pre&gt;
			&lt;/td&gt;
		&lt;/tr&gt;
				&lt;tr id=&quot;syntaxplugin_code_and_gutter&quot;&gt;
						&lt;td  style=&quot; line-height: 1.4em !important; padding: 0em; vertical-align: top;&quot;&gt;
					&lt;pre style=&quot;font-size: 1em; margin: 0 10px;   width: auto; padding: 0;&quot;&gt;&lt;span style=&quot;color: black; font-family: &apos;Consolas&apos;, &apos;Bitstream Vera Sans Mono&apos;, &apos;Courier New&apos;, Courier, monospace !important;&quot;&gt;            &quot;address&quot; =&amp;gt; [(&quot;subsystem&quot; =&amp;gt; &quot;test&quot;)],&lt;/span&gt;&lt;/pre&gt;
			&lt;/td&gt;
		&lt;/tr&gt;
				&lt;tr id=&quot;syntaxplugin_code_and_gutter&quot;&gt;
						&lt;td  style=&quot; line-height: 1.4em !important; padding: 0em; vertical-align: top;&quot;&gt;
					&lt;pre style=&quot;font-size: 1em; margin: 0 10px;   width: auto; padding: 0;&quot;&gt;&lt;span style=&quot;color: black; font-family: &apos;Consolas&apos;, &apos;Bitstream Vera Sans Mono&apos;, &apos;Courier New&apos;, Courier, monospace !important;&quot;&gt;            &quot;name&quot; =&amp;gt; &quot;my-list-attribute&quot;,&lt;/span&gt;&lt;/pre&gt;
			&lt;/td&gt;
		&lt;/tr&gt;
				&lt;tr id=&quot;syntaxplugin_code_and_gutter&quot;&gt;
						&lt;td  style=&quot; line-height: 1.4em !important; padding: 0em; vertical-align: top;&quot;&gt;
					&lt;pre style=&quot;font-size: 1em; margin: 0 10px;   width: auto; padding: 0;&quot;&gt;&lt;span style=&quot;color: black; font-family: &apos;Consolas&apos;, &apos;Bitstream Vera Sans Mono&apos;, &apos;Courier New&apos;, Courier, monospace !important;&quot;&gt;            &quot;value&quot; =&amp;gt; &quot;value2&quot;&lt;/span&gt;&lt;/pre&gt;
			&lt;/td&gt;
		&lt;/tr&gt;
				&lt;tr id=&quot;syntaxplugin_code_and_gutter&quot;&gt;
						&lt;td  style=&quot; line-height: 1.4em !important; padding: 0em; vertical-align: top;&quot;&gt;
					&lt;pre style=&quot;font-size: 1em; margin: 0 10px;   width: auto; padding: 0;&quot;&gt;&lt;span style=&quot;color: black; font-family: &apos;Consolas&apos;, &apos;Bitstream Vera Sans Mono&apos;, &apos;Courier New&apos;, Courier, monospace !important;&quot;&gt;        }&lt;/span&gt;&lt;/pre&gt;
			&lt;/td&gt;
		&lt;/tr&gt;
				&lt;tr id=&quot;syntaxplugin_code_and_gutter&quot;&gt;
						&lt;td  style=&quot; line-height: 1.4em !important; padding: 0em; vertical-align: top;&quot;&gt;
					&lt;pre style=&quot;font-size: 1em; margin: 0 10px;   width: auto; padding: 0;&quot;&gt;&lt;span style=&quot;color: black; font-family: &apos;Consolas&apos;, &apos;Bitstream Vera Sans Mono&apos;, &apos;Courier New&apos;, Courier, monospace !important;&quot;&gt;    ]&lt;/span&gt;&lt;/pre&gt;
			&lt;/td&gt;
		&lt;/tr&gt;
				&lt;tr id=&quot;syntaxplugin_code_and_gutter&quot;&gt;
						&lt;td  style=&quot; line-height: 1.4em !important; padding: 0em; vertical-align: top;&quot;&gt;
					&lt;pre style=&quot;font-size: 1em; margin: 0 10px;   margin-bottom: 10px;  width: auto; padding: 0;&quot;&gt;&lt;span style=&quot;color: black; font-family: &apos;Consolas&apos;, &apos;Bitstream Vera Sans Mono&apos;, &apos;Courier New&apos;, Courier, monospace !important;&quot;&gt;}&lt;/span&gt;&lt;/pre&gt;
			&lt;/td&gt;
		&lt;/tr&gt;
			&lt;/tbody&gt;
&lt;/table&gt;
&lt;/div&gt;
&lt;p/&gt;

&lt;p&gt;Problem is that the second list-add reads before the first one writes. The step sequence would go:&lt;/p&gt;

&lt;p&gt;1) begin operation&lt;/p&gt;

&lt;p&gt;M0 PrepareStepHandler&lt;/p&gt;

&lt;p&gt;2) M0 executes&lt;/p&gt;

&lt;p&gt;M1 CompositeOperationHandler&lt;/p&gt;

&lt;p&gt;3) M1 executes&lt;/p&gt;

&lt;p&gt;M2 ListAddHandler &quot;value1&quot;&lt;br/&gt;
M3 ListAddHandler &quot;value2&quot;&lt;/p&gt;

&lt;p&gt;4) M2 executes&lt;/p&gt;

&lt;p&gt;M4 ReadAttributeHandler&lt;br/&gt;
M5 handler that modifies the value and adds write handler&lt;br/&gt;
M3 ListAddHandler &quot;value2&quot;&lt;/p&gt;

&lt;p&gt;5) M4 executes - which executes ReadOST, which in this case effectively reads from runtime&lt;/p&gt;

&lt;p&gt;M5 handler that modifies the value and adds write handler&lt;br/&gt;
M3 ListAddHandler &quot;value2&quot;&lt;/p&gt;

&lt;p&gt;6) M5 executes&lt;/p&gt;

&lt;p&gt;M6 WriteAttributeHandler - executes AbstractWriteAttributeHandler instance defined as WriteOST&lt;br/&gt;
M3 ListAddHandler &quot;value2&quot;&lt;/p&gt;

&lt;p&gt;7) M6 executes - resource model is updated&lt;/p&gt;

&lt;p&gt;M3 ListAddHandler &quot;value2&quot;&lt;br/&gt;
R1 handler that updates runtime with [&quot;value1&quot;]&lt;/p&gt;

&lt;p&gt;8) M3 ListAddHandler for &quot;value2&quot; executes, and is about to read from runtime again, but runtime still wasn&apos;t updated, so it reads [] instead of [&quot;value1&quot;].&lt;/p&gt;

&lt;p&gt;Then, after second ListAddHandler processes, we are left with:&lt;/p&gt;

&lt;p&gt;R1 handler that updates runtime with [&quot;value1&quot;]&lt;br/&gt;
R2 handler that updates runtime with [&quot;value2&quot;] (instead of [&quot;value1&quot;, &quot;value2&quot;])&lt;/p&gt;


&lt;p&gt;I mean to me the test case seams like reader OST is reading from RUNTIME in stage MODEL, and writer OSH is writing to RUNTIME in stage RUNTIME, so they can never meet. I think the reader OST should either not be there, or should not read from a variable that is only updated in RUNTIME stage.&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="12310120">
                    <name>Cloners</name>
                                                                <inwardlinks description="cloned to">
                                        <issuelink>
            <issuekey id="12615671">JBEAP-4245</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310220" key="org.jboss.labs.jira.plugin.jboss-custom-field-types-plugin:multiurl">
                        <customfieldname>Git Pull Request</customfieldname>
                        <customfieldvalues>
                            https://github.com/wildfly/wildfly-core/pull/1613
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12310641" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Number of attachments</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310640" key="com.atlassian.jira.toolkit:comments">
                        <customfieldname>Number of comments</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>10.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12311940" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1|i03dp3:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310840" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                            <customfield id="customfield_12310183" key="com.atlassian.jira.plugin.system.customfieldtypes:textarea">
                        <customfieldname>Steps to Reproduce</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>&lt;ol&gt;
	&lt;li&gt;query login-modules: &lt;tt&gt;/subsystem=security/security-domain=other/authentication=classic:read-resource&lt;/tt&gt; - there should be two modules: Remoting and RealmDirect&lt;/li&gt;
	&lt;li&gt;execute in cli
&lt;p/&gt;
&lt;div id=&quot;syntaxplugin&quot; class=&quot;syntaxplugin&quot; style=&quot;border: 1px dashed #bbb; border-radius: 5px !important; overflow: auto; max-height: 30em;&quot;&gt;
&lt;table cellspacing=&quot;0&quot; cellpadding=&quot;0&quot; border=&quot;0&quot; width=&quot;100%&quot; style=&quot;font-size: 1em; line-height: 1.4em !important; font-weight: normal; font-style: normal; color: black;&quot;&gt;
		&lt;tbody &gt;
				&lt;tr id=&quot;syntaxplugin_code_and_gutter&quot;&gt;
						&lt;td  style=&quot; line-height: 1.4em !important; padding: 0em; vertical-align: top;&quot;&gt;
					&lt;pre style=&quot;font-size: 1em; margin: 0 10px;  margin-top: 10px;   width: auto; padding: 0;&quot;&gt;&lt;span style=&quot;color: black; font-family: &apos;Consolas&apos;, &apos;Bitstream Vera Sans Mono&apos;, &apos;Courier New&apos;, Courier, monospace !important;&quot;&gt;/subsystem=security/security-domain=other/authentication=classic:list-add(name=&quot;login-modules&quot;, value={ \&lt;/span&gt;&lt;/pre&gt;
			&lt;/td&gt;
		&lt;/tr&gt;
				&lt;tr id=&quot;syntaxplugin_code_and_gutter&quot;&gt;
						&lt;td  style=&quot; line-height: 1.4em !important; padding: 0em; vertical-align: top;&quot;&gt;
					&lt;pre style=&quot;font-size: 1em; margin: 0 10px;   width: auto; padding: 0;&quot;&gt;&lt;span style=&quot;color: black; font-family: &apos;Consolas&apos;, &apos;Bitstream Vera Sans Mono&apos;, &apos;Courier New&apos;, Courier, monospace !important;&quot;&gt; code=&amp;gt;&quot;RoleMapping&quot;, \&lt;/span&gt;&lt;/pre&gt;
			&lt;/td&gt;
		&lt;/tr&gt;
				&lt;tr id=&quot;syntaxplugin_code_and_gutter&quot;&gt;
						&lt;td  style=&quot; line-height: 1.4em !important; padding: 0em; vertical-align: top;&quot;&gt;
					&lt;pre style=&quot;font-size: 1em; margin: 0 10px;   width: auto; padding: 0;&quot;&gt;&lt;span style=&quot;color: black; font-family: &apos;Consolas&apos;, &apos;Bitstream Vera Sans Mono&apos;, &apos;Courier New&apos;, Courier, monospace !important;&quot;&gt; flag=&amp;gt;&quot;optional&quot;\&lt;/span&gt;&lt;/pre&gt;
			&lt;/td&gt;
		&lt;/tr&gt;
				&lt;tr id=&quot;syntaxplugin_code_and_gutter&quot;&gt;
						&lt;td  style=&quot; line-height: 1.4em !important; padding: 0em; vertical-align: top;&quot;&gt;
					&lt;pre style=&quot;font-size: 1em; margin: 0 10px;   margin-bottom: 10px;  width: auto; padding: 0;&quot;&gt;&lt;span style=&quot;color: black; font-family: &apos;Consolas&apos;, &apos;Bitstream Vera Sans Mono&apos;, &apos;Courier New&apos;, Courier, monospace !important;&quot;&gt;})&lt;/span&gt;&lt;/pre&gt;
			&lt;/td&gt;
		&lt;/tr&gt;
			&lt;/tbody&gt;
&lt;/table&gt;
&lt;/div&gt;
&lt;p/&gt;&lt;/li&gt;
	&lt;li&gt;query login-modules: &lt;tt&gt;/subsystem=security/security-domain=other/authentication=classic:read-resource&lt;/tt&gt;&lt;/li&gt;
&lt;/ol&gt;


&lt;p&gt;Expected:&lt;br/&gt;
There should be three login-modules: Remoting, RealmDirect and RoleMapping&lt;/p&gt;

&lt;p&gt;Actual:&lt;br/&gt;
There is only one login-module: RoleMapping&lt;/p&gt;</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310243" key="com.atlassian.jira.plugin.system.customfieldtypes:float">
                        <customfieldname>Story Points</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>55.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                </customfields>
    </item>
</channel>
</rss>