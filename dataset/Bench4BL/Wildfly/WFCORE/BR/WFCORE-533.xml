<!-- 
RSS generated by JIRA (7.2.3#72005-sha1:73be91d2b96fc29303a7eb6820acf420e5d0ed65) at Tue Dec 06 17:53:33 EST 2016

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.jboss.org/si/jira.issueviews:issue-xml/WFCORE-533/WFCORE-533.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>JBoss Issue Tracker</title>
    <link>https://issues.jboss.org</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-us</language>    <build-info>
        <version>7.2.3</version>
        <build-number>72005</build-number>
        <build-date>06-10-2016</build-date>
    </build-info>

<item>
            <title>[WFCORE-533] Handling of ModelControllerClient means there is no safe way to reload a process from the wildfly maven plugin</title>
                <link>https://issues.jboss.org/browse/WFCORE-533</link>
                <project id="12315422" key="WFCORE">WildFly Core</project>
                    <description>&lt;p&gt;reload command is non-blocking which causes problems in CLI scripts. Let&apos;s take this as an example:&lt;/p&gt;

&lt;p/&gt;
&lt;div id=&quot;syntaxplugin&quot; class=&quot;syntaxplugin&quot; style=&quot;border: 1px dashed #bbb; border-radius: 5px !important; overflow: auto; max-height: 30em;&quot;&gt;
&lt;table cellspacing=&quot;0&quot; cellpadding=&quot;0&quot; border=&quot;0&quot; width=&quot;100%&quot; style=&quot;font-size: 1em; line-height: 1.4em !important; font-weight: normal; font-style: normal; color: black;&quot;&gt;
		&lt;tbody &gt;
				&lt;tr id=&quot;syntaxplugin_code_and_gutter&quot;&gt;
						&lt;td  style=&quot; line-height: 1.4em !important; padding: 0em; vertical-align: top;&quot;&gt;
					&lt;pre style=&quot;font-size: 1em; margin: 0 10px;  margin-top: 10px;   width: auto; padding: 0;&quot;&gt;&lt;span style=&quot;color: black; font-family: &apos;Consolas&apos;, &apos;Bitstream Vera Sans Mono&apos;, &apos;Courier New&apos;, Courier, monospace !important;&quot;&gt;if (outcome == failed) of /subsystem=resource-adapters/resource-adapter=activemq-ra:read-resource&lt;/span&gt;&lt;/pre&gt;
			&lt;/td&gt;
		&lt;/tr&gt;
				&lt;tr id=&quot;syntaxplugin_code_and_gutter&quot;&gt;
						&lt;td  style=&quot; line-height: 1.4em !important; padding: 0em; vertical-align: top;&quot;&gt;
					&lt;pre style=&quot;font-size: 1em; margin: 0 10px;   width: auto; padding: 0;&quot;&gt;&lt;span style=&quot;color: black; font-family: &apos;Consolas&apos;, &apos;Bitstream Vera Sans Mono&apos;, &apos;Courier New&apos;, Courier, monospace !important;&quot;&gt;        /subsystem=resource-adapters/resource-adapter=activemq-ra:add(archive=activemq-ra.rar)&lt;/span&gt;&lt;/pre&gt;
			&lt;/td&gt;
		&lt;/tr&gt;
				&lt;tr id=&quot;syntaxplugin_code_and_gutter&quot;&gt;
						&lt;td  style=&quot; line-height: 1.4em !important; padding: 0em; vertical-align: top;&quot;&gt;
					&lt;pre style=&quot;font-size: 1em; margin: 0 10px;   width: auto; padding: 0;&quot;&gt;&lt;span style=&quot;color: black; font-family: &apos;Consolas&apos;, &apos;Bitstream Vera Sans Mono&apos;, &apos;Courier New&apos;, Courier, monospace !important;&quot;&gt;        :reload&lt;/span&gt;&lt;/pre&gt;
			&lt;/td&gt;
		&lt;/tr&gt;
				&lt;tr id=&quot;syntaxplugin_code_and_gutter&quot;&gt;
						&lt;td  style=&quot; line-height: 1.4em !important; padding: 0em; vertical-align: top;&quot;&gt;
					&lt;pre style=&quot;font-size: 1em; margin: 0 10px;   margin-bottom: 10px;  width: auto; padding: 0;&quot;&gt;&lt;span style=&quot;color: black; font-family: &apos;Consolas&apos;, &apos;Bitstream Vera Sans Mono&apos;, &apos;Courier New&apos;, Courier, monospace !important;&quot;&gt;end-if&lt;/span&gt;&lt;/pre&gt;
			&lt;/td&gt;
		&lt;/tr&gt;
			&lt;/tbody&gt;
&lt;/table&gt;
&lt;/div&gt;
&lt;p/&gt;

&lt;p&gt;I use jboss-as-maven-plugin for its execution and sometimes I get: &lt;tt&gt;Command execution failed for command &apos;end-if&apos;. if request failed: java.util.concurrent.ExecutionException: Operation failed: Channel closed&lt;/tt&gt;&lt;/p&gt;

&lt;p&gt;This functionality has already been asked in &lt;a href=&quot;https://issues.jboss.org/browse/WFLY-208&quot; title=&quot;add blocking option to start/stop/restart/reload commands for server groups&quot; class=&quot;issue-link&quot; data-issue-key=&quot;WFLY-208&quot;&gt;&lt;del&gt;WFLY-208&lt;/del&gt;&lt;/a&gt;, but for some reason it was implemented only for domain-related commands but not standalone-related (reload and shutdown).&lt;/p&gt;</description>
                <environment></environment>
        <key id="12562434">WFCORE-533</key>
            <summary>Handling of ModelControllerClient means there is no safe way to reload a process from the wildfly maven plugin</summary>
                <type id="13" iconUrl="https://issues.jboss.org/secure/viewavatar?size=xsmall&amp;avatarId=13269&amp;avatarType=issuetype">Enhancement</type>
                                            <priority id="3" iconUrl="https://issues.jboss.org/images/icons/priorities/major.svg">Major</priority>
                        <status id="1" iconUrl="https://issues.jboss.org/images/icons/statuses/open.png" description="The issue is open and ready for the assignee to start work on it.">Open</status>
                    <statusCategory id="2" key="new" colorName="blue-gray"/>
                                    <resolution id="-1">Unresolved</resolution>
                                        <assignee username="aloubyansky">Alexey Loubyansky</assignee>
                                    <reporter username="trohovsky">Tomas Rohovsky</reporter>
                        <labels>
                    </labels>
                <created>Wed, 4 Feb 2015 11:06:12 -0500</created>
                <updated>Thu, 17 Sep 2015 11:59:29 -0400</updated>
                                                                            <component>CLI</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>9</watches>
                                                                <comments>
                            <comment id="13037658" author="brian.stansberry" created="Wed, 4 Feb 2015 15:02:33 -0500"  >&lt;p&gt;Does this work?&lt;/p&gt;

&lt;p/&gt;
&lt;div id=&quot;syntaxplugin&quot; class=&quot;syntaxplugin&quot; style=&quot;border: 1px dashed #bbb; border-radius: 5px !important; overflow: auto; max-height: 30em;&quot;&gt;
&lt;table cellspacing=&quot;0&quot; cellpadding=&quot;0&quot; border=&quot;0&quot; width=&quot;100%&quot; style=&quot;font-size: 1em; line-height: 1.4em !important; font-weight: normal; font-style: normal; color: black;&quot;&gt;
		&lt;tbody &gt;
				&lt;tr id=&quot;syntaxplugin_code_and_gutter&quot;&gt;
						&lt;td  style=&quot; line-height: 1.4em !important; padding: 0em; vertical-align: top;&quot;&gt;
					&lt;pre style=&quot;font-size: 1em; margin: 0 10px;  margin-top: 10px;   width: auto; padding: 0;&quot;&gt;&lt;span style=&quot;color: black; font-family: &apos;Consolas&apos;, &apos;Bitstream Vera Sans Mono&apos;, &apos;Courier New&apos;, Courier, monospace !important;&quot;&gt;if (outcome == failed) of /subsystem=resource-adapters/resource-adapter=activemq-ra:read-resource&lt;/span&gt;&lt;/pre&gt;
			&lt;/td&gt;
		&lt;/tr&gt;
				&lt;tr id=&quot;syntaxplugin_code_and_gutter&quot;&gt;
						&lt;td  style=&quot; line-height: 1.4em !important; padding: 0em; vertical-align: top;&quot;&gt;
					&lt;pre style=&quot;font-size: 1em; margin: 0 10px;   width: auto; padding: 0;&quot;&gt;&lt;span style=&quot;color: black; font-family: &apos;Consolas&apos;, &apos;Bitstream Vera Sans Mono&apos;, &apos;Courier New&apos;, Courier, monospace !important;&quot;&gt;        /subsystem=resource-adapters/resource-adapter=activemq-ra:add(archive=activemq-ra.rar)&lt;/span&gt;&lt;/pre&gt;
			&lt;/td&gt;
		&lt;/tr&gt;
				&lt;tr id=&quot;syntaxplugin_code_and_gutter&quot;&gt;
						&lt;td  style=&quot; line-height: 1.4em !important; padding: 0em; vertical-align: top;&quot;&gt;
					&lt;pre style=&quot;font-size: 1em; margin: 0 10px;   width: auto; padding: 0;&quot;&gt;&lt;span style=&quot;color: black; font-family: &apos;Consolas&apos;, &apos;Bitstream Vera Sans Mono&apos;, &apos;Courier New&apos;, Courier, monospace !important;&quot;&gt;        reload&lt;/span&gt;&lt;/pre&gt;
			&lt;/td&gt;
		&lt;/tr&gt;
				&lt;tr id=&quot;syntaxplugin_code_and_gutter&quot;&gt;
						&lt;td  style=&quot; line-height: 1.4em !important; padding: 0em; vertical-align: top;&quot;&gt;
					&lt;pre style=&quot;font-size: 1em; margin: 0 10px;   margin-bottom: 10px;  width: auto; padding: 0;&quot;&gt;&lt;span style=&quot;color: black; font-family: &apos;Consolas&apos;, &apos;Bitstream Vera Sans Mono&apos;, &apos;Courier New&apos;, Courier, monospace !important;&quot;&gt;end-if&lt;/span&gt;&lt;/pre&gt;
			&lt;/td&gt;
		&lt;/tr&gt;
			&lt;/tbody&gt;
&lt;/table&gt;
&lt;/div&gt;
&lt;p/&gt;

&lt;p&gt;No &quot;:&quot; before &quot;reload&quot;.&lt;/p&gt;

&lt;p&gt;The behavior you are looking for is not possible with a low level operation, i.e. &quot;:reload&quot;. It is possible with the high level CLI command &quot;reload&quot;.&lt;/p&gt;

&lt;p&gt;A low-level operation that triggers a reload can support a blocking parameter if it is targeted at a Host Controller. The blocking behavior is implemented in the HC process, which isn&apos;t being reloaded. The blocking behavior can&apos;t be implemented in the server process because the reload requires stopping all the services, including those that would block. The high level CLI &quot;reload&quot; command does the blocking on the client side.&lt;/p&gt;</comment>
                            <comment id="13037760" author="trohovsky" created="Thu, 5 Feb 2015 03:54:31 -0500"  >&lt;p&gt;Brian thanks for the prompt answer. I tied to use reload without colon and I got  &lt;tt&gt;Command execution failed for command &apos;reload&apos;. Unsupported ModelControllerClient implementation org.jboss.as.plugin.cli.Commands$NonClosingModelControllerClient&lt;/tt&gt;. It looks to be this issue &lt;a href=&quot;https://issues.jboss.org/browse/JBASMP-59&quot; title=&quot;Shutdown CLI handler fails due to different ModelControllerClient being used&quot; class=&quot;issue-link&quot; data-issue-key=&quot;JBASMP-59&quot;&gt;&lt;del&gt;JBASMP-59&lt;/del&gt;&lt;/a&gt;. I tried to execute it with jboss-cli.sh as well. The result was &lt;tt&gt;if request failed: JBAS013493: System boot is in process; execution of remote management operations is not currently available&lt;/tt&gt;. Any of these two ways didn&apos;t changed standalone-full.xml.&lt;/p&gt;</comment>
                            <comment id="13038033" author="brian.stansberry" created="Thu, 5 Feb 2015 11:44:09 -0500"  >&lt;p&gt;OK, thanks for the info. I&apos;m going to move this to WFCORE and convert it to a CLI issue.&lt;/p&gt;</comment>
                            <comment id="13038036" author="brian.stansberry" created="Thu, 5 Feb 2015 11:47:56 -0500"  >&lt;p&gt;Alexey,&lt;/p&gt;

&lt;p&gt;This is shown as an enhancement, but it may be a bug. The issue I see here is that the &quot;reload&quot; command does not work. I don&apos;t expect the low level :reload op to work. &lt;/p&gt;</comment>
                            <comment id="13038079" author="aloubyansky" created="Thu, 5 Feb 2015 14:00:17 -0500"  >&lt;p&gt;reload handler impl relies upon CLIModelControllClient that implements the blocking logic, which explains the exception. We could come up with an interface for the blocking API and let people interested implement it or just build this functionality into the default ModelControllerClient impl.&lt;/p&gt;

&lt;p&gt;But even if it was able to use any ModelControllerClient impl, it wouldn&apos;t be enough to solve your original problem. The body of the if is a CLI batch. reload command in the batch mode will translate to a simple :reload. And we are back.&lt;/p&gt;

&lt;p&gt;So, for this to work, we need to:&lt;br/&gt;
1) stop treating the bodies of if-else (and try-catch-finally for consistency) as batches. Which will be easy to do with the latest revision of the control flow in CLI. This may break the existing scripts though.&lt;br/&gt;
2) do something about the ModelControllerClient impl.&lt;/p&gt;</comment>
                            <comment id="13096966" author="brian.stansberry" created="Mon, 10 Aug 2015 11:43:02 -0400"  >&lt;p&gt;Ah, I misunderstood the comments of Feb 5. The problem Tomas reported in his comment that day is due to use of the jboss-as maven plugin to execute the commands. I didn&apos;t notice that and (stupidly, now that I think more about it) thought it was an issue with the CLI&apos;s handling of if/end-if blocks.&lt;/p&gt;

&lt;p&gt;Looking at the current code, both in the jboss-as plugin and the wildfly plugin I&apos;m pretty sure that problem will still exist. &lt;a href=&quot;https://issues.jboss.org/secure/ViewProfile.jspa?name=jamezp&quot; class=&quot;user-hover&quot; rel=&quot;jamezp&quot;&gt;James Perkins&lt;/a&gt; should I open a WFMP JIRA for this? Alexey&apos;s right; better is to have built in support in ModelControllerClient itself, but if you know of a simple WFMP solution then that may be more expedient.&lt;/p&gt;</comment>
                            <comment id="13096986" author="jamezp" created="Mon, 10 Aug 2015 12:17:51 -0400"  >&lt;p&gt;I&apos;m working on allowing CLI commands/scripts to be sent to a new process with CLI running in jboss-modules. This should hopefully help with this issue.&lt;/p&gt;

&lt;p&gt;The way it currently works is the &lt;tt&gt;org.jboss.as.cli.CommandContext&lt;/tt&gt; is created and the &lt;tt&gt;org.jboss.as.cli.CommandContext.handle(line)&lt;/tt&gt; method is invoked for each line read from the maven configuration or a script file. These lines are all sent from the same &lt;tt&gt;ModelControllerClient&lt;/tt&gt; which is bound to the &lt;tt&gt;CommandContext&lt;/tt&gt;.&lt;/p&gt;</comment>
                            <comment id="13109900" author="aloubyansky" created="Thu, 17 Sep 2015 07:31:46 -0400"  >&lt;p&gt;This is practically a duplicate of &lt;a href=&quot;https://issues.jboss.org/browse/WFCORE-876&quot; title=&quot;Reload or Shutdown inside IF statement is performed before the if/else block batch is executed&quot; class=&quot;issue-link&quot; data-issue-key=&quot;WFCORE-876&quot;&gt;&lt;del&gt;WFCORE-876&lt;/del&gt;&lt;/a&gt;. Once &lt;a href=&quot;https://issues.jboss.org/browse/WFCORE-876&quot; title=&quot;Reload or Shutdown inside IF statement is performed before the if/else block batch is executed&quot; class=&quot;issue-link&quot; data-issue-key=&quot;WFCORE-876&quot;&gt;&lt;del&gt;WFCORE-876&lt;/del&gt;&lt;/a&gt; is fixed, this issues can be closed with the suggestion to use reload instead of :reload.&lt;/p&gt;</comment>
                            <comment id="13110113" author="brian.stansberry" created="Thu, 17 Sep 2015 11:58:18 -0400"  >&lt;p&gt;It&apos;s not a duplicate.&lt;/p&gt;

&lt;p&gt;The problem here is the reporter is using the WildFly maven plugin, and the &quot;reload&quot; command will not work there because the plugin is providing a ModelControllerClient rather than letting the CLI create its own custom impl. I believe the if/end-if aspect of the original report is really a tangent. The basic issue is there is no safe way to do a reload from within the maven plugin.&lt;/p&gt;

&lt;p&gt;I&apos;ll update the issue title to reflect this.&lt;/p&gt;

&lt;p&gt;I could just move this to WFMP, but the WFCORE code has an issue. The code for embedding the CLI in another app allows the embedding app to provide the MCC, but the CLI can&apos;t fully function unless it controls the type of the MCC. So we either need to disable that ability for the embedding app to provide the MCC, or we need the basic MCC contract to provide all the hooks the CLI uses, and thus get rid of the CLI&apos;s custom impl.&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="12310000">
                    <name>Duplicate</name>
                                            <outwardlinks description="duplicates">
                                        <issuelink>
            <issuekey id="12580049">WFCORE-855</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                            <issuelinktype id="12310001">
                    <name>Related</name>
                                                                <inwardlinks description="is related to">
                                        <issuelink>
            <issuekey id="12580927">WFCORE-876</issuekey>
        </issuelink>
            <issuelink>
            <issuekey id="12524826">JBASMP-59</issuekey>
        </issuelink>
            <issuelink>
            <issuekey id="12580560">WFMP-11</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310641" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Number of attachments</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310640" key="com.atlassian.jira.toolkit:comments">
                        <customfieldname>Number of comments</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12311940" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1|hzuwlr:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310840" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                </customfields>
    </item>
</channel>
</rss>