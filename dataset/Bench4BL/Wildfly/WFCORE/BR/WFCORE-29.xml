<!-- 
RSS generated by JIRA (7.2.3#72005-sha1:73be91d2b96fc29303a7eb6820acf420e5d0ed65) at Tue Dec 06 16:47:04 EST 2016

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary add field=key&field=summary to the URL of your request.
For example:
https://issues.jboss.org/si/jira.issueviews:issue-xml/WFCORE-29/WFCORE-29.xml?field=key&amp;field=summary
-->
<rss version="0.92" >
<channel>
    <title>JBoss Issue Tracker</title>
    <link>https://issues.jboss.org</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-us</language>    <build-info>
        <version>7.2.3</version>
        <build-number>72005</build-number>
        <build-date>06-10-2016</build-date>
    </build-info>

<item>
            <title>[WFCORE-29] IllegalStateException when patching MBeans are queried during shutdown</title>
                <link>https://issues.jboss.org/browse/WFCORE-29</link>
                <project id="12315422" key="WFCORE">WildFly Core</project>
                    <description>&lt;p&gt;If the MBeans for the patching subsystem are queried during server shutdown, it can result in an IllegalStateException.  InstallationManagerService has already had stop() called on it, so the value is null.&lt;/p&gt;

&lt;p&gt;This can be reproduced by the attached EJB, which does a MBeanServer.queryMBeans(null, null); from the @PreDestroy method. It&apos;s in a loop to ensure it runs after the installation manager gets de-initialised.&lt;/p&gt;

&lt;p&gt;java.lang.IllegalStateException&lt;br/&gt;
	at org.jboss.as.patching.installation.InstallationManagerService.getValue(InstallationManagerService.java:87) &lt;span class=&quot;error&quot;&gt;&amp;#91;wildfly-patching-8.1.0.Final.jar:8.1.0.Final&amp;#93;&lt;/span&gt;&lt;br/&gt;
	at org.jboss.as.patching.installation.InstallationManagerService.getValue(InstallationManagerService.java:28) &lt;span class=&quot;error&quot;&gt;&amp;#91;wildfly-patching-8.1.0.Final.jar:8.1.0.Final&amp;#93;&lt;/span&gt;&lt;br/&gt;
	at org.jboss.msc.service.ServiceControllerImpl.getValue(ServiceControllerImpl.java:1158) &lt;span class=&quot;error&quot;&gt;&amp;#91;jboss-msc-1.2.2.Final.jar:1.2.2.Final&amp;#93;&lt;/span&gt;&lt;br/&gt;
	at org.jboss.as.patching.management.PatchResource$ElementProviderResourceProvider.children(PatchResource.java:139) &lt;span class=&quot;error&quot;&gt;&amp;#91;wildfly-patching-8.1.0.Final.jar:8.1.0.Final&amp;#93;&lt;/span&gt;&lt;br/&gt;
	at org.jboss.as.patching.management.PatchResource$ElementProviderResourceProvider.hasChildren(PatchResource.java:134) &lt;span class=&quot;error&quot;&gt;&amp;#91;wildfly-patching-8.1.0.Final.jar:8.1.0.Final&amp;#93;&lt;/span&gt;&lt;br/&gt;
	at org.jboss.as.controller.registry.AbstractModelResource.hasChildren(AbstractModelResource.java:81) &lt;span class=&quot;error&quot;&gt;&amp;#91;wildfly-controller-8.1.0.Final.jar:8.1.0.Final&amp;#93;&lt;/span&gt;&lt;br/&gt;
	at org.jboss.as.controller.registry.AbstractModelResource$DelegateResource.hasChildren(AbstractModelResource.java:279) &lt;span class=&quot;error&quot;&gt;&amp;#91;wildfly-controller-8.1.0.Final.jar:8.1.0.Final&amp;#93;&lt;/span&gt;&lt;br/&gt;
	at org.jboss.as.jmx.model.RootResourceIterator.doIterate(RootResourceIterator.java:57) &lt;span class=&quot;error&quot;&gt;&amp;#91;wildfly-jmx-8.1.0.Final.jar:8.1.0.Final&amp;#93;&lt;/span&gt;&lt;br/&gt;
	at org.jboss.as.jmx.model.RootResourceIterator.doIterate(RootResourceIterator.java:61) &lt;span class=&quot;error&quot;&gt;&amp;#91;wildfly-jmx-8.1.0.Final.jar:8.1.0.Final&amp;#93;&lt;/span&gt;&lt;br/&gt;
	at org.jboss.as.jmx.model.RootResourceIterator.iterate(RootResourceIterator.java:43) &lt;span class=&quot;error&quot;&gt;&amp;#91;wildfly-jmx-8.1.0.Final.jar:8.1.0.Final&amp;#93;&lt;/span&gt;&lt;br/&gt;
	at org.jboss.as.jmx.model.ModelControllerMBeanHelper.queryMBeans(ModelControllerMBeanHelper.java:125) &lt;span class=&quot;error&quot;&gt;&amp;#91;wildfly-jmx-8.1.0.Final.jar:8.1.0.Final&amp;#93;&lt;/span&gt;&lt;br/&gt;
	at org.jboss.as.jmx.model.ModelControllerMBeanServerPlugin.queryMBeans(ModelControllerMBeanServerPlugin.java:159) &lt;span class=&quot;error&quot;&gt;&amp;#91;wildfly-jmx-8.1.0.Final.jar:8.1.0.Final&amp;#93;&lt;/span&gt;&lt;br/&gt;
	at org.jboss.as.jmx.PluggableMBeanServerImpl.queryMBeans(PluggableMBeanServerImpl.java:816) &lt;span class=&quot;error&quot;&gt;&amp;#91;wildfly-jmx-8.1.0.Final.jar:8.1.0.Final&amp;#93;&lt;/span&gt;&lt;br/&gt;
	at example.ShutdownMBeanQuery.destroy(ShutdownMBeanQuery.java:23)&lt;/p&gt;</description>
                <environment></environment>
        <key id="12544056">WFCORE-29</key>
            <summary>IllegalStateException when patching MBeans are queried during shutdown</summary>
                <type id="1" iconUrl="https://issues.jboss.org/secure/viewavatar?size=xsmall&amp;avatarId=13263&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.jboss.org/images/icons/priorities/major.svg">Major</priority>
                        <status id="5" iconUrl="https://issues.jboss.org/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Done</resolution>
                                        <assignee username="jameslivingston">James Livingston</assignee>
                                    <reporter username="jameslivingston">James Livingston</reporter>
                        <labels>
                    </labels>
                <created>Tue, 17 Jun 2014 01:19:39 -0400</created>
                <updated>Mon, 13 Oct 2014 14:39:19 -0400</updated>
                            <resolved>Tue, 30 Sep 2014 16:16:06 -0400</resolved>
                                                    <fixVersion>1.0.0.Alpha4</fixVersion>
                                    <component>Domain Management</component>
                    <component>Patching </component>
                        <due></due>
                            <votes>1</votes>
                                    <watches>7</watches>
                                                                <comments>
                            <comment id="12976820" author="jameslivingston" created="Tue, 17 Jun 2014 02:08:03 -0400"  >&lt;p&gt;org.jboss.as.messaging.HornetQServerResource has a similar dependency on a MSC service, and it tests controller.getState()==ServiceController.State.UP before using it. While subject to race conditins (is that worth a bug for HornetQServerResource&apos;s potential race?) it would prevent most failures.&lt;/p&gt;</comment>
                            <comment id="12976835" author="emuckenhuber" created="Tue, 17 Jun 2014 03:03:18 -0400"  >&lt;p&gt;This seems to be a general issues when shutting down and not specific to patching. So i&apos;ll look if we can handle shutdown better in general for JMX as well, since i am already looking into some mgmt protocol related issues related to shutting down.&lt;/p&gt;</comment>
                            <comment id="12978428" author="jameslivingston" created="Sun, 22 Jun 2014 22:50:01 -0400"  >&lt;p&gt;Would doing a similar thing to HornetQServerResource in PatchResource as a temporary work-around until the general issue is fixed be acceptable? If so, I&apos;ll submit a PR for &lt;a href=&quot;https://github.com/doctau/wildfly/tree/WFLY-3505&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://github.com/doctau/wildfly/tree/WFLY-3505&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="12978474" author="japearson" created="Mon, 23 Jun 2014 04:54:30 -0400"  >&lt;p&gt;I tried out James&apos; patch for a shutdown problem I am experiencing with EAP 6.2.3 and it fixed the problem. &lt;/p&gt;</comment>
                            <comment id="12978487" author="emuckenhuber" created="Mon, 23 Jun 2014 05:50:07 -0400"  >&lt;p&gt;Yeah, i guess this would be fine as a workaround for now.&lt;/p&gt;</comment>
                            <comment id="12985823" author="jira-bugzilla-migration" created="Thu, 17 Jul 2014 02:20:56 -0400"  >&lt;p&gt;James Livingston &amp;lt;jlivings@redhat.com&amp;gt; changed the Status of &lt;a href=&quot;https://bugzilla.redhat.com/show_bug.cgi?id=1110117&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;bug 1110117&lt;/a&gt; from NEW to POST&lt;/p&gt;</comment>
                            <comment id="12988356" author="brian.stansberry" created="Mon, 28 Jul 2014 11:17:28 -0400"  >&lt;p&gt;Emanuel, since the PR is now merged, please make sure any JIRAS needed for further work are in place and then resolve this one.&lt;/p&gt;</comment>
                            <comment id="12990911" author="jira-bugzilla-migration" created="Wed, 6 Aug 2014 15:52:06 -0400"  >&lt;p&gt;Kabir Khan &amp;lt;kkhan@redhat.com&amp;gt; changed the Status of &lt;a href=&quot;https://bugzilla.redhat.com/show_bug.cgi?id=1110117&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;bug 1110117&lt;/a&gt; from POST to MODIFIED&lt;/p&gt;</comment>
                            <comment id="12997289" author="jira-bugzilla-migration" created="Mon, 1 Sep 2014 04:12:25 -0400"  >&lt;p&gt;Jan Martiska &amp;lt;jmartisk@redhat.com&amp;gt; changed the Status of &lt;a href=&quot;https://bugzilla.redhat.com/show_bug.cgi?id=1120535&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;bug 1120535&lt;/a&gt; from ON_QA to VERIFIED&lt;/p&gt;</comment>
                            <comment id="13003158" author="jira-bugzilla-migration" created="Tue, 16 Sep 2014 15:14:59 -0400"  >&lt;p&gt;Paul Gier &amp;lt;pgier@redhat.com&amp;gt; changed the Status of &lt;a href=&quot;https://bugzilla.redhat.com/show_bug.cgi?id=1110117&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;bug 1110117&lt;/a&gt; from MODIFIED to ON_QA&lt;/p&gt;</comment>
                            <comment id="13003878" author="jira-bugzilla-migration" created="Thu, 18 Sep 2014 08:50:28 -0400"  >&lt;p&gt;Martin Simka &amp;lt;msimka@redhat.com&amp;gt; changed the Status of &lt;a href=&quot;https://bugzilla.redhat.com/show_bug.cgi?id=1110117&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;bug 1110117&lt;/a&gt; from ON_QA to VERIFIED&lt;/p&gt;</comment>
                            <comment id="13011297" author="jira-bugzilla-migration" created="Mon, 13 Oct 2014 14:39:19 -0400"  >&lt;p&gt;mark yarborough &amp;lt;myarboro@redhat.com&amp;gt; changed the Status of &lt;a href=&quot;https://bugzilla.redhat.com/show_bug.cgi?id=1120535&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;bug 1120535&lt;/a&gt; from VERIFIED to CLOSED&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12383194" name="shutdownmbeanquery.jar" size="2202" author="jameslivingston" created="Tue, 17 Jun 2014 01:21:05 -0400"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310440" key="org.jboss.labs.jira.plugin.jboss-custom-field-types-plugin:multiurl">
                        <customfieldname>Bugzilla References</customfieldname>
                        <customfieldvalues>
                            https://bugzilla.redhat.com/show_bug.cgi?id=1110117, https://bugzilla.redhat.com/show_bug.cgi?id=1120535
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310341" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                        <customfieldname>Bugzilla Update</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10250"><![CDATA[Perform]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310220" key="org.jboss.labs.jira.plugin.jboss-custom-field-types-plugin:multiurl">
                        <customfieldname>Git Pull Request</customfieldname>
                        <customfieldvalues>
                            https://github.com/wildfly/wildfly-core/pull/51
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12310641" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Number of attachments</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310640" key="com.atlassian.jira.toolkit:comments">
                        <customfieldname>Number of comments</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>12.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                            <customfield id="customfield_12311940" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1|hzryl3:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310840" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>