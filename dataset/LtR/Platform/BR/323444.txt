Bug 323444  [Undo] [Commands] java.util.ConcurrentModificationException when trying to get the undo history from a source viewerI got the following exception once when attempting to get the undo history from a source viewer in my code.  Looking at the implementation of this method, I cannot seem to see how this could occur since all access to this list in DefaultOperationHistory are synchronized.  Maybe it is the creation of the iterator outside of the synchronized block?  Note that I have been unable to reproduce this since I first saw it since it seems to be a rare race condition.

Exception Stack Trace:

java.util.ConcurrentModificationException
at java.util.AbstractList$Itr.checkForComodification(AbstractList.java:372)
at java.util.AbstractList$Itr.next(AbstractList.java:343)
at org.eclipse.core.commands.operations.DefaultOperationHistory.filter(DefaultOperationHistory.java:558)
at org.eclipse.core.commands.operations.DefaultOperationHistory.getUndoHistory(DefaultOperationHistory.java:843)