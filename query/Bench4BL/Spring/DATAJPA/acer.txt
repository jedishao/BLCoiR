268	LockModePopulatingMethodInterceptor leak OutOfMemoryError PermGen spaceIn cases locking externally set invoking form Transactional call stack org springframework data jpa repository support LockModeRepositoryPostProcessor LockModePopulatingMethodIntercceptor invoke MethodInvocation registering locking mode target method key org springframework transaction support TransactionSynchronizationManager bindResource Object Object calling org springframework transaction support TransactionSynchronizationManager unbindResource Object environments classloaders discarded threads reused application web server service thread pool hot redeployments ends running PermGen space link java lang Thread threadLocals strong reference bound method keeping alive unused loader classes objects graph test written rush Heap dump https dropbox LockModeRepositoryPostProcessor LockModePopulatingMethodIntercceptorMemoryLeakTest zip LockModePopulatingMethodInterceptor leak OutOfMemoryError PermGen spaceIn cases locking externally set invoking form Transactional call stack org springframework data jpa repository support LockModeRepositoryPostProcessor LockModePopulatingMethodIntercceptor invoke MethodInvocation registering locking mode target method key org springframework transaction support TransactionSynchronizationManager bindResource Object Object calling org springframework transaction support TransactionSynchronizationManager unbindResource Object url mapping classes find entity method jar file
359	Lock annotation doesn work findOne methodIf repository defined DataObjectRepository PagingAndSortingRepository DataObject Integer Override Lock LockModeType PESSIMISTIC WRITE DataObject findOne Integer Query DataObject Lock LockModeType PESSIMISTIC WRITE DataObject findOneAndLock Integer findOne findOneAndLock specific method acquires lock Lock annotation applied CRUD method operation Interestingly applying annotation findAll method docs work documentation suggests Lock annotation apply CRUD methods created sample Maven Eclipse project demonstrate issue Derby issue MySQL discovered output running test Application ends Hibernate logging Derby Hibernate select dataobject dataobject data dataobject dataobject Hibernate select dataobject dataobject data dataobject update Hibernate select dataobject dataobject data dataobject dataobject update expected query Lock amp apos findOne acquired lock update suffix Lock annotation doesn work findOne methodIf repository defined query method named repository find entity lock hints
620	Infinite loop unsynchronized HashMap CrudMethodMetadataPostProcessor method org springframework data jpa repository support CrudMethodMetadataPostProcessor CrudMethodMetadataPopulatingMethodIntercceptor invoke thread safe called concurrently Spring Data JPA Queries executed concurrently concretely method thread safe java util HashMap concurrent calls method result infinite loop executing Hashmap Lookup amp apos metadataCache method amp apos version RELEASE encountered behavior application Infinite loops concurrently hashmaps problem https jira spring browse DATACMNS http mailinator blogspot beautiful race condition html method thread safe java util concurrent ConcurrentHashMap Infinite loop unsynchronized HashMap CrudMethodMetadataPostProcessor repository bean method metadata custom query entity lock