65	BasicPersistentEntity suffers ConcurrentModificationException BasicPersistentEntity exposes addPersistentEntity method adding properties essentially mutable opens concurrency problem scenario concurrently MongoTemplate inserting objects type MappingContext Thread enters getPersistentEntity discovers entity mapped calls addPersistentEntity algorithm eagerly adds PersistentEntity object map PersistentEntities type references detected properties discovered Thread enters getPersistentEntity discovers semi parsed PersistentEntity returns thread continues point doWithProperties invoked iterating PersistentProperties registered Thread add additional PersistentProperties ConcurrentModificationException thread BasicPersistentEntity suffers ConcurrentModificationException property type persistent entity simple map entities object
362	Potential concurrency issues RepositoriesgetRepoInfoFor iterating key set repositories cached eagerly RepositoryInformation instances upfront thread passed block code triggered lookupRepositoryFactoryInformationFor writes repositories instance variable ConcurrentModificationException reported issue Potential concurrency issues RepositoriesgetRepoInfoFor iterating key set repositories cached eagerly RepositoryInformation instances upfront repository type transaction bean set query factory annotation
390	ConcurrentModificationException MappingContextTypeInformationMapper resolveTypeFrom Spring Data Stacktrace logs Caused java util ConcurrentModificationException data race implementation org springframework data mapping context AbstractMappingContext getPersistentEntities Collection getPersistentEntities read lock persistentEntities values read unlock code acquires read lock returning values HashMap persistentEntities releases lock opens possibility thread modifies values persistentEntities thread iterating values JavaDoc java util HashMap values map modified iteration collection progress iterator remove operation iteration undefined ConcurrentModificationException nice issue ConcurrentModificationException MappingContextTypeInformationMapper resolveTypeFrom type alias mapping mapper unknown create add raw
831	AbstractMappingContext getPersistentEntity returns empty entity called multiple threads call getPersistentEntity method AbstractMappingContext type multiple threads concurrently empty entity entity properties caused race condition addPersistentEntity method thread calls method executing write lock method thread empty entity persistentEntities map thread populating properties addPersistentEntity method acquire read lock accessing persistentEntities map AbstractMappingContext getPersistentEntity returns empty entity called multiple threads set repository persistent property annotation bean query entity