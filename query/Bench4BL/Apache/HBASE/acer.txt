543	region‘s places master opening possibility race conditions region amp apos exists multiple maps RegionManager unassignedRegions pendingRegions regionsToClose closingRegions regionsToDelete race conditions HBASE HBase patch holes find ultimate solution requires lot HMaster applied HBase trunk Proposed solution Create encapsulates region’s provide access validates single structure holds regions transitional collection kind region‘s places master opening possibility race conditions region table server procedure chunk master family open
659	HLog cacheFlushLock cleared hangs region region stuck close ordained split log pertaining stuck region INFO org apache hadoop hbase HRegion checking compaction completed region enwiki sWdHJe ffGZgFPsqIvk INFO org apache hadoop hbase HRegion Splitting enwiki sWdHJe ffGZgFPsqIvk largest aggregate size desired size DEBUG org apache hadoop hbase HRegion compactions cache flushes disabled region enwiki sWdHJe ffGZgFPsqIvk DEBUG org apache hadoop hbase HRegion updates scanners region enwiki sWdHJe ffGZgFPsqIvk disabled DEBUG org apache hadoop hbase HRegion active scanners region enwiki sWdHJe ffGZgFPsqIvk DEBUG org apache hadoop hbase HRegion row locks outstanding region enwiki sWdHJe ffGZgFPsqIvk DEBUG org apache hadoop hbase HRegionServer enwiki sWdHJe ffGZgFPsqIvk closing Adding retiringRegions DEBUG org apache hadoop hbase HRegion Started memcache flush region enwiki sWdHJe ffGZgFPsqIvk Current region memcache size INFO org apache hadoop ipc Server IPC Server handler call batchUpdate enwiki sWdHJe ffGZgFPsqIvk org apache hadoop hbase BatchUpdate eeb err org apache hadoop hbase NotServingRegionException enwiki sWdHJe ffGZgFPsqIvk org apache hadoop hbase NotServingRegionException enwiki sWdHJe ffGZgFPsqIvk INFO org apache hadoop ipc Server IPC Server handler call batchUpdate enwiki sWdHJe ffGZgFPsqIvk org apache hadoop hbase BatchUpdate err org apache hadoop hbase NotServingRegionException enwiki sWdHJe ffGZgFPsqIvk org apache hadoop hbase NotServingRegionException enwiki sWdHJe ffGZgFPsqIvk thread dump threads blocked HLog cacheFlushLock code obvious code path situation lock held released regionserver compactor daemon prio tid aab nid waiting condition locked aaab java lang Integer locked aaab java lang Integer regionserver logRoller daemon prio tid aab nid waiting condition locked aaab ccf java lang Integer HLog cacheFlushLock cleared hangs region server test region snapshot flush store create compaction
663	Incorrect sequence number cache flushAn HRegion asks HStore flush cache sequence number assumption updates flushed startup reconstruction updates skipped updatesLock guarantee updates flushed HStore flushes snapshots write lock updatesLock acquired updates written log cache read lock updatesLock acquired sequence number write lock updatesLock updates sequence number written cache flushed Incorrect sequence number cache flushAn HRegion asks HStore flush cache sequence number flush region store row compaction check table test
699	TestMigrate HudsonIts hanging hudson Caught threaddump waiting vanished unix process hbase threads hanging adding relocateRegion scan verify good fixing region table hung region address TestMigrate HudsonIts hanging hudson Caught threaddump test thread rpc server create exception connection table
818	Deadlock running flushSomeRegions Playing uploading regionserver regions deadlock Java level deadlock IPC Server handler waiting lock monitor object org apache hadoop hbase regionserver Flusher held IPC Server handler IPC Server handler waiting lock monitor dec object org apache hadoop hbase regionserver HRegion WriteState held IPC Server handler IPC Server handler waiting lock monitor object java util HashSet held IPC Server handler Java stack threads listed IPC Server handler waiting lock org apache hadoop hbase regionserver Flusher IPC Server handler waiting lock org apache hadoop hbase regionserver HRegion WriteState locked java util HashSet locked org apache hadoop hbase regionserver Flusher IPC Server handler waiting lock java util HashSet locked org apache hadoop hbase regionserver HRegion WriteState deadlock Regionserver hosed Deadlock running flushSomeRegions post pre procedure key compact row scanner event
950	HTable commit longer works existing RowLocks APIIntroduced HBASE RowLock passed HTable commit update hang rowlock expires proceeds row lock HTable commit longer works existing RowLocks APIIntroduced HBASE RowLock passed HTable commit flush region test pre check row store compaction
1569	rare race condition regionserver happened hours heavy load cluster Luckily shutdown clean java lang IllegalAccessError Call open rare race condition regionserver region test store cell task master open file
1740	ICV subtle race condition visible high load ICV demonstrates race condition high load result duplicate KeyValue timestamp memcache hfile hfile scan code doesnt read picks arbitrarily keyvalues correct incorrect deeper level start ICV snapshot moves memstore snapshot ICV code puts key memstore timestamp keyvalue snapshot deep race condition attempts failed production issue permanent ICV subtle race condition visible high load test region file flush replay prefetch open store
1840	RowLock fails IndexTableThe exception thrown RowLock update row IndexedTable junit java IOException java IOException Invalid row lock junit junit junit junit junit junit junit junit junit junit NOTE numbers stacktrace sense amp apos hacking loads debug info NOTE attaching includes unit tests RowLock fails IndexTableThe exception thrown RowLock update row IndexedTable flush region test row check store pre compaction
1869	IndexedTable delete fails conjunction RowLock Created test TestIndexedTable testLockedRowDelete IOException writeInitalRows Delete row row PerformanceEvaluation format RowLock lock table lockRow row table delete Delete row HConstants LATEST TIMESTAMP lock table unlockRow lock assertRowDeleted NUM ROWS fails exception java IOException java IOException Invalid row lock Patch coded latest version SVN testing packaging attach shortly IndexedTable delete fails conjunction RowLock flush region row check pre store post compaction
2023	Client sync block thread multi threaded client block othersTake highly multithreaded client processing requests table offline thread stuck locateRegionInMeta located sync block userRegionLock locateRegionInMeta META TABLE tableName row useCache threads find region CACHED encounter sync wait issue busy thrift server noticed problem region offline prevent access regions Potential solution narrow lock rid completely Client sync block thread multi threaded client block othersTake highly multithreaded client processing requests block size region create request log call set
6565	Coprocessor exec result Map thread safe develop coprocessor program repeated tests result size appears read HTable java code TreeMap thread unsafe multithreading environment bug happened Coprocessor exec result Map thread safe region post table check file pre coprocessor set
8923	ChaosMonkey test teardown fail race ChaosMonkey chaosmonkey restarts moment test teardown cluster recovery cluster status process running cluster recovery start ExitCodeException Boom ChaosMonkey test teardown fail race ChaosMonkey test set monkey key data load reader verify
13606	AssignmentManager assign sync pathfrom comment expected behavior AssignmentManager assign sync Assigns regions robin synchronous call region assign List HRegionInfo regions code path sync async servers regions bulkAssignThresholdRegions amp amp servers bulkAssignThresholdServers HRegionInfo region plan getValue invokeAssign region async threadPool submit assign BulkAssigner GeneralBulkAssigner bulkAssign sync calls BulkAssign waitUntilDone https builds apache org job HBase TestCreateTableProcedure flaky async behavior AssignmentManager assign sync pathfrom comment expected behavior AssignmentManager assign sync region server meta procedure assign transition assignment table
13662	RSRpcService scan OutOfOrderScannerNext scan retriable failurewhile fixing HBASE noticed failure RSRpcService scan request hasNextCallSeq nextCallSeq incremented rolledback client retry send request nextCallSeq result OutOfOrderScannerNextException rows request hasNextCallSeq request getNextCallSeq rsh nextCallSeq OutOfOrderScannerNextException Increment nextCallSeq expected client rsh nextCallSeq scan code scanner heartbeat patches HBASE recover OutOfOrder exception error discussion Stack ended decrementing callSeq exception fine open question nextCallSeq atomic supposed prevent concurrent requests thoughts RSRpcService scan OutOfOrderScannerNext scan retriable failurewhile fixing HBASE table count region snapshot read scan dependency num
13959	Region splitting single thread common cases storefiles split region split current logic threadpool size set size number stores common table setup involves single column family translates single store threadpool single thread write heavy workload tens storefiles store time splitting threadpool size files split sequentially bit tracing noticed takes average create single reference file splitting storefile involves creating storefile count takes phase reference files storefile pushing total time region offline environments setup fail fast client exhaust retries fail NotServingRegionException increase concurrency operation Region splitting single thread common cases log split region compaction file test edits writer
13988	Add exception handler lease thread prod cluster region server exited threads alive excluding threads log doubted lease thread root add exception handler lease thread debug exited INFO org apache hadoop hbase regionserver HRegionServer STOPPED threads longer alive INFO org apache hadoop ipc HBaseServer Stopping server INFO org apache hadoop hbase regionserver LogRoller LogRoller exiting INFO org apache hadoop hbase regionserver MemStoreFlusher Thread exiting INFO org apache hadoop hbase regionserver HRegionServer CompactionChecker regionserver compactionChecker exiting INFO org apache hadoop hbase regionserver HRegionServer PeriodicMemstoreFlusher regionserver periodicFlusher exiting Add exception handler lease thread procedure queue call time thread sync rpc lease
14178	regionserver blocks waiting offsetLock regionserver blocks client rpc timeout print regionserver jstack lot threads blocked waiting offsetLock detail infomation belows table block cache DefaultRpcServer handler queue port daemon prio prio tid nid cdc Object wait java lang Thread WAITING object monitor locked org apache hadoop hbase util IdLock Entry locked org apache hadoop hbase regionserver HRegion RegionScannerImpl Locked ownable synchronizers java util concurrent locks ReentrantLock NonfairSync regionserver blocks waiting offsetLock region compaction file master update store test start
14241	deadlock cluster shutdown concurrent connection closeCaught testing branch shutting TestMasterMetricsWrapper Java level deadlock MASTER META SERVER OPERATIONS waiting lock monitor object org apache hadoop hbase util PoolMap held waiting lock monitor object org apache hadoop hbase ipc RpcClientImpl Connection held MASTER META SERVER OPERATIONS Full stack dump deadlock debug output attached Root RpcClientImpl close lock connections connections Connection conn connections values markClosed lock connection object conn isAlive conn markClosed InterruptedIOException RpcClient closing conn close thread MetaServerShutdownHandler calls RpcClientImpl Connection setupIOstreams markClosed close Lock connection object lock connections attempted leading deadlock connections connections removeValue remoteId deadlock cluster shutdown concurrent connection closeCaught testing branch shutting TestMasterMetricsWrapper region master cluster server node call start client
14359	HTable close hang unchecked error exception thrown AsyncProcess sendMultiActionCurrently AsyncProcess sendMultiAction RejectedExecutionException error exception decTaskCounter invoked recommendation HTable close table clause HTable close call flushCommits wait task problem unchecked error exception OutOfMemoryError thrown taskSent equal taskDone AsyncProcess waitUntilDone autoflush set data flush table close rpc call rpcTimeOut call thread wait product env unchecked error observed java lang OutOfMemoryError unable create thread observed client thread hang hours HTable close hang unchecked error exception thrown AsyncProcess sendMultiActionCurrently test region table replica request server time set
14463	Severe performance downgrade parallel reading single key BucketCacheWe store feature data online items HBase machine learning features supply outputs online search engine scenario launch hundreds yarn workers worker read features item single rowkey HBase heavy parallel reading single rowkey LruCache start BucketCache resolve issue titled observed severe performance downgrade analytics root lock BucketCache getBlock lockEntry offsetLock getLockEntry bucketEntry offset bucketEntry equals backingMap key len bucketEntry getLength Cacheable cachedBlock ioEngine read bucketEntry offset len bucketEntry deserializerReference deserialiserMap ioEnging read involves array copy time costed operation LruCache IdLock getLockEntry parallel read dropping bucket executed serial bad performance resolve problem propose ReentranceReadWriteLock BucketCache introduce called IdReadWriteLock implement Severe performance downgrade parallel reading single key BucketCacheWe store feature data online items HBase machine learning features supply outputs online search engine set region file count block table meta split
14555	Deadlock MVCC branch toString test Thread PriorityRpcServer handler queue port BLOCKED Blocked count Waited count Blocked java util LinkedList Blocked PriorityRpcServer handler queue port Stack org apache hadoop hbase regionserver MultiVersionConcurrencyControl toString MultiVersionConcurrencyControl java java lang String valueOf String java java lang StringBuilder append StringBuilder java org apache hadoop hbase regionserver MultiVersionConcurrencyControl waitForRead MultiVersionConcurrencyControl java org apache hadoop hbase regionserver MultiVersionConcurrencyControl completeAndWait MultiVersionConcurrencyControl java org apache hadoop hbase regionserver HRegion doMiniBatchMutation HRegion java org apache hadoop hbase regionserver HRegion batchMutate HRegion java org apache hadoop hbase regionserver HRegion batchMutate HRegion java org apache hadoop hbase regionserver RSRpcServices doBatchOp RSRpcServices java org apache hadoop hbase regionserver RSRpcServices doNonAtomicRegionMutation RSRpcServices java org apache hadoop hbase regionserver RSRpcServices multi RSRpcServices java org apache hadoop hbase protobuf generated ClientProtos ClientService callBlockingMethod ClientProtos java org apache hadoop hbase ipc RpcServer call RpcServer java org apache hadoop hbase ipc CallRunner CallRunner java org apache hadoop hbase ipc RpcExecutor consumerLoop RpcExecutor java org apache hadoop hbase ipc RpcExecutor RpcExecutor java java lang Thread Thread java Thread PriorityRpcServer handler queue port BLOCKED Blocked count Waited count Blocked java lang Object Blocked PriorityRpcServer handler queue port Stack org apache hadoop hbase regionserver MultiVersionConcurrencyControl complete MultiVersionConcurrencyControl java org apache hadoop hbase regionserver MultiVersionConcurrencyControl completeAndWait MultiVersionConcurrencyControl java org apache hadoop hbase regionserver HRegion doMiniBatchMutation HRegion java org apache hadoop hbase regionserver HRegion batchMutate HRegion java org apache hadoop hbase regionserver HRegion batchMutate HRegion java org apache hadoop hbase regionserver RSRpcServices doBatchOp RSRpcServices java org apache hadoop hbase regionserver RSRpcServices doNonAtomicRegionMutation RSRpcServices java org apache hadoop hbase regionserver RSRpcServices multi RSRpcServices java org apache hadoop hbase protobuf generated ClientProtos ClientService callBlockingMethod ClientProtos java org apache hadoop hbase ipc RpcServer call RpcServer java org apache hadoop hbase ipc CallRunner CallRunner java org apache hadoop hbase ipc RpcExecutor consumerLoop RpcExecutor java org apache hadoop hbase ipc RpcExecutor RpcExecutor java java lang Thread Thread java Thread PriorityRpcServer handler queue port Deadlock MVCC branch toString test test region family log flush file peer write
14812	ResultBoundedCompletionService deadlock thrift worker daemon prio prio tid nid Object wait java lang Thread WAITING object monitor locked Lorg apache hadoop hbase client ResultBoundedCompletionService QueueingFuture locked org apache hadoop hbase client BufferedMutatorImpl ResultBoundedCompletionService deadlock store compaction file post pre group size flush
14926	Hung ThriftServer timeout read client client crashes worker thread stuck readingThrift server hung worker threads thrift worker daemon prio tid nid runnable java lang Thread RUNNABLE locked java BufferedInputStream recover don client side logs HBASE connected client thrift sockets server side read timeout patch applied branch thrift changed Hung ThriftServer server table scanner test num set conf create
15001	Thread Safety issues ReplicationSinkManager HBaseInterClusterReplicationEndpoint ReplicationSinkManager thread safe problems HBaseInterClusterReplicationEndpoint walprovider multiwal multiple threads report bad sinks sink list empty report negative size ArrayList thread safe HBaseInterClusterReplicationEndpoint depends number sinks batch edits shipping code assume batches process sink size time reach batching sink size replicationSinkMgr getSinks size Math min Math min maxThreads entries size replicationSinkMgr getSinks size Update leads ArithmeticException division entryLists Math abs Bytes hashCode getKey getEncodedRegionName add benign lead retries ReplicationSource idea operations ReplicationSinkManager thread safe verification size replicated edits report success Thread Safety issues ReplicationSinkManager HBaseInterClusterReplicationEndpoint replication failure auths time sink lock server fast
15030	Deadlock master TableNamespaceManager running IntegrationTestDDLMasterFailoverI running IntegrationTestDDLMasterFailover distributed cluster notice relevant master jstack ProcedureExecutor daemon prio tid nid waiting monitor entry java lang Thread BLOCKED object monitor waiting lock org apache hadoop hbase master TableNamespaceManager Locked ownable synchronizers java util concurrent locks ReentrantReadWriteLock NonfairSync ProcedureExecutor daemon prio tid nid waiting condition java lang Thread TIMED WAITING parking parking wait java util concurrent locks ReentrantReadWriteLock NonfairSync locked org apache hadoop hbase master TableNamespaceManager Locked ownable synchronizers Java level deadlock ProcedureExecutor waiting ownable synchronizer java util concurrent locks ReentrantReadWriteLock NonfairSync held ProcedureExecutor ProcedureExecutor waiting lock monitor object org apache hadoop hbase master TableNamespaceManager held ProcedureExecutor Java stack threads listed ProcedureExecutor parking wait java util concurrent locks ReentrantReadWriteLock NonfairSync locked org apache hadoop hbase master TableNamespaceManager ProcedureExecutor waiting lock org apache hadoop hbase master TableNamespaceManager deadlock dig info happened logs showing Deadlock master TableNamespaceManager running IntegrationTestDDLMasterFailoverI running IntegrationTestDDLMasterFailover distributed cluster notice master region cluster key server namespace table start
15093	Replication report incorrect size log queue global source multiwal enabled Replication report incorrect size size log queue global source multiwal enabled method MetricsSource setSizeofLogQueue performs trivial operations multithreaded simply divide MetricsSource setSizeofLogQueue MetricsSource incrSizeofLogQueue MetricsSource decrSizeofLogQueue setting size incrementing decrementing Replication report incorrect size log queue global source multiwal enabled log replication peer file source size entry path
15146	Don block Reader threads queueing scheduler queueBlocking epoll thread awful rpc scheduler lots queues queues capacity limits dispatch method block add blocking queue schedulers readers block tcp acks delayed slows Don block Reader threads queueing scheduler queueBlocking epoll thread awful procedure file block chore set thread data time
15650	Remove TimeRangeTracker point contention threads reading StoreFile HBASE Remove TimeRangeTracker point contention threads writing Store point contention reading Remove TimeRangeTracker point contention threads reading StoreFile sync file test cell region set snapshot timestamp
15957	RpcClientImpl close ends circumstances bug HBASE HBASE HBASE introduced check alive connections connection alive close conn isAlive connsToClose connsToClose HashSet Connection connsToClose add conn connsToClose Connection conn connsToClose conn markClosed InterruptedIOException RpcClient closing conn close worked fine HBASE introduced handling interrupt writer thread cts callsToWrite InterruptedException markClosed InterruptedIOException writer thread running connection thread started interrupt calling markClosed set shouldCloseConnection flag parent connection time handling alive connections markClosed close called result connection removed connections pool RpcClientImpl close finish RpcClientImpl close ends circumstances log region test server edits file close recovered
16081	Replication remove peer stuck blocks WAL rollingWe blocking CompletionService HBaseInterClusterReplicationEndpoint remove peer shut threads gracefully race condition underlying executor shutdown CompletionService block remove peer call gracefully finish ReplicationSourceManager removePeer ReplicationSourceManager recordLog lock object roll WALs situation gigantic WALs Replication remove peer stuck blocks WAL rollingWe blocking CompletionService HBaseInterClusterReplicationEndpoint peer log table replication queue queues source test
16144	Replication queue lock live acquiring lock died prematurelyIn multi operation claimQueues set hbase zookeeper useMulti add lock copy nodes clean queue lock acquiring lock crash claimQueues lock claim queue Replication queue lock live acquiring lock died prematurelyIn multi operation claimQueues lock queue set procedure log table region test
16304	HRegion RegionScannerImpl handleFileNotFoundException lead deadlock write lock updatesLockhere jvm stack Full thread dump Java HotSpot Bit Server mixed mode Timer amp apos HBase amp apos metrics system daemon prio tid nid xafa Object wait java lang Thread TIMED WAITING object monitor locked java util TaskQueue Attach Listener daemon prio tid nid waiting condition java lang Thread RUNNABLE IPC Parameter Sending Thread daemon prio tid nid waiting condition java lang Thread TIMED WAITING parking parking wait java util concurrent SynchronousQueue TransferStack LOG REPLAY OPS hadoop datanode prio tid nid waiting condition java lang Thread WAITING parking parking wait ffb java util concurrent locks AbstractQueuedSynchronizer ConditionObject LOG REPLAY OPS hadoop datanode prio tid nid waiting condition bba java lang Thread WAITING parking parking wait ffb java util concurrent locks AbstractQueuedSynchronizer ConditionObject hadoop datanode corp cootek ChoreService daemon prio tid nid waiting condition java lang Thread WAITING parking parking wait java util concurrent locks AbstractQueuedSynchronizer ConditionObject CLOSE REGION hadoop datanode prio tid nid xab waiting condition java lang Thread WAITING parking parking wait java util concurrent locks ReentrantReadWriteLock NonfairSync locked java lang Object CLOSE REGION hadoop datanode prio tid cfa nid xab waiting condition ebd java lang Thread WAITING parking parking wait ffb java util concurrent locks AbstractQueuedSynchronizer ConditionObject CLOSE REGION hadoop datanode prio tid nid xab waiting condition java lang Thread WAITING parking parking wait ffb java util concurrent locks AbstractQueuedSynchronizer ConditionObject group cache daemon prio tid nid waiting condition java lang Thread WAITING parking parking wait java util concurrent locks AbstractQueuedSynchronizer ConditionObject ReplicationExecutor daemon prio tid nid waiting condition java lang Thread WAITING parking parking wait ffb java util concurrent locks AbstractQueuedSynchronizer ConditionObject OPEN REGION hadoop datanode prio tid nid waiting condition java lang Thread WAITING parking parking wait java util concurrent locks AbstractQueuedSynchronizer ConditionObject OPEN REGION hadoop datanode prio tid nid waiting condition java lang Thread WAITING parking parking wait java util concurrent locks AbstractQueuedSynchronizer ConditionObject OPEN REGION hadoop datanode prio tid nid waiting condition java lang Thread WAITING parking parking wait java util concurrent locks AbstractQueuedSynchronizer ConditionObject org apache hadoop hdfs PeerCache daemon prio tid cfdd nid waiting condition java lang Thread TIMED WAITING sleeping hadoop datanode Replication Statistics daemon prio tid nid waiting condition java lang Thread TIMED WAITING parking parking wait fef java util concurrent locks AbstractQueuedSynchronizer ConditionObject HBase Metrics daemon prio tid nid waiting condition java lang Thread TIMED WAITING parking parking wait java util concurrent locks AbstractQueuedSynchronizer ConditionObject sync prio tid nid waiting condition java lang Thread WAITING parking parking wait java util concurrent locks AbstractQueuedSynchronizer ConditionObject sync prio tid nid waiting condition java lang Thread WAITING parking parking wait java util concurrent locks AbstractQueuedSynchronizer ConditionObject sync prio tid nid waiting condition java lang Thread WAITING parking parking wait fef java util concurrent locks AbstractQueuedSynchronizer ConditionObject sync prio tid nid waiting condition java lang Thread WAITING parking parking wait java util concurrent locks AbstractQueuedSynchronizer ConditionObject sync prio tid nid waiting condition java lang Thread WAITING parking parking wait fef java util concurrent locks AbstractQueuedSynchronizer ConditionObject regionserver hadoop datanode corp cootek append pool prio tid nid waiting condition java lang Thread WAITING parking parking wait java util concurrent locks AbstractQueuedSynchronizer ConditionObject LeaseRenewer hadoop hadoop namenode daemon prio tid nid waiting condition java lang Thread TIMED WAITING sleeping JvmPauseMonitor daemon prio tid nid waiting condition java lang Thread TIMED WAITING sleeping regionserver hadoop datanode corp cootek prio tid nid waiting condition java lang Thread TIMED WAITING sleeping ReplicationRpcServer handler queue port daemon prio tid cfe nid waiting condition java lang Thread WAITING parking parking wait java util concurrent locks AbstractQueuedSynchronizer ConditionObject ReplicationRpcServer handler queue port daemon prio tid cfdf nid waiting condition java lang Thread WAITING parking parking wait java util concurrent locks AbstractQueuedSynchronizer ConditionObject ReplicationRpcServer handler queue port daemon prio tid cfdd nid waiting condition java lang Thread WAITING parking parking wait java util concurrent locks AbstractQueuedSynchronizer ConditionObject PriorityRpcServer handler queue port daemon prio tid cfdb nid waiting condition java lang Thread WAITING parking parking wait java util concurrent locks AbstractQueuedSynchronizer ConditionObject PriorityRpcServer handler queue port daemon prio tid cfd nid waiting condition java lang Thread WAITING parking parking wait java util concurrent locks AbstractQueuedSynchronizer ConditionObject PriorityRpcServer handler queue port daemon prio tid cfd nid waiting condition java lang Thread WAITING parking parking wait java util concurrent locks AbstractQueuedSynchronizer ConditionObject PriorityRpcServer handler queue port daemon prio tid cfd nid waiting condition java lang Thread WAITING parking parking wait java util concurrent locks AbstractQueuedSynchronizer ConditionObject PriorityRpcServer handler queue port daemon prio tid cfd nid waiting condition java lang Thread WAITING parking parking wait java util concurrent locks AbstractQueuedSynchronizer ConditionObject PriorityRpcServer handler queue port daemon prio tid cfd nid waiting condition java lang Thread WAITING parking parking wait java util concurrent locks AbstractQueuedSynchronizer ConditionObject PriorityRpcServer handler queue port daemon prio tid cfce nid waiting condition java lang Thread WAITING parking parking wait java util concurrent locks AbstractQueuedSynchronizer ConditionObject PriorityRpcServer handler queue port daemon prio tid cfcc nid waiting condition java lang Thread WAITING parking parking wait java util concurrent locks AbstractQueuedSynchronizer ConditionObject PriorityRpcServer handler queue port daemon prio tid cfca nid waiting condition java lang Thread WAITING parking parking wait java util concurrent locks AbstractQueuedSynchronizer ConditionObject PriorityRpcServer handler queue port daemon prio tid cfc nid waiting condition java lang Thread WAITING parking parking wait java util concurrent locks AbstractQueuedSynchronizer ConditionObject PriorityRpcServer handler queue port daemon prio tid cfc nid waiting condition java lang Thread WAITING parking parking wait java util concurrent locks AbstractQueuedSynchronizer ConditionObject PriorityRpcServer handler queue port daemon prio tid cfc nid waiting condition java lang Thread WAITING parking parking wait java util concurrent locks AbstractQueuedSynchronizer ConditionObject PriorityRpcServer handler queue port daemon prio tid
16367	Race master region server initialization lead premature server abort troubleshooting hbase master dies shortly start attached master log snippet turned master initialization thread racing HRegionServer preRegistrationInitialization initializeZooKeeper HMaster HRegionServer additional logging master oldLogDir createInitialFileSystemLayout HFileSystem addLocationsOrderInterceptor conf LOG info creating splitLogManager execution didn reach log region server declared cluster Race master region server initialization lead premature server abort region master server table regions start manager check
16429	FSHLog deadlock rollWriter called ring buffer filled appendsRecently experienced online problem handlers stuck Checking jstack handler threads waiting RingBuffer single ring buffer consumer dead waiting safePointReleasedLatch count Normal handler thread defaultRpcServer handler queue port daemon prio tid efd nid runnable efd java lang Thread TIMED WAITING parking RingBufferEventHandler thread waiting safePointReleasedLatch regionserver hadoop tbsite net append pool prio tid efd nid waiting condition efd java lang Thread WAITING parking parking wait java util concurrent CountDownLatch Sync FSHLog replaceWriter call SafePointZigZagLatch releaseSafePoint count safePointReleasedLatch replaceWriter stuck publish sync ring buffer regionserver hadoop tbsite net logRoller daemon prio tid efd nid runnable efd java lang Thread TIMED WAITING parking deadlock process deadlock forms ring buffer filled appends rollWriter consumer ring buffer waiting safePointReleasedLatch rollWriter publish sync ring buffer full rollWriter won amp apos release safePointReleasedLatch JIRA targeting resolve issue add cover FSHLog deadlock rollWriter called ring buffer filled appendsRecently experienced online problem handlers stuck sync log roll writer cell time file event
16699	Overflows AverageIntervalRateLimiter apos refill getWaitInterval overflow places concurrent issue post patch days figure adding unittest cases lines overflows wrong behavior unconfigured RateLimiters simpler logic byPass check https github apache hbase blob master hbase server src main java org apache hadoop hbase quotas AverageIntervalRateLimiter java https github apache hbase blob master hbase server src main java org apache hadoop hbase quotas AverageIntervalRateLimiter java Overflows AverageIntervalRateLimiter apos refill getWaitInterval test time unit limiter server interval refill html
16721	Concurrency issue WAL unflushed seqId tracking inspecting interesting production cluster regionservers ends accumulating hundreds WAL files force flushes max logs happened multiple times cluster clusters cluster periodic memstore flusher disabled explain force flush regions max limit working periodic memstore flusher masks underlying problem clusters problem starts INFO regionserver logRoller wal FSHLog wals logs maxlogs forcing flush regions WARN regionserver logRoller regionserver LogRoller Failed schedule flush region requester continues restarted INFO regionserver logRoller wal FSHLog wals logs maxlogs forcing flush regions WARN regionserver logRoller regionserver LogRoller Failed schedule flush region requester problem region split time flush data split problems FSHLog thinks unflushed data region Concurrency issue WAL unflushed seqId tracking flush region store seq row test check compaction
16788	Race compacted file deletion HStore close closeAndArchiveCompactedFiles HBASE changed compacted files archived inline compaction completion async cleanup CompactedHFilesDischarger chore HStore support introduced race condition compacted HFile archiving sequence wind separate threads archive HFiles causing regionserver abort compaction completes compacted files compactedfiles HStore DefaultStoreFileManager threadA CompactedHFilesDischargeHandler runs executor service calling closeAndArchiveCompactedFiles obtains HStore readlock copy compactedfiles releases readlock threadB calls HStore close region close obtains HStore writelock calls DefaultStoreFileManager clearCompactedfiles copy compactedfiles threadA calls HStore removeCompactedfiles compactedfiles archives files compactedfiles HRegionFileSystem removeStoreFiles call HStore clearCompactedFiles waits write lock threadB continues close calls removeCompactedfiles compactedfiles calls HRegionFIleSystem removeStoreFiles HFileArchiver archiveStoreFiles receives FileNotFoundException files archived thread IOException aborts combination fetching compactedfiles list removing files covered locking Options Modify HStore closeAndArchiveCompactedFiles writelock readlock move call removeCompactedfiles lock read operations blocked files archived bad Synchronize closeAndArchiveCompactedFiles modify close call calling removeCompactedfiles Add separate lock compacted files removal closeAndArchiveCompactedFiles close Race compacted file deletion HStore close closeAndArchiveCompactedFiles flush file store compaction files region scan test